*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  UCBLOOK                               -03/18/08-<3> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  UCB Look-Up                                   * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 1990, 2008                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7750                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The UCBLOOK macro is used to obtain the UCB common segment     * 00002100
*      address of a given device number or a given volume serial.     * 00002200
*      The input device number may be specified either as binary or   * 00002300
*      EBCDIC.                                                        * 00002400
*                                                                     * 00002500
*      UCBLOOK can be used to locate any UCB including those defined  * 00002600
*      as dynamic and those with 4 digit device numbers.  The caller  * 00002700
*      must cause the UCB to be pinned via the PIN parameter unless   * 00002800
*      the caller is running in an environment such that dynamic I/O  * 00002900
*      configuration changes cannot occur.                            * 00003000
*                                                                     * 00003100
*      UCBLOOK can be used to locate Actual UCBs that are located     * 00003200
*      above or below the 16Mb line.                                  * 00003300
*                                                                     * 00003400
*      The contents of registers 0, 1, 14, and 15 are altered by the  * 00003500
*      macro expansion.                                               * 00003600
*                                                                     * 00003700
*      The parameter list must be in the caller's primary address     * 00003800
*      space or be addressable by the dispatchable unit access list.  * 00003900
*                                                                     * 00004000
*      The LINKAGE=BRANCH option is intended for performance          * 00004100
*      sensitive invokers or programs which require this function     * 00004200
*      during NIP before a PC can be issued.                          * 00004300
*                                                                     * 00004400
*      The NONBASE=YES option is intended for including alias UCBs of * 00004500
*      a parallel access volume.  If this option is not specified     * 00004600
*      then UCBLOOK will not return the UCB address of an alias UCB.  * 00004700
*                                                                     * 00004800
*      The UNBOUND_ALIAS=YES option is intended for including alias   * 00004900
*      UCBs of a parallel access volume that have not yet been bound  * 00005000
*      to a base PAV.  If this option is not specified then UCBLOOK   * 00005100
*      will not return the UCB address of an alias UCB.               * 00005200
*                                                                     * 00005300
*01* EXTERNAL CLASSIFICATION:                                         * 00005400
*                                                                     * 00005500
*02* GUPI: BASE                                                       * 00005600
*                                                                     * 00005700
*02* PSPI: FIELDS                                                     * 00005800
*          UCBPXPTR, UCBPAREA                                         * 00005900
*                                                                     * 00006000
*02* NONE: FIELDS                                                     * 00006100
*          NOTFIND, UNBOUND_ALIAS                                     * 00006200
*                                                                     * 00006300
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00006400
*                                                                     * 00006500
*01* ENVIRONMENT:                                                     * 00006600
*                                                                     * 00006700
*                                                                     * 00006800
*      Dispatchable unit mode: Task or SRB mode.                      * 00006900
*                                                                     * 00007000
*      Minimum authorization: Supervisor state or program key mask    * 00007100
*                        (PKM) allowing keys 0-7.                     * 00007200
*                                                                     * 00007300
*      AMODE:            24- or 31-bit.                               * 00007400
*                                                                     * 00007500
*      ASC mode:         Primary or Access Register.                  * 00007600
*                                                                     * 00007700
*                        If in Access Register ASC mode, specify      * 00007800
*                        SYSSTATE ASCENV=AR before invoking this      * 00007900
*                        macro.                                       * 00008000
*                                                                     * 00008100
*      Interrupt status: Enabled or disabled for I/O and external     * 00008200
*                        interrupts.                                  * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*                                                                     * 00008600
*01* RESTRICTIONS:                                                    * 00008700
*    The invoker must not hold any lock higher than the IOSULUT lock. * 00008800
*                                                                     * 00008900
*    The LINKAGE=BRANCH option is limited to callers which meet the   * 00009000
*    following criteria:                                              * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*    o   supervisor state key 0                                       * 00009400
*                                                                     * 00009500
*    o   31 bit addressing mode                                       * 00009600
*                                                                     * 00009700
*    o   primary ASC mode                                             * 00009800
*                                                                     * 00009900
*    o   the parameter list (including any data areas pointed to by   * 00010000
*        the parameter list) resides in fixed or DREF storage         * 00010100
*                                                                     * 00010200
*                                                                     * 00010300
*                                                                     * 00010400
*01* SYNTAX:                                                          * 00010500
*                                                                     * 00010600
*Ýxlabel¨  UCBLOOK  Ð  DEVN=xdevn                                     * 00010700
*                   !    Ý,SCHSET=»xschset!0º¨                        * 00010800
*                   Ô ,DEVNCHAR=xdevnchar                             * 00010900
*                   !    Ý,SCHSET=»xschset!0º¨                        * 00011000
*                   Ô ,LDEVNCHAR=xldevnchar                           * 00011100
*                   ¿ ,VOLSER=xvolser                                 * 00011200
*                        Ý,DEVCLASS=»DASDTAPE!TAPE!DASDº¨             * 00011300
*                     ,UCBPTR=xucbptr                                 * 00011400
*                    Ý,UCBCXPTR=xucbcxptr¨                            * 00011500
*                    Ý,UCBPXPTR=xucbpxptr¨                            * 00011600
*                    Ý,LOC=»BELOW!ANYº¨                               * 00011700
*                    Ý,DYNAMIC=»NO!YESº¨                              * 00011800
*                    Ý,RANGE=»3DIGIT!ALLº¨                            * 00011900
*                    Ý,NONBASE=»NO!YESº¨                              * 00012000
*                    Ý,UNBOUND_ALIAS=»NO!YESº¨                        * 00012100
*                    Ý,SPECIAL=»NO!YESº¨                              * 00012200
*                    Ý,NOTFIND=»NO!YESº¨                              * 00012300
*                   Ð ,PIN                                            * 00012400
*                   !     ,TEXT=xtext                                 * 00012500
*                   !     ,PTOKEN=xptoken                             * 00012600
*                   !    Ý,COMPID=»xcompid!NONEº¨                     * 00012700
*                   !    Ý,HELP=»xhelp!NONEº¨                         * 00012800
*                   !    Ý,LASTING¨                                   * 00012900
*                   !    Ý,PINPATHS¨                                  * 00013000
*                   ¿ ,NOPIN                                          * 00013100
*                    Ý,UCBPAREA=»xucbparea!NONEº¨                     * 00013200
*                    Ý,IOCTOKEN=»xioctoken!NONEº¨                     * 00013300
*                    Ý,LINKAGE=»SYSTEM!BRANCHº¨                       * 00013400
*                    Ý,RETCODE=xretcode¨                              * 00013500
*                    Ý,RSNCODE=xrsncode¨                              * 00013600
*                    Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨          * 00013700
*                   ÐÝ,MF=S¨                                          * 00013800
*                   ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                   * 00013900
*                   ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                     * 00014000
*                                                                     * 00014100
*                                                                     * 00014200
*      Where:                                                         * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*      Ýxlabel¨                                                       * 00014600
*          is an optional symbol, starting in column 1, that is the   * 00014700
*          name on the UCBLOOK macro invocation.  The name must       * 00014800
*          conform to the rules for an ordinary assembler language    * 00014900
*          symbol.                                                    * 00015000
*          DEFAULT: No name.                                          * 00015100
*                                                                     * 00015200
*                                                                     * 00015300
*                                                                     * 00015400
*                                                                     * 00015500
*      The following is a set of mutually exclusive keys.  This set   * 00015600
*      is required; only one key must be specified.                   * 00015700
*                                                                     * 00015800
*                                                                     * 00015900
*      DEVN=xdevn                                                     * 00016000
*          belongs to a set of mutually exclusive keys. It is the     * 00016100
*          name (RS-type), or address in register (2)-(12), of a      * 00016200
*          halfword input which specifies the device number in binary * 00016300
*          of the device whose UCB address is to be obtained.         * 00016400
*                                                                     * 00016500
*                                                                     * 00016600
*          ÝSCHSET=»xschset!0º¨                                       * 00016700
*              is the name (RS-type), or address in register          * 00016800
*              (2)-(12), of an optional byte input which specifies    * 00016900
*              the subchannel set of the device.                      * 00017000
*              DEFAULT: 0.                                            * 00017100
*                                                                     * 00017200
*                                                                     * 00017300
*                                                                     * 00017400
*      DEVNCHAR=xdevnchar                                             * 00017500
*          belongs to a set of mutually exclusive keys. It is the     * 00017600
*          name (RS-type), or address in register (2)-(12), of a 4    * 00017700
*          character input which specifies the device number in       * 00017800
*          EBCDIC of the device whose UCB address is to be obtained.  * 00017900
*                                                                     * 00018000
*          NOTE:  A three digit device number can either be           * 00018100
*          represented as ' ddd' or '0ddd'.                           * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*          ÝSCHSET=»xschset!0º¨                                       * 00018500
*              is the name (RS-type), or address in register          * 00018600
*              (2)-(12), of an optional byte input which specifies    * 00018700
*              the subchannel set of the device.                      * 00018800
*              DEFAULT: 0.                                            * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*                                                                     * 00019200
*      LDEVNCHAR=xldevnchar                                           * 00019300
*          belongs to a set of mutually exclusive keys. It is the     * 00019400
*          name (RS-type), or address in register (2)-(12), of a 5    * 00019500
*          character input which specifies the logical device number  * 00019600
*          in EBCDIC of the device whose UCB address is to be         * 00019700
*          obtained.                                                  * 00019800
*                                                                     * 00019900
*          NOTE:  A logical device number is represented by the       * 00020000
*          1-digit subchannel set id followed by the 4-digit device   * 00020100
*          number: 'sdddd'.                                           * 00020200
*                                                                     * 00020300
*      VOLSER=xvolser                                                 * 00020400
*          belongs to a set of mutually exclusive keys. It is the     * 00020500
*          name (RS-type), or address in register (2)-(12), of a 6    * 00020600
*          character input which specifies the volume serial in       * 00020700
*          EBCDIC of the device whose UCB address is to be obtained.  * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*          ÝDEVCLASS=»DASDTAPE!TAPE!DASDº¨                            * 00021100
*              is an optional keyword input which specifies the       * 00021200
*              device class that is to be searched for the VOLSER     * 00021300
*              look-up.                                               * 00021400
*              DEFAULT: DASDTAPE                                      * 00021500
*                                                                     * 00021600
*                                                                     * 00021700
*              DEVCLASS=DASDTAPE                                      * 00021800
*                  searches both DASD and TAPE UCBs                   * 00021900
*                                                                     * 00022000
*              DEVCLASS=TAPE                                          * 00022100
*                  searches TAPE UCBs                                 * 00022200
*                                                                     * 00022300
*              DEVCLASS=DASD                                          * 00022400
*                  searches DASD UCBs                                 * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*                                                                     * 00023000
*                                                                     * 00023100
*                                                                     * 00023200
*      End of a set of mutually exclusive required keys.              * 00023300
*                                                                     * 00023400
*                                                                     * 00023500
*                                                                     * 00023600
*      UCBPTR=xucbptr                                                 * 00023700
*          is the name (RS-type), or address in register (2)-(12), of * 00023800
*          a required 4 byte output that will contain the address of  * 00023900
*          the UCB common segment (mapped by IEFUCBOB) associated     * 00024000
*          with the look-up argument (DEVN, DEVNCHAR, or VOLSER).     * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*      ÝUCBCXPTR=xucbcxptr¨                                           * 00024600
*          is the name (RS-type), or address in register (2)-(12), of * 00024700
*          an optional 4 byte output that will contain the address of * 00024800
*          the UCB common extension segment associated with the       * 00024900
*          look-up argument (DEVN, DEVNCHAR, or VOLSER).  This        * 00025000
*          address points to the area mapped by macro IEFUCBOB.       * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*                                                                     * 00025400
*                                                                     * 00025500
*      ÝUCBPXPTR=xucbpxptr¨                                           * 00025600
*          is the name (RS-type), or address in register (2)-(12), of * 00025700
*          an optional 4 byte output that will contain the address of * 00025800
*          the UCB prefix extension segment associated with the       * 00025900
*          look-up argument (DEVN, DEVNCHAR, or VOLSER).  This        * 00026000
*          address points to the area mapped by macro IOSDUPFX.       * 00026100
*                                                                     * 00026200
*                                                                     * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*      ÝLOC=»BELOW!ANYº¨                                              * 00026600
*          is an optional keyword input that indicates whether or not * 00026700
*          the look-up is to include Actual UCBs from above or below  * 00026800
*          the 16Mb line.                                             * 00026900
*          DEFAULT: BELOW                                             * 00027000
*                                                                     * 00027100
*                                                                     * 00027200
*          LOC=BELOW                                                  * 00027300
*              limits the look-up to Actual UCBs below the 16MB line. * 00027400
*                                                                     * 00027500
*          LOC=ANY                                                    * 00027600
*              request that both above and below the 16Mb line Actual * 00027700
*              UCBs be included in the look-up.                       * 00027800
*                                                                     * 00027900
*                                                                     * 00028000
*                                                                     * 00028100
*                                                                     * 00028200
*                                                                     * 00028300
*                                                                     * 00028400
*      ÝDYNAMIC=»NO!YESº¨                                             * 00028500
*          is an optional keyword input that indicates whether the    * 00028600
*          look-up is to be restricted to static or                   * 00028700
*          installation-static UCBs only (i.e. UCBs which are not     * 00028800
*          subject to dynamic additions and deletions)                * 00028900
*          DEFAULT: NO                                                * 00029000
*                                                                     * 00029100
*                                                                     * 00029200
*          DYNAMIC=NO                                                 * 00029300
*              limits the look-up to UCBs defined as static or        * 00029400
*              installation-static                                    * 00029500
*                                                                     * 00029600
*          DYNAMIC=YES                                                * 00029700
*              requests that static, installation-static, and dynamic * 00029800
*              UCBs be included in the look-up                        * 00029900
*                                                                     * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*      ÝRANGE=»3DIGIT!ALLº¨                                           * 00030600
*          is an optional keyword input that indicates whether or not * 00030700
*          the look-up is to include UCBs with 4 digit device numbers * 00030800
*          DEFAULT: 3DIGIT                                            * 00030900
*                                                                     * 00031000
*                                                                     * 00031100
*          RANGE=3DIGIT                                               * 00031200
*              limits the look-up to UCBs with 3 digit device numbers * 00031300
*                                                                     * 00031400
*          RANGE=ALL                                                  * 00031500
*              requests that both UCBs with 3 digit device numbers    * 00031600
*              and UCBs with 4 digit device numbers be included in    * 00031700
*              the look-up                                            * 00031800
*                                                                     * 00031900
*                                                                     * 00032000
*                                                                     * 00032100
*                                                                     * 00032200
*                                                                     * 00032300
*                                                                     * 00032400
*      ÝNONBASE=»NO!YESº¨                                             * 00032500
*          is an optional keyword input that indicates whether or not * 00032600
*          the look-up will include alias UCBs of a parallel access   * 00032700
*          volume.                                                    * 00032800
*          DEFAULT: NO                                                * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*          NONBASE=NO                                                 * 00033200
*              the look-up will not include alias UCBs                * 00033300
*                                                                     * 00033400
*          NONBASE=YES                                                * 00033500
*              the look-up will include alias UCBs                    * 00033600
*                                                                     * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*                                                                     * 00034200
*      ÝUNBOUND_ALIAS=»NO!YESº¨                                       * 00034300
*          is an optional keyword input that indicates whether or not * 00034400
*          the look-up will include alias UCBs of a parallel access   * 00034500
*          volume that have not yet been bound to a base PAV.         * 00034600
*                                                                     * 00034700
*          NOTE:  The UNBOUND_ALIAS keyword is for system use use     * 00034800
*          only.                                                      * 00034900
*          DEFAULT: NO                                                * 00035000
*                                                                     * 00035100
*                                                                     * 00035200
*          UNBOUND_ALIAS=NO                                           * 00035300
*              the look-up will not include alias UCBs                * 00035400
*                                                                     * 00035500
*          UNBOUND_ALIAS=YES                                          * 00035600
*              the look-up will include alias UCBs                    * 00035700
*                                                                     * 00035800
*                                                                     * 00035900
*                                                                     * 00036000
*                                                                     * 00036100
*                                                                     * 00036200
*                                                                     * 00036300
*      ÝSPECIAL=»NO!YESº¨                                             * 00036400
*          is an optional keyword input that indicates whether the    * 00036500
*          scan is to include devices marked as Special.  Special     * 00036600
*          devices include non-PAV alias devices that are defined in  * 00036700
*          an alternate subchannel set. Special devices are for       * 00036800
*          restricted use.                                            * 00036900
*          DEFAULT: NO                                                * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*          SPECIAL=NO                                                 * 00037300
*              the look-up will not include devices marked as         * 00037400
*              special.                                               * 00037500
*                                                                     * 00037600
*          SPECIAL=YES                                                * 00037700
*              the look-up will include devices marked as special.    * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*                                                                     * 00038100
*                                                                     * 00038200
*                                                                     * 00038300
*                                                                     * 00038400
*      ÝNOTFIND=»NO!YESº¨                                             * 00038500
*          is an optional keyword input that indicates whether the    * 00038600
*          look-up is to include not-findable UCBs                    * 00038700
*                                                                     * 00038800
*          NOTE:  The NOTFIND keyword is for IOS use only.            * 00038900
*          DEFAULT: NO                                                * 00039000
*                                                                     * 00039100
*                                                                     * 00039200
*          NOTFIND=NO                                                 * 00039300
*              limits the look-up to findable UCBs                    * 00039400
*                                                                     * 00039500
*          NOTFIND=YES                                                * 00039600
*              requests that both findable and not-findable UCBs be   * 00039700
*              included in the look-up                                * 00039800
*                                                                     * 00039900
*                                                                     * 00040000
*                                                                     * 00040100
*                                                                     * 00040200
*                                                                     * 00040300
*                                                                     * 00040400
*      The following is a set of mutually exclusive keys.  This set   * 00040500
*      is required; only one key must be specified.                   * 00040600
*                                                                     * 00040700
*                                                                     * 00040800
*      PIN                                                            * 00040900
*          The UCB is to be pinned to prevent its disappearance via   * 00041000
*          the dynamic UCB capability.  It is the caller's            * 00041100
*          responsibility to un-pin the UCB using the UCBPIN UNPIN    * 00041200
*          service.                                                   * 00041300
*                                                                     * 00041400
*                                                                     * 00041500
*          TEXT=xtext                                                 * 00041600
*              is the name (RS-type) of a required 58 character input * 00041700
*              which specifies the descriptive text documenting the   * 00041800
*              reason for the PIN request.  This text will be         * 00041900
*              displayed on a message identifying the reason for a    * 00042000
*              configuration change failure if this pin request       * 00042100
*              remains outstanding during a configuration change.     * 00042200
*                                                                     * 00042300
*                                                                     * 00042400
*                                                                     * 00042500
*                                                                     * 00042600
*          PTOKEN=xptoken                                             * 00042700
*              is the name (RS-type), or address in register          * 00042800
*              (2)-(12), of a required 8 character output which is to * 00042900
*              receive the pin token. The caller must use the pin     * 00043000
*              token when unpinning the UCB.                          * 00043100
*                                                                     * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*          ÝCOMPID=»xcompid!NONEº¨                                    * 00043600
*              is the name (RS-type) of an optional 5 character input * 00043700
*              which specifies the component ID of the component      * 00043800
*              requesting the pin.                                    * 00043900
*              DEFAULT: NONE                                          * 00044000
*                                                                     * 00044100
*                                                                     * 00044200
*                                                                     * 00044300
*                                                                     * 00044400
*          ÝHELP=»xhelp!NONEº¨                                        * 00044500
*              is the name (RS-type), or address in register          * 00044600
*              (2)-(12), of an optional 8 character input which       * 00044700
*              specifies the help panel ID in SYS1.LINKLIB which      * 00044800
*              provides help information on why the device was pinned * 00044900
*              and/or how to un-pin the device.                       * 00045000
*              DEFAULT: NONE                                          * 00045100
*                                                                     * 00045200
*                                                                     * 00045300
*                                                                     * 00045400
*                                                                     * 00045500
*          ÝLASTING¨                                                  * 00045600
*              KEYWORD that indicates that the pin request should not * 00045700
*              be automatically cleaned up (i.e. unpinned) by IOS     * 00045800
*              during end-of-task or end-of-memory termination.       * 00045900
*              DEFAULT: NONE                                          * 00046000
*                                                                     * 00046100
*                                                                     * 00046200
*                                                                     * 00046300
*                                                                     * 00046400
*          ÝPINPATHS¨                                                 * 00046500
*              KEYWORD that indicates to pin all paths to the device  * 00046600
*              (in addition to pinning the device)                    * 00046700
*              DEFAULT: NONE                                          * 00046800
*                                                                     * 00046900
*                                                                     * 00047000
*                                                                     * 00047100
*      NOPIN                                                          * 00047200
*          The UCB will not be pinned.                                * 00047300
*                                                                     * 00047400
*                                                                     * 00047500
*                                                                     * 00047600
*      End of a set of mutually exclusive required keys.              * 00047700
*                                                                     * 00047800
*                                                                     * 00047900
*                                                                     * 00048000
*      ÝUCBPAREA=»xucbparea!NONEº¨                                    * 00048100
*          is the name (RS-type), or address in register (2)-(12), of * 00048200
*          an optional 48 character input work area which is to       * 00048300
*          receive a copy of the UCB prefix data.  The data can be    * 00048400
*          mapped by macro IOSDUPI.                                   * 00048500
*          DEFAULT: NONE                                              * 00048600
*                                                                     * 00048700
*                                                                     * 00048800
*                                                                     * 00048900
*                                                                     * 00049000
*      ÝIOCTOKEN=»xioctoken!NONEº¨                                    * 00049100
*          is the name (RS-type), or address in register (2)-(12), of * 00049200
*          an optional 48 character input/output which specifies the  * 00049300
*          I/O configuration token.  If the UCB definition for the    * 00049400
*          UCB to be returned is not consistent with the I/O          * 00049500
*          configuration token supplied as input, the caller will be  * 00049600
*          notified via a return code.                                * 00049700
*                                                                     * 00049800
*          If the input IOCTOKEN is set to binary zeroes, then this   * 00049900
*          service will set IOCTOKEN to the current I/O configuration * 00050000
*          token.                                                     * 00050100
*          DEFAULT: NONE                                              * 00050200
*                                                                     * 00050300
*                                                                     * 00050400
*                                                                     * 00050500
*                                                                     * 00050600
*      ÝLINKAGE=»SYSTEM!BRANCHº¨                                      * 00050700
*          is an optional keyword input that indicates whether a      * 00050800
*          branch-entry linkage should be generated or a Program Call * 00050900
*          should be issued for the routine invocation.               * 00051000
*          DEFAULT: SYSTEM                                            * 00051100
*                                                                     * 00051200
*                                                                     * 00051300
*          LINKAGE=SYSTEM                                             * 00051400
*              requests Program Call invocation.                      * 00051500
*                                                                     * 00051600
*          LINKAGE=BRANCH                                             * 00051700
*              requests branch-entry invocation.  See INVOCATION      * 00051800
*              REQUIREMENTS for the restrictions on branch-entry      * 00051900
*              invocation.                                            * 00052000
*                                                                     * 00052100
*                                                                     * 00052200
*                                                                     * 00052300
*                                                                     * 00052400
*                                                                     * 00052500
*                                                                     * 00052600
*      ÝRETCODE=xretcode¨                                             * 00052700
*          is the name (RS-type) of an optional fullword output       * 00052800
*          variable, or register (2)-(12) or (15), into which the     * 00052900
*          return code is to be copied from GPR 15.  If you specify   * 00053000
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00053100
*          the value will be left in GPR 15.                          * 00053200
*                                                                     * 00053300
*                                                                     * 00053400
*                                                                     * 00053500
*                                                                     * 00053600
*      ÝRSNCODE=xrsncode¨                                             * 00053700
*          is the name (RS-type) of an optional fullword output       * 00053800
*          variable into which the reason code is to be copied from   * 00053900
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00054000
*          R0 (within or without parentheses), the value will be left * 00054100
*          in GPR 0.                                                  * 00054200
*                                                                     * 00054300
*                                                                     * 00054400
*                                                                     * 00054500
*                                                                     * 00054600
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00054700
*          is an optional byte input decimal value in the "3-3" range * 00054800
*          that specifies the macro version.  PLISTVER is the only    * 00054900
*          key allowed on the list form of MF and determines which    * 00055000
*          parameter list is generated.  Note that MAX may be         * 00055100
*          specified instead of a number, and the parameter list will * 00055200
*          be of the largest size currently supported. This size may  * 00055300
*          grow from release to release (thus possibly affecting the  * 00055400
*          amount of storage needed by your program).  If your        * 00055500
*          program can tolerate this, IBM recommends that you always  * 00055600
*          specify MAX when creating the list form parameter list as  * 00055700
*          that will ensure that the list form parameter list is      * 00055800
*          always long enough to hold whatever parameters might be    * 00055900
*          specified on the execute form.                             * 00056000
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00056100
*          default is the lowest version which allows all of the      * 00056200
*          parameters specified on the invocation to be processed.    * 00056300
*                                                                     * 00056400
*                                                                     * 00056500
*                                                                     * 00056600
*                                                                     * 00056700
*      ÝMF=»S!L!Eº¨                                                   * 00056800
*          is an optional keyword input which specifies the macro     * 00056900
*          form.                                                      * 00057000
*          DEFAULT: S                                                 * 00057100
*                                                                     * 00057200
*                                                                     * 00057300
*          ÝMF=S¨                                                     * 00057400
*              specifies the standard form of the macro.  The "S"     * 00057500
*              form generates code to put the parameters into an      * 00057600
*              in-line parameter list and invoke the desired service. * 00057700
*              Full checking for required macro keys is done along    * 00057800
*              with supplying defaults for omitted optional           * 00057900
*              parameters.                                            * 00058000
*                                                                     * 00058100
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00058200
*              specifies the list form of the macro.  The "L" form    * 00058300
*              defines an area to be used for the parameter list.     * 00058400
*              Only the PLISTVER key may be specified on the          * 00058500
*              invocation.  All other macro parameters are flagged as * 00058600
*              errors.  If PLISTVER is not specified, the original    * 00058700
*              parameter list definition is used.                     * 00058800
*                                                                     * 00058900
*            ,xmfctrl                                                 * 00059000
*              is a required input.  It is the name of a storage area * 00059100
*              for the parameter list.                                * 00059200
*                                                                     * 00059300
*            »,xmfattr!0Dº                                            * 00059400
*              is an optional 60 character input string that varies   * 00059500
*              from 1 to 60 characters. Use it to force boundary      * 00059600
*              alignment of the parameter list. Use only 0F or 0D.    * 00059700
*              DEFAULT: 0D which forces the parameter list to a       * 00059800
*              doubleword boundary.                                   * 00059900
*                                                                     * 00060000
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00060100
*              specifies the execute form of the macro.  The "E" form * 00060200
*              generates code to put the parameters into the          * 00060300
*              parameter list specified by xmfctrl and provides full  * 00060400
*              syntax checking with default setting.                  * 00060500
*                                                                     * 00060600
*            ,xmfctrl                                                 * 00060700
*              is a required input.  It is the name (RS-type), or     * 00060800
*              address in register (1)-(12), of a storage area for    * 00060900
*              the parameter list.                                    * 00061000
*                                                                     * 00061100
*            »,COMPLETEº                                              * 00061200
*              is an optional keyword input which specifies the       * 00061300
*              degree of macro parameter syntax checking.             * 00061400
*              DEFAULT: COMPLETE                                      * 00061500
*                                                                     * 00061600
*                                                                     * 00061700
*              COMPLETE                                               * 00061800
*                  Checking for required macro keys is done and       * 00061900
*                  defaults are supplied for omitted optional         * 00062000
*                  parameters.                                        * 00062100
*                                                                     * 00062200
*                                                                     * 00062300
*                                                                     * 00062400
*                                                                     * 00062500
*                                                                     * 00062600
*                                                                     * 00062700
*                                                                     * 00062800
*01* RETURN CODES:                                                    * 00062900
*                                                                     * 00063000
*                                                                     * 00063100
*                                                                     * 00063200
*                 X'00'     Successful execution.  The address of the * 00063300
*                           UCB common segment has been returned in   * 00063400
*                           UCBPTR.  Also, the pin token has been     * 00063500
*                           returned in PTOKEN if PIN was specified.  * 00063600
*                                                                     * 00063700
*                 X'04'     No UCB exists for the device number or    * 00063800
*                           VOLSER specified as input.  The contents  * 00063900
*                           of UCBPTR remain unchanged.               * 00064000
*                                                                     * 00064100
*                 X'08'     Error in caller's parameters              * 00064200
*                                                                     * 00064300
*                           Reason codes                              * 00064400
*                                                                     * 00064500
*                                                                     * 00064600
*                           X'01'     The caller specified an invalid * 00064700
*                                     ALET.                           * 00064800
*                                                                     * 00064900
*                           X'02'     An error occurred in accessing  * 00065000
*                                     the caller's parameter list.    * 00065100
*                                                                     * 00065200
*                           X'04'     An error occurred referencing   * 00065300
*                                     the user-supplied work area for * 00065400
*                                     the UCB prefix data (UCBPAREA). * 00065500
*                                     (This reason code is valid only * 00065600
*                                     for callers using the UCBPAREA  * 00065700
*                                     keyword.                        * 00065800
*                                                                     * 00065900
*                           X'05'     An error occurred referencing   * 00066000
*                                     the user-supplied work area for * 00066100
*                                     the IOCTOKEN (IOCTOKEN).  (This * 00066200
*                                     reason code is valid only for   * 00066300
*                                     callers using the IOCTOKEN      * 00066400
*                                     keyword.                        * 00066500
*                                                                     * 00066600
*                           X'0A'     An error occurred referencing   * 00066700
*                                     the user-supplied area for the  * 00066800
*                                     pin reason text (TEXT).  (This  * 00066900
*                                     reason code is valid only for   * 00067000
*                                     callers using the TEXT          * 00067100
*                                     keyword.)                       * 00067200
*                                                                     * 00067300
*                           X'0B'     The value specified on the      * 00067400
*                                     SCHSET keyword is not valid.    * 00067500
*                                                                     * 00067600
*                                                                     * 00067700
*                                                                     * 00067800
*                 X'0C'     The UCB definition for the device         * 00067900
*                           represented by the look-up argument has   * 00068000
*                           changed and is no longer consistent with  * 00068100
*                           the UCB definition represented by the     * 00068200
*                           input I/O configuration token.  (This     * 00068300
*                           return code is valid only for callers     * 00068400
*                           using the IOCTOKEN keyword.               * 00068500
*                                                                     * 00068600
*                 X'10'     The UCB address was returned in UCBPTR    * 00068700
*                           and the UCB was pinned, but the paths     * 00068800
*                           could not be pinned.  (This return code   * 00068900
*                           is valid only for callers using the       * 00069000
*                           PINPATHS keyword.                         * 00069100
*                                                                     * 00069200
*                 X'20'     An unexpected error occurred.             * 00069300
*                                                                     * 00069400
*                                                                     * 00069500
*                                                                     * 00069600
*                                                                     * 00069700
*                                                                     * 00069800
*01* REASON CODES:                                                    * 00069900
*                                                                     * 00070000
*       See return codes section.                                     * 00070100
*                                                                     * 00070200
*01* MODULE TYPE:  ASSEM MACRO                                        * 00070300
*                                                                     * 00070400
*02*   PROCESSOR:  ASSEM                                              * 00070500
*                                                                     * 00070600
*01* COMPONENT:  SC1C3                                                * 00070700
*                                                                     * 00070800
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00070900
*                                                                     * 00071000
*01* MACRO USAGE NOTES:                                               * 00071100
*                                                                     * 00071200
*                                                                     * 00071300
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00071400
*        global macro variable.  Any value other than 'NO' will       * 00071500
*        result in the macro expansion being printed.  The default is * 00071600
*        'YES'.  The following examples illustrate how the ZPRINT     * 00071700
*        variable should be set.                                      * 00071800
*                                                                     * 00071900
*                    GBLC &ZPRINT                                     * 00072000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00072100
*                                                                     * 00072200
*                                                                     * 00072300
*    2.  All keys currently contained in the UCBLOOK macro correspond * 00072400
*        to  version 3.  If you specify PLISTVER, use a value of 3 or * 00072500
*        MAX.                                                         * 00072600
*                                                                     * 00072700
*                                                                     * 00072800
*                                                                     * 00072900
*                                                                     * 00073000
*01* CHANGE ACTIVITY:                                                 * 00073100
*                                                                     * 00073200
*   Flag LineItem  FMID    Date   ID    Comment                       * 00073300
*                                                                     * 00073400
*    $L0=USERV    HBB4410 890626 PDLK:  UCB Services                  * 00073500
*    $L1=UCBVP    HBB5520 940106 PDKB:  UCB VSCR Support - Add LOC    * 00073600
*                                         keyword                     * 00073700
*    $L2=PAVS     HBB5520 940210 PDLP:  Add NONBASE keyword option    * 00073800
*    $L3=SCHSET   HBB7720 040315 PDSC:  Subchannel Sets               * 00073900
*    $L4=SCHSET   HBB7720 040731 PDON:  Subchannel Sets - LDEVNCHAR   * 00074000
*                                         support                     * 00074100
*    $L5=SCHSET2  HBB7750 080331 PDCT:  Subchannel Sets for special   * 00074200
*                                         devices.  Changes flagged   * 00074300
*                                         by OA24142                  * 00074400
*    $A6=OA24142  HBB7740 080831 PDB7:  Exploitation of Subchannel    * 00074500
*                                         Sets for special devices.   * 00074600
*                                         Add SPECIAL keyword.        * 00074700
*    $P1=PEO3586  HBB4410 900226 PDLK:  Use macdefs=no to get around  * 00074800
*                                         AMG problem                 * 00074900
*    $P2=PH31790  HBB4420 901126 PDLS:  Add NOTFIND option            * 00075000
*    $P3=PIG3063  HBB5510 930924 PDKB:  CDPI update.                  * 00075100
*    $P4=ME12193  HBB7750 080229 PDGG:  Add mapping macro name of     * 00075200
*                                         IEFUCBOB to UCBPTR          * 00075300
*                                         description.                * 00075400
*    $D1=DCR112   HBB5510 930520 PDLL:  Add UCBCXPTR and UCBPXPTR     * 00075500
*                                         options                     * 00075600
*    $D2=DCR095   HBB5520 940912 PDLU:  Changed UCBLOOK UCBCXPTR to   * 00075700
*                                         GUPI.                       * 00075800
*    $01=OW37980  HBB6603 990531 PDLZ:  Add UNBOUND_ALIAS keyword     * 00075900
*                                         option                      * 00076000
****** END OF SPECIFICATIONS *****************************************/ 00076100
*/********************************************************************* 00076200
         MACRO                                                          00076300
&XLABEL  UCBLOOK &DEVN=,&SCHSET=,&DEVNCHAR=,&LDEVNCHAR=,&VOLSER=,      *00076400
               &DEVCLASS=,&UCBPTR=,&UCBCXPTR=,&UCBPXPTR=,&LOC=,        *00076500
               &DYNAMIC=,&RANGE=,&NONBASE=,&UNBOUND_ALIAS=,&SPECIAL=,  *00076600
               &NOTFIND=,&TEXT=,&PTOKEN=,&COMPID=,&HELP=,&UCBPAREA=,   *00076700
               &IOCTOKEN=,&LINKAGE=,&RETCODE=,&RSNCODE=,&PLISTVER=,    *00076800
               &MF=                                                     00076900
.*                                                                      00077000
*                   MACDATE -03/18/08-<3>                               00077100
.*                                                                      00077200
.*******************************************************************    00077300
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00077400
.*******************************************************************    00077500
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              00077600
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                00077700
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        00077800
.*                                                                      00077900
                   GBLC  &ZUCBLOOK   YES=MACRO USED AT LEAST ONCE       00078000
.*******************************************************************    00078100
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00078200
.*******************************************************************    00078300
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            00078400
                   LCLC  &ZCNDX      SYSNDX CHARACTERS                  00078500
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         00078600
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        00078700
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        00078800
                   LCLA  &ZAWRK      USED AS A WORK AREA                00078900
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             00079000
                   LCLA  &ZN         NUMERIC WORK VARIABLE              00079100
                   LCLC  &ZC         CHARACTER WORK VARIABLE            00079200
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        00079300
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            00079400
                   LCLC  &ZMAC_G     "G" or null                        00079500
&ZMAC_G            SETC  ''                                             00079600
                   LCLC  &ZMAC_LR                                       00079700
&ZMAC_LR           SETC  'LR'                                           00079800
                   LCLC  &ZMAC_L                                        00079900
&ZMAC_L            SETC  'L'                                            00080000
                   LCLC  &ZMAC_ST                                       00080100
&ZMAC_ST           SETC  'ST'                                           00080200
                   LCLA  &ZMACRET    MACRO RETURN CODE                  00080300
&ZMACRET           SETA  0           ASSUME NO ERRORS                   00080400
.*                                                                      00080500
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      00080600
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         00080700
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              00080800
                   LCLC  &ZENDBASEPL            End of base PL          00080900
                   LCLA  &ZPLWORKA   PARAMETER LIST LENGTH              00081000
.*******************************************************************    00081100
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00081200
.*******************************************************************    00081300
                   LCLA  &ZI         INDEX FOR ARRAY                    00081400
                   LCLA  &ZJ         INDEX FOR PARMS                    00081500
                   LCLA  &ZK         INDEX FOR PARSE                    00081600
                   LCLA  &ZLO        LOW RANGE VALUE                    00081700
                   LCLA  &ZHI        HIGH RANGE VALUE                   00081800
                   LCLC  &ZW         WORK AREA FOR PARM                 00081900
.********************************************************************   00082000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00082100
.********************************************************************   00082200
                   GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL            00082300
                   GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE     00082400
                   GBLA  &SYSALVL    SYSSTATE ARCHLVL                   00082500
                   GBLC  &SYSAM64    SYSSTATE AMODE64                   00082600
.*                                                                      00082700
                   AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED     00082800
                   AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED      00082900
                   SPLEVEL  TEST                                        00083000
.ZSYS2             ANOP  ,                                              00083100
                   AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1          00083200
                   AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1          00083300
                   SYSSTATE TEST                                        00083400
                   AGO   .ZSYS4                                         00083500
.ZSYS3             ANOP  ,                                              00083600
&SYSASCE           SETC  'P'         ASSUME SYSSTATE PRIMARY            00083700
.ZSYS4             ANOP  ,                                              00083800
.*******************************************************************    00083900
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00084000
.*******************************************************************    00084100
                   LCLC  &XDEVVAR1   ++ NAME                            00084200
                   LCLC  &XDEVN      ++ NAME                            00084300
                   LCLC  &XSCHSET    ++ NAME                            00084400
                   LCLC  &XDEVNCHAR  ++ NAME                            00084500
                   LCLC  &XLDEVNCHAR            ++ NAME                 00084600
                   LCLC  &XVOLSER    ++ NAME                            00084700
                   LCLC  &XDEVCLASS  ++ VALUE                           00084800
                   LCLC  &XUCBPTR    ++ NAME                            00084900
                   LCLC  &XUCBCXPTR  ++ NAME                            00085000
                   LCLC  &XUCBPXPTR  ++ NAME                            00085100
                   LCLC  &XLOC       ++ VALUE                           00085200
                   LCLC  &XDYNAMIC   ++ VALUE                           00085300
                   LCLC  &XRANGE     ++ VALUE                           00085400
                   LCLC  &XNONBASE   ++ VALUE                           00085500
                   LCLC  &XUNBOUND_ALIAS        ++ VALUE                00085600
                   LCLC  &XSPECIAL   ++ VALUE                           00085700
                   LCLC  &XNOTFIND   ++ VALUE                           00085800
                   LCLC  &XPINREQ    ++ VALUE                           00085900
                   LCLC  &XPIN       ++ VALUE                           00086000
                   LCLC  &XTEXT      ++ NAME                            00086100
                   LCLC  &XPTOKEN    ++ NAME                            00086200
                   LCLC  &XCOMPID    ++ NAME                            00086300
                   LCLC  &XHELP      ++ NAME                            00086400
                   LCLC  &XLASTING   ++ VALUE                           00086500
                   LCLC  &XPINPATHS  ++ VALUE                           00086600
                   LCLC  &XNOPIN     ++ VALUE                           00086700
                   LCLC  &XUCBPAREA  ++ NAME                            00086800
                   LCLC  &XIOCTOKEN  ++ NAME                            00086900
                   LCLC  &XLINKAGE   ++ VALUE                           00087000
                   LCLC  &XRETCODE   ++ NAME                            00087100
                   LCLC  &XRSNCODE   ++ NAME                            00087200
                   LCLA  &XPLISTVER  ++ VALUE                           00087300
                   LCLC  &XMF        ++ VALUE                           00087400
                   LCLC  &XMFCTRL    ++ NAME                            00087500
                   LCLC  &XMFATTR    ++ VALUE                           00087600
                   LCLC  &XMFSCK     ++ VALUE                           00087700
.*******************************************************************    00087800
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00087900
.*******************************************************************    00088000
                   LCLC  &ZXDEVVAR1  ++ INPUT NAME                      00088100
                   LCLC  &ZXDEVN     ++ INPUT NAME                      00088200
                   LCLC  &ZXSCHSET   ++ INPUT NAME                      00088300
                   LCLC  &ZXDEVNCHAR            ++ INPUT NAME           00088400
                   LCLC  &ZXLDEVNCHAR           ++ INPUT NAME           00088500
                   LCLC  &ZXVOLSER   ++ INPUT NAME                      00088600
                   LCLC  &ZXDEVCLASS            ++ INPUT VALUE          00088700
                   LCLC  &ZXUCBPTR   ++ OUTPUT NAME                     00088800
                   LCLC  &ZXUCBCXPTR            ++ OUTPUT NAME          00088900
                   LCLC  &ZXUCBPXPTR            ++ OUTPUT NAME          00089000
                   LCLC  &ZXLOC      ++ INPUT VALUE                     00089100
                   LCLC  &ZXDYNAMIC  ++ INPUT VALUE                     00089200
                   LCLC  &ZXRANGE    ++ INPUT VALUE                     00089300
                   LCLC  &ZXNONBASE  ++ INPUT VALUE                     00089400
                   LCLC  &ZXUNBOUND_ALIAS       ++ INPUT VALUE          00089500
                   LCLC  &ZXSPECIAL  ++ INPUT VALUE                     00089600
                   LCLC  &ZXNOTFIND  ++ INPUT VALUE                     00089700
                   LCLC  &ZXPINREQ   ++ INPUT VALUE                     00089800
                   LCLC  &ZXPIN      ++ INPUT VALUE                     00089900
                   LCLC  &ZXTEXT     ++ INPUT NAME                      00090000
                   LCLC  &ZXPTOKEN   ++ OUTPUT NAME                     00090100
                   LCLC  &ZXCOMPID   ++ INPUT NAME                      00090200
                   LCLC  &ZXHELP     ++ INPUT NAME                      00090300
                   LCLC  &ZXLASTING  ++ INPUT VALUE                     00090400
                   LCLC  &ZXPINPATHS            ++ INPUT VALUE          00090500
                   LCLC  &ZXNOPIN    ++ INPUT VALUE                     00090600
                   LCLC  &ZXUCBPAREA            ++ INPUT NAME           00090700
                   LCLC  &ZXIOCTOKEN            ++ INOUT NAME           00090800
                   LCLC  &ZXLINKAGE  ++ INPUT VALUE                     00090900
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     00091000
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     00091100
                   LCLC  &ZXPLISTVER            ++ INPUT VALUE          00091200
                   LCLC  &ZXMF       ++ INPUT VALUE                     00091300
                   LCLC  &ZXMFCTRL   ++ INPUT NAME                      00091400
                   LCLC  &ZXMFATTR   ++ INPUT VALUE                     00091500
                   LCLC  &ZXMFSCK    ++ INPUT VALUE                     00091600
.********************************************************************   00091700
.***AC.PLV01  PROCESS PLISTVER                                      *   00091800
.********************************************************************   00091900
&XPLISTVER      SETA  3                                                 00092000
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00092100
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00092200
&XPLISTVER      SETA  3                                                 00092300
.ZPLV0          ANOP  ,                                                 00092400
.*                                                                      00092500
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00092600
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00092700
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00092800
.*-------------------------------------------------------------------   00092900
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00093000
&ZMS            SETC  '"PLISTVER='                                      00093100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00093200
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00093300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00093400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00093500
                AGO   .ZPVCK2                                           00093600
.ZPVCK3         ANOP  ,                                                 00093700
.*-------------------------------------------------------------------   00093800
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00093900
&ZMS            SETC  '"PLISTVER='                                      00094000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00094100
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00094200
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00094300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00094400
                AGO   .ZPVCKE                                           00094500
.ZPVCK2         ANOP  ,                                                 00094600
.*-------------------------------------------------------------------   00094700
&ZCVAL          SETC  '&PLISTVER(1)'                                    00094800
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00094900
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00095000
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00095100
                AIF   (&ZN LT 3).ZPVCK6    TOO LOW                      00095200
                AIF   (&ZN LE 3).ZPVCK4A   NOT HIGH                     00095300
.ZPVCK6         ANOP  ,                                                 00095400
&ZMS            SETC  '"PLISTVER='                                      00095500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00095600
&ZMS            SETC  '&ZMS THE RANGE IS "3-3"'                         00095700
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00095800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00095900
&XPLISTVER      SETA  3                                                 00096000
                AGO   .ZPVCKE                                           00096100
.*-------------------------------------------------------------------   00096200
.ZPVCK4A        ANOP  ,                                                 00096300
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00096400
&ZMS            SETC  'PLISTVER='                                       00096500
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00096600
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00096700
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00096800
                MNOTE 8,' &ZMS IS REQUIRED.'                            00096900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00097000
                AGO   .ZPVCK5                                           00097100
.ZPVCK4         ANOP  ,                                                 00097200
&XPLISTVER      SETA  &PLISTVER(1)                                      00097300
.ZPVCK5         ANOP  ,                                                 00097400
.ZPVCKE         ANOP  ,                                                 00097500
.********************************************************************   00097600
.***AG.MF01 PROCESS MF MACRO FORMS                                      00097700
.********************************************************************   00097800
                   ACTR  10000                                          00097900
.*------------------------------------------------------------------    00098000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00098100
&XMF               SETC  ''          INITIALIZE XVARIABLE               00098200
.*-------------------------------------------------------------------   00098300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00098400
.ZG107             ANOP  ,                                              00098500
&ZTLC              SETC 'S'                                             00098600
                   AIF   ('&MF(1)' NE '&ZTLC').ZG108                    00098700
&XMF               SETC  'S'         SET KEYWORD                        00098800
                   AIF   (N'&MF LE 1).ZG107A    CK NUM                  00098900
&ZMS               SETC  '"MF='                                         00099000
&ZMS               SETC  '&ZMS.&MF"'                                    00099100
&ZMS               SETC  '&ZMS "MF"'                                    00099200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00099300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00099400
.ZG107A            ANOP  ,                                              00099500
.*-------------------------------------------------------------------   00099600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00099700
.ZG108             ANOP  ,                                              00099800
&ZTLC              SETC 'L'                                             00099900
                   AIF   ('&MF(1)' NE '&ZTLC').ZG115                    00100000
&XMF               SETC  'L'         SET KEYWORD                        00100100
                   AIF   (N'&MF LE 3).ZG108A    CK NUM                  00100200
&ZMS               SETC  '"MF='                                         00100300
&ZMS               SETC  '&ZMS.&MF"'                                    00100400
&ZMS               SETC  '&ZMS "MF"'                                    00100500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00100600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00100700
.ZG108A            ANOP  ,                                              00100800
.*-------------------------------------------------------------------   00100900
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00101000
                   AIF   (N'&SYSLIST NE 0).ZG108B  POSITIONALS?         00101100
                   AIF   ('&DEVN' NE '').ZG108B  KEYS?                  00101200
                   AIF   ('&SCHSET' NE '').ZG108B  KEYS?                00101300
                   AIF   ('&DEVNCHAR' NE '').ZG108B  KEYS?              00101400
                   AIF   ('&LDEVNCHAR' NE '').ZG108B  KEYS?             00101500
                   AIF   ('&VOLSER' NE '').ZG108B  KEYS?                00101600
                   AIF   ('&DEVCLASS' NE '').ZG108B  KEYS?              00101700
                   AIF   ('&UCBPTR' NE '').ZG108B  KEYS?                00101800
                   AIF   ('&UCBCXPTR' NE '').ZG108B  KEYS?              00101900
                   AIF   ('&UCBPXPTR' NE '').ZG108B  KEYS?              00102000
                   AIF   ('&LOC' NE '').ZG108B  KEYS?                   00102100
                   AIF   ('&DYNAMIC' NE '').ZG108B  KEYS?               00102200
                   AIF   ('&RANGE' NE '').ZG108B  KEYS?                 00102300
                   AIF   ('&NONBASE' NE '').ZG108B  KEYS?               00102400
                   AIF   ('&UNBOUND_ALIAS' NE '').ZG108B  KEYS?         00102500
                   AIF   ('&SPECIAL' NE '').ZG108B  KEYS?               00102600
                   AIF   ('&NOTFIND' NE '').ZG108B  KEYS?               00102700
                   AIF   ('&TEXT' NE '').ZG108B  KEYS?                  00102800
                   AIF   ('&PTOKEN' NE '').ZG108B  KEYS?                00102900
                   AIF   ('&COMPID' NE '').ZG108B  KEYS?                00103000
                   AIF   ('&HELP' NE '').ZG108B  KEYS?                  00103100
                   AIF   ('&UCBPAREA' NE '').ZG108B  KEYS?              00103200
                   AIF   ('&IOCTOKEN' NE '').ZG108B  KEYS?              00103300
                   AIF   ('&LINKAGE' NE '').ZG108B  KEYS?               00103400
                   AIF   ('&RETCODE' NE '').ZG108B  KEYS?               00103500
                   AIF   ('&RSNCODE' NE '').ZG108B  KEYS?               00103600
                   AGO    .ZG108C    INVOCATION OKAY                    00103700
.ZG108B            ANOP  ,                                              00103800
&ZMS               SETC  'THE "L" FORM OF "MF"'                         00103900
&ZMS               SETC  '&ZMS CAN ONLY HAVE'                           00104000
&ZMS               SETC  '&ZMS THE "PLISTVER" KEY'                      00104100
                   MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'         00104200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00104300
.ZG108C            ANOP  ,                                              00104400
.*-------------------------------------------------------------------   00104500
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00104600
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00104700
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00104800
                   AIF   (N'&MF(2) GT 1).ZG110B  MULTI PARMS            00104900
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00105000
.ZG110B            AIF   (K'&MF(2) GT 0).ZG110C                         00105100
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00105200
&ZMS               SETC  'WHEN "L" IS SPECIFIED'                        00105300
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00105400
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00105500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00105600
.ZG110C            ANOP  ,                                              00105700
.*-------------------------------------------------------------------   00105800
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00105900
                   AIF   (K'&ZXMFCTRL LE 0).ZG110P  NOT I/O             00106000
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG110P                00106100
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00106200
&ZMS               SETC  '"MF='                                         00106300
&ZMS               SETC  '&ZMS.&MF"'                                    00106400
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00106500
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'              00106600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00106700
.ZG110P            ANOP  ,                                              00106800
.*-------------------------------------------------------------------   00106900
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00107000
&ZXMFATTR          SETC  'INPUT'     SET IN/OUTPUT                      00107100
&XMFATTR           SETC  '0D'                                           00107200
                   AIF   (K'&MF(3) LE 0).ZG113B  PARM                   00107300
&XMFATTR           SETC  '&MF(3,1)'  SET XVARIABLE                      00107400
                   AIF   (N'&MF(3) GT 1).ZG113B  MULTI                  00107500
&XMFATTR           SETC  '&MF(3)'    SET XVARIABLE                      00107600
.ZG113B            ANOP  ,                                              00107700
.*-------------------------------------------------------------------   00107800
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00107900
                   AIF   (K'&ZXMFATTR LE 0).ZG113P  NOT I/O             00108000
                   AIF   ('&XMFATTR'(1,1) NE '(').ZG113P                00108100
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00108200
&ZMS               SETC  '"MF='                                         00108300
&ZMS               SETC  '&ZMS.&MF"'                                    00108400
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00108500
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'              00108600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00108700
.ZG113P            ANOP  ,                                              00108800
.*-------------------------------------------------------------------   00108900
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00109000
                   AIF   (K'&ZXMFATTR LE 0).ZG113S  NOT I/O             00109100
                   AIF   (K'&XMFATTR LE 60).ZG113S  LNG OK              00109200
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00109300
&ZMS               SETC  '"MF='                                         00109400
&ZMS               SETC  '&ZMS.&MF"'                                    00109500
&ZMS               SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'          00109600
                   MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'             00109700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00109800
.ZG113S            ANOP  ,                                              00109900
.*-------------------------------------------------------------------   00110000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00110100
.ZG115             ANOP  ,                                              00110200
&ZTLC              SETC 'E'                                             00110300
                   AIF   ('&MF(1)' NE '&ZTLC').ZG123                    00110400
&XMF               SETC  'E'         SET KEYWORD                        00110500
                   AIF   (N'&MF LE 3).ZG115A    CK NUM                  00110600
&ZMS               SETC  '"MF='                                         00110700
&ZMS               SETC  '&ZMS.&MF"'                                    00110800
&ZMS               SETC  '&ZMS "MF"'                                    00110900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00111000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00111100
.ZG115A            ANOP  ,                                              00111200
.*-------------------------------------------------------------------   00111300
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00111400
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00111500
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00111600
                   AIF   (N'&MF(2) GT 1).ZG117B  MULTI PARMS            00111700
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00111800
.ZG117B            AIF   (K'&MF(2) GT 0).ZG117C                         00111900
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00112000
&ZMS               SETC  'WHEN "E" IS SPECIFIED'                        00112100
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00112200
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00112300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00112400
.ZG117C            ANOP  ,                                              00112500
.*-------------------------------------------------------------------   00112600
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00112700
                   AIF   (K'&ZXMFCTRL LE 0).ZG117R  NOT I/O             00112800
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG117R                00112900
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     00113000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG117P                  00113100
                   AIF   (K'&ZCGPR GT 2).ZG117Q                         00113200
                   AIF   ('&ZCGPR' EQ '0').ZG117Q                       00113300
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00113400
                   AIF   (T'&ZCGPR NE 'N').ZG117Q  INVALID REG NAME     00113500
.ZG117P            ANOP  ,                                              00113600
                   AIF   (T'&ZCGPR NE 'N').ZG117R  NON NUMERIC          00113700
                   AIF   ('&ZCGPR' LT '1').ZG117Q                       00113800
                   AIF   ('&ZCGPR' LE '12').ZG117R                      00113900
.ZG117Q            ANOP  ,                                              00114000
&ZMS               SETC  '"MF='                                         00114100
&ZMS               SETC  '&ZMS.&MF"'                                    00114200
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      00114300
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               00114400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00114500
.ZG117R            ANOP  ,                                              00114600
.*-------------------------------------------------------------------   00114700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00114800
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               00114900
.ZG121A   AIF   ('&MF(3)' NE 'COMPLETE').ZG122A                         00115000
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        00115100
.*-------------------------------------------------------------------   00115200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00115300
.ZG122A            AIF   (K'&XMFSCK GT 0).ZG122C  KEYWORD               00115400
                   AIF   (K'&MF(3) LE 0).ZG122B                         00115500
&ZMS               SETC  '"MF='                                         00115600
&ZMS               SETC  '&ZMS.&MF"'                                    00115700
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      00115800
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00115900
&ZMS               SETC  '&ZMS "COMPLETE".'                             00116000
                   MNOTE 8,' &ZMS '                                     00116100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00116200
.ZG122B            ANOP  ,                                              00116300
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                00116400
.ZG122C            ANOP  ,                                              00116500
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      00116600
.*------------------------------------------------------------------    00116700
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00116800
.ZG123             ANOP  ,                                              00116900
&ZXMF              SETC  'INPUT'     SET IN/OUTPUT                      00117000
                   AIF   (K'&XMF GT 0).ZG123E   VALID ARG               00117100
                   AIF   (T'&MF EQ 'O').ZG123D  OMITTED                 00117200
&ZASYSLNDX         SETA  0                                              00117300
.ZG123A            ANOP  ,           POSITIONAL MACRO KEY               00117400
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00117500
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG123C              00117600
&ZTLC              SETC 'MF'                                            00117700
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG123A     00117800
.ZG123B            ANOP  ,                                              00117900
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00118000
&ZMS               SETC  'THE "MF" KEY'                                 00118100
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00118200
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00118300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00118400
                   AGO   .ZG123E                                        00118500
.ZG123C            ANOP  ,                                              00118600
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00118700
&ZMS               SETC  '"MF='                                         00118800
&ZMS               SETC  '&ZMS.&MF"'                                    00118900
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00119000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00119100
&ZMS               SETC  '&ZMS "S",'                                    00119200
&ZMS               SETC  '&ZMS "L",'                                    00119300
&ZMS               SETC  '&ZMS OR "E".'                                 00119400
                   MNOTE 8,' &ZMS '                                     00119500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00119600
                   AGO   .ZG123E                                        00119700
.ZG123D            ANOP  ,                                              00119800
&XMF               SETC  'S'         SET DEFAULT KEYWORD                00119900
&XMFSCK            SETC  'COMPLETE'  COMPLETE CHECKING                  00120000
.ZG123E            ANOP  ,                                              00120100
.********************************************************************   00120200
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00120300
.********************************************************************   00120400
                   ACTR  10000                                          00120500
.*-------------------------------------------------------------------   00120600
.***AG.MF03 MF=(SLE)                                                    00120700
                   AIF   ('&XMF' EQ 'L').ZGMFX                          00120800
.*----------------------------------------------------------------***   00120900
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00121000
&XDEVVAR1          SETC  ''          INITIALIZE XVARIABLE               00121100
                   AIF   (K'&DEVN LE 0).ZG2C                            00121200
&ZXDEVVAR1         SETC  'INPUT'     SET IN/OUTPUT                      00121300
&XDEVVAR1          SETC  'DEVN'      SET XVARIABLE                      00121400
&ZXDEVN            SETC  'INPUT'     SET IN/OUTPUT                      00121500
&XDEVN             SETC  '&DEVN(1)'  SET XVARIABLE PARM                 00121600
                   AIF   (N'&DEVN GT 1).ZG2A                            00121700
&XDEVN             SETC  '&DEVN'     SET XVARIABLE PARM                 00121800
.ZG2A              AIF   (N'&DEVN LE 1).ZG2B    CK NUM                  00121900
&ZMS               SETC  '"DEVN='                                       00122000
&ZMS               SETC  '&ZMS.&DEVN"'                                  00122100
&ZMS               SETC  '&ZMS "DEVN"'                                  00122200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00122300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00122400
.ZG2B              AIF   (K'&XDEVN GT 0).ZG2C   ONE PARM                00122500
&ZXDEVVAR1         SETC  ''          RESET IN/OUTPUT                    00122600
&ZXDEVN            SETC  ''          RESET IN/OUTPUT                    00122700
&ZMS               SETC  ' '                                            00122800
&ZMS               SETC  '&ZMS "DEVN" KEY AND ITS'                      00122900
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00123000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00123100
.ZG2C              ANOP  ,                                              00123200
.*----------------------------------------------------------------***   00123300
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00123400
                   AIF   (K'&DEVNCHAR LE 0).ZG6D  NO ME KEY             00123500
                   AIF   (N'&DEVNCHAR LE 1).ZG6A  CK NUM                00123600
&ZMS               SETC  '"DEVNCHAR='                                   00123700
&ZMS               SETC  '&ZMS.&DEVNCHAR"'                              00123800
&ZMS               SETC  '&ZMS "DEVNCHAR"'                              00123900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00124000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00124100
.ZG6A              AIF   (K'&XDEVVAR1 LE 0).ZG6B                        00124200
&ZMS               SETC  '"DEVNCHAR'                                    00124300
&ZMS               SETC  '&ZMS.=&DEVNCHAR"'                             00124400
&ZMS               SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'          00124500
&ZMS               SETC  '&ZMS "&XDEVVAR1"'                             00124600
                   MNOTE 8,' &ZMS KEY.'                                 00124700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00124800
                   AGO   .ZG6D                                          00124900
.*                                                                      00125000
.ZG6B              ANOP  ,                                              00125100
&ZXDEVVAR1         SETC  'INPUT'     SET IN/OUTPUT                      00125200
&XDEVVAR1          SETC  'DEVNCHAR'  SET XVARIABLE                      00125300
&ZXDEVNCHAR        SETC  'INPUT'     SET IN/OUTPUT                      00125400
&XDEVNCHAR         SETC  '&DEVNCHAR(1)'         SET XVARIABLE PARM      00125500
                   AIF   (N'&DEVNCHAR GT 1).ZG6C                        00125600
&XDEVNCHAR         SETC  '&DEVNCHAR'            SET XVARIABLE PARM      00125700
.ZG6C              AIF   (K'&XDEVNCHAR GT 0).ZG6D  ONE PARM             00125800
&ZXDEVVAR1         SETC  ''          RESET IN/OUTPUT                    00125900
&ZXDEVNCHAR        SETC  ''          RESET IN/OUTPUT                    00126000
&ZMS               SETC  ' '                                            00126100
&ZMS               SETC  '&ZMS "DEVNCHAR" KEY AND ITS'                  00126200
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00126300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00126400
.ZG6D              ANOP  ,                                              00126500
.*----------------------------------------------------------------***   00126600
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00126700
                   AIF   (K'&LDEVNCHAR LE 0).ZG10D  NO ME KEY           00126800
                   AIF   (N'&LDEVNCHAR LE 1).ZG10A  CK NUM              00126900
&ZMS               SETC  '"LDEVNCHAR='                                  00127000
&ZMS               SETC  '&ZMS.&LDEVNCHAR"'                             00127100
&ZMS               SETC  '&ZMS "LDEVNCHAR"'                             00127200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00127300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00127400
.ZG10A             AIF   (K'&XDEVVAR1 LE 0).ZG10B                       00127500
&ZMS               SETC  '"LDEVNCHAR'                                   00127600
&ZMS               SETC  '&ZMS.=&LDEVNCHAR"'                            00127700
&ZMS               SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'          00127800
&ZMS               SETC  '&ZMS "&XDEVVAR1"'                             00127900
                   MNOTE 8,' &ZMS KEY.'                                 00128000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00128100
                   AGO   .ZG10D                                         00128200
.*                                                                      00128300
.ZG10B             ANOP  ,                                              00128400
&ZXDEVVAR1         SETC  'INPUT'     SET IN/OUTPUT                      00128500
&XDEVVAR1          SETC  'LDEVNCHAR'            SET XVARIABLE           00128600
&ZXLDEVNCHAR       SETC  'INPUT'     SET IN/OUTPUT                      00128700
&XLDEVNCHAR        SETC  '&LDEVNCHAR(1)'        SET XVARIABLE PARM      00128800
                   AIF   (N'&LDEVNCHAR GT 1).ZG10C                      00128900
&XLDEVNCHAR        SETC  '&LDEVNCHAR'           SET XVARIABLE PARM      00129000
.ZG10C             AIF   (K'&XLDEVNCHAR GT 0).ZG10D  ONE PARM           00129100
&ZXDEVVAR1         SETC  ''          RESET IN/OUTPUT                    00129200
&ZXLDEVNCHAR       SETC  ''          RESET IN/OUTPUT                    00129300
&ZMS               SETC  ' '                                            00129400
&ZMS               SETC  '&ZMS "LDEVNCHAR" KEY AND ITS'                 00129500
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00129600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00129700
.ZG10D             ANOP  ,                                              00129800
.*----------------------------------------------------------------***   00129900
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00130000
                   AIF   (K'&VOLSER LE 0).ZG11D  NO ME KEY              00130100
                   AIF   (N'&VOLSER LE 1).ZG11A  CK NUM                 00130200
&ZMS               SETC  '"VOLSER='                                     00130300
&ZMS               SETC  '&ZMS.&VOLSER"'                                00130400
&ZMS               SETC  '&ZMS "VOLSER"'                                00130500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00130600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00130700
.ZG11A             AIF   (K'&XDEVVAR1 LE 0).ZG11B                       00130800
&ZMS               SETC  '"VOLSER'                                      00130900
&ZMS               SETC  '&ZMS.=&VOLSER"'                               00131000
&ZMS               SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'          00131100
&ZMS               SETC  '&ZMS "&XDEVVAR1"'                             00131200
                   MNOTE 8,' &ZMS KEY.'                                 00131300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00131400
                   AGO   .ZG11D                                         00131500
.*                                                                      00131600
.ZG11B             ANOP  ,                                              00131700
&ZXDEVVAR1         SETC  'INPUT'     SET IN/OUTPUT                      00131800
&XDEVVAR1          SETC  'VOLSER'    SET XVARIABLE                      00131900
&ZXVOLSER          SETC  'INPUT'     SET IN/OUTPUT                      00132000
&XVOLSER           SETC  '&VOLSER(1)'           SET XVARIABLE PARM      00132100
                   AIF   (N'&VOLSER GT 1).ZG11C                         00132200
&XVOLSER           SETC  '&VOLSER'   SET XVARIABLE PARM                 00132300
.ZG11C             AIF   (K'&XVOLSER GT 0).ZG11D  ONE PARM              00132400
&ZXDEVVAR1         SETC  ''          RESET IN/OUTPUT                    00132500
&ZXVOLSER          SETC  ''          RESET IN/OUTPUT                    00132600
&ZMS               SETC  ' '                                            00132700
&ZMS               SETC  '&ZMS "VOLSER" KEY AND ITS'                    00132800
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00132900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00133000
.ZG11D             ANOP  ,                                              00133100
.*------------------------------------------------------------------    00133200
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00133300
                   AIF   (K'&XDEVVAR1 GT 0).ZG18B                       00133400
&ZXDEVVAR1         SETC  ''          RESET IN/OUTPUT                    00133500
&ZXDEVN            SETC  ''          RESET IN/OUTPUT                    00133600
&XDEVVAR1          SETC  ''          ENSURE NULL                        00133700
&XDEVN             SETC  ''          ENSURE NULL                        00133800
&ZMS               SETC  'ONE OF THE FOLLOWING'                         00133900
&ZMS               SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'            00134000
&ZMS               SETC  '&ZMS REQUIRED:'                               00134100
&ZMS               SETC  '&ZMS "DEVN",'         VALID ME KEY            00134200
&ZMS               SETC  '&ZMS "DEVNCHAR",'     VALID ME KEY            00134300
&ZMS               SETC  '&ZMS "LDEVNCHAR",'    VALID ME KEY            00134400
&ZMS               SETC  '&ZMS OR "VOLSER".'    VALID ME KEY            00134500
                   MNOTE 8,' &ZMS '                                     00134600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00134700
.ZG18B             ANOP  ,                                              00134800
.*-------------------------------------------------------------------   00134900
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00135000
.ZG2ZY  AIF    ('&XDEVVAR1' NE 'DEVN').ZG6ZY                            00135100
.*-------------------------------------------------------------------   00135200
.***AG.KMEKY14 NAME, RQD INPUT, ME KEYS -DISALLOWED KEYS                00135300
&ZCVAL             SETC ''           ERROR KEY FIELD                    00135400
.ZG2I0             AIF   (K'&DEVCLASS LE 0).ZG2I1                       00135500
&ZCVAL             SETC '&ZCVAL DEVCLASS'       DISALLOWED KEY          00135600
.ZG2I1             AIF   (K'&ZCVAL LE 0).ZG2J   KEY                     00135700
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00135800
&ZMS               SETC  '"DEVN'                                        00135900
&ZMS               SETC  '&ZMS.=&DEVN"'                                 00136000
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00136100
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00136200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00136300
.ZG2J              ANOP  ,                                              00136400
.*-------------------------------------------------------------------   00136500
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00136600
                   AIF   (K'&ZXDEVN LE 0).ZG2R  NOT I/O                 00136700
                   AIF   ('&XDEVN'(1,1) NE '(').ZG2R                    00136800
&ZCGPR             SETC  '&XDEVN'(2,K'&XDEVN-2)                         00136900
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                    00137000
                   AIF   (K'&ZCGPR GT 2).ZG2Q                           00137100
                   AIF   ('&ZCGPR' EQ '0').ZG2Q                         00137200
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00137300
                   AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME       00137400
.ZG2P              ANOP  ,                                              00137500
                   AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC            00137600
                   AIF   ('&ZCGPR' LT '2').ZG2Q                         00137700
                   AIF   ('&ZCGPR' LE '12').ZG2R                        00137800
.ZG2Q              ANOP  ,                                              00137900
&ZMS               SETC  '"DEVN='                                       00138000
&ZMS               SETC  '&ZMS.&DEVN"'                                  00138100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00138200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00138300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00138400
.ZG2R              ANOP  ,                                              00138500
.*----------------------------------------------------------------***   00138600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00138700
                   AIF   (N'&SCHSET LE 1).ZG4A  CK NUM                  00138800
&ZMS               SETC  '"SCHSET='                                     00138900
&ZMS               SETC  '&ZMS.&SCHSET"'                                00139000
&ZMS               SETC  '&ZMS "SCHSET"'                                00139100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00139200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00139300
.ZG4A              ANOP  ,                                              00139400
.*-------------------------------------------------------------------   00139500
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00139600
&ZXSCHSET          SETC  'INPUT'     SET IN/OUTPUT                      00139700
&XSCHSET           SETC  '0'                                            00139800
                   AIF   (K'&SCHSET(1) LE 0).ZG4B  PARM                 00139900
&XSCHSET           SETC  '&SCHSET(1)'           SET XVARIABLE           00140000
                   AIF   (N'&SCHSET GT 1).ZG4B  MULTI                   00140100
&XSCHSET           SETC  '&SCHSET'   SET XVARIABLE                      00140200
.ZG4B              ANOP  ,                                              00140300
.*-------------------------------------------------------------------   00140400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00140500
                   AIF   (K'&ZXSCHSET LE 0).ZG4R  NOT I/O               00140600
                   AIF   ('&XSCHSET'(1,1) NE '(').ZG4R                  00140700
&ZCGPR             SETC  '&XSCHSET'(2,K'&XSCHSET-2)                     00140800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                    00140900
                   AIF   (K'&ZCGPR GT 2).ZG4Q                           00141000
                   AIF   ('&ZCGPR' EQ '0').ZG4Q                         00141100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00141200
                   AIF   (T'&ZCGPR NE 'N').ZG4Q  INVALID REG NAME       00141300
.ZG4P              ANOP  ,                                              00141400
                   AIF   (T'&ZCGPR NE 'N').ZG4R  NON NUMERIC            00141500
                   AIF   ('&ZCGPR' LT '2').ZG4Q                         00141600
                   AIF   ('&ZCGPR' LE '12').ZG4R                        00141700
.ZG4Q              ANOP  ,                                              00141800
&ZMS               SETC  '"SCHSET='                                     00141900
&ZMS               SETC  '&ZMS.&SCHSET"'                                00142000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00142100
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00142200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00142300
.ZG4R              ANOP  ,                                              00142400
.*-------------------------------------------------------------------   00142500
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00142600
.ZG6ZY  AIF    ('&XDEVVAR1' NE 'DEVNCHAR').ZG10ZY                       00142700
.*-------------------------------------------------------------------   00142800
.***AG.KMEKY14 NAME, RQD INPUT, ME KEYS -DISALLOWED KEYS                00142900
&ZCVAL             SETC ''           ERROR KEY FIELD                    00143000
.ZG6I0             AIF   (K'&DEVCLASS LE 0).ZG6I1                       00143100
&ZCVAL             SETC '&ZCVAL DEVCLASS'       DISALLOWED KEY          00143200
.ZG6I1             AIF   (K'&ZCVAL LE 0).ZG6J   KEY                     00143300
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00143400
&ZMS               SETC  '"DEVNCHAR'                                    00143500
&ZMS               SETC  '&ZMS.=&DEVNCHAR"'                             00143600
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00143700
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00143800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00143900
.ZG6J              ANOP  ,                                              00144000
.*-------------------------------------------------------------------   00144100
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00144200
                   AIF   (K'&ZXDEVNCHAR LE 0).ZG6R  NOT I/O             00144300
                   AIF   ('&XDEVNCHAR'(1,1) NE '(').ZG6R                00144400
&ZCGPR             SETC  '&XDEVNCHAR'(2,K'&XDEVNCHAR-2)                 00144500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                    00144600
                   AIF   (K'&ZCGPR GT 2).ZG6Q                           00144700
                   AIF   ('&ZCGPR' EQ '0').ZG6Q                         00144800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00144900
                   AIF   (T'&ZCGPR NE 'N').ZG6Q  INVALID REG NAME       00145000
.ZG6P              ANOP  ,                                              00145100
                   AIF   (T'&ZCGPR NE 'N').ZG6R  NON NUMERIC            00145200
                   AIF   ('&ZCGPR' LT '2').ZG6Q                         00145300
                   AIF   ('&ZCGPR' LE '12').ZG6R                        00145400
.ZG6Q              ANOP  ,                                              00145500
&ZMS               SETC  '"DEVNCHAR='                                   00145600
&ZMS               SETC  '&ZMS.&DEVNCHAR"'                              00145700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00145800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00145900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00146000
.ZG6R              ANOP  ,                                              00146100
.*----------------------------------------------------------------***   00146200
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00146300
                   AIF   (N'&SCHSET LE 1).ZG8A  CK NUM                  00146400
&ZMS               SETC  '"SCHSET='                                     00146500
&ZMS               SETC  '&ZMS.&SCHSET"'                                00146600
&ZMS               SETC  '&ZMS "SCHSET"'                                00146700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00146800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00146900
.ZG8A              ANOP  ,                                              00147000
.*-------------------------------------------------------------------   00147100
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00147200
&ZXSCHSET          SETC  'INPUT'     SET IN/OUTPUT                      00147300
&XSCHSET           SETC  '0'                                            00147400
                   AIF   (K'&SCHSET(1) LE 0).ZG8B  PARM                 00147500
&XSCHSET           SETC  '&SCHSET(1)'           SET XVARIABLE           00147600
                   AIF   (N'&SCHSET GT 1).ZG8B  MULTI                   00147700
&XSCHSET           SETC  '&SCHSET'   SET XVARIABLE                      00147800
.ZG8B              ANOP  ,                                              00147900
.*-------------------------------------------------------------------   00148000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00148100
                   AIF   (K'&ZXSCHSET LE 0).ZG8R  NOT I/O               00148200
                   AIF   ('&XSCHSET'(1,1) NE '(').ZG8R                  00148300
&ZCGPR             SETC  '&XSCHSET'(2,K'&XSCHSET-2)                     00148400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                    00148500
                   AIF   (K'&ZCGPR GT 2).ZG8Q                           00148600
                   AIF   ('&ZCGPR' EQ '0').ZG8Q                         00148700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00148800
                   AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME       00148900
.ZG8P              ANOP  ,                                              00149000
                   AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC            00149100
                   AIF   ('&ZCGPR' LT '2').ZG8Q                         00149200
                   AIF   ('&ZCGPR' LE '12').ZG8R                        00149300
.ZG8Q              ANOP  ,                                              00149400
&ZMS               SETC  '"SCHSET='                                     00149500
&ZMS               SETC  '&ZMS.&SCHSET"'                                00149600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00149700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00149800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00149900
.ZG8R              ANOP  ,                                              00150000
.*-------------------------------------------------------------------   00150100
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00150200
.ZG10ZY  AIF    ('&XDEVVAR1' NE 'LDEVNCHAR').ZG11ZY                     00150300
.*-------------------------------------------------------------------   00150400
.***AG.KMEKY14 NAME, RQD INPUT, ME KEYS -DISALLOWED KEYS                00150500
&ZCVAL             SETC ''           ERROR KEY FIELD                    00150600
.ZG10I0            AIF   (K'&SCHSET LE 0).ZG10I1                        00150700
&ZCVAL             SETC '&ZCVAL SCHSET'         DISALLOWED KEY          00150800
.ZG10I1            AIF   (K'&DEVCLASS LE 0).ZG10I2                      00150900
&ZCVAL             SETC '&ZCVAL DEVCLASS'       DISALLOWED KEY          00151000
.ZG10I2            AIF   (K'&ZCVAL LE 0).ZG10J  KEY                     00151100
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00151200
&ZMS               SETC  '"LDEVNCHAR'                                   00151300
&ZMS               SETC  '&ZMS.=&LDEVNCHAR"'                            00151400
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00151500
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00151600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00151700
.ZG10J             ANOP  ,                                              00151800
.*-------------------------------------------------------------------   00151900
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00152000
                   AIF   (K'&ZXLDEVNCHAR LE 0).ZG10R  NOT I/O           00152100
                   AIF   ('&XLDEVNCHAR'(1,1) NE '(').ZG10R              00152200
&ZCGPR             SETC  '&XLDEVNCHAR'(2,K'&XLDEVNCHAR-2)               00152300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                   00152400
                   AIF   (K'&ZCGPR GT 2).ZG10Q                          00152500
                   AIF   ('&ZCGPR' EQ '0').ZG10Q                        00152600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00152700
                   AIF   (T'&ZCGPR NE 'N').ZG10Q  INVALID REG NAME      00152800
.ZG10P             ANOP  ,                                              00152900
                   AIF   (T'&ZCGPR NE 'N').ZG10R  NON NUMERIC           00153000
                   AIF   ('&ZCGPR' LT '2').ZG10Q                        00153100
                   AIF   ('&ZCGPR' LE '12').ZG10R                       00153200
.ZG10Q             ANOP  ,                                              00153300
&ZMS               SETC  '"LDEVNCHAR='                                  00153400
&ZMS               SETC  '&ZMS.&LDEVNCHAR"'                             00153500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00153600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00153700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00153800
.ZG10R             ANOP  ,                                              00153900
.*-------------------------------------------------------------------   00154000
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00154100
.ZG11ZY  AIF    ('&XDEVVAR1' NE 'VOLSER').ZG18ZY                        00154200
.*-------------------------------------------------------------------   00154300
.***AG.KMEKY14 NAME, RQD INPUT, ME KEYS -DISALLOWED KEYS                00154400
&ZCVAL             SETC ''           ERROR KEY FIELD                    00154500
.ZG11I0            AIF   (K'&SCHSET LE 0).ZG11I1                        00154600
&ZCVAL             SETC '&ZCVAL SCHSET'         DISALLOWED KEY          00154700
.ZG11I1            AIF   (K'&ZCVAL LE 0).ZG11J  KEY                     00154800
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00154900
&ZMS               SETC  '"VOLSER'                                      00155000
&ZMS               SETC  '&ZMS.=&VOLSER"'                               00155100
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00155200
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00155300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00155400
.ZG11J             ANOP  ,                                              00155500
.*-------------------------------------------------------------------   00155600
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00155700
                   AIF   (K'&ZXVOLSER LE 0).ZG11R  NOT I/O              00155800
                   AIF   ('&XVOLSER'(1,1) NE '(').ZG11R                 00155900
&ZCGPR             SETC  '&XVOLSER'(2,K'&XVOLSER-2)                     00156000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                   00156100
                   AIF   (K'&ZCGPR GT 2).ZG11Q                          00156200
                   AIF   ('&ZCGPR' EQ '0').ZG11Q                        00156300
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00156400
                   AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME      00156500
.ZG11P             ANOP  ,                                              00156600
                   AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC           00156700
                   AIF   ('&ZCGPR' LT '2').ZG11Q                        00156800
                   AIF   ('&ZCGPR' LE '12').ZG11R                       00156900
.ZG11Q             ANOP  ,                                              00157000
&ZMS               SETC  '"VOLSER='                                     00157100
&ZMS               SETC  '&ZMS.&VOLSER"'                                00157200
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00157300
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00157400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00157500
.ZG11R             ANOP  ,                                              00157600
.*----------------------------------------------------------------***   00157700
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00157800
                   AIF   (N'&DEVCLASS LE 1).ZG13A  CK NUM               00157900
&ZMS               SETC  '"DEVCLASS='                                   00158000
&ZMS               SETC  '&ZMS.&DEVCLASS"'                              00158100
&ZMS               SETC  '&ZMS "DEVCLASS"'                              00158200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00158300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00158400
.ZG13A             ANOP  ,                                              00158500
.*-------------------------------------------------------------------   00158600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00158700
&XDEVCLASS         SETC  ''          INITIALIZE XVARIABLE               00158800
.ZG14A   AIF   ('&DEVCLASS(1)' NE 'DASDTAPE').ZG15A                     00158900
&XDEVCLASS         SETC  'DASDTAPE'  SET KEYWORD                        00159000
.*-------------------------------------------------------------------   00159100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00159200
.ZG15A   AIF   ('&DEVCLASS(1)' NE 'TAPE').ZG16A                         00159300
&XDEVCLASS         SETC  'TAPE'      SET KEYWORD                        00159400
.*-------------------------------------------------------------------   00159500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00159600
.ZG16A   AIF   ('&DEVCLASS(1)' NE 'DASD').ZG17A                         00159700
&XDEVCLASS         SETC  'DASD'      SET KEYWORD                        00159800
.*-------------------------------------------------------------------   00159900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00160000
.ZG17A             AIF   (K'&XDEVCLASS GT 0).ZG17C  KEYWORD             00160100
                   AIF   (K'&DEVCLASS(1) LE 0).ZG17B                    00160200
&ZMS               SETC  '"DEVCLASS='                                   00160300
&ZMS               SETC  '&ZMS.&DEVCLASS"'                              00160400
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00160500
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00160600
&ZMS               SETC  '&ZMS "DASDTAPE",'                             00160700
&ZMS               SETC  '&ZMS "TAPE",'                                 00160800
&ZMS               SETC  '&ZMS OR "DASD".'                              00160900
                   MNOTE 8,' &ZMS '                                     00161000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00161100
.ZG17B             ANOP  ,                                              00161200
&XDEVCLASS         SETC  'DASDTAPE'  SET DEFAULT KEYWORD                00161300
.ZG17C             ANOP  ,                                              00161400
&ZXDEVCLASS        SETC  'INPUT'     SET IN/OUTPUT                      00161500
.*-------------------------------------------------------------------   00161600
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00161700
.ZG18ZY            ANOP ,            END MUTUALLY EXCLUSIVE KEYS        00161800
.*----------------------------------------------------------------***   00161900
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00162000
                   AIF   (N'&UCBPTR LE 1).ZG20A  CK NUM                 00162100
&ZMS               SETC  '"UCBPTR='                                     00162200
&ZMS               SETC  '&ZMS.&UCBPTR"'                                00162300
&ZMS               SETC  '&ZMS "UCBPTR"'                                00162400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00162500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00162600
.ZG20A             ANOP  ,                                              00162700
.*-------------------------------------------------------------------   00162800
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00162900
&ZXUCBPTR          SETC  'OUTPUT'    SET IN/OUTPUT                      00163000
&XUCBPTR           SETC  '&UCBPTR(1)'           SET XVARIABLE           00163100
                   AIF   (N'&UCBPTR GT 1).ZG20B  MULTI PARMS            00163200
&XUCBPTR           SETC  '&UCBPTR'   SET XVARIABLE                      00163300
.ZG20B             AIF   (K'&UCBPTR(1) GT 0).ZG20C                      00163400
&ZXUCBPTR          SETC  ''          RESET IN/OUTPUT                    00163500
&ZMS               SETC  ' '                                            00163600
&ZMS               SETC  '&ZMS "UCBPTR" KEY AND ITS'                    00163700
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00163800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00163900
.ZG20C             ANOP  ,                                              00164000
.*-------------------------------------------------------------------   00164100
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00164200
                   AIF   (K'&ZXUCBPTR LE 0).ZG20R  NOT I/O              00164300
                   AIF   ('&XUCBPTR'(1,1) NE '(').ZG20R                 00164400
&ZCGPR             SETC  '&XUCBPTR'(2,K'&XUCBPTR-2)                     00164500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                   00164600
                   AIF   (K'&ZCGPR GT 2).ZG20Q                          00164700
                   AIF   ('&ZCGPR' EQ '0').ZG20Q                        00164800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00164900
                   AIF   (T'&ZCGPR NE 'N').ZG20Q  INVALID REG NAME      00165000
.ZG20P             ANOP  ,                                              00165100
                   AIF   (T'&ZCGPR NE 'N').ZG20R  NON NUMERIC           00165200
                   AIF   ('&ZCGPR' LT '2').ZG20Q                        00165300
                   AIF   ('&ZCGPR' LE '12').ZG20R                       00165400
.ZG20Q             ANOP  ,                                              00165500
&ZMS               SETC  '"UCBPTR='                                     00165600
&ZMS               SETC  '&ZMS.&UCBPTR"'                                00165700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00165800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00165900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00166000
.ZG20R             ANOP  ,                                              00166100
.*----------------------------------------------------------------***   00166200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00166300
                   AIF   (N'&UCBCXPTR LE 1).ZG23A  CK NUM               00166400
&ZMS               SETC  '"UCBCXPTR='                                   00166500
&ZMS               SETC  '&ZMS.&UCBCXPTR"'                              00166600
&ZMS               SETC  '&ZMS "UCBCXPTR"'                              00166700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00166800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00166900
.ZG23A             ANOP  ,                                              00167000
.*-------------------------------------------------------------------   00167100
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00167200
                   AIF   (K'&UCBCXPTR(1) LE 0).ZG23C  NO PARM           00167300
&ZXUCBCXPTR        SETC  'OUTPUT'    SET OUTPUT                         00167400
&XUCBCXPTR         SETC  '&UCBCXPTR(1)'         SET XVARIABLE           00167500
                   AIF   (N'&UCBCXPTR GT 1).ZG23C                       00167600
&XUCBCXPTR         SETC  '&UCBCXPTR'            SET XVARIABLE           00167700
.ZG23C             ANOP  ,                                              00167800
.*-------------------------------------------------------------------   00167900
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00168000
                   AIF   (K'&ZXUCBCXPTR LE 0).ZG23R  NOT I/O            00168100
                   AIF   ('&XUCBCXPTR'(1,1) NE '(').ZG23R               00168200
&ZCGPR             SETC  '&XUCBCXPTR'(2,K'&XUCBCXPTR-2)                 00168300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                   00168400
                   AIF   (K'&ZCGPR GT 2).ZG23Q                          00168500
                   AIF   ('&ZCGPR' EQ '0').ZG23Q                        00168600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00168700
                   AIF   (T'&ZCGPR NE 'N').ZG23Q  INVALID REG NAME      00168800
.ZG23P             ANOP  ,                                              00168900
                   AIF   (T'&ZCGPR NE 'N').ZG23R  NON NUMERIC           00169000
                   AIF   ('&ZCGPR' LT '2').ZG23Q                        00169100
                   AIF   ('&ZCGPR' LE '12').ZG23R                       00169200
.ZG23Q             ANOP  ,                                              00169300
&ZMS               SETC  '"UCBCXPTR='                                   00169400
&ZMS               SETC  '&ZMS.&UCBCXPTR"'                              00169500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00169600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00169700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00169800
.ZG23R             ANOP  ,                                              00169900
.*----------------------------------------------------------------***   00170000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00170100
                   AIF   (N'&UCBPXPTR LE 1).ZG26A  CK NUM               00170200
&ZMS               SETC  '"UCBPXPTR='                                   00170300
&ZMS               SETC  '&ZMS.&UCBPXPTR"'                              00170400
&ZMS               SETC  '&ZMS "UCBPXPTR"'                              00170500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00170600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00170700
.ZG26A             ANOP  ,                                              00170800
.*-------------------------------------------------------------------   00170900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00171000
                   AIF   (K'&UCBPXPTR(1) LE 0).ZG26C  NO PARM           00171100
&ZXUCBPXPTR        SETC  'OUTPUT'    SET OUTPUT                         00171200
&XUCBPXPTR         SETC  '&UCBPXPTR(1)'         SET XVARIABLE           00171300
                   AIF   (N'&UCBPXPTR GT 1).ZG26C                       00171400
&XUCBPXPTR         SETC  '&UCBPXPTR'            SET XVARIABLE           00171500
.ZG26C             ANOP  ,                                              00171600
.*-------------------------------------------------------------------   00171700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00171800
                   AIF   (K'&ZXUCBPXPTR LE 0).ZG26R  NOT I/O            00171900
                   AIF   ('&XUCBPXPTR'(1,1) NE '(').ZG26R               00172000
&ZCGPR             SETC  '&XUCBPXPTR'(2,K'&XUCBPXPTR-2)                 00172100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                   00172200
                   AIF   (K'&ZCGPR GT 2).ZG26Q                          00172300
                   AIF   ('&ZCGPR' EQ '0').ZG26Q                        00172400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00172500
                   AIF   (T'&ZCGPR NE 'N').ZG26Q  INVALID REG NAME      00172600
.ZG26P             ANOP  ,                                              00172700
                   AIF   (T'&ZCGPR NE 'N').ZG26R  NON NUMERIC           00172800
                   AIF   ('&ZCGPR' LT '2').ZG26Q                        00172900
                   AIF   ('&ZCGPR' LE '12').ZG26R                       00173000
.ZG26Q             ANOP  ,                                              00173100
&ZMS               SETC  '"UCBPXPTR='                                   00173200
&ZMS               SETC  '&ZMS.&UCBPXPTR"'                              00173300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00173400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00173500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00173600
.ZG26R             ANOP  ,                                              00173700
.*----------------------------------------------------------------***   00173800
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00173900
                   AIF   (N'&LOC LE 1).ZG29A    CK NUM                  00174000
&ZMS               SETC  '"LOC='                                        00174100
&ZMS               SETC  '&ZMS.&LOC"'                                   00174200
&ZMS               SETC  '&ZMS "LOC"'                                   00174300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00174400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00174500
.ZG29A             ANOP  ,                                              00174600
.*-------------------------------------------------------------------   00174700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00174800
&XLOC              SETC  ''          INITIALIZE XVARIABLE               00174900
.ZG30A   AIF   ('&LOC(1)' NE 'BELOW').ZG31A                             00175000
&XLOC              SETC  'BELOW'     SET KEYWORD                        00175100
.*-------------------------------------------------------------------   00175200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00175300
.ZG31A   AIF   ('&LOC(1)' NE 'ANY').ZG32A                               00175400
&XLOC              SETC  'ANY'       SET KEYWORD                        00175500
.*-------------------------------------------------------------------   00175600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00175700
.ZG32A             AIF   (K'&XLOC GT 0).ZG32C   KEYWORD                 00175800
                   AIF   (K'&LOC(1) LE 0).ZG32B                         00175900
&ZMS               SETC  '"LOC='                                        00176000
&ZMS               SETC  '&ZMS.&LOC"'                                   00176100
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00176200
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00176300
&ZMS               SETC  '&ZMS "BELOW"'                                 00176400
&ZMS               SETC  '&ZMS OR "ANY".'                               00176500
                   MNOTE 8,' &ZMS '                                     00176600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00176700
.ZG32B             ANOP  ,                                              00176800
&XLOC              SETC  'BELOW'     SET DEFAULT KEYWORD                00176900
.ZG32C             ANOP  ,                                              00177000
&ZXLOC             SETC  'INPUT'     SET IN/OUTPUT                      00177100
.*----------------------------------------------------------------***   00177200
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00177300
                   AIF   (N'&DYNAMIC LE 1).ZG34A  CK NUM                00177400
&ZMS               SETC  '"DYNAMIC='                                    00177500
&ZMS               SETC  '&ZMS.&DYNAMIC"'                               00177600
&ZMS               SETC  '&ZMS "DYNAMIC"'                               00177700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00177800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00177900
.ZG34A             ANOP  ,                                              00178000
.*-------------------------------------------------------------------   00178100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00178200
&XDYNAMIC          SETC  ''          INITIALIZE XVARIABLE               00178300
.ZG35A   AIF   ('&DYNAMIC(1)' NE 'NO').ZG36A                            00178400
&XDYNAMIC          SETC  'NO'        SET KEYWORD                        00178500
.*-------------------------------------------------------------------   00178600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00178700
.ZG36A   AIF   ('&DYNAMIC(1)' NE 'YES').ZG37A                           00178800
&XDYNAMIC          SETC  'YES'       SET KEYWORD                        00178900
.*-------------------------------------------------------------------   00179000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00179100
.ZG37A             AIF   (K'&XDYNAMIC GT 0).ZG37C  KEYWORD              00179200
                   AIF   (K'&DYNAMIC(1) LE 0).ZG37B                     00179300
&ZMS               SETC  '"DYNAMIC='                                    00179400
&ZMS               SETC  '&ZMS.&DYNAMIC"'                               00179500
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00179600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00179700
&ZMS               SETC  '&ZMS "NO"'                                    00179800
&ZMS               SETC  '&ZMS OR "YES".'                               00179900
                   MNOTE 8,' &ZMS '                                     00180000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00180100
.ZG37B             ANOP  ,                                              00180200
&XDYNAMIC          SETC  'NO'        SET DEFAULT KEYWORD                00180300
.ZG37C             ANOP  ,                                              00180400
&ZXDYNAMIC         SETC  'INPUT'     SET IN/OUTPUT                      00180500
.*----------------------------------------------------------------***   00180600
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00180700
                   AIF   (N'&RANGE LE 1).ZG39A  CK NUM                  00180800
&ZMS               SETC  '"RANGE='                                      00180900
&ZMS               SETC  '&ZMS.&RANGE"'                                 00181000
&ZMS               SETC  '&ZMS "RANGE"'                                 00181100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00181200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00181300
.ZG39A             ANOP  ,                                              00181400
.*-------------------------------------------------------------------   00181500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00181600
&XRANGE            SETC  ''          INITIALIZE XVARIABLE               00181700
.ZG40A   AIF   ('&RANGE(1)' NE '3DIGIT').ZG41A                          00181800
&XRANGE            SETC  '3DIGIT'    SET KEYWORD                        00181900
.*-------------------------------------------------------------------   00182000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00182100
.ZG41A   AIF   ('&RANGE(1)' NE 'ALL').ZG42A                             00182200
&XRANGE            SETC  'ALL'       SET KEYWORD                        00182300
.*-------------------------------------------------------------------   00182400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00182500
.ZG42A             AIF   (K'&XRANGE GT 0).ZG42C  KEYWORD                00182600
                   AIF   (K'&RANGE(1) LE 0).ZG42B                       00182700
&ZMS               SETC  '"RANGE='                                      00182800
&ZMS               SETC  '&ZMS.&RANGE"'                                 00182900
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00183000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00183100
&ZMS               SETC  '&ZMS "3DIGIT"'                                00183200
&ZMS               SETC  '&ZMS OR "ALL".'                               00183300
                   MNOTE 8,' &ZMS '                                     00183400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00183500
.ZG42B             ANOP  ,                                              00183600
&XRANGE            SETC  '3DIGIT'    SET DEFAULT KEYWORD                00183700
.ZG42C             ANOP  ,                                              00183800
&ZXRANGE           SETC  'INPUT'     SET IN/OUTPUT                      00183900
.*----------------------------------------------------------------***   00184000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00184100
                   AIF   (N'&NONBASE LE 1).ZG44A  CK NUM                00184200
&ZMS               SETC  '"NONBASE='                                    00184300
&ZMS               SETC  '&ZMS.&NONBASE"'                               00184400
&ZMS               SETC  '&ZMS "NONBASE"'                               00184500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00184600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00184700
.ZG44A             ANOP  ,                                              00184800
.*-------------------------------------------------------------------   00184900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00185000
&XNONBASE          SETC  ''          INITIALIZE XVARIABLE               00185100
.ZG45A   AIF   ('&NONBASE(1)' NE 'NO').ZG46A                            00185200
&XNONBASE          SETC  'NO'        SET KEYWORD                        00185300
.*-------------------------------------------------------------------   00185400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00185500
.ZG46A   AIF   ('&NONBASE(1)' NE 'YES').ZG47A                           00185600
&XNONBASE          SETC  'YES'       SET KEYWORD                        00185700
.*-------------------------------------------------------------------   00185800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00185900
.ZG47A             AIF   (K'&XNONBASE GT 0).ZG47C  KEYWORD              00186000
                   AIF   (K'&NONBASE(1) LE 0).ZG47B                     00186100
&ZMS               SETC  '"NONBASE='                                    00186200
&ZMS               SETC  '&ZMS.&NONBASE"'                               00186300
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00186400
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00186500
&ZMS               SETC  '&ZMS "NO"'                                    00186600
&ZMS               SETC  '&ZMS OR "YES".'                               00186700
                   MNOTE 8,' &ZMS '                                     00186800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00186900
.ZG47B             ANOP  ,                                              00187000
&XNONBASE          SETC  'NO'        SET DEFAULT KEYWORD                00187100
.ZG47C             ANOP  ,                                              00187200
&ZXNONBASE         SETC  'INPUT'     SET IN/OUTPUT                      00187300
.*----------------------------------------------------------------***   00187400
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00187500
                   AIF   (N'&UNBOUND_ALIAS LE 1).ZG49A  CK NUM          00187600
&ZMS               SETC  '"UNBOUND_ALIAS='                              00187700
&ZMS               SETC  '&ZMS.&UNBOUND_ALIAS"'                         00187800
&ZMS               SETC  '&ZMS "UNBOUND_ALIAS"'                         00187900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00188000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00188100
.ZG49A             ANOP  ,                                              00188200
.*-------------------------------------------------------------------   00188300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00188400
&XUNBOUND_ALIAS    SETC  ''          INITIALIZE XVARIABLE               00188500
.ZG50A   AIF   ('&UNBOUND_ALIAS(1)' NE 'NO').ZG51A                      00188600
&XUNBOUND_ALIAS    SETC  'NO'        SET KEYWORD                        00188700
.*-------------------------------------------------------------------   00188800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00188900
.ZG51A   AIF   ('&UNBOUND_ALIAS(1)' NE 'YES').ZG52A                     00189000
&XUNBOUND_ALIAS    SETC  'YES'       SET KEYWORD                        00189100
.*-------------------------------------------------------------------   00189200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00189300
.ZG52A             AIF   (K'&XUNBOUND_ALIAS GT 0).ZG52C  KEYWORD        00189400
                   AIF   (K'&UNBOUND_ALIAS(1) LE 0).ZG52B               00189500
&ZMS               SETC  '"UNBOUND_ALIAS='                              00189600
&ZMS               SETC  '&ZMS.&UNBOUND_ALIAS"'                         00189700
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00189800
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00189900
&ZMS               SETC  '&ZMS "NO"'                                    00190000
&ZMS               SETC  '&ZMS OR "YES".'                               00190100
                   MNOTE 8,' &ZMS '                                     00190200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00190300
.ZG52B             ANOP  ,                                              00190400
&XUNBOUND_ALIAS    SETC  'NO'        SET DEFAULT KEYWORD                00190500
.ZG52C             ANOP  ,                                              00190600
&ZXUNBOUND_ALIAS   SETC  'INPUT'     SET IN/OUTPUT                      00190700
.*----------------------------------------------------------------***   00190800
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00190900
                   AIF   (N'&SPECIAL LE 1).ZG54A  CK NUM                00191000
&ZMS               SETC  '"SPECIAL='                                    00191100
&ZMS               SETC  '&ZMS.&SPECIAL"'                               00191200
&ZMS               SETC  '&ZMS "SPECIAL"'                               00191300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00191400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00191500
.ZG54A             ANOP  ,                                              00191600
.*-------------------------------------------------------------------   00191700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00191800
&XSPECIAL          SETC  ''          INITIALIZE XVARIABLE               00191900
.ZG55A   AIF   ('&SPECIAL(1)' NE 'NO').ZG56A                            00192000
&XSPECIAL          SETC  'NO'        SET KEYWORD                        00192100
.*-------------------------------------------------------------------   00192200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00192300
.ZG56A   AIF   ('&SPECIAL(1)' NE 'YES').ZG57A                           00192400
&XSPECIAL          SETC  'YES'       SET KEYWORD                        00192500
.*-------------------------------------------------------------------   00192600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00192700
.ZG57A             AIF   (K'&XSPECIAL GT 0).ZG57C  KEYWORD              00192800
                   AIF   (K'&SPECIAL(1) LE 0).ZG57B                     00192900
&ZMS               SETC  '"SPECIAL='                                    00193000
&ZMS               SETC  '&ZMS.&SPECIAL"'                               00193100
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00193200
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00193300
&ZMS               SETC  '&ZMS "NO"'                                    00193400
&ZMS               SETC  '&ZMS OR "YES".'                               00193500
                   MNOTE 8,' &ZMS '                                     00193600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00193700
.ZG57B             ANOP  ,                                              00193800
&XSPECIAL          SETC  'NO'        SET DEFAULT KEYWORD                00193900
.ZG57C             ANOP  ,                                              00194000
&ZXSPECIAL         SETC  'INPUT'     SET IN/OUTPUT                      00194100
.*----------------------------------------------------------------***   00194200
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00194300
                   AIF   (N'&NOTFIND LE 1).ZG59A  CK NUM                00194400
&ZMS               SETC  '"NOTFIND='                                    00194500
&ZMS               SETC  '&ZMS.&NOTFIND"'                               00194600
&ZMS               SETC  '&ZMS "NOTFIND"'                               00194700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00194800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00194900
.ZG59A             ANOP  ,                                              00195000
.*-------------------------------------------------------------------   00195100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00195200
&XNOTFIND          SETC  ''          INITIALIZE XVARIABLE               00195300
.ZG60A   AIF   ('&NOTFIND(1)' NE 'NO').ZG61A                            00195400
&XNOTFIND          SETC  'NO'        SET KEYWORD                        00195500
.*-------------------------------------------------------------------   00195600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00195700
.ZG61A   AIF   ('&NOTFIND(1)' NE 'YES').ZG62A                           00195800
&XNOTFIND          SETC  'YES'       SET KEYWORD                        00195900
.*-------------------------------------------------------------------   00196000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00196100
.ZG62A             AIF   (K'&XNOTFIND GT 0).ZG62C  KEYWORD              00196200
                   AIF   (K'&NOTFIND(1) LE 0).ZG62B                     00196300
&ZMS               SETC  '"NOTFIND='                                    00196400
&ZMS               SETC  '&ZMS.&NOTFIND"'                               00196500
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00196600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00196700
&ZMS               SETC  '&ZMS "NO"'                                    00196800
&ZMS               SETC  '&ZMS OR "YES".'                               00196900
                   MNOTE 8,' &ZMS '                                     00197000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00197100
.ZG62B             ANOP  ,                                              00197200
&XNOTFIND          SETC  'NO'        SET DEFAULT KEYWORD                00197300
.ZG62C             ANOP  ,                                              00197400
&ZXNOTFIND         SETC  'INPUT'     SET IN/OUTPUT                      00197500
.*-------------------------------------------------------------------   00197600
.***AG.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00197700
&XPINREQ           SETC  ''          INITIALIZE XVARIABLE               00197800
&ZASYSLNDX         SETA  0                                              00197900
.ZG64A             ANOP  ,           POSITIONAL KEY SEARCH              00198000
&ZASYSLNDX         SETA  &ZASYSLNDX+1           NEXT POSITIONAL         00198100
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG64B  DONE                   00198200
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG64A            00198300
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'PIN').ZG64A                  00198400
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00198500
&ZXPINREQ          SETC  'INPUT'     SET IN/OUTPUT                      00198600
&XPINREQ           SETC  'PIN'       SET XVARIABLE                      00198700
&ZXPIN             SETC  'INPUT'     SET IN/OUTPUT                      00198800
&XPIN              SETC  'PIN'       SET XVARIABLE PARM                 00198900
.ZG64B             ANOP  ,                                              00199000
.*-------------------------------------------------------------------   00199100
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00199200
&ZASYSLNDX         SETA  0                                              00199300
.ZG83A             ANOP  ,           POSITIONAL KEY SEARCH              00199400
&ZASYSLNDX         SETA  &ZASYSLNDX+1           NEXT POSITIONAL         00199500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG83C  DONE                   00199600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG83A            00199700
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'NOPIN').ZG83A                00199800
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00199900
                   AIF   (K'&XPINREQ LE 0).ZG83B  VALID                 00200000
&ZMS               SETC  '"NOPIN'                                       00200100
&ZMS               SETC  '&ZMS."'                                       00200200
&ZMS               SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'          00200300
&ZMS               SETC  '&ZMS "&XPINREQ"'                              00200400
                   MNOTE 8,' &ZMS KEY.'                                 00200500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00200600
                   AGO   .ZG83C                                         00200700
.*                                                                      00200800
.ZG83B             ANOP  ,                                              00200900
&ZXPINREQ          SETC  'INPUT'     SET IN/OUTPUT                      00201000
&XPINREQ           SETC  'NOPIN'     SET XVARIABLE                      00201100
&ZXNOPIN           SETC  'INPUT'     SET IN/OUTPUT                      00201200
&XNOPIN            SETC  'NOPIN'     SET XVARIABLE PARM                 00201300
.ZG83C             ANOP  ,                                              00201400
.*------------------------------------------------------------------    00201500
.***AG.KME4Y09 VALUE, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED          00201600
                   AIF   (K'&XPINREQ GT 0).ZG84B                        00201700
&ZXPINREQ          SETC  ''          RESET IN/OUTPUT                    00201800
&ZXPIN             SETC  ''          RESET IN/OUTPUT                    00201900
&XPINREQ           SETC  ''          ENSURE NULL                        00202000
&XPIN              SETC  ''          ENSURE NULL                        00202100
&ZMS               SETC  'ONE OF THE FOLLOWING'                         00202200
&ZMS               SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'            00202300
&ZMS               SETC  '&ZMS REQUIRED:'                               00202400
&ZMS               SETC  '&ZMS "PIN"'           VALID ME KEY            00202500
&ZMS               SETC  '&ZMS OR "NOPIN".'     VALID ME KEY            00202600
                   MNOTE 8,' &ZMS '                                     00202700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00202800
.ZG84B             ANOP  ,                                              00202900
.*-------------------------------------------------------------------   00203000
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00203100
.ZG64ZY  AIF    ('&XPINREQ' NE 'PIN').ZG83ZY                            00203200
.*----------------------------------------------------------------***   00203300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00203400
                   AIF   (N'&TEXT LE 1).ZG66A   CK NUM                  00203500
&ZMS               SETC  '"TEXT='                                       00203600
&ZMS               SETC  '&ZMS.&TEXT"'                                  00203700
&ZMS               SETC  '&ZMS "TEXT"'                                  00203800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00203900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00204000
.ZG66A             ANOP  ,                                              00204100
.*-------------------------------------------------------------------   00204200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00204300
&ZXTEXT            SETC  'INPUT'     SET IN/OUTPUT                      00204400
&XTEXT             SETC  '&TEXT(1)'  SET XVARIABLE                      00204500
                   AIF   (N'&TEXT GT 1).ZG66B   MULTI PARMS             00204600
&XTEXT             SETC  '&TEXT'     SET XVARIABLE                      00204700
.ZG66B             AIF   (K'&TEXT(1) GT 0).ZG66C                        00204800
&ZXTEXT            SETC  ''          RESET IN/OUTPUT                    00204900
&ZMS               SETC  ' '                                            00205000
&ZMS               SETC  '&ZMS "TEXT" KEY AND ITS'                      00205100
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00205200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00205300
.ZG66C             ANOP  ,                                              00205400
.*-------------------------------------------------------------------   00205500
.***AG.KCK01 NAME, RQD INPUT, KEYS -GPR NOT ALLOWED                     00205600
                   AIF   (K'&ZXTEXT LE 0).ZG66P  NOT I/O                00205700
                   AIF   ('&XTEXT'(1,1) NE '(').ZG66P                   00205800
&ZXTEXT            SETC  ''          RESET IN/OUTPUT                    00205900
&ZMS               SETC  '"TEXT='                                       00206000
&ZMS               SETC  '&ZMS.&TEXT"'                                  00206100
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00206200
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'              00206300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00206400
.ZG66P             ANOP  ,                                              00206500
.*----------------------------------------------------------------***   00206600
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00206700
                   AIF   (N'&PTOKEN LE 1).ZG69A  CK NUM                 00206800
&ZMS               SETC  '"PTOKEN='                                     00206900
&ZMS               SETC  '&ZMS.&PTOKEN"'                                00207000
&ZMS               SETC  '&ZMS "PTOKEN"'                                00207100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00207200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00207300
.ZG69A             ANOP  ,                                              00207400
.*-------------------------------------------------------------------   00207500
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00207600
&ZXPTOKEN          SETC  'OUTPUT'    SET IN/OUTPUT                      00207700
&XPTOKEN           SETC  '&PTOKEN(1)'           SET XVARIABLE           00207800
                   AIF   (N'&PTOKEN GT 1).ZG69B  MULTI PARMS            00207900
&XPTOKEN           SETC  '&PTOKEN'   SET XVARIABLE                      00208000
.ZG69B             AIF   (K'&PTOKEN(1) GT 0).ZG69C                      00208100
&ZXPTOKEN          SETC  ''          RESET IN/OUTPUT                    00208200
&ZMS               SETC  ' '                                            00208300
&ZMS               SETC  '&ZMS "PTOKEN" KEY AND ITS'                    00208400
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00208500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00208600
.ZG69C             ANOP  ,                                              00208700
.*-------------------------------------------------------------------   00208800
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00208900
                   AIF   (K'&ZXPTOKEN LE 0).ZG69R  NOT I/O              00209000
                   AIF   ('&XPTOKEN'(1,1) NE '(').ZG69R                 00209100
&ZCGPR             SETC  '&XPTOKEN'(2,K'&XPTOKEN-2)                     00209200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG69P                   00209300
                   AIF   (K'&ZCGPR GT 2).ZG69Q                          00209400
                   AIF   ('&ZCGPR' EQ '0').ZG69Q                        00209500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00209600
                   AIF   (T'&ZCGPR NE 'N').ZG69Q  INVALID REG NAME      00209700
.ZG69P             ANOP  ,                                              00209800
                   AIF   (T'&ZCGPR NE 'N').ZG69R  NON NUMERIC           00209900
                   AIF   ('&ZCGPR' LT '2').ZG69Q                        00210000
                   AIF   ('&ZCGPR' LE '12').ZG69R                       00210100
.ZG69Q             ANOP  ,                                              00210200
&ZMS               SETC  '"PTOKEN='                                     00210300
&ZMS               SETC  '&ZMS.&PTOKEN"'                                00210400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00210500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00210600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00210700
.ZG69R             ANOP  ,                                              00210800
.*----------------------------------------------------------------***   00210900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00211000
                   AIF   (N'&COMPID LE 1).ZG72A  CK NUM                 00211100
&ZMS               SETC  '"COMPID='                                     00211200
&ZMS               SETC  '&ZMS.&COMPID"'                                00211300
&ZMS               SETC  '&ZMS "COMPID"'                                00211400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00211500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00211600
.ZG72A             ANOP  ,                                              00211700
.*-------------------------------------------------------------------   00211800
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00211900
&ZXCOMPID          SETC  'INPUT'     SET IN/OUTPUT                      00212000
&XCOMPID           SETC  'NONE'                                         00212100
                   AIF   (K'&COMPID(1) LE 0).ZG72B  PARM                00212200
&XCOMPID           SETC  '&COMPID(1)'           SET XVARIABLE           00212300
                   AIF   (N'&COMPID GT 1).ZG72B  MULTI                  00212400
&XCOMPID           SETC  '&COMPID'   SET XVARIABLE                      00212500
.ZG72B             ANOP  ,                                              00212600
.*-------------------------------------------------------------------   00212700
.***AG.KCK01 NAME, OPT INPUT, KEYS -GPR NOT ALLOWED                     00212800
                   AIF   (K'&ZXCOMPID LE 0).ZG72P  NOT I/O              00212900
                   AIF   ('&XCOMPID' EQ 'NONE').ZG72P                   00213000
                   AIF   ('&XCOMPID'(1,1) NE '(').ZG72P                 00213100
&ZXCOMPID          SETC  ''          RESET IN/OUTPUT                    00213200
&ZMS               SETC  '"COMPID='                                     00213300
&ZMS               SETC  '&ZMS.&COMPID"'                                00213400
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00213500
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'              00213600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00213700
.ZG72P             ANOP  ,                                              00213800
.*----------------------------------------------------------------***   00213900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00214000
                   AIF   (N'&HELP LE 1).ZG75A   CK NUM                  00214100
&ZMS               SETC  '"HELP='                                       00214200
&ZMS               SETC  '&ZMS.&HELP"'                                  00214300
&ZMS               SETC  '&ZMS "HELP"'                                  00214400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00214500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00214600
.ZG75A             ANOP  ,                                              00214700
.*-------------------------------------------------------------------   00214800
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00214900
&ZXHELP            SETC  'INPUT'     SET IN/OUTPUT                      00215000
&XHELP             SETC  'NONE'                                         00215100
                   AIF   (K'&HELP(1) LE 0).ZG75B  PARM                  00215200
&XHELP             SETC  '&HELP(1)'  SET XVARIABLE                      00215300
                   AIF   (N'&HELP GT 1).ZG75B   MULTI                   00215400
&XHELP             SETC  '&HELP'     SET XVARIABLE                      00215500
.ZG75B             ANOP  ,                                              00215600
.*-------------------------------------------------------------------   00215700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00215800
                   AIF   (K'&ZXHELP LE 0).ZG75R  NOT I/O                00215900
         AIF   ('&XHELP' EQ 'NONE').ZG75R                               00216000
                   AIF   ('&XHELP'(1,1) NE '(').ZG75R                   00216100
&ZCGPR             SETC  '&XHELP'(2,K'&XHELP-2)                         00216200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG75P                   00216300
                   AIF   (K'&ZCGPR GT 2).ZG75Q                          00216400
                   AIF   ('&ZCGPR' EQ '0').ZG75Q                        00216500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00216600
                   AIF   (T'&ZCGPR NE 'N').ZG75Q  INVALID REG NAME      00216700
.ZG75P             ANOP  ,                                              00216800
                   AIF   (T'&ZCGPR NE 'N').ZG75R  NON NUMERIC           00216900
                   AIF   ('&ZCGPR' LT '2').ZG75Q                        00217000
                   AIF   ('&ZCGPR' LE '12').ZG75R                       00217100
.ZG75Q             ANOP  ,                                              00217200
&ZMS               SETC  '"HELP='                                       00217300
&ZMS               SETC  '&ZMS.&HELP"'                                  00217400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00217500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00217600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00217700
.ZG75R             ANOP  ,                                              00217800
.*----------------------------------------------------------------***   00217900
.***AG.KXVAR01 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00218000
&XLASTING          SETC  ''          RESET XVARIABLE                    00218100
&ZXLASTING         SETC  ''          RESET IN/OUTPUT                    00218200
&ZASYSLNDX         SETA  0                                              00218300
.ZG78A             ANOP  ,           POSITIONAL MACRO KEY               00218400
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00218500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG78B                         00218600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG78A            00218700
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'LASTING').ZG78A              00218800
&ZCSYSLIST(&ZASYSLNDX) SETC  'NONXKEY'          POSITIONAL IS MACRO KEY 00218900
&XLASTING          SETC  'LASTING'   MACRO KEY FOUND                    00219000
&ZXLASTING         SETC  'INPUT'     SET IN/OUTPUT                      00219100
.ZG78B             ANOP  ,                                              00219200
.*-------------------------------------------------------------------   00219300
.***AG.KXVAR03 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00219400
                   AIF   (K'&XLASTING GT 0).ZG78C  KEY ENTERED          00219500
&ZXLASTING         SETC  'INPUT'     SET IN/OUTPUT                      00219600
&XLASTING          SETC  'NONE'      SET DEFAULT                        00219700
.ZG78C             ANOP  ,                                              00219800
.*----------------------------------------------------------------***   00219900
.***AG.KXVAR01 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00220000
&XPINPATHS         SETC  ''          RESET XVARIABLE                    00220100
&ZXPINPATHS        SETC  ''          RESET IN/OUTPUT                    00220200
&ZASYSLNDX         SETA  0                                              00220300
.ZG81A             ANOP  ,           POSITIONAL MACRO KEY               00220400
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00220500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG81B                         00220600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG81A            00220700
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'PINPATHS').ZG81A             00220800
&ZCSYSLIST(&ZASYSLNDX) SETC  'NONXKEY'          POSITIONAL IS MACRO KEY 00220900
&XPINPATHS         SETC  'PINPATHS'  MACRO KEY FOUND                    00221000
&ZXPINPATHS        SETC  'INPUT'     SET IN/OUTPUT                      00221100
.ZG81B             ANOP  ,                                              00221200
.*-------------------------------------------------------------------   00221300
.***AG.KXVAR03 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00221400
                   AIF   (K'&XPINPATHS GT 0).ZG81C  KEY ENTERED         00221500
&ZXPINPATHS        SETC  'INPUT'     SET IN/OUTPUT                      00221600
&XPINPATHS         SETC  'NONE'      SET DEFAULT                        00221700
.ZG81C             ANOP  ,                                              00221800
.*-------------------------------------------------------------------   00221900
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00222000
.ZG83ZY  AIF    ('&XPINREQ' NE 'NOPIN').ZG84ZY                          00222100
.*-------------------------------------------------------------------   00222200
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00222300
&ZCVAL             SETC ''           ERROR KEY FIELD                    00222400
.ZG83I0            AIF   (K'&TEXT LE 0).ZG83I1                          00222500
&ZCVAL             SETC '&ZCVAL TEXT'           DISALLOWED KEY          00222600
.ZG83I1            AIF   (K'&PTOKEN LE 0).ZG83I2                        00222700
&ZCVAL             SETC '&ZCVAL PTOKEN'         DISALLOWED KEY          00222800
.ZG83I2            AIF   (K'&COMPID LE 0).ZG83I3                        00222900
&ZCVAL             SETC '&ZCVAL COMPID'         DISALLOWED KEY          00223000
.ZG83I3            AIF   (K'&HELP LE 0).ZG83I4                          00223100
&ZCVAL             SETC '&ZCVAL HELP'           DISALLOWED KEY          00223200
.ZG83I4            AIF   (K'&XLASTING LE 0).ZG83I5                      00223300
&ZCVAL             SETC '&ZCVAL XLASTING'       DISALLOWED KEY          00223400
.ZG83I5            AIF   (K'&XPINPATHS LE 0).ZG83I6                     00223500
&ZCVAL             SETC '&ZCVAL XPINPATHS'      DISALLOWED KEY          00223600
.ZG83I6            AIF   (K'&ZCVAL LE 0).ZG83J  KEY                     00223700
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00223800
&ZMS               SETC  '"NOPIN'                                       00223900
&ZMS               SETC  '&ZMS."'                                       00224000
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00224100
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00224200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00224300
.ZG83J             ANOP  ,                                              00224400
.*-------------------------------------------------------------------   00224500
.***AG.KMEKY15 VALUE, RQD INPUT, ME KEYS -END                           00224600
.ZG84ZY            ANOP ,            END MUTUALLY EXCLUSIVE KEYS        00224700
.*----------------------------------------------------------------***   00224800
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00224900
                   AIF   (N'&UCBPAREA LE 1).ZG86A  CK NUM               00225000
&ZMS               SETC  '"UCBPAREA='                                   00225100
&ZMS               SETC  '&ZMS.&UCBPAREA"'                              00225200
&ZMS               SETC  '&ZMS "UCBPAREA"'                              00225300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00225400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00225500
.ZG86A             ANOP  ,                                              00225600
.*-------------------------------------------------------------------   00225700
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00225800
&ZXUCBPAREA        SETC  'INPUT'     SET IN/OUTPUT                      00225900
&XUCBPAREA         SETC  'NONE'                                         00226000
                   AIF   (K'&UCBPAREA(1) LE 0).ZG86B  PARM              00226100
&XUCBPAREA         SETC  '&UCBPAREA(1)'         SET XVARIABLE           00226200
                   AIF   (N'&UCBPAREA GT 1).ZG86B  MULTI                00226300
&XUCBPAREA         SETC  '&UCBPAREA'            SET XVARIABLE           00226400
.ZG86B             ANOP  ,                                              00226500
.*-------------------------------------------------------------------   00226600
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00226700
                   AIF   (K'&ZXUCBPAREA LE 0).ZG86R  NOT I/O            00226800
         AIF   ('&XUCBPAREA' EQ 'NONE').ZG86R                           00226900
                   AIF   ('&XUCBPAREA'(1,1) NE '(').ZG86R               00227000
&ZCGPR             SETC  '&XUCBPAREA'(2,K'&XUCBPAREA-2)                 00227100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG86P                   00227200
                   AIF   (K'&ZCGPR GT 2).ZG86Q                          00227300
                   AIF   ('&ZCGPR' EQ '0').ZG86Q                        00227400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00227500
                   AIF   (T'&ZCGPR NE 'N').ZG86Q  INVALID REG NAME      00227600
.ZG86P             ANOP  ,                                              00227700
                   AIF   (T'&ZCGPR NE 'N').ZG86R  NON NUMERIC           00227800
                   AIF   ('&ZCGPR' LT '2').ZG86Q                        00227900
                   AIF   ('&ZCGPR' LE '12').ZG86R                       00228000
.ZG86Q             ANOP  ,                                              00228100
&ZMS               SETC  '"UCBPAREA='                                   00228200
&ZMS               SETC  '&ZMS.&UCBPAREA"'                              00228300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00228400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00228500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00228600
.ZG86R             ANOP  ,                                              00228700
.*----------------------------------------------------------------***   00228800
.***AG.KXVAR05 NAME, OPT INOUT, KEYS -XVARIABLE KEY                     00228900
                   AIF   (N'&IOCTOKEN LE 1).ZG89A  CK NUM               00229000
&ZMS               SETC  '"IOCTOKEN='                                   00229100
&ZMS               SETC  '&ZMS.&IOCTOKEN"'                              00229200
&ZMS               SETC  '&ZMS "IOCTOKEN"'                              00229300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00229400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00229500
.ZG89A             ANOP  ,                                              00229600
.*-------------------------------------------------------------------   00229700
.***AG.KXVAR13 NAME, OPT INOUT, KEYS -XVARIABLE                         00229800
&ZXIOCTOKEN        SETC  'INOUT'     SET IN/OUTPUT                      00229900
&XIOCTOKEN         SETC  'NONE'                                         00230000
                   AIF   (K'&IOCTOKEN(1) LE 0).ZG89B  PARM              00230100
&XIOCTOKEN         SETC  '&IOCTOKEN(1)'         SET XVARIABLE           00230200
                   AIF   (N'&IOCTOKEN GT 1).ZG89B  MULTI                00230300
&XIOCTOKEN         SETC  '&IOCTOKEN'            SET XVARIABLE           00230400
.ZG89B             ANOP  ,                                              00230500
.*-------------------------------------------------------------------   00230600
.***AG.KCK02 NAME, OPT INOUT, KEYS -GPR OUT OF RANGE                    00230700
                   AIF   (K'&ZXIOCTOKEN LE 0).ZG89R  NOT I/O            00230800
         AIF   ('&XIOCTOKEN' EQ 'NONE').ZG89R                           00230900
                   AIF   ('&XIOCTOKEN'(1,1) NE '(').ZG89R               00231000
&ZCGPR             SETC  '&XIOCTOKEN'(2,K'&XIOCTOKEN-2)                 00231100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG89P                   00231200
                   AIF   (K'&ZCGPR GT 2).ZG89Q                          00231300
                   AIF   ('&ZCGPR' EQ '0').ZG89Q                        00231400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00231500
                   AIF   (T'&ZCGPR NE 'N').ZG89Q  INVALID REG NAME      00231600
.ZG89P             ANOP  ,                                              00231700
                   AIF   (T'&ZCGPR NE 'N').ZG89R  NON NUMERIC           00231800
                   AIF   ('&ZCGPR' LT '2').ZG89Q                        00231900
                   AIF   ('&ZCGPR' LE '12').ZG89R                       00232000
.ZG89Q             ANOP  ,                                              00232100
&ZMS               SETC  '"IOCTOKEN='                                   00232200
&ZMS               SETC  '&ZMS.&IOCTOKEN"'                              00232300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00232400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00232500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00232600
.ZG89R             ANOP  ,                                              00232700
.*----------------------------------------------------------------***   00232800
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00232900
                   AIF   (N'&LINKAGE LE 1).ZG92A  CK NUM                00233000
&ZMS               SETC  '"LINKAGE='                                    00233100
&ZMS               SETC  '&ZMS.&LINKAGE"'                               00233200
&ZMS               SETC  '&ZMS "LINKAGE"'                               00233300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00233400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00233500
.ZG92A             ANOP  ,                                              00233600
.*-------------------------------------------------------------------   00233700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00233800
&XLINKAGE          SETC  ''          INITIALIZE XVARIABLE               00233900
.ZG93A   AIF   ('&LINKAGE(1)' NE 'SYSTEM').ZG94A                        00234000
&XLINKAGE          SETC  'SYSTEM'    SET KEYWORD                        00234100
.*-------------------------------------------------------------------   00234200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00234300
.ZG94A   AIF   ('&LINKAGE(1)' NE 'BRANCH').ZG95A                        00234400
&XLINKAGE          SETC  'BRANCH'    SET KEYWORD                        00234500
.*-------------------------------------------------------------------   00234600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00234700
.ZG95A             AIF   (K'&XLINKAGE GT 0).ZG95C  KEYWORD              00234800
                   AIF   (K'&LINKAGE(1) LE 0).ZG95B                     00234900
&ZMS               SETC  '"LINKAGE='                                    00235000
&ZMS               SETC  '&ZMS.&LINKAGE"'                               00235100
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00235200
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00235300
&ZMS               SETC  '&ZMS "SYSTEM"'                                00235400
&ZMS               SETC  '&ZMS OR "BRANCH".'                            00235500
                   MNOTE 8,' &ZMS '                                     00235600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00235700
.ZG95B             ANOP  ,                                              00235800
&XLINKAGE          SETC  'SYSTEM'    SET DEFAULT KEYWORD                00235900
.ZG95C             ANOP  ,                                              00236000
&ZXLINKAGE         SETC  'INPUT'     SET IN/OUTPUT                      00236100
.*----------------------------------------------------------------***   00236200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00236300
                   AIF   (N'&RETCODE LE 1).ZG97A  CK NUM                00236400
&ZMS               SETC  '"RETCODE='                                    00236500
&ZMS               SETC  '&ZMS.&RETCODE"'                               00236600
&ZMS               SETC  '&ZMS "RETCODE"'                               00236700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00236800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00236900
.ZG97A             ANOP  ,                                              00237000
.*-------------------------------------------------------------------   00237100
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00237200
                   AIF   (K'&RETCODE(1) LE 0).ZG97C  NO PARM            00237300
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         00237400
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00237500
                   AIF   (N'&RETCODE GT 1).ZG97C                        00237600
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00237700
.ZG97C             ANOP  ,                                              00237800
.*-------------------------------------------------------------------   00237900
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00238000
                   AIF   (K'&ZXRETCODE LE 0).ZG97R  NOT I/O             00238100
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG97R                00238200
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00238300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG97P                   00238400
                   AIF   (K'&ZCGPR GT 2).ZG97Q                          00238500
                   AIF   ('&ZCGPR' EQ '0').ZG97Q                        00238600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00238700
                   AIF   (T'&ZCGPR NE 'N').ZG97Q  INVALID REG NAME      00238800
.ZG97P             ANOP  ,                                              00238900
                   AIF   (T'&ZCGPR NE 'N').ZG97R  NON NUMERIC           00239000
                   AIF   ('&ZCGPR' EQ '15').ZG97R                       00239100
                   AIF   ('&ZCGPR' LT '2').ZG97Q                        00239200
                   AIF   ('&ZCGPR' LE '12').ZG97R                       00239300
.ZG97Q             ANOP  ,                                              00239400
&ZMS               SETC  '"RETCODE='                                    00239500
&ZMS               SETC  '&ZMS.&RETCODE"'                               00239600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00239700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'       00239800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00239900
.ZG97R             ANOP  ,                                              00240000
.*----------------------------------------------------------------***   00240100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00240200
                   AIF   (N'&RSNCODE LE 1).ZG100A  CK NUM               00240300
&ZMS               SETC  '"RSNCODE='                                    00240400
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00240500
&ZMS               SETC  '&ZMS "RSNCODE"'                               00240600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00240700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00240800
.ZG100A            ANOP  ,                                              00240900
.*-------------------------------------------------------------------   00241000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00241100
                   AIF   (K'&RSNCODE(1) LE 0).ZG100C  NO PARM           00241200
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         00241300
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00241400
                   AIF   (N'&RSNCODE GT 1).ZG100C                       00241500
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00241600
.ZG100C            ANOP  ,                                              00241700
.*-------------------------------------------------------------------   00241800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00241900
                   AIF   (K'&ZXRSNCODE LE 0).ZG100R  NOT I/O            00242000
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG100R               00242100
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00242200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG100P                  00242300
                   AIF   (K'&ZCGPR GT 2).ZG100Q                         00242400
                   AIF   ('&ZCGPR' EQ '0').ZG100R                       00242500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00242600
                   AIF   (T'&ZCGPR NE 'N').ZG100Q  INVALID REG NAME     00242700
.ZG100P            ANOP  ,                                              00242800
                   AIF   (T'&ZCGPR NE 'N').ZG100R  NON NUMERIC          00242900
                   AIF   ('&ZCGPR' EQ '0').ZG100R                       00243000
                   AIF   ('&ZCGPR' LT '2').ZG100Q                       00243100
                   AIF   ('&ZCGPR' LE '12').ZG100R                      00243200
.ZG100Q            ANOP  ,                                              00243300
&ZMS               SETC  '"RSNCODE='                                    00243400
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00243500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00243600
                   MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'        00243700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00243800
.ZG100R            ANOP  ,                                              00243900
.******************************************************************     00244000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00244100
.******************************************************************     00244200
                   ACTR  10000                                          00244300
.*-------------------------------------------------------------------   00244400
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00244500
&ZCVAL             SETC  ''          ERROR FIELD                        00244600
&ZAWRK             SETA  0           POSITIONAL COUNTER                 00244700
&ZASYSLNDX         SETA  0           NON-X KEY COUNTER                  00244800
.ZGLIST2           ANOP  ,                                              00244900
&ZASYSLNDX         SETA  &ZASYSLNDX+1           NEXT NON-X KEY          00245000
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 00245100
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          00245200
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00245300
                   AIF   (&ZAWRK LE 0).ZGLIST2                          00245400
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA            00245500
                   AGO   .ZGLIST2                                       00245600
.*                                                                      00245700
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  00245800
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00245900
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'                      00246000
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00246100
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00246200
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00246300
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00246400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00246500
.ZGLISTX           ANOP  ,                                              00246600
&ZASYSLNDX         SETA  0                                              00246700
.*-------------------------------------------------------------------   00246800
.***AG.MF04 MF=(SLE)                                                    00246900
.ZGMFX             ANOP  ,           END OF FULL SYNTAX CHECK           00247000
.*******************************************************************    00247100
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00247200
.*******************************************************************    00247300
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          00247400
.*******************************************************************    00247500
.***AE.01  START OF UCBLOOK MACRO CODE                                  00247600
.*******************************************************************    00247700
                   LCLC  &M0M0001                 NAME                  00247800
&M0M0001           SETC  '&XLABEL'                SET NAME              00247900
                   AIF   (K'&XLABEL NE 0).XLAB2                         00248000
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          00248100
.*                                                                      00248200
.XLAB2             ANOP  ,                                              00248300
                   AIF   ('&XMF' EQ 'L').XLAB3                          00248400
&M0M0001 DS    0H                             UCBLOOK-3                 00248500
.XLAB3             ANOP  ,                                              00248600
.*******************************************************************    00248700
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00248800
.*******************************************************************    00248900
              PUSH  PRINT                                               00249000
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     00249100
                   PRINT OFF         ++ PR01                            00249200
                   AGO   .ZPRNTXX                                       00249300
.ZPRINTX           PRINT ON                                             00249400
.ZPRNTXX           ANOP  ,                                              00249500
.********************************************************************   00249600
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00249700
.********************************************************************   00249800
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00249900
                      LCLA  &ZOPN1         INVOCATION INDEX             00250000
                      LCLC  &ZOPL(4095)    LABEL                        00250100
                      LCLC  &ZOPO(4095)    OPERATION                    00250200
                      LCLC  &ZOPV(4095)    VALUE                        00250300
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00250400
.*                                                                      00250500
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00250600
.******************************************************************     00250700
.***AL.L10 UCBLOOK FMT=LIST MF=S!L PARAMETERS                           00250800
.******************************************************************     00250900
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00251000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00251100
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00251200
&XMFATTR              SETC  '0D'                                        00251300
.*                                                                      00251400
&ZOPN                 SETA  &ZOPN+1                                     00251500
&ZOPL(&ZOPN)          SETC  ' '                                         00251600
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00251700
&ZOPO(&ZOPN)          SETC  'B'                                         00251800
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00251900
                      AGO   .ZALVL6B                                    00252000
.ZALVL6A              ANOP                                              00252100
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00252200
&ZOPV(&ZOPN)          SETC  '4,8'                                       00252300
&ZOPN                 SETA  &ZOPN+1                                     00252400
&ZOPL(&ZOPN)          SETC  ' '                                         00252500
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00252600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00252700
.ZALVL6B              ANOP                                              00252800
&ZOPD(&ZOPN)          SETC  '++ UCBLOOK ARG PARMS'                      00252900
.*                                                                      00253000
&ZOPN                 SETA  &ZOPN+1                                     00253100
&ZOPL(&ZOPN)          SETC  ' '                                         00253200
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00253300
&ZOPV(&ZOPN)          SETC  '1'                                         00253400
&ZOPD(&ZOPN)          SETC  ' '                                         00253500
.*                                                                      00253600
.ZLMFSL2              ANOP  ,                                           00253700
.*-------------------------------------------------------------------   00253800
.***AM.L00  UCBLOOK FMT=LIST name                                       00253900
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00254000
&ZOPN                 SETA &ZOPN+1                                      00254100
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00254200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00254300
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00254400
&ZOPD(&ZOPN)          SETC '++ UCBLOOK NAME'                            00254500
.ZLMFSL2M             ANOP  ,                                           00254600
.*-------------------------------------------------------------------   00254700
.***AM.L01  UCBLOOK FMT=LIST PARAMETERS                                 00254800
&ZOPN                 SETA &ZOPN+1                                      00254900
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00255000
&ZOPO(&ZOPN)          SETC 'DS'                                         00255100
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00255200
&ZOPD(&ZOPN)          SETC '++ UCBLOOK PARM LIST'                       00255300
.*-------------------------------------------------------------------   00255400
.***AM.L02 XVERSION XL1                                                 00255500
&ZOPN                 SETA &ZOPN+1                                      00255600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00255700
&ZOPO(&ZOPN)          SETC 'DS'                                         00255800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00255900
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00256000
.*-------------------------------------------------------------------   00256100
.***AM.L09  XSCHSET XL1                                                 00256200
&ZOPN                 SETA &ZOPN+1                                      00256300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSCHSET'                          00256400
&ZOPO(&ZOPN)          SETC 'DS'                                         00256500
&ZOPV(&ZOPN)          SETC 'XL1'                                        00256600
&ZOPD(&ZOPN)          SETC '++ &ZXSCHSET '                              00256700
.*-------------------------------------------------------------------   00256800
.***AM.L09  XDEVN XL2                                                   00256900
&ZOPN                 SETA &ZOPN+1                                      00257000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDEVN'                            00257100
&ZOPO(&ZOPN)          SETC 'DS'                                         00257200
&ZOPV(&ZOPN)          SETC 'XL2'                                        00257300
&ZOPD(&ZOPN)          SETC '++ &ZXDEVN '                                00257400
.*-------------------------------------------------------------------   00257500
.***AM.L09  XDEVNCHAR CL4                                               00257600
&ZOPN                 SETA &ZOPN+1                                      00257700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDEVNCHAR'                        00257800
&ZOPO(&ZOPN)          SETC 'DS'                                         00257900
&ZOPV(&ZOPN)          SETC 'CL4'                                        00258000
&ZOPD(&ZOPN)          SETC '++ &ZXDEVNCHAR '                            00258100
.*-------------------------------------------------------------------   00258200
.***AM.L09  XVOLSER CL6                                                 00258300
&ZOPN                 SETA &ZOPN+1                                      00258400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVOLSER'                          00258500
&ZOPO(&ZOPN)          SETC 'DS'                                         00258600
&ZOPV(&ZOPN)          SETC 'CL6'                                        00258700
&ZOPD(&ZOPN)          SETC '++ &ZXVOLSER '                              00258800
.*-------------------------------------------------------------------   00258900
.***AM.L05 XDEVCLASS XL1                                                00259000
&ZOPN                 SETA &ZOPN+1                                      00259100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDEVCLASS'                        00259200
&ZOPO(&ZOPN)          SETC 'DS'                                         00259300
&ZOPV(&ZOPN)          SETC 'XL1'                                        00259400
&ZOPD(&ZOPN)          SETC '++ &ZXDEVCLASS XDEVCLASS'                   00259500
.*                                                                      00259600
&ZOPN                 SETA  &ZOPN+1                                     00259700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDEVCLASS_DASDTAPE'              00259800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00259900
&ZOPV(&ZOPN)          SETC  '0'                                         00260000
&ZOPD(&ZOPN)          SETC  '++ XDEVCLASS.'                             00260100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DASDTAPE'                     00260200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00260300
.*                                                                      00260400
&ZOPN                 SETA  &ZOPN+1                                     00260500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDEVCLASS_TAPE'                  00260600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00260700
&ZOPV(&ZOPN)          SETC  '1'                                         00260800
&ZOPD(&ZOPN)          SETC  '++ XDEVCLASS.'                             00260900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).TAPE'                         00261000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00261100
.*                                                                      00261200
&ZOPN                 SETA  &ZOPN+1                                     00261300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDEVCLASS_DASD'                  00261400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00261500
&ZOPV(&ZOPN)          SETC  '2'                                         00261600
&ZOPD(&ZOPN)          SETC  '++ XDEVCLASS.'                             00261700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DASD'                         00261800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00261900
.*-------------------------------------------------------------------   00262000
.***AM.L03 XRESERVED2 BL.8                                              00262100
&ZOPN                 SETA &ZOPN+1                                      00262200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED2'                       00262300
&ZOPO(&ZOPN)          SETC 'DS'                                         00262400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00262500
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00262600
.*                                                                      00262700
&ZOPN                 SETA  &ZOPN+1                                     00262800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XNOTFIND_YES'                    00262900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00263000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00263100
&ZOPD(&ZOPN)          SETC  '++ XNOTFIND.'                              00263200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00263300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00263400
.*-------------------------------------------------------------------   00263500
.***AM.L09  XUCBPTR A                                                   00263600
&ZOPN                 SETA &ZOPN+1                                      00263700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBPTR'                          00263800
&ZOPO(&ZOPN)          SETC 'DS'                                         00263900
&ZOPV(&ZOPN)          SETC 'A'                                          00264000
&ZOPD(&ZOPN)          SETC '++ &ZXUCBPTR '                              00264100
.*-------------------------------------------------------------------   00264200
.***AM.L09  XCOMPID CL5                                                 00264300
&ZOPN                 SETA &ZOPN+1                                      00264400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCOMPID'                          00264500
&ZOPO(&ZOPN)          SETC 'DS'                                         00264600
&ZOPV(&ZOPN)          SETC 'CL5'                                        00264700
&ZOPD(&ZOPN)          SETC '++ &ZXCOMPID '                              00264800
.*-------------------------------------------------------------------   00264900
.***AM.L03 XMASK BL.8                                                   00265000
&ZOPN                 SETA &ZOPN+1                                      00265100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMASK'                            00265200
&ZOPO(&ZOPN)          SETC 'DS'                                         00265300
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00265400
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00265500
.*                                                                      00265600
&ZOPN                 SETA  &ZOPN+1                                     00265700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XNONBASE_YES'                    00265800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00265900
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00266000
&ZOPD(&ZOPN)          SETC  '++ XNONBASE.'                              00266100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00266200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00266300
.*                                                                      00266400
&ZOPN                 SETA  &ZOPN+1                                     00266500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDYNAMIC_NO'                     00266600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00266700
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00266800
&ZOPD(&ZOPN)          SETC  '++ XDYNAMIC.'                              00266900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NO'                           00267000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00267100
.*                                                                      00267200
&ZOPN                 SETA  &ZOPN+1                                     00267300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XRANGE_3DIGIT'                   00267400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00267500
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00267600
&ZOPD(&ZOPN)          SETC  '++ XRANGE.'                                00267700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).3DIGIT'                       00267800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00267900
.*                                                                      00268000
&ZOPN                 SETA  &ZOPN+1                                     00268100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XLOC_ANY'                        00268200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00268300
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00268400
&ZOPD(&ZOPN)          SETC  '++ XLOC.'                                  00268500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ANY'                          00268600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00268700
.*                                                                      00268800
&ZOPN                 SETA  &ZOPN+1                                     00268900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSPECIAL_YES'                    00269000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00269100
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00269200
&ZOPD(&ZOPN)          SETC  '++ XSPECIAL.'                              00269300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00269400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00269500
.*                                                                      00269600
&ZOPN                 SETA  &ZOPN+1                                     00269700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUNBOUND_ALIAS_YES'              00269800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00269900
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00270000
&ZOPD(&ZOPN)          SETC  '++ XUNBOUND_ALIAS.'                        00270100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00270200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00270300
.*-------------------------------------------------------------------   00270400
.***AM.L03 XFLAGS BL.8                                                  00270500
&ZOPN                 SETA &ZOPN+1                                      00270600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00270700
&ZOPO(&ZOPN)          SETC 'DS'                                         00270800
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00270900
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00271000
.*                                                                      00271100
&ZOPN                 SETA  &ZOPN+1                                     00271200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_DEVN'                    00271300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00271400
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00271500
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00271600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DEVN'                         00271700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00271800
.*                                                                      00271900
&ZOPN                 SETA  &ZOPN+1                                     00272000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_DEVNCHAR'                00272100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00272200
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00272300
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00272400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DEVNCHAR'                     00272500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00272600
.*                                                                      00272700
&ZOPN                 SETA  &ZOPN+1                                     00272800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_VOLSER'                  00272900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00273000
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00273100
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00273200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).VOLSER'                       00273300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00273400
.*                                                                      00273500
&ZOPN                 SETA  &ZOPN+1                                     00273600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_LASTING'                 00273700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00273800
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00273900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00274000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).LASTING'                      00274100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00274200
.*                                                                      00274300
&ZOPN                 SETA  &ZOPN+1                                     00274400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_COMPID'                  00274500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00274600
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00274700
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00274800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).COMPID'                       00274900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00275000
.*                                                                      00275100
&ZOPN                 SETA  &ZOPN+1                                     00275200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_HELP'                    00275300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00275400
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00275500
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00275600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).HELP'                         00275700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00275800
.*                                                                      00275900
&ZOPN                 SETA  &ZOPN+1                                     00276000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_PIN'                     00276100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00276200
&ZOPV(&ZOPN)          SETC  'B''00000010'''                             00276300
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00276400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PIN'                          00276500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00276600
.*                                                                      00276700
&ZOPN                 SETA  &ZOPN+1                                     00276800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_PINPATHS'                00276900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00277000
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00277100
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00277200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PINPATHS'                     00277300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00277400
.*-------------------------------------------------------------------   00277500
.***AM.L03 XFLAGS2 BL.8                                                 00277600
&ZOPN                 SETA &ZOPN+1                                      00277700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS2'                          00277800
&ZOPO(&ZOPN)          SETC 'DS'                                         00277900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00278000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00278100
.*                                                                      00278200
&ZOPN                 SETA  &ZOPN+1                                     00278300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_UCBCXPTR'                00278400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00278500
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00278600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00278700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UCBCXPTR'                     00278800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00278900
.*                                                                      00279000
&ZOPN                 SETA  &ZOPN+1                                     00279100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_UCBPXPTR'                00279200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00279300
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00279400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00279500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UCBPXPTR'                     00279600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00279700
.*                                                                      00279800
&ZOPN                 SETA  &ZOPN+1                                     00279900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_LDEVNCHAR'               00280000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00280100
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00280200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00280300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).LDEVNCHAR'                    00280400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00280500
.*                                                                      00280600
&ZOPN                 SETA  &ZOPN+1                                     00280700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_SCHSET'                  00280800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00280900
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00281000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00281100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SCHSET'                       00281200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00281300
.*-------------------------------------------------------------------   00281400
.***AM.L09 ADDR XTEXT A                                                 00281500
&ZOPN                 SETA &ZOPN+1                                      00281600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTEXT_ADDR'                       00281700
&ZOPO(&ZOPN)          SETC 'DS'                                         00281800
&ZOPV(&ZOPN)          SETC 'A'                                          00281900
&ZOPD(&ZOPN)          SETC '++ &ZXTEXT ADDR'                            00282000
.*-------------------------------------------------------------------   00282100
.***AM.L09 ALET XTEXT F                                                 00282200
&ZOPN                 SETA &ZOPN+1                                      00282300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTEXT_ALET'                       00282400
&ZOPO(&ZOPN)          SETC 'DS'                                         00282500
&ZOPV(&ZOPN)          SETC 'F'                                          00282600
&ZOPD(&ZOPN)          SETC '++ &ZXTEXT ALET'                            00282700
.*-------------------------------------------------------------------   00282800
.***AM.L09  XPTOKEN CL8                                                 00282900
&ZOPN                 SETA &ZOPN+1                                      00283000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPTOKEN'                          00283100
&ZOPO(&ZOPN)          SETC 'DS'                                         00283200
&ZOPV(&ZOPN)          SETC 'CL8'                                        00283300
&ZOPD(&ZOPN)          SETC '++ &ZXPTOKEN '                              00283400
.*-------------------------------------------------------------------   00283500
.***AM.L09  XHELP CL8                                                   00283600
&ZOPN                 SETA &ZOPN+1                                      00283700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XHELP'                            00283800
&ZOPO(&ZOPN)          SETC 'DS'                                         00283900
&ZOPV(&ZOPN)          SETC 'CL8'                                        00284000
&ZOPD(&ZOPN)          SETC '++ &ZXHELP '                                00284100
.*-------------------------------------------------------------------   00284200
.***AM.L09 ADDR XIOCTOKEN A                                             00284300
&ZOPN                 SETA &ZOPN+1                                      00284400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XIOCTOKEN_ADDR'                   00284500
&ZOPO(&ZOPN)          SETC 'DS'                                         00284600
&ZOPV(&ZOPN)          SETC 'A'                                          00284700
&ZOPD(&ZOPN)          SETC '++ &ZXIOCTOKEN ADDR'                        00284800
.*-------------------------------------------------------------------   00284900
.***AM.L09 ALET XIOCTOKEN F                                             00285000
&ZOPN                 SETA &ZOPN+1                                      00285100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XIOCTOKEN_ALET'                   00285200
&ZOPO(&ZOPN)          SETC 'DS'                                         00285300
&ZOPV(&ZOPN)          SETC 'F'                                          00285400
&ZOPD(&ZOPN)          SETC '++ &ZXIOCTOKEN ALET'                        00285500
.*-------------------------------------------------------------------   00285600
.***AM.L09 ADDR XUCBPAREA A                                             00285700
&ZOPN                 SETA &ZOPN+1                                      00285800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBPAREA_ADDR'                   00285900
&ZOPO(&ZOPN)          SETC 'DS'                                         00286000
&ZOPV(&ZOPN)          SETC 'A'                                          00286100
&ZOPD(&ZOPN)          SETC '++ &ZXUCBPAREA ADDR'                        00286200
.*-------------------------------------------------------------------   00286300
.***AM.L09 ALET XUCBPAREA F                                             00286400
&ZOPN                 SETA &ZOPN+1                                      00286500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBPAREA_ALET'                   00286600
&ZOPO(&ZOPN)          SETC 'DS'                                         00286700
&ZOPV(&ZOPN)          SETC 'F'                                          00286800
&ZOPD(&ZOPN)          SETC '++ &ZXUCBPAREA ALET'                        00286900
.*-------------------------------------------------------------------   00287000
.***AM.L09  XUCBCXPTR A                                                 00287100
&ZOPN                 SETA &ZOPN+1                                      00287200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBCXPTR'                        00287300
&ZOPO(&ZOPN)          SETC 'DS'                                         00287400
&ZOPV(&ZOPN)          SETC 'A'                                          00287500
&ZOPD(&ZOPN)          SETC '++ &ZXUCBCXPTR '                            00287600
.*-------------------------------------------------------------------   00287700
.***AM.L09  XUCBPXPTR A                                                 00287800
&ZOPN                 SETA &ZOPN+1                                      00287900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBPXPTR'                        00288000
&ZOPO(&ZOPN)          SETC 'DS'                                         00288100
&ZOPV(&ZOPN)          SETC 'A'                                          00288200
&ZOPD(&ZOPN)          SETC '++ &ZXUCBPXPTR '                            00288300
.*-------------------------------------------------------------------   00288400
.***AM.L09  XLDEVNCHAR CL5                                              00288500
&ZOPN                 SETA &ZOPN+1                                      00288600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XLDEVNCHAR'                       00288700
&ZOPO(&ZOPN)          SETC 'DS'                                         00288800
&ZOPV(&ZOPN)          SETC 'CL5'                                        00288900
&ZOPD(&ZOPN)          SETC '++ &ZXLDEVNCHAR '                           00289000
.*-------------------------------------------------------------------   00289100
.***AM.L09  XRESERVED1 CL3                                              00289200
&ZOPN                 SETA &ZOPN+1                                      00289300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       00289400
&ZOPO(&ZOPN)          SETC 'DS'                                         00289500
&ZOPV(&ZOPN)          SETC 'CL3'                                        00289600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00289700
.*-------------------------------------------------------------------   00289800
.***AM.L10 END OF UCBLOOK LIST PARAMETERS                               00289900
&ZOPN                 SETA &ZOPN+1                                      00290000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00290100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00290200
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00290300
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00290400
.*                                                                      00290500
&ZOPN                 SETA &ZOPN+1                                      00290600
&ZOPL(&ZOPN)          SETC ' '                                          00290700
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00290800
&ZOPV(&ZOPN)          SETC '1'                                          00290900
&ZOPD(&ZOPN)          SETC ' '                                          00291000
.*-------------------------------------------------------------------   00291100
.***AL.L12 UCBLOOK FMT=LIST MF=S!L PARAMETERS                           00291200
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00291300
.*                                                                      00291400
&ZOPN                 SETA  &ZOPN+1                                     00291500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00291600
&ZOPO(&ZOPN)          SETC  'DC'                                        00291700
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00291800
&ZOPD(&ZOPN)          SETC  '++ UCBLOOK ARG PARMS'                      00291900
.*                                                                      00292000
.ZLMFSLX              ANOP  ,                                           00292100
.*-------------------------------------------------------------------   00292200
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00292300
&ZPLLEN               SETA 84                                           00292400
.*                                                                      00292500
.******************************************************************     00292600
.***AI.L01 UCBLOOK FMT=LIST FILL IN PARAMETER AREA                      00292700
.******************************************************************     00292800
                      ACTR  10000                                       00292900
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00293000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00293100
&ZCVAL                SETC  'LAE'          XAX MODE                     00293200
.ZIMFXA               ANOP ,                                            00293300
.*                                                                      00293400
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00293500
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00293600
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00293700
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00293800
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00293900
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00294000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00294100
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00294200
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00294300
&ZOPN                 SETA  &ZOPN+1                                     00294400
&ZOPL(&ZOPN)          SETC  ' '                                         00294500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00294600
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00294700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00294800
                      AGO   .ZIMFNX                                     00294900
.*                                                                      00295000
.ZIMFN2               ANOP ,                                            00295100
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00295200
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00295300
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00295400
&ZOPN                 SETA  &ZOPN+1                                     00295500
&ZOPL(&ZOPN)          SETC  ' '                                         00295600
&ZOPO(&ZOPN)          SETC  'LAE'                                       00295700
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00295800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00295900
                      AGO   .ZIMFNX                                     00296000
.ZIMFNX1              ANOP ,                                            00296100
&ZOPN                 SETA  &ZOPN+1                                     00296200
&ZOPL(&ZOPN)          SETC  ' '                                         00296300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00296400
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00296500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00296600
.ZIMFNX               ANOP ,                                            00296700
.********************************************************************   00296800
.***AI.L02 UCBLOOK FMT=LIST INITIALIZE PARAMETER AREA                   00296900
.********************************************************************   00297000
.***AI.L03 MF=(SLE)                                                     00297100
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00297200
.*                                                                      00297300
&ZOPN                 SETA  &ZOPN+1                                     00297400
&ZOPL(&ZOPN)          SETC  ' '                                         00297500
&ZOPO(&ZOPN)          SETC  'XC'                                        00297600
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00297700
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00297800
.ZIMFLX               ANOP  ,                                           00297900
.*-------------------------------------------------------------------   00298000
.***AI.L04A XVERSION XL1                                                00298100
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00298200
&ZOPN                 SETA  &ZOPN+1                                     00298300
&ZOPL(&ZOPN)          SETC  ' '                                         00298400
&ZOPO(&ZOPN)          SETC  'MVI'                                       00298500
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00298600
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00298700
.ZIMFVW               ANOP  ,                                           00298800
.*-------------------------------------------------------------------   00298900
.***AI.L25  XSCHSET XL1                                                 00299000
                      AIF   ('&ZXSCHSET' EQ '').ZI2E                    00299100
                      AIF   ('&ZXSCHSET' EQ 'OUTPUT').ZI2E              00299200
&ZCGPR                SETC  '&XSCHSET'                                  00299300
         AIF   ('&XSCHSET' EQ '0').ZI2E                                 00299400
         AIF   ('&XSCHSET' EQ '0').ZI2E                                 00299500
.*                                                                      00299600
                      AIF   ('&XSCHSET'(1,1) NE '(').ZI2B               00299700
&ZCGPR   SETC  '0('.'&XSCHSET'(2,K'&XSCHSET-2).')'                      00299800
                      AGO   .ZI2D                                       00299900
.ZI2B                 ANOP  ,                                           00300000
.*                                                                      00300100
&ZC                   SETC  '&XSCHSET'(1,1)                             00300200
                      AIF   (T'&ZC NE 'N').ZI2D                         00300300
&ZC                   SETC  '&XSCHSET'                                  00300400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI2D                00300500
&ZCGPR                SETC  '=AL1(&XSCHSET)'                            00300600
.*                                                                      00300700
.ZI2D                 ANOP  ,                                           00300800
.*                                                                      00300900
&ZOPN                 SETA  &ZOPN+1                                     00301000
&ZOPL(&ZOPN)          SETC  ' '                                         00301100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00301200
&ZOPV(&ZOPN)          SETC  '1(1,1),&ZCGPR'                             00301300
&ZOPD(&ZOPN)          SETC  '++ &ZXSCHSET XSCHSET'                      00301400
.*                                                                      00301500
.ZI2E                 ANOP  ,                                           00301600
.*-------------------------------------------------------------------   00301700
.***AI.L25  XDEVN XL2                                                   00301800
                      AIF   ('&ZXDEVN' EQ '').ZI3E                      00301900
                      AIF   ('&ZXDEVN' EQ 'OUTPUT').ZI3E                00302000
&ZCGPR                SETC  '&XDEVN'                                    00302100
.*                                                                      00302200
                      AIF   ('&XDEVN'(1,1) NE '(').ZI3B                 00302300
&ZCGPR   SETC  '0('.'&XDEVN'(2,K'&XDEVN-2).')'                          00302400
                      AGO   .ZI3D                                       00302500
.ZI3B                 ANOP  ,                                           00302600
.*                                                                      00302700
&ZC                   SETC  '&XDEVN'(1,1)                               00302800
                      AIF   (T'&ZC NE 'N').ZI3D                         00302900
&ZC                   SETC  '&XDEVN'                                    00303000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI3D                00303100
&ZCGPR                SETC  '=AL2(&XDEVN)'                              00303200
.*                                                                      00303300
.ZI3D                 ANOP  ,                                           00303400
.*                                                                      00303500
&ZOPN                 SETA  &ZOPN+1                                     00303600
&ZOPL(&ZOPN)          SETC  ' '                                         00303700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00303800
&ZOPV(&ZOPN)          SETC  '2(2,1),&ZCGPR'                             00303900
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVN XDEVN'                          00304000
.*                                                                      00304100
.ZI3E                 ANOP  ,                                           00304200
.*-------------------------------------------------------------------   00304300
.***AI.L25  XDEVNCHAR CL4                                               00304400
                      AIF   ('&ZXDEVNCHAR' EQ '').ZI4E                  00304500
                      AIF   ('&ZXDEVNCHAR' EQ 'OUTPUT').ZI4E            00304600
&ZCGPR                SETC  '&XDEVNCHAR'                                00304700
.*                                                                      00304800
                      AIF   ('&XDEVNCHAR'(1,1) NE '(').ZI4B             00304900
&ZCGPR   SETC  '0('.'&XDEVNCHAR'(2,K'&XDEVNCHAR-2).')'                  00305000
.ZI4B                 ANOP  ,                                           00305100
.*                                                                      00305200
&ZOPN                 SETA  &ZOPN+1                                     00305300
&ZOPL(&ZOPN)          SETC  ' '                                         00305400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00305500
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00305600
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVNCHAR XDEVNCHAR'                  00305700
.*                                                                      00305800
.ZI4E                 ANOP  ,                                           00305900
.*-------------------------------------------------------------------   00306000
.***AI.L25  XVOLSER CL6                                                 00306100
                      AIF   ('&ZXVOLSER' EQ '').ZI5E                    00306200
                      AIF   ('&ZXVOLSER' EQ 'OUTPUT').ZI5E              00306300
&ZCGPR                SETC  '&XVOLSER'                                  00306400
.*                                                                      00306500
                      AIF   ('&XVOLSER'(1,1) NE '(').ZI5B               00306600
&ZCGPR   SETC  '0('.'&XVOLSER'(2,K'&XVOLSER-2).')'                      00306700
.ZI5B                 ANOP  ,                                           00306800
.*                                                                      00306900
&ZOPN                 SETA  &ZOPN+1                                     00307000
&ZOPL(&ZOPN)          SETC  ' '                                         00307100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00307200
&ZOPV(&ZOPN)          SETC  '8(6,1),&ZCGPR'                             00307300
&ZOPD(&ZOPN)          SETC  '++ &ZXVOLSER XVOLSER'                      00307400
.*                                                                      00307500
.ZI5E                 ANOP  ,                                           00307600
.*-------------------------------------------------------------------   00307700
.***AI.L07 XDEVCLASS AL1                                                00307800
&ZW                   SETC  ''                                          00307900
.*-------------------------------------------------------------------   00308000
.***AI.L15 XDEVCLASS "DASDTAPE" AL1                                     00308100
         AIF   ('&XDEVCLASS' NE 'DASDTAPE').ZI7A                        00308200
&ZW                   SETC  '0'                                         00308300
.ZI7A                 ANOP  ,                                           00308400
.*-------------------------------------------------------------------   00308500
.***AI.L15 XDEVCLASS "TAPE" AL1                                         00308600
         AIF   ('&XDEVCLASS' NE 'TAPE').ZI8A                            00308700
&ZW                   SETC  '1'                                         00308800
.ZI8A                 ANOP  ,                                           00308900
.*-------------------------------------------------------------------   00309000
.***AI.L15 XDEVCLASS "DASD" AL1                                         00309100
         AIF   ('&XDEVCLASS' NE 'DASD').ZI9A                            00309200
&ZW                   SETC  '2'                                         00309300
.ZI9A                 ANOP  ,                                           00309400
.*-------------------------------------------------------------------   00309500
.***AI.L17 XDEVCLASS AL1                                                00309600
                      AIF   ('&ZW' EQ '0').ZI9B                         00309700
                      AIF   ('&ZW' EQ '').ZI9B                          00309800
.*                                                                      00309900
&ZOPN                 SETA  &ZOPN+1                                     00310000
&ZOPL(&ZOPN)          SETC  ' '                                         00310100
&ZOPO(&ZOPN)          SETC  'MVI'                                       00310200
&ZOPV(&ZOPN)          SETC  '14(1),&ZW'                                 00310300
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVCLASS XDEVCLASS'                  00310400
.ZI9B                 ANOP  ,                                           00310500
.*-------------------------------------------------------------------   00310600
.***AI.L05 XRESERVED2 BL1                                               00310700
&ZW                   SETC  ''                                          00310800
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00310900
.*-------------------------------------------------------------------   00311000
.***AI.L08 XRESERVED2 "YES"                                             00311100
.***      BL1'1XXXXXXX'                                                 00311200
         AIF   ('&XNOTFIND' NE 'YES').ZI11A                             00311300
&ZW                   SETC  '&ZW.10000000'                              00311400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00311500
                      AGO   .ZI11C                                      00311600
.*                                                                      00311700
.ZI11A                ANOP  ,                                           00311800
&ZW                   SETC  '&ZW.00000000'                              00311900
.ZI11C                ANOP  ,                                           00312000
.*-------------------------------------------------------------------   00312100
.***AI.L11 XRESERVED2 BL1                                               00312200
                      AIF   ('&ZCLNG' NE 'YES').ZI11E  ALL ZERO BITS    00312300
&ZOPN                 SETA  &ZOPN+1                                     00312400
&ZOPL(&ZOPN)          SETC  ' '                                         00312500
&ZOPO(&ZOPN)          SETC  'OI'                                        00312600
&ZOPV(&ZOPN)          SETC  '15(1),B''&ZW'''                            00312700
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00312800
.ZI11E                ANOP  ,                                           00312900
.*-------------------------------------------------------------------   00313000
.***AI.L18  XCOMPID CL5                                                 00313100
         AIF   ('&XCOMPID' NE 'NONE').ZI13                              00313200
&ZXCOMPID             SETC  ''             RESET INPUT/OUTPUT           00313300
.ZI13                 ANOP  ,                                           00313400
.*-------------------------------------------------------------------   00313500
.***AI.L25  XCOMPID CL5                                                 00313600
                      AIF   ('&ZXCOMPID' EQ '').ZI13E                   00313700
                      AIF   ('&ZXCOMPID' EQ 'OUTPUT').ZI13E             00313800
&ZCGPR                SETC  '&XCOMPID'                                  00313900
.*                                                                      00314000
&ZOPN                 SETA  &ZOPN+1                                     00314100
&ZOPL(&ZOPN)          SETC  ' '                                         00314200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00314300
&ZOPV(&ZOPN)          SETC  '20(5,1),&ZCGPR'                            00314400
&ZOPD(&ZOPN)          SETC  '++ &ZXCOMPID XCOMPID'                      00314500
.*                                                                      00314600
.ZI13E                ANOP  ,                                           00314700
.*-------------------------------------------------------------------   00314800
.***AI.L05 XMASK BL1                                                    00314900
&ZW                   SETC  ''                                          00315000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00315100
.*-------------------------------------------------------------------   00315200
.***AI.L08 XMASK "YES"                                                  00315300
.***      BL1'1XXXXXXX'                                                 00315400
         AIF   ('&XNONBASE' NE 'YES').ZI15A                             00315500
&ZW                   SETC  '&ZW.1'                                     00315600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00315700
                      AGO   .ZI15C                                      00315800
.*                                                                      00315900
.ZI15A                ANOP  ,                                           00316000
&ZW                   SETC  '&ZW.0'                                     00316100
.ZI15C                ANOP  ,                                           00316200
.*-------------------------------------------------------------------   00316300
.***AI.L08 XMASK "NO"                                                   00316400
.***      BL1'X1XXXXXX'                                                 00316500
         AIF   ('&XDYNAMIC' NE 'NO').ZI16A                              00316600
&ZW                   SETC  '&ZW.1'                                     00316700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00316800
                      AGO   .ZI16C                                      00316900
.*                                                                      00317000
.ZI16A                ANOP  ,                                           00317100
&ZW                   SETC  '&ZW.0'                                     00317200
.ZI16C                ANOP  ,                                           00317300
.*-------------------------------------------------------------------   00317400
.***AI.L08 XMASK "3DIGIT"                                               00317500
.***      BL1'XX1XXXXX'                                                 00317600
         AIF   ('&XRANGE' NE '3DIGIT').ZI17A                            00317700
&ZW                   SETC  '&ZW.1'                                     00317800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00317900
                      AGO   .ZI17C                                      00318000
.*                                                                      00318100
.ZI17A                ANOP  ,                                           00318200
&ZW                   SETC  '&ZW.0'                                     00318300
.ZI17C                ANOP  ,                                           00318400
.*-------------------------------------------------------------------   00318500
.***AI.L08 XMASK "ANY"                                                  00318600
.***      BL1'XXX1XXXX'                                                 00318700
         AIF   ('&XLOC' NE 'ANY').ZI18A                                 00318800
&ZW                   SETC  '&ZW.1'                                     00318900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00319000
                      AGO   .ZI18C                                      00319100
.*                                                                      00319200
.ZI18A                ANOP  ,                                           00319300
&ZW                   SETC  '&ZW.0'                                     00319400
.ZI18C                ANOP  ,                                           00319500
.*-------------------------------------------------------------------   00319600
.***AI.L08 XMASK "YES"                                                  00319700
.***      BL1'XXXX1XXX'                                                 00319800
         AIF   ('&XSPECIAL' NE 'YES').ZI19A                             00319900
&ZW                   SETC  '&ZW.1'                                     00320000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00320100
                      AGO   .ZI19C                                      00320200
.*                                                                      00320300
.ZI19A                ANOP  ,                                           00320400
&ZW                   SETC  '&ZW.0'                                     00320500
.ZI19C                ANOP  ,                                           00320600
.*-------------------------------------------------------------------   00320700
.***AI.L08 XMASK "YES"                                                  00320800
.***      BL1'XXXXXXX1'                                                 00320900
         AIF   ('&XUNBOUND_ALIAS' NE 'YES').ZI20A                       00321000
&ZW                   SETC  '&ZW.001'                                   00321100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00321200
                      AGO   .ZI20C                                      00321300
.*                                                                      00321400
.ZI20A                ANOP  ,                                           00321500
&ZW                   SETC  '&ZW.000'                                   00321600
.ZI20C                ANOP  ,                                           00321700
.*-------------------------------------------------------------------   00321800
.***AI.L11 XMASK BL1                                                    00321900
                      AIF   ('&ZCLNG' NE 'YES').ZI20E  ALL ZERO BITS    00322000
&ZOPN                 SETA  &ZOPN+1                                     00322100
&ZOPL(&ZOPN)          SETC  ' '                                         00322200
&ZOPO(&ZOPN)          SETC  'OI'                                        00322300
&ZOPV(&ZOPN)          SETC  '25(1),B''&ZW'''                            00322400
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00322500
.ZI20E                ANOP  ,                                           00322600
.*-------------------------------------------------------------------   00322700
.***AI.L05 XFLAGS BL1                                                   00322800
&ZW                   SETC  ''                                          00322900
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00323000
.*-------------------------------------------------------------------   00323100
.***AI.L08 XFLAGS "DEVN"                                                00323200
.***      BL1'1XXXXXXX'                                                 00323300
         AIF   ('&DEVN' EQ '').ZI22A                                    00323400
&ZW                   SETC  '&ZW.1'                                     00323500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00323600
                      AGO   .ZI22C                                      00323700
.*                                                                      00323800
.ZI22A                ANOP  ,                                           00323900
&ZW                   SETC  '&ZW.0'                                     00324000
.ZI22C                ANOP  ,                                           00324100
.*-------------------------------------------------------------------   00324200
.***AI.L08 XFLAGS "DEVNCHAR"                                            00324300
.***      BL1'X1XXXXXX'                                                 00324400
         AIF   ('&DEVNCHAR' EQ '').ZI23A                                00324500
&ZW                   SETC  '&ZW.1'                                     00324600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00324700
                      AGO   .ZI23C                                      00324800
.*                                                                      00324900
.ZI23A                ANOP  ,                                           00325000
&ZW                   SETC  '&ZW.0'                                     00325100
.ZI23C                ANOP  ,                                           00325200
.*-------------------------------------------------------------------   00325300
.***AI.L08 XFLAGS "VOLSER"                                              00325400
.***      BL1'XX1XXXXX'                                                 00325500
         AIF   ('&VOLSER' EQ '').ZI24A                                  00325600
&ZW                   SETC  '&ZW.1'                                     00325700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00325800
                      AGO   .ZI24C                                      00325900
.*                                                                      00326000
.ZI24A                ANOP  ,                                           00326100
&ZW                   SETC  '&ZW.0'                                     00326200
.ZI24C                ANOP  ,                                           00326300
.*-------------------------------------------------------------------   00326400
.***AI.L08 XFLAGS "LASTING"                                             00326500
.***      BL1'XXX1XXXX'                                                 00326600
         AIF   ('&XLASTING' EQ '').ZI25A                                00326700
         AIF   ('&XLASTING' EQ 'NONE').ZI25A                            00326800
&ZW                   SETC  '&ZW.1'                                     00326900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00327000
                      AGO   .ZI25C                                      00327100
.*                                                                      00327200
.ZI25A                ANOP  ,                                           00327300
&ZW                   SETC  '&ZW.0'                                     00327400
.ZI25C                ANOP  ,                                           00327500
.*-------------------------------------------------------------------   00327600
.***AI.L08 XFLAGS "COMPID"                                              00327700
.***      BL1'XXXX1XXX'                                                 00327800
         AIF   ('&COMPID' EQ '').ZI26A                                  00327900
&ZW                   SETC  '&ZW.1'                                     00328000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00328100
                      AGO   .ZI26C                                      00328200
.*                                                                      00328300
.ZI26A                ANOP  ,                                           00328400
&ZW                   SETC  '&ZW.0'                                     00328500
.ZI26C                ANOP  ,                                           00328600
.*-------------------------------------------------------------------   00328700
.***AI.L08 XFLAGS "HELP"                                                00328800
.***      BL1'XXXXX1XX'                                                 00328900
         AIF   ('&HELP' EQ '').ZI27A                                    00329000
&ZW                   SETC  '&ZW.1'                                     00329100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00329200
                      AGO   .ZI27C                                      00329300
.*                                                                      00329400
.ZI27A                ANOP  ,                                           00329500
&ZW                   SETC  '&ZW.0'                                     00329600
.ZI27C                ANOP  ,                                           00329700
.*-------------------------------------------------------------------   00329800
.***AI.L08 XFLAGS "PIN"                                                 00329900
.***      BL1'XXXXXX1X'                                                 00330000
         AIF   ('&XPIN' EQ '').ZI28A                                    00330100
         AIF   ('&XPIN' EQ 'NONE').ZI28A                                00330200
&ZW                   SETC  '&ZW.1'                                     00330300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00330400
                      AGO   .ZI28C                                      00330500
.*                                                                      00330600
.ZI28A                ANOP  ,                                           00330700
&ZW                   SETC  '&ZW.0'                                     00330800
.ZI28C                ANOP  ,                                           00330900
.*-------------------------------------------------------------------   00331000
.***AI.L08 XFLAGS "PINPATHS"                                            00331100
.***      BL1'XXXXXXX1'                                                 00331200
         AIF   ('&XPINPATHS' EQ '').ZI29A                               00331300
         AIF   ('&XPINPATHS' EQ 'NONE').ZI29A                           00331400
&ZW                   SETC  '&ZW.1'                                     00331500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00331600
                      AGO   .ZI29C                                      00331700
.*                                                                      00331800
.ZI29A                ANOP  ,                                           00331900
&ZW                   SETC  '&ZW.0'                                     00332000
.ZI29C                ANOP  ,                                           00332100
.*-------------------------------------------------------------------   00332200
.***AI.L11 XFLAGS BL1                                                   00332300
                      AIF   ('&ZCLNG' NE 'YES').ZI29E  ALL ZERO BITS    00332400
&ZOPN                 SETA  &ZOPN+1                                     00332500
&ZOPL(&ZOPN)          SETC  ' '                                         00332600
&ZOPO(&ZOPN)          SETC  'OI'                                        00332700
&ZOPV(&ZOPN)          SETC  '26(1),B''&ZW'''                            00332800
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00332900
.ZI29E                ANOP  ,                                           00333000
.*-------------------------------------------------------------------   00333100
.***AI.L05 XFLAGS2 BL1                                                  00333200
&ZW                   SETC  ''                                          00333300
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00333400
.*-------------------------------------------------------------------   00333500
.***AI.L08 XFLAGS2 "UCBCXPTR"                                           00333600
.***      BL1'1XXXXXXX'                                                 00333700
         AIF   ('&UCBCXPTR' EQ '').ZI31A                                00333800
&ZW                   SETC  '&ZW.1'                                     00333900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00334000
                      AGO   .ZI31C                                      00334100
.*                                                                      00334200
.ZI31A                ANOP  ,                                           00334300
&ZW                   SETC  '&ZW.0'                                     00334400
.ZI31C                ANOP  ,                                           00334500
.*-------------------------------------------------------------------   00334600
.***AI.L08 XFLAGS2 "UCBPXPTR"                                           00334700
.***      BL1'X1XXXXXX'                                                 00334800
         AIF   ('&UCBPXPTR' EQ '').ZI32A                                00334900
&ZW                   SETC  '&ZW.1'                                     00335000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00335100
                      AGO   .ZI32C                                      00335200
.*                                                                      00335300
.ZI32A                ANOP  ,                                           00335400
&ZW                   SETC  '&ZW.0'                                     00335500
.ZI32C                ANOP  ,                                           00335600
.*-------------------------------------------------------------------   00335700
.***AI.L08 XFLAGS2 "LDEVNCHAR"                                          00335800
.***      BL1'XX1XXXXX'                                                 00335900
         AIF   ('&LDEVNCHAR' EQ '').ZI33A                               00336000
&ZW                   SETC  '&ZW.1'                                     00336100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00336200
                      AGO   .ZI33C                                      00336300
.*                                                                      00336400
.ZI33A                ANOP  ,                                           00336500
&ZW                   SETC  '&ZW.0'                                     00336600
.ZI33C                ANOP  ,                                           00336700
.*-------------------------------------------------------------------   00336800
.***AI.L08 XFLAGS2 "SCHSET"                                             00336900
.***      BL1'XXX1XXXX'                                                 00337000
         AIF   ('&SCHSET' EQ '').ZI34A                                  00337100
&ZW                   SETC  '&ZW.10000'                                 00337200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00337300
                      AGO   .ZI34C                                      00337400
.*                                                                      00337500
.ZI34A                ANOP  ,                                           00337600
&ZW                   SETC  '&ZW.00000'                                 00337700
.ZI34C                ANOP  ,                                           00337800
.*-------------------------------------------------------------------   00337900
.***AI.L11 XFLAGS2 BL1                                                  00338000
                      AIF   ('&ZCLNG' NE 'YES').ZI34E  ALL ZERO BITS    00338100
&ZOPN                 SETA  &ZOPN+1                                     00338200
&ZOPL(&ZOPN)          SETC  ' '                                         00338300
&ZOPO(&ZOPN)          SETC  'OI'                                        00338400
&ZOPV(&ZOPN)          SETC  '27(1),B''&ZW'''                            00338500
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00338600
.ZI34E                ANOP  ,                                           00338700
.*-------------------------------------------------------------------   00338800
.***AI.L19 ADDR XTEXT A                                                 00338900
                      AIF   ('&ZXTEXT' EQ '').ZI35H                     00339000
&ZCLNG                SETC  '&XTEXT'                                    00339100
&ZCGPR                SETC  '14'                                        00339200
.*                                                                      00339300
&ZOPN                 SETA  &ZOPN+1                                     00339400
&ZOPL(&ZOPN)          SETC  ' '                                         00339500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00339600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00339700
&ZOPD(&ZOPN)          SETC  '++ &ZXTEXT XTEXT'                          00339800
.*                                                                      00339900
&ZOPN                 SETA  &ZOPN+1                                     00340000
&ZOPL(&ZOPN)          SETC  ' '                                         00340100
&ZOPO(&ZOPN)          SETC  'ST'                                        00340200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,28(,1)'                             00340300
&ZOPD(&ZOPN)          SETC  '++ &ZXTEXT XTEXT'                          00340400
.*                                                                      00340500
.ZI35H                ANOP  ,                                           00340600
.*-------------------------------------------------------------------   00340700
.***AI.L24 ALET XTEXT F                                                 00340800
         AIF   ('&ZXTEXT' EQ '').ZI36G                                  00340900
         AIF   ('&SYSASCE' EQ 'P').ZI36G   SYSSTATE PRIMARY             00341000
&ZCLNG                SETC  '&XTEXT'                                    00341100
.*                                                                      00341200
&ZCGPR                SETC  '14'                                        00341300
.*                                                                      00341400
&ZOPN                 SETA  &ZOPN+1                                     00341500
&ZOPL(&ZOPN)          SETC  ' '                                         00341600
&ZOPO(&ZOPN)          SETC  'STAM'                                      00341700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,32(1)'                       00341800
&ZOPD(&ZOPN)          SETC  '++ &ZXTEXT XTEXT'                          00341900
.*                                                                      00342000
.ZI36G                ANOP  ,                                           00342100
.*-------------------------------------------------------------------   00342200
.***AI.L18  XHELP CL8                                                   00342300
         AIF   ('&XHELP' NE 'NONE').ZI38                                00342400
&ZXHELP               SETC  ''             RESET INPUT/OUTPUT           00342500
.ZI38                 ANOP  ,                                           00342600
.*-------------------------------------------------------------------   00342700
.***AI.L25  XHELP CL8                                                   00342800
                      AIF   ('&ZXHELP' EQ '').ZI38E                     00342900
                      AIF   ('&ZXHELP' EQ 'OUTPUT').ZI38E               00343000
&ZCGPR                SETC  '&XHELP'                                    00343100
.*                                                                      00343200
                      AIF   ('&XHELP'(1,1) NE '(').ZI38B                00343300
&ZCGPR   SETC  '0('.'&XHELP'(2,K'&XHELP-2).')'                          00343400
.ZI38B                ANOP  ,                                           00343500
.*                                                                      00343600
&ZOPN                 SETA  &ZOPN+1                                     00343700
&ZOPL(&ZOPN)          SETC  ' '                                         00343800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00343900
&ZOPV(&ZOPN)          SETC  '44(8,1),&ZCGPR'                            00344000
&ZOPD(&ZOPN)          SETC  '++ &ZXHELP XHELP'                          00344100
.*                                                                      00344200
.ZI38E                ANOP  ,                                           00344300
.*-------------------------------------------------------------------   00344400
.***AI.L18 ADDR XIOCTOKEN A                                             00344500
         AIF   ('&XIOCTOKEN' NE 'NONE').ZI39                            00344600
&ZXIOCTOKEN           SETC  ''             RESET INPUT/OUTPUT           00344700
.ZI39                 ANOP  ,                                           00344800
.*-------------------------------------------------------------------   00344900
.***AI.L19 ADDR XIOCTOKEN A                                             00345000
                      AIF   ('&ZXIOCTOKEN' EQ '').ZI39H                 00345100
&ZCLNG                SETC  '&XIOCTOKEN'                                00345200
&ZCGPR                SETC  '14'                                        00345300
         AIF   ('&XIOCTOKEN'(1,1) EQ '(').ZI39F  IN GPR                 00345400
.*                                                                      00345500
&ZOPN                 SETA  &ZOPN+1                                     00345600
&ZOPL(&ZOPN)          SETC  ' '                                         00345700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00345800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00345900
&ZOPD(&ZOPN)          SETC  '++ &ZXIOCTOKEN XIOCTOKEN'                  00346000
.*                                                                      00346100
                      AGO   .ZI39G                                      00346200
.*                                                                      00346300
.ZI39F                ANOP  ,                                           00346400
&ZCGPR   SETC  '&XIOCTOKEN'(2,K'&XIOCTOKEN-2)                           00346500
.*                                                                      00346600
.ZI39G                ANOP  ,                                           00346700
.*                                                                      00346800
&ZOPN                 SETA  &ZOPN+1                                     00346900
&ZOPL(&ZOPN)          SETC  ' '                                         00347000
&ZOPO(&ZOPN)          SETC  'ST'                                        00347100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,52(,1)'                             00347200
&ZOPD(&ZOPN)          SETC  '++ &ZXIOCTOKEN XIOCTOKEN'                  00347300
.*                                                                      00347400
.ZI39H                ANOP  ,                                           00347500
.*-------------------------------------------------------------------   00347600
.***AI.L18 ALET XIOCTOKEN F                                             00347700
         AIF   ('&XIOCTOKEN' NE 'NONE').ZI40                            00347800
&ZXIOCTOKEN           SETC  ''             RESET INPUT/OUTPUT           00347900
.ZI40                 ANOP  ,                                           00348000
.*-------------------------------------------------------------------   00348100
.***AI.L23 ALET XIOCTOKEN F                                             00348200
         AIF   ('&ZXIOCTOKEN' EQ '').ZI40G                              00348300
         AIF   ('&SYSASCE' EQ 'P').ZI40G   SYSSTATE PRIMARY             00348400
&ZCLNG                SETC  '&XIOCTOKEN'                                00348500
         AIF   ('&XIOCTOKEN'(1,1) EQ '(').ZI40E  IN AR                  00348600
.*                                                                      00348700
&ZCGPR                SETC  '14'                                        00348800
                      AGO   .ZI40F                                      00348900
.*                                                                      00349000
.ZI40E                ANOP  ,                                           00349100
&ZCGPR   SETC  '&XIOCTOKEN'(2,K'&XIOCTOKEN-2)                           00349200
.*                                                                      00349300
.ZI40F                ANOP  ,                                           00349400
.*                                                                      00349500
&ZOPN                 SETA  &ZOPN+1                                     00349600
&ZOPL(&ZOPN)          SETC  ' '                                         00349700
&ZOPO(&ZOPN)          SETC  'STAM'                                      00349800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,56(1)'                       00349900
&ZOPD(&ZOPN)          SETC  '++ &ZXIOCTOKEN XIOCTOKEN'                  00350000
.*                                                                      00350100
.ZI40G                ANOP  ,                                           00350200
.*-------------------------------------------------------------------   00350300
.***AI.L18 ADDR XUCBPAREA A                                             00350400
         AIF   ('&XUCBPAREA' NE 'NONE').ZI41                            00350500
&ZXUCBPAREA           SETC  ''             RESET INPUT/OUTPUT           00350600
.ZI41                 ANOP  ,                                           00350700
.*-------------------------------------------------------------------   00350800
.***AI.L19 ADDR XUCBPAREA A                                             00350900
                      AIF   ('&ZXUCBPAREA' EQ '').ZI41H                 00351000
&ZCLNG                SETC  '&XUCBPAREA'                                00351100
&ZCGPR                SETC  '14'                                        00351200
         AIF   ('&XUCBPAREA'(1,1) EQ '(').ZI41F  IN GPR                 00351300
.*                                                                      00351400
&ZOPN                 SETA  &ZOPN+1                                     00351500
&ZOPL(&ZOPN)          SETC  ' '                                         00351600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00351700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00351800
&ZOPD(&ZOPN)          SETC  '++ &ZXUCBPAREA XUCBPAREA'                  00351900
.*                                                                      00352000
                      AGO   .ZI41G                                      00352100
.*                                                                      00352200
.ZI41F                ANOP  ,                                           00352300
&ZCGPR   SETC  '&XUCBPAREA'(2,K'&XUCBPAREA-2)                           00352400
.*                                                                      00352500
.ZI41G                ANOP  ,                                           00352600
.*                                                                      00352700
&ZOPN                 SETA  &ZOPN+1                                     00352800
&ZOPL(&ZOPN)          SETC  ' '                                         00352900
&ZOPO(&ZOPN)          SETC  'ST'                                        00353000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,60(,1)'                             00353100
&ZOPD(&ZOPN)          SETC  '++ &ZXUCBPAREA XUCBPAREA'                  00353200
.*                                                                      00353300
.ZI41H                ANOP  ,                                           00353400
.*-------------------------------------------------------------------   00353500
.***AI.L18 ALET XUCBPAREA F                                             00353600
         AIF   ('&XUCBPAREA' NE 'NONE').ZI42                            00353700
&ZXUCBPAREA           SETC  ''             RESET INPUT/OUTPUT           00353800
.ZI42                 ANOP  ,                                           00353900
.*-------------------------------------------------------------------   00354000
.***AI.L23 ALET XUCBPAREA F                                             00354100
         AIF   ('&ZXUCBPAREA' EQ '').ZI42G                              00354200
         AIF   ('&SYSASCE' EQ 'P').ZI42G   SYSSTATE PRIMARY             00354300
&ZCLNG                SETC  '&XUCBPAREA'                                00354400
         AIF   ('&XUCBPAREA'(1,1) EQ '(').ZI42E  IN AR                  00354500
.*                                                                      00354600
&ZCGPR                SETC  '14'                                        00354700
                      AGO   .ZI42F                                      00354800
.*                                                                      00354900
.ZI42E                ANOP  ,                                           00355000
&ZCGPR   SETC  '&XUCBPAREA'(2,K'&XUCBPAREA-2)                           00355100
.*                                                                      00355200
.ZI42F                ANOP  ,                                           00355300
.*                                                                      00355400
&ZOPN                 SETA  &ZOPN+1                                     00355500
&ZOPL(&ZOPN)          SETC  ' '                                         00355600
&ZOPO(&ZOPN)          SETC  'STAM'                                      00355700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,64(1)'                       00355800
&ZOPD(&ZOPN)          SETC  '++ &ZXUCBPAREA XUCBPAREA'                  00355900
.*                                                                      00356000
.ZI42G                ANOP  ,                                           00356100
.*-------------------------------------------------------------------   00356200
.***AI.L25  XLDEVNCHAR CL5                                              00356300
                      AIF   ('&ZXLDEVNCHAR' EQ '').ZI45E                00356400
                      AIF   ('&ZXLDEVNCHAR' EQ 'OUTPUT').ZI45E          00356500
&ZCGPR                SETC  '&XLDEVNCHAR'                               00356600
.*                                                                      00356700
                      AIF   ('&XLDEVNCHAR'(1,1) NE '(').ZI45B           00356800
&ZCGPR   SETC  '0('.'&XLDEVNCHAR'(2,K'&XLDEVNCHAR-2).')'                00356900
.ZI45B                ANOP  ,                                           00357000
.*                                                                      00357100
&ZOPN                 SETA  &ZOPN+1                                     00357200
&ZOPL(&ZOPN)          SETC  ' '                                         00357300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00357400
&ZOPV(&ZOPN)          SETC  '76(5,1),&ZCGPR'                            00357500
&ZOPD(&ZOPN)          SETC  '++ &ZXLDEVNCHAR XLDEVNCHAR'                00357600
.*                                                                      00357700
.ZI45E                ANOP  ,                                           00357800
.*-------------------------------------------------------------------   00357900
&ZOPN1                SETA &ZOPN                                        00358000
.*******************************************************************    00358100
.***  PROCESS UCBLOOK OUTPUT PARAMETERS                                 00358200
.*******************************************************************    00358300
                      ACTR  10000                                       00358400
.*------------------------------------------------------------------    00358500
.***AO.L02 XUCBPTR A                                                    00358600
         AIF   ('&ZXUCBPTR' EQ 'OUTPUT').ZO12A  OUTPUT                  00358700
         AIF   ('&ZXUCBPTR' NE 'INOUT').ZO12C  INOUT                    00358800
.ZO12A    AIF   ('&XUCBPTR'(1,1) NE '(').ZO12B  ADDR IN GPR             00358900
&ZCGPR   SETC  '&XUCBPTR'(2,K'&XUCBPTR-2)                               00359000
&ZOPN                 SETA  &ZOPN+1                                     00359100
&ZOPL(&ZOPN)          SETC  ' '                                         00359200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00359300
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),16(1)'                         00359400
&ZOPD(&ZOPN)          SETC  '++ XUCBPTR A'                              00359500
                      AGO   .ZO12C                                      00359600
.*                                                                      00359700
.ZO12B                ANOP  ,                                           00359800
&ZAWRK   SETA  K'&XUCBPTR                                               00359900
         AIF   ('&XUCBPTR'(&ZAWRK,1) NE ')').ZO12G                      00360000
&ZN      SETA  2                                                        00360100
.ZO12H    ANOP                                                          00360200
         AIF   (&ZN GE &ZAWRK).ZO12G                                    00360300
         AIF   ('&XUCBPTR'(&ZN,1) NE '(').ZO12I                         00360400
&ZC      SETC  '&XUCBPTR'(1,&ZN).'4'.','                                00360500
&ZC      SETC  '&ZC'.'&XUCBPTR'(&ZN+1,&ZAWRK-&ZN).',16(1)'              00360600
         AGO   .ZO12J                                                   00360700
.ZO12I    ANOP                                                          00360800
&ZN      SETA  &ZN+1                                                    00360900
         AGO   .ZO12H                                                   00361000
.ZO12G    ANOP                                                          00361100
&ZC      SETC  '&XUCBPTR.(4),16(1)'                                     00361200
.ZO12J    ANOP                                                          00361300
&ZOPN                 SETA  &ZOPN+1                                     00361400
&ZOPL(&ZOPN)          SETC  ' '                                         00361500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00361600
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00361700
&ZOPD(&ZOPN)          SETC  '++ XUCBPTR A'                              00361800
.ZO12C                ANOP  ,                                           00361900
.*------------------------------------------------------------------    00362000
.***AO.L02 XPTOKEN CL8                                                  00362100
         AIF   ('&ZXPTOKEN' EQ 'OUTPUT').ZO37A  OUTPUT                  00362200
         AIF   ('&ZXPTOKEN' NE 'INOUT').ZO37C  INOUT                    00362300
.ZO37A    AIF   ('&XPTOKEN'(1,1) NE '(').ZO37B  ADDR IN GPR             00362400
&ZCGPR   SETC  '&XPTOKEN'(2,K'&XPTOKEN-2)                               00362500
&ZOPN                 SETA  &ZOPN+1                                     00362600
&ZOPL(&ZOPN)          SETC  ' '                                         00362700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00362800
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),36(1)'                         00362900
&ZOPD(&ZOPN)          SETC  '++ XPTOKEN CL8'                            00363000
                      AGO   .ZO37C                                      00363100
.*                                                                      00363200
.ZO37B                ANOP  ,                                           00363300
&ZAWRK   SETA  K'&XPTOKEN                                               00363400
         AIF   ('&XPTOKEN'(&ZAWRK,1) NE ')').ZO37G                      00363500
&ZN      SETA  2                                                        00363600
.ZO37H    ANOP                                                          00363700
         AIF   (&ZN GE &ZAWRK).ZO37G                                    00363800
         AIF   ('&XPTOKEN'(&ZN,1) NE '(').ZO37I                         00363900
&ZC      SETC  '&XPTOKEN'(1,&ZN).'8'.','                                00364000
&ZC      SETC  '&ZC'.'&XPTOKEN'(&ZN+1,&ZAWRK-&ZN).',36(1)'              00364100
         AGO   .ZO37J                                                   00364200
.ZO37I    ANOP                                                          00364300
&ZN      SETA  &ZN+1                                                    00364400
         AGO   .ZO37H                                                   00364500
.ZO37G    ANOP                                                          00364600
&ZC      SETC  '&XPTOKEN.(8),36(1)'                                     00364700
.ZO37J    ANOP                                                          00364800
&ZOPN                 SETA  &ZOPN+1                                     00364900
&ZOPL(&ZOPN)          SETC  ' '                                         00365000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00365100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00365200
&ZOPD(&ZOPN)          SETC  '++ XPTOKEN CL8'                            00365300
.ZO37C                ANOP  ,                                           00365400
.*------------------------------------------------------------------    00365500
.***AO.L02 XUCBCXPTR A                                                  00365600
         AIF   ('&ZXUCBCXPTR' EQ 'OUTPUT').ZO43A  OUTPUT                00365700
         AIF   ('&ZXUCBCXPTR' NE 'INOUT').ZO43C  INOUT                  00365800
.ZO43A    AIF   ('&XUCBCXPTR'(1,1) NE '(').ZO43B  ADDR IN GPR           00365900
&ZCGPR   SETC  '&XUCBCXPTR'(2,K'&XUCBCXPTR-2)                           00366000
&ZOPN                 SETA  &ZOPN+1                                     00366100
&ZOPL(&ZOPN)          SETC  ' '                                         00366200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00366300
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),68(1)'                         00366400
&ZOPD(&ZOPN)          SETC  '++ XUCBCXPTR A'                            00366500
                      AGO   .ZO43C                                      00366600
.*                                                                      00366700
.ZO43B                ANOP  ,                                           00366800
&ZAWRK   SETA  K'&XUCBCXPTR                                             00366900
         AIF   ('&XUCBCXPTR'(&ZAWRK,1) NE ')').ZO43G                    00367000
&ZN      SETA  2                                                        00367100
.ZO43H    ANOP                                                          00367200
         AIF   (&ZN GE &ZAWRK).ZO43G                                    00367300
         AIF   ('&XUCBCXPTR'(&ZN,1) NE '(').ZO43I                       00367400
&ZC      SETC  '&XUCBCXPTR'(1,&ZN).'4'.','                              00367500
&ZC      SETC  '&ZC'.'&XUCBCXPTR'(&ZN+1,&ZAWRK-&ZN).',68(1)'            00367600
         AGO   .ZO43J                                                   00367700
.ZO43I    ANOP                                                          00367800
&ZN      SETA  &ZN+1                                                    00367900
         AGO   .ZO43H                                                   00368000
.ZO43G    ANOP                                                          00368100
&ZC      SETC  '&XUCBCXPTR.(4),68(1)'                                   00368200
.ZO43J    ANOP                                                          00368300
&ZOPN                 SETA  &ZOPN+1                                     00368400
&ZOPL(&ZOPN)          SETC  ' '                                         00368500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00368600
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00368700
&ZOPD(&ZOPN)          SETC  '++ XUCBCXPTR A'                            00368800
.ZO43C                ANOP  ,                                           00368900
.*------------------------------------------------------------------    00369000
.***AO.L02 XUCBPXPTR A                                                  00369100
         AIF   ('&ZXUCBPXPTR' EQ 'OUTPUT').ZO44A  OUTPUT                00369200
         AIF   ('&ZXUCBPXPTR' NE 'INOUT').ZO44C  INOUT                  00369300
.ZO44A    AIF   ('&XUCBPXPTR'(1,1) NE '(').ZO44B  ADDR IN GPR           00369400
&ZCGPR   SETC  '&XUCBPXPTR'(2,K'&XUCBPXPTR-2)                           00369500
&ZOPN                 SETA  &ZOPN+1                                     00369600
&ZOPL(&ZOPN)          SETC  ' '                                         00369700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00369800
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),72(1)'                         00369900
&ZOPD(&ZOPN)          SETC  '++ XUCBPXPTR A'                            00370000
                      AGO   .ZO44C                                      00370100
.*                                                                      00370200
.ZO44B                ANOP  ,                                           00370300
&ZAWRK   SETA  K'&XUCBPXPTR                                             00370400
         AIF   ('&XUCBPXPTR'(&ZAWRK,1) NE ')').ZO44G                    00370500
&ZN      SETA  2                                                        00370600
.ZO44H    ANOP                                                          00370700
         AIF   (&ZN GE &ZAWRK).ZO44G                                    00370800
         AIF   ('&XUCBPXPTR'(&ZN,1) NE '(').ZO44I                       00370900
&ZC      SETC  '&XUCBPXPTR'(1,&ZN).'4'.','                              00371000
&ZC      SETC  '&ZC'.'&XUCBPXPTR'(&ZN+1,&ZAWRK-&ZN).',72(1)'            00371100
         AGO   .ZO44J                                                   00371200
.ZO44I    ANOP                                                          00371300
&ZN      SETA  &ZN+1                                                    00371400
         AGO   .ZO44H                                                   00371500
.ZO44G    ANOP                                                          00371600
&ZC      SETC  '&XUCBPXPTR.(4),72(1)'                                   00371700
.ZO44J    ANOP                                                          00371800
&ZOPN                 SETA  &ZOPN+1                                     00371900
&ZOPL(&ZOPN)          SETC  ' '                                         00372000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00372100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00372200
&ZOPD(&ZOPN)          SETC  '++ XUCBPXPTR A'                            00372300
.ZO44C                ANOP  ,                                           00372400
.*******************************************************************    00372500
.***AO.X02  RETURN CODE PROCESSING                                      00372600
.*******************************************************************    00372700
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00372800
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00372900
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00373000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00373100
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00373200
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00373300
&ZOPN                 SETA  &ZOPN+1                                     00373400
&ZOPL(&ZOPN)          SETC  ' '                                         00373500
&ZOPO(&ZOPN)          SETC  'ST'                                        00373600
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00373700
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00373800
                      AGO   .ZMRETX                                     00373900
.*                                                                      00374000
.ZMRET2               ANOP  ,                                           00374100
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00374200
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00374300
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00374400
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00374500
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00374600
&ZOPN                 SETA  &ZOPN+1                                     00374700
&ZOPL(&ZOPN)          SETC  ' '                                         00374800
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00374900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00375000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00375100
.ZMRETX               ANOP  ,                                           00375200
.*******************************************************************    00375300
.***AO.X03  REASON CODE PROCESSING                                      00375400
.*******************************************************************    00375500
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00375600
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00375700
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00375800
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00375900
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00376000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00376100
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00376200
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00376300
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00376400
&ZOPN                 SETA  &ZOPN+1                                     00376500
&ZOPL(&ZOPN)          SETC  ' '                                         00376600
&ZOPO(&ZOPN)          SETC  'ST'                                        00376700
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00376800
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00376900
                      AGO   .ZMRSNX                                     00377000
.*                                                                      00377100
.ZMRSN2               ANOP  ,                                           00377200
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00377300
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00377400
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00377500
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00377600
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00377700
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00377800
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00377900
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00378000
&ZOPN                 SETA  &ZOPN+1                                     00378100
&ZOPL(&ZOPN)          SETC  ' '                                         00378200
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00378300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00378400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00378500
.ZMRSNX               ANOP  ,                                           00378600
.*******************************************************************    00378700
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00378800
.*******************************************************************    00378900
.ZMFLX                ANOP  ,              MF=L PROCESSING              00379000
.*******************************************************************    00379100
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00379200
.*******************************************************************    00379300
                      ACTR  10000                                       00379400
.*                                                                      00379500
                      LCLA  &ZLC           COLUMN POSITION              00379600
                      LCLA  &ZOPX          LIST TABLE INDEX             00379700
                      LCLC  &ZLL           LABEL                        00379800
                      LCLC  &ZLOP          OPERATION                    00379900
                      LCLC  &ZLV           VALUE                        00380000
                      LCLC  &ZLD           DESCRIPTION                  00380100
.*                                                                      00380200
&ZOPX                 SETA  1                                           00380300
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00380400
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00380500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00380600
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00380700
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00380800
                      AIF   (K'&ZLD LE 0).ZL5                           00380900
&ZLC                  SETA  35             COMMENT COLUMN               00381000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00381100
&ZLC                  SETA  33             COMMMENT COLUMN              00381200
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00381300
&ZLV                  SETC  '&ZLV'.' '                                  00381400
                      AGO   .ZL3                                        00381500
.*                                                                      00381600
.ZL4                  ANOP  ,                                           00381700
&ZLV                  SETC  '&ZLV'.' '                                  00381800
.ZL5                  ANOP  ,                                           00381900
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00382000
.*                                                                      00382100
&ZLL     &ZLOP &ZLV                                                     00382200
.*                                                                      00382300
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00382400
                      AGO   .ZL2           CONTINUE LOOPING             00382500
.*                                                                      00382600
.ZLX                  ANOP  ,                                           00382700
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00382800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00382900
.*-----------BAL invocation code-------------                           00383000
         LA    0,1                ++ SET UCBLOOK FUNCTION CODE          00383100
         AIF    ('&XLINKAGE' NE 'BRANCH').LNKPC1                        00383200
.*********************************************************************  00383300
.*                                                                   *  00383400
.*  Get addressability to CVT                                        *  00383500
.*                                                                   *  00383600
.*********************************************************************  00383700
         L     15,16(0,0)                                               00383800
.*********************************************************************  00383900
.*                                                                   *  00384000
.*  Get addressability to IOCOM                                      *  00384100
.*                                                                   *  00384200
.*********************************************************************  00384300
         L     15,124(15,0)                                             00384400
.*********************************************************************  00384500
.*                                                                   *  00384600
.*  Get addressability to IOVT                                       *  00384700
.*                                                                   *  00384800
.*********************************************************************  00384900
         L     15,208(15,0)                                             00385000
         L     15,12(15,0)        ++ SET ADDR OF UCB SERVICES           00385100
         BALR  14,15              ++ BRANCH TO UCB SERVICES             00385200
         AGO   .DONE1                                                   00385300
.LNKPC1  ANOP                                                           00385400
         L     14,16(0,0)         ++ GET CVT ADDRESS                    00385500
         L     14,772(14,0)       ++ GET SFT ADDRESS                    00385600
.*********************************************************************  00385700
.*                                                                   *  00385800
.*  Get LX/EX for UCB Services                                       *  00385900
.*                                                                   *  00386000
.*  Note: LX/EX is calculated by multiplying the PC number (78)      *  00386100
.*        times the length of a PC/AUTH table entry (4) and          *  00386200
.*        then subtracting 4.                                        *  00386300
.*                                                                   *  00386400
.*********************************************************************  00386500
         L     14,308(14,0)       ++ GET LX/EX FOR UCB SERVICES         00386600
         PC    0(14)              ++ PC TO UCB SERVICES                 00386700
.DONE1   ANOP                                                           00386800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00386900
.ZLINKX               ANOP  ,                                           00387000
.*******************************************************************    00387100
.***AP.X01  FORMAT GENERATED CODE                                       00387200
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00387300
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00387400
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00387500
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00387600
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00387700
                      AIF   (K'&ZLD LE 0).ZL51                          00387800
&ZLC                  SETA  35             COMMENT COLUMN               00387900
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00388000
&ZLC                  SETA  33             COMMENT COLUMN               00388100
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00388200
&ZLV                  SETC  '&ZLV'.' '                                  00388300
                      AGO   .ZL31                                       00388400
.*                                                                      00388500
.ZL41                 ANOP  ,                                           00388600
&ZLV                  SETC  '&ZLV'.' '                                  00388700
.ZL51                 ANOP  ,                                           00388800
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00388900
.*                                                                      00389000
&ZLL     &ZLOP &ZLV                                                     00389100
.*                                                                      00389200
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00389300
                      AGO   .ZL21          CONTINUE LOOPING             00389400
.*                                                                      00389500
.ZLX1                 ANOP  ,                                           00389600
.*******************************************************************    00389700
.***AP.X02  END OF UCBLOOK MACRO                                        00389800
&ZUCBLOOK             SETC  'YES'          SET UCBLOOK USED             00389900
         POP   PRINT                                                    00390000
*                                            UCBLOOK-3                  00390100
         SPACE 1                                                        00390200
.ZLX2                 ANOP  ,                                           00390300
         MEND                                                           00390400
**********************************************************************/ 00390500
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00390600
*%UCBLOOK: MACRO KEYS(DEVN,SCHSET,DEVNCHAR,LDEVNCHAR,VOLSER,DEVCLASS,   00390700
*                 UCBPTR,UCBCXPTR,UCBPXPTR,LOC,DYNAMIC,RANGE,NONBASE,   00390800
*                 UNBOUND_ALIAS,SPECIAL,NOTFIND,PIN,TEXT,PTOKEN,        00390900
*                 COMPID,HELP,LASTING,PINPATHS,NOPIN,UCBPAREA,          00391000
*                 IOCTOKEN,LINKAGE,RETCODE,RSNCODE,PLISTVER,MF);        00391100
*  ANS('?'!!MACLABEL!!' '!!'UCBLOOKP '!!MACLIST!!                       00391200
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00391300
*%END UCBLOOK;                                                          00391400

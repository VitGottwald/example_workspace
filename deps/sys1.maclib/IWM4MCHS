*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWM4MCHS                              -05/20/14-<3> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Change State of Work Request                  * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2004, 2013                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7790                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The purpose of this service is to reflect in a monitoring      * 00002100
*      environment what the current state of a work request is with   * 00002200
*      respect to delays.                                             * 00002300
*                                                                     * 00002400
*      A work unit started by IWM4MSTR is blocked and unblocked       * 00002500
*      automatically. WAITING states, that allow the specification of * 00002600
*      the ASYNC keyword, block the work unit. All other states       * 00002700
*      unblock the work unit.                                         * 00002800
*                                                                     * 00002900
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00003000
*                                                                     * 00003100
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003200
*                                                                     * 00003300
*01* ENVIRONMENT:                                                     * 00003400
*                                                                     * 00003500
*                                                                     * 00003600
*      Dispatchable unit mode: Task or SRB mode.                      * 00003700
*                                                                     * 00003800
*      Minimum authorization: Problem or Supervisor state.  PSW key   * 00003900
*                        must either be 0 or match the value supplied * 00004000
*                        on IWM4MCRE.                                 * 00004100
*                                                                     * 00004200
*      AMODE:            31- or 64-bit.  If in 64-Bit addressing      * 00004300
*                        mode, code SYSSTATE AMODE64=YES before       * 00004400
*                        invoking this macro.                         * 00004500
*                                                                     * 00004600
*      ASC mode:         Primary.                                     * 00004700
*                                                                     * 00004800
*      Interrupt status: Enabled for I/O and external interrupts.     * 00004900
*                                                                     * 00005000
*      Locks:            Suspend locks are allowed.                   * 00005100
*                                                                     * 00005200
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00005300
*                                                                     * 00005400
*      Control parameters: Control parameters must be in the primary  * 00005500
*                        address space.                               * 00005600
*                                                                     * 00005700
*                                                                     * 00005800
*                                                                     * 00005900
*01* PROGRAMMING REQUIREMENTS:                                        * 00006000
*                                                                     * 00006100
*                                                                     * 00006200
*    1.  The macro IWMYCON must be included to use this macro.        * 00006300
*                                                                     * 00006400
*    2.  The macro IWMPB must be in the library concatenation, since  * 00006500
*        it is included by IWMYCON.                                   * 00006600
*                                                                     * 00006700
*    3.  Note that the high order halfword of bits 0-31 of register   * 00006800
*        0, and the reason code variable when specified, may be       * 00006900
*        non-zero and represents diagnostic data which is NOT part of * 00007000
*        the external interface.  The high order halfword should thus * 00007100
*        be excluded from comparison with the reason code values      * 00007200
*        described above.  The constant, IWMRSNCODE_MASK_CONST        * 00007300
*        defined in IWMYCON, may be used for this purpose.            * 00007400
*                                                                     * 00007500
*                                                                     * 00007600
*                                                                     * 00007700
*01* RESTRICTIONS:                                                    * 00007800
*                                                                     * 00007900
*                                                                     * 00008000
*    1.  This macro may not be used prior to the completion of WLM    * 00008100
*        address space initialization                                 * 00008200
*                                                                     * 00008300
*    2.  Caller is responsible for error recovery                     * 00008400
*                                                                     * 00008500
*    3.  Only limited checking is done against the input monitoring   * 00008600
*        token.                                                       * 00008700
*                                                                     * 00008800
*    4.  If the key specified on IWM4MCRE was a user key (8-F), then  * 00008900
*        the primary addressability must exist to the performance     * 00009000
*        block IWM4MCRE obtained.  This condition is satisfied by     * 00009100
*        ensuring that current primary matches primary at the time    * 00009200
*        that IWM4MCRE was invoked.  If this service is invoked in a  * 00009300
*        subspace, the condition may be satisfied by ensuring that    * 00009400
*        the performance block is shared with the base space.         * 00009500
*                                                                     * 00009600
*    5.  The caller must serialize to prevent any delay monitoring    * 00009700
*        services from being invoked concurrently for the environment * 00009800
*        represented by the monitoring token.                         * 00009900
*                                                                     * 00010000
*    6.  This macro may only be used on z/OS R2 or higher levels for  * 00010100
*        the following state/resources                                * 00010200
*                                                                     * 00010300
*                                                                     * 00010400
*        o   STATE(ACTIVE_APPL)                                       * 00010500
*                                                                     * 00010600
*        o   RESOURCE(SSL_THREAD)                                     * 00010700
*                                                                     * 00010800
*        o   RESOURCE(REG_THREAD)                                     * 00010900
*                                                                     * 00011000
*        o   RESOURCE(REG_TO_WRKTB)                                   * 00011100
*                                                                     * 00011200
*        o   RESOURCE(TYPE1)                                          * 00011300
*                                                                     * 00011400
*        o   RESOURCE(TYPE2)                                          * 00011500
*                                                                     * 00011600
*        o   RESOURCE(TYPE3)                                          * 00011700
*                                                                     * 00011800
*        o   RESOURCE(TYPE4)                                          * 00011900
*                                                                     * 00012000
*        o   RESOURCE(TYPE5)                                          * 00012100
*                                                                     * 00012200
*                                                                     * 00012300
*                                                                     * 00012400
*    7.  This macro may only be used on z/OS R8 or higher levels for  * 00012500
*        the following resources                                      * 00012600
*                                                                     * 00012700
*                                                                     * 00012800
*        o   RESOURCE(BUFFER_POOL_IO)                                 * 00012900
*                                                                     * 00013000
*                                                                     * 00013100
*                                                                     * 00013200
*    8.  This macro may only be used on z/OS R8 or higher levels for  * 00013300
*        RESTKN keyword.                                              * 00013400
*                                                                     * 00013500
*    9.  This macro may only be used on z/OS R10 or higher levels for * 00013600
*        the following state/resources                                * 00013700
*                                                                     * 00013800
*                                                                     * 00013900
*        o   RESOURCE(TYPE6)                                          * 00014000
*                                                                     * 00014100
*        o   RESOURCE(TYPE7)                                          * 00014200
*                                                                     * 00014300
*        o   RESOURCE(TYPE8)                                          * 00014400
*                                                                     * 00014500
*        o   RESOURCE(TYPE9)                                          * 00014600
*                                                                     * 00014700
*        o   RESOURCE(TYPE10)                                         * 00014800
*                                                                     * 00014900
*        o   RESOURCE(TYPE11)                                         * 00015000
*                                                                     * 00015100
*        o   RESOURCE(TYPE12)                                         * 00015200
*                                                                     * 00015300
*        o   RESOURCE(TYPE13)                                         * 00015400
*                                                                     * 00015500
*        o   RESOURCE(TYPE14)                                         * 00015600
*                                                                     * 00015700
*        o   RESOURCE(TYPE15)                                         * 00015800
*                                                                     * 00015900
*                                                                     * 00016000
*                                                                     * 00016100
*    10. This macro may only be used on z/OS V2R1 or higher levels    * 00016200
*        for the MONTKN64 keyword.                                    * 00016300
*                                                                     * 00016400
*                                                                     * 00016500
*                                                                     * 00016600
*                                                                     * 00016700
*01* INPUT REGISTER INFORMATION:                                      * 00016800
*                                                                     * 00016900
*    Before issuing the IWM4MCHS macro, the caller does not have to   * 00017000
*    place any information into any register unless using it in       * 00017100
*    register notation for a particular parameter, or using it as a   * 00017200
*    base register.                                                   * 00017300
*                                                                     * 00017400
*01* OUTPUT REGISTER INFORMATION:                                     * 00017500
*                                                                     * 00017600
*    When control returns to the caller, the GPRs contain:            * 00017700
*                                                                     * 00017800
*                                                                     * 00017900
*    REGISTER  CONTENTS                                               * 00018000
*                                                                     * 00018100
*    0         Reason code if GR15 return code is non-zero. The       * 00018200
*              reason code is stored in bits 0-31                     * 00018300
*                                                                     * 00018400
*    1         Used as work registers by the system                   * 00018500
*                                                                     * 00018600
*    2-13      Unchanged                                              * 00018700
*                                                                     * 00018800
*    14        Used as work registers by the system                   * 00018900
*                                                                     * 00019000
*    15        Return code stored in bits 0-31                        * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*                                                                     * 00019400
*    When control returns to the caller, the ARs contain:             * 00019500
*                                                                     * 00019600
*                                                                     * 00019700
*    REGISTER  CONTENTS                                               * 00019800
*                                                                     * 00019900
*    0-1       Used as work registers by the system                   * 00020000
*                                                                     * 00020100
*    2-13      Unchanged                                              * 00020200
*                                                                     * 00020300
*    14-15     Used as work registers by the system                   * 00020400
*                                                                     * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*    Some callers depend on register contents remaining the same      * 00020800
*    before and after issuing a service.  If the system changes the   * 00020900
*    contents of registers on which the caller depends, the caller    * 00021000
*    must save them before issuing the service, and restore them      * 00021100
*    after the system returns control.                                * 00021200
*                                                                     * 00021300
*01* PERFORMANCE IMPLICATIONS:                                        * 00021400
*                                                                     * 00021500
*    None                                                             * 00021600
*                                                                     * 00021700
*01* SYNTAX:                                                          * 00021800
*                                                                     * 00021900
*Ýxlabel¨  IWM4MCHS  Ð  STATE=FREE                                    * 00022000
*                    Ô ,STATE=ACTIVE                                  * 00022100
*                    Ô ,STATE=ACTIVE_APPL                             * 00022200
*                    Ô ,STATE=READY                                   * 00022300
*                    Ô ,STATE=IDLE                                    * 00022400
*                    ¿ ,STATE=WAITING                                 * 00022500
*                        Ð ,RESOURCE=LATCH                            * 00022600
*                        Ô ,RESOURCE=LOCK                             * 00022700
*                        Ô ,RESOURCE=IO                               * 00022800
*                        Ô ,RESOURCE=CONV                             * 00022900
*                        !    Ý,ASYNC=»NO!YESº¨                       * 00023000
*                        Ô ,RESOURCE=DISTRIB                          * 00023100
*                        !    Ý,ASYNC=»NO!YESº¨                       * 00023200
*                        Ô ,RESOURCE=SESS_LOCALMVS                    * 00023300
*                        !    Ý,ASYNC=»NO!YESº¨                       * 00023400
*                        Ô ,RESOURCE=SESS_NETWORK                     * 00023500
*                        !    Ý,ASYNC=»NO!YESº¨                       * 00023600
*                        Ô ,RESOURCE=SESS_SYSPLEX                     * 00023700
*                        !    Ý,ASYNC=»NO!YESº¨                       * 00023800
*                        Ô ,RESOURCE=TIMER                            * 00023900
*                        Ô ,RESOURCE=OTHER_PRODUCT                    * 00024000
*                        !    Ý,ASYNC=»NO!YESº¨                       * 00024100
*                        Ô ,RESOURCE=MISC                             * 00024200
*                        Ô ,RESOURCE=SSL_THREAD                       * 00024300
*                        Ô ,RESOURCE=REG_THREAD                       * 00024400
*                        Ô ,RESOURCE=REG_TO_WRKTB                     * 00024500
*                        Ô ,RESOURCE=TYPE1                            * 00024600
*                        Ô ,RESOURCE=TYPE2                            * 00024700
*                        Ô ,RESOURCE=TYPE3                            * 00024800
*                        Ô ,RESOURCE=TYPE4                            * 00024900
*                        Ô ,RESOURCE=TYPE5                            * 00025000
*                        Ô ,RESOURCE=TYPE6                            * 00025100
*                        Ô ,RESOURCE=TYPE7                            * 00025200
*                        Ô ,RESOURCE=TYPE8                            * 00025300
*                        Ô ,RESOURCE=TYPE9                            * 00025400
*                        Ô ,RESOURCE=TYPE10                           * 00025500
*                        Ô ,RESOURCE=TYPE11                           * 00025600
*                        Ô ,RESOURCE=TYPE12                           * 00025700
*                        Ô ,RESOURCE=TYPE13                           * 00025800
*                        Ô ,RESOURCE=TYPE14                           * 00025900
*                        Ô ,RESOURCE=TYPE15                           * 00026000
*                        ¿ ,RESOURCE=BUFFER_POOL_IO                   * 00026100
*                     Ý,EWLM=»NOº¨                                    * 00026200
*                    Ð ,MONTKN=xmontkn                                * 00026300
*                    ¿ ,MONTKN64=xmontkn64                            * 00026400
*                     Ý,RESTKN=»xrestkn!NORESTKNº¨                    * 00026500
*                    ÐÝ,RUNTIME_VER=SHORT_FORM¨                       * 00026600
*                    ¿Ý,RUNTIME_VER=MINIMAL¨                          * 00026700
*                    ÐÝ,COMPCODE=YES¨                                 * 00026800
*                    ¿Ý,COMPCODE=NO¨                                  * 00026900
*                     Ý,RETCODE=xretcode¨                             * 00027000
*                     Ý,RSNCODE=xrsncode¨                             * 00027100
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*      Where:                                                         * 00027500
*                                                                     * 00027600
*                                                                     * 00027700
*      Ýxlabel¨                                                       * 00027800
*          is an optional symbol, starting in column 1, that is the   * 00027900
*          name on the IWM4MCHS macro invocation.  The name must      * 00028000
*          conform to the rules for an ordinary assembler language    * 00028100
*          symbol.                                                    * 00028200
*          DEFAULT: No name.                                          * 00028300
*                                                                     * 00028400
*                                                                     * 00028500
*                                                                     * 00028600
*                                                                     * 00028700
*      STATE=»FREE!ACTIVE!ACTIVE_APPL!READY!IDLE!WAITINGº             * 00028800
*          is a required keyword input which indicates the current    * 00028900
*          state for the work request.                                * 00029000
*                                                                     * 00029100
*                                                                     * 00029200
*          STATE=FREE                                                 * 00029300
*              indicates that the work manager has no work request    * 00029400
*              associated with the monitoring environment.            * 00029500
*                                                                     * 00029600
*          STATE=ACTIVE                                               * 00029700
*              indicates that there is a program executing on behalf  * 00029800
*              of the work request described by the monitoring        * 00029900
*              environment.  This is an indication from the           * 00030000
*              perspective of the work manager using this service,    * 00030100
*              who should not try to factor in MVS decisions in       * 00030200
*              preempting work, etc.                                  * 00030300
*                                                                     * 00030400
*          STATE=ACTIVE_APPL                                          * 00030500
*              indicates that there is a application program          * 00030600
*              executing on behalf of the work request described by   * 00030700
*              the monitoring environment.  This is an indication     * 00030800
*              from the perspective of the work manager using this    * 00030900
*              service, who should not try to factor in MVS decisions * 00031000
*              in preempting work, etc.  This state represents the    * 00031100
*              application activity in contrast to the active         * 00031200
*              (subsystem) state.                                     * 00031300
*                                                                     * 00031400
*          STATE=READY                                                * 00031500
*              indicates that there is a program ready to execute on  * 00031600
*              behalf of the work request described by the monitoring * 00031700
*              environment, but the work manager has given priority   * 00031800
*              to another work request.                               * 00031900
*                                                                     * 00032000
*          STATE=IDLE                                                 * 00032100
*              indicates that the work manager has no work requests   * 00032200
*              that it is allowed to service within the monitoring    * 00032300
*              environment.  This represents a delay that is not      * 00032400
*              under the control of the work manager itself and which * 00032500
*              it cannot eliminate.  This may be caused by limits     * 00032600
*              imposed by the installation or by the nature of the    * 00032700
*              work request itself.                                   * 00032800
*                                                                     * 00032900
*          STATE=WAITING                                              * 00033000
*              indicates that the work manager is waiting for a       * 00033100
*              resource on behalf of the work request described by    * 00033200
*              the the monitoring environment.  Some resources the    * 00033300
*              work manager is waiting for cause a blocking of the    * 00033400
*              work unit started by IWM4MSTR. The blocking is         * 00033500
*              terminated when the work unit state is changed into a  * 00033600
*              state that does not cause blocking.                    * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*              RESOURCE=»LATCH!LOCK!IO!CONV!DISTRIB!SESS_LOCALMVS!SES * 00034000
*                  S_NETWORK!SESS_SYSPLEX!TIMER!OTHER_PRODUCT!MISC!SS * 00034100
*                  L_THREAD!REG_THREAD!REG_TO_WRKTB!TYPE1!TYPE2!TYPE3 * 00034200
*                  !TYPE4!TYPE5!TYPE6!TYPE7!TYPE8!TYPE9!TYPE10!...º   * 00034300
*                                                                     * 00034400
*                  is a required keyword input which indicates the    * 00034500
*                  resource that the work manager is waiting for on   * 00034600
*                  behalf of the work request described by the        * 00034700
*                  monitoring environment.                            * 00034800
*                                                                     * 00034900
*                                                                     * 00035000
*                  RESOURCE=LATCH                                     * 00035100
*                      indicates that the work manager is waiting on  * 00035200
*                      a latch.                                       * 00035300
*                                                                     * 00035400
*                  RESOURCE=LOCK                                      * 00035500
*                      indicates that the work manager is waiting on  * 00035600
*                      a lock.                                        * 00035700
*                                                                     * 00035800
*                  RESOURCE=IO                                        * 00035900
*                      indicates that the work manager is waiting on  * 00036000
*                      an activity related to an I/O request. This    * 00036100
*                      may either be an actual I/O operation or some  * 00036200
*                      function associated with an IO request that    * 00036300
*                      cannot be more precisely determined by the     * 00036400
*                      work manager (e.g. locks, buffers, etc.).      * 00036500
*                                                                     * 00036600
*                  RESOURCE=CONV                                      * 00036700
*                      indicates that the work manager is waiting on  * 00036800
*                      a conversation.  This may be used in           * 00036900
*                      conjunction with IWM4MSWC to identify where    * 00037000
*                      the target is located.                         * 00037100
*                                                                     * 00037200
*                                                                     * 00037300
*                      ÝASYNC=»NO!YESº¨                               * 00037400
*                          is an optional keyword input which         * 00037500
*                          specifies the blocking type of a work unit * 00037600
*                          started by IWM4MSTR.                       * 00037700
*                          DEFAULT: NO                                * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*                          ASYNC=NO                                   * 00038100
*                              indicates that the blocking type is    * 00038200
*                              synchronous.                           * 00038300
*                                                                     * 00038400
*                          ASYNC=YES                                  * 00038500
*                              indicates that the blocking type is    * 00038600
*                              asynchronous.                          * 00038700
*                                                                     * 00038800
*                                                                     * 00038900
*                                                                     * 00039000
*                                                                     * 00039100
*                                                                     * 00039200
*                  RESOURCE=DISTRIB                                   * 00039300
*                      indicates that the work manager is waiting on  * 00039400
*                      a distributed request.  This says at a high    * 00039500
*                      level that some function or data must be       * 00039600
*                      routed prior to resumption of the work         * 00039700
*                      request.  This is to be contrasted with        * 00039800
*                      Waiting on Conversation, which is a low level  * 00039900
*                      view of the precise resource that is needed. A * 00040000
*                      distributed request could involve waiting on a * 00040100
*                      conversation as part of its processing.        * 00040200
*                                                                     * 00040300
*                                                                     * 00040400
*                      ÝASYNC=»NO!YESº¨                               * 00040500
*                          is an optional keyword input which         * 00040600
*                          specifies the blocking type of a work unit * 00040700
*                          started by IWM4MSTR.                       * 00040800
*                          DEFAULT: NO                                * 00040900
*                                                                     * 00041000
*                                                                     * 00041100
*                          ASYNC=NO                                   * 00041200
*                              indicates that the blocking type is    * 00041300
*                              synchronous.                           * 00041400
*                                                                     * 00041500
*                          ASYNC=YES                                  * 00041600
*                              indicates that the blocking type is    * 00041700
*                              asynchronous.                          * 00041800
*                                                                     * 00041900
*                                                                     * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*                                                                     * 00042300
*                  RESOURCE=SESS_LOCALMVS                             * 00042400
*                      indicates that the work manager is waiting to  * 00042500
*                      establish a session somewhere in the current   * 00042600
*                      MVS image.                                     * 00042700
*                                                                     * 00042800
*                                                                     * 00042900
*                      ÝASYNC=»NO!YESº¨                               * 00043000
*                          is an optional keyword input which         * 00043100
*                          specifies the blocking type of a work unit * 00043200
*                          started by IWM4MSTR.                       * 00043300
*                          DEFAULT: NO                                * 00043400
*                                                                     * 00043500
*                                                                     * 00043600
*                          ASYNC=NO                                   * 00043700
*                              indicates that the blocking type is    * 00043800
*                              synchronous.                           * 00043900
*                                                                     * 00044000
*                          ASYNC=YES                                  * 00044100
*                              indicates that the blocking type is    * 00044200
*                              asynchronous.                          * 00044300
*                                                                     * 00044400
*                                                                     * 00044500
*                                                                     * 00044600
*                                                                     * 00044700
*                                                                     * 00044800
*                  RESOURCE=SESS_NETWORK                              * 00044900
*                      indicates that the work manager is waiting to  * 00045000
*                      establish a session somewhere in the network.  * 00045100
*                                                                     * 00045200
*                                                                     * 00045300
*                      ÝASYNC=»NO!YESº¨                               * 00045400
*                          is an optional keyword input which         * 00045500
*                          specifies the blocking type of a work unit * 00045600
*                          started by IWM4MSTR.                       * 00045700
*                          DEFAULT: NO                                * 00045800
*                                                                     * 00045900
*                                                                     * 00046000
*                          ASYNC=NO                                   * 00046100
*                              indicates that the blocking type is    * 00046200
*                              synchronous.                           * 00046300
*                                                                     * 00046400
*                          ASYNC=YES                                  * 00046500
*                              indicates that the blocking type is    * 00046600
*                              asynchronous.                          * 00046700
*                                                                     * 00046800
*                                                                     * 00046900
*                                                                     * 00047000
*                                                                     * 00047100
*                                                                     * 00047200
*                  RESOURCE=SESS_SYSPLEX                              * 00047300
*                      indicates that the work manager is waiting to  * 00047400
*                      establish a session somewhere in the sysplex.  * 00047500
*                                                                     * 00047600
*                                                                     * 00047700
*                      ÝASYNC=»NO!YESº¨                               * 00047800
*                          is an optional keyword input which         * 00047900
*                          specifies the blocking type of a work unit * 00048000
*                          started by IWM4MSTR.                       * 00048100
*                          DEFAULT: NO                                * 00048200
*                                                                     * 00048300
*                                                                     * 00048400
*                          ASYNC=NO                                   * 00048500
*                              indicates that the blocking type is    * 00048600
*                              synchronous.                           * 00048700
*                                                                     * 00048800
*                          ASYNC=YES                                  * 00048900
*                              indicates that the blocking type is    * 00049000
*                              asynchronous.                          * 00049100
*                                                                     * 00049200
*                                                                     * 00049300
*                                                                     * 00049400
*                                                                     * 00049500
*                                                                     * 00049600
*                  RESOURCE=TIMER                                     * 00049700
*                      indicates that the work request is waiting on  * 00049800
*                      a timer.                                       * 00049900
*                                                                     * 00050000
*                  RESOURCE=OTHER_PRODUCT                             * 00050100
*                      indicates that the work manager is waiting on  * 00050200
*                      another product to complete its function.      * 00050300
*                                                                     * 00050400
*                                                                     * 00050500
*                      ÝASYNC=»NO!YESº¨                               * 00050600
*                          is an optional keyword input which         * 00050700
*                          specifies the blocking type of a work unit * 00050800
*                          started by IWM4MSTR.                       * 00050900
*                          DEFAULT: NO                                * 00051000
*                                                                     * 00051100
*                                                                     * 00051200
*                          ASYNC=NO                                   * 00051300
*                              indicates that the blocking type is    * 00051400
*                              synchronous.                           * 00051500
*                                                                     * 00051600
*                          ASYNC=YES                                  * 00051700
*                              indicates that the blocking type is    * 00051800
*                              asynchronous.                          * 00051900
*                                                                     * 00052000
*                                                                     * 00052100
*                                                                     * 00052200
*                                                                     * 00052300
*                                                                     * 00052400
*                  RESOURCE=MISC                                      * 00052500
*                      indicates that the work manager is waiting on  * 00052600
*                      some unidentified resource, possibly among the * 00052700
*                      previous categories.                           * 00052800
*                                                                     * 00052900
*                  RESOURCE=SSL_THREAD                                * 00053000
*                      indicates that the work manager is waiting on  * 00053100
*                      a SSL thread.                                  * 00053200
*                                                                     * 00053300
*                  RESOURCE=REG_THREAD                                * 00053400
*                      indicates that the work manager is waiting on  * 00053500
*                      a regular processing thread.                   * 00053600
*                                                                     * 00053700
*                  RESOURCE=REG_TO_WRKTB                              * 00053800
*                      indicates that the work manager is waiting for * 00053900
*                      the registration to a worktable.               * 00054000
*                                                                     * 00054100
*                  RESOURCE=TYPE1                                     * 00054200
*                      indicates that the work manager is waiting for * 00054300
*                      resource type 1.                               * 00054400
*                                                                     * 00054500
*                  RESOURCE=TYPE2                                     * 00054600
*                      indicates that the work manager is waiting for * 00054700
*                      resource type 2.                               * 00054800
*                                                                     * 00054900
*                  RESOURCE=TYPE3                                     * 00055000
*                      indicates that the work manager is waiting for * 00055100
*                      resource type 3.                               * 00055200
*                                                                     * 00055300
*                  RESOURCE=TYPE4                                     * 00055400
*                      indicates that the work manager is waiting for * 00055500
*                      resource type 4.                               * 00055600
*                                                                     * 00055700
*                  RESOURCE=TYPE5                                     * 00055800
*                      indicates that the work manager is waiting for * 00055900
*                      resource type 5.                               * 00056000
*                                                                     * 00056100
*                  RESOURCE=TYPE6                                     * 00056200
*                      indicates that the work manager is waiting for * 00056300
*                      resource type 6.                               * 00056400
*                                                                     * 00056500
*                  RESOURCE=TYPE7                                     * 00056600
*                      indicates that the work manager is waiting for * 00056700
*                      resource type 7.                               * 00056800
*                                                                     * 00056900
*                  RESOURCE=TYPE8                                     * 00057000
*                      indicates that the work manager is waiting for * 00057100
*                      resource type 8.                               * 00057200
*                                                                     * 00057300
*                  RESOURCE=TYPE9                                     * 00057400
*                      indicates that the work manager is waiting for * 00057500
*                      resource type 9.                               * 00057600
*                                                                     * 00057700
*                  RESOURCE=TYPE10                                    * 00057800
*                      indicates that the work manager is waiting for * 00057900
*                      resource type 10.                              * 00058000
*                                                                     * 00058100
*                  RESOURCE=TYPE11                                    * 00058200
*                      indicates that the work manager is waiting for * 00058300
*                      resource type 11.                              * 00058400
*                                                                     * 00058500
*                  RESOURCE=TYPE12                                    * 00058600
*                      indicates that the work manager is waiting for * 00058700
*                      resource type 12.                              * 00058800
*                                                                     * 00058900
*                  RESOURCE=TYPE13                                    * 00059000
*                      indicates that the work manager is waiting for * 00059100
*                      resource type 13.                              * 00059200
*                                                                     * 00059300
*                  RESOURCE=TYPE14                                    * 00059400
*                      indicates that the work manager is waiting for * 00059500
*                      resource type 14.                              * 00059600
*                                                                     * 00059700
*                  RESOURCE=TYPE15                                    * 00059800
*                      indicates that the work manager is waiting for * 00059900
*                      resource type 15.                              * 00060000
*                                                                     * 00060100
*                  RESOURCE=BUFFER_POOL_IO                            * 00060200
*                      indicates that the work manager is waiting for * 00060300
*                      resource buffer pool IO.                       * 00060400
*                                                                     * 00060500
*                                                                     * 00060600
*                                                                     * 00060700
*                                                                     * 00060800
*                                                                     * 00060900
*                                                                     * 00061000
*                                                                     * 00061100
*                                                                     * 00061200
*                                                                     * 00061300
*                                                                     * 00061400
*      ÝEWLM=»NOº¨                                                    * 00061500
*          is an optional keyword input which indicates if this work  * 00061600
*          manager intents to participate in cross platform           * 00061700
*          Enterprise Workload Management (eWLM).                     * 00061800
*          DEFAULT: NO                                                * 00061900
*                                                                     * 00062000
*                                                                     * 00062100
*          EWLM=NO                                                    * 00062200
*              The work manager interacts only with WLM and no        * 00062300
*              interaction with eWLM takes place.                     * 00062400
*              DEFAULT: NO                                            * 00062500
*                                                                     * 00062600
*                                                                     * 00062700
*                                                                     * 00062800
*                                                                     * 00062900
*                                                                     * 00063000
*                                                                     * 00063100
*      The following is a set of mutually exclusive keys.  This set   * 00063200
*      is required; only one key must be specified.                   * 00063300
*                                                                     * 00063400
*                                                                     * 00063500
*      MONTKN=xmontkn                                                 * 00063600
*          belongs to a set of mutually exclusive keys. It is the     * 00063700
*          name (RS-type), or address in register (2)-(12), of a 32   * 00063800
*          bit input which contains the delay monitoring token.       * 00063900
*                                                                     * 00064000
*      MONTKN64=xmontkn64                                             * 00064100
*          belongs to a set of mutually exclusive keys. It is the     * 00064200
*          name (RS-type), or address in register (2)-(12), of a 64   * 00064300
*          bit input which contains the long delay monitoring token.  * 00064400
*                                                                     * 00064500
*                                                                     * 00064600
*                                                                     * 00064700
*      End of a set of mutually exclusive required keys.              * 00064800
*                                                                     * 00064900
*                                                                     * 00065000
*                                                                     * 00065100
*      ÝRESTKN=»xrestkn!NORESTKNº¨                                    * 00065200
*          is the name (RS-type), or address in register (2)-(12), of * 00065300
*          an optional 8 character input which contains the token of  * 00065400
*          the managed resource previously registered with Register   * 00065500
*          Resource (IWM4MREG)                                        * 00065600
*          DEFAULT: NORESTKN indicates that no resource token is      * 00065700
*          provided.                                                  * 00065800
*                                                                     * 00065900
*          NORESTKN will preserve the existing resource token, if     * 00066000
*          any.                                                       * 00066100
*                                                                     * 00066200
*                                                                     * 00066300
*                                                                     * 00066400
*                                                                     * 00066500
*      ÝRUNTIME_VER=»SHORT_FORM!MINIMALº¨                             * 00066600
*          is an optional keyword input which indicates what level of * 00066700
*          runtime verification will be performed.                    * 00066800
*          DEFAULT: SHORT_FORM                                        * 00066900
*                                                                     * 00067000
*                                                                     * 00067100
*          ÝRUNTIME_VER=SHORT_FORM¨                                   * 00067200
*              indicates that checking should verify that a           * 00067300
*              monitoring environment is established and passes a     * 00067400
*              short form of verification prior to being used.        * 00067500
*                                                                     * 00067600
*          ÝRUNTIME_VER=MINIMAL¨                                      * 00067700
*              indicates that checking will only be done to verify    * 00067800
*              that a monitoring environment may be established,      * 00067900
*              assuming that it would be valid and useable if         * 00068000
*              established.                                           * 00068100
*              DEFAULT: SHORT_FORM indicates that short form checking * 00068200
*              is desired.                                            * 00068300
*                                                                     * 00068400
*                                                                     * 00068500
*                                                                     * 00068600
*                                                                     * 00068700
*                                                                     * 00068800
*                                                                     * 00068900
*      ÝCOMPCODE=»YES!NOº¨                                            * 00069000
*          is an optional keyword input which indicates whether       * 00069100
*          completion status for this service is needed.              * 00069200
*          DEFAULT: YES                                               * 00069300
*                                                                     * 00069400
*                                                                     * 00069500
*          ÝCOMPCODE=YES¨                                             * 00069600
*              indicates that completion status is needed.            * 00069700
*                                                                     * 00069800
*          ÝCOMPCODE=NO¨                                              * 00069900
*              indicates that completion status is not needed.        * 00070000
*              Registers 0, 15 cannot be used as reason code and      * 00070100
*              return code registers upon completion of the macro     * 00070200
*              expansion. For this reason neither RETCODE NOR RSNCODE * 00070300
*              may be specified when COMPCODE(NO) is specified.       * 00070400
*              DEFAULT: YES indicates that completion status is       * 00070500
*              needed.                                                * 00070600
*                                                                     * 00070700
*                                                                     * 00070800
*                                                                     * 00070900
*                                                                     * 00071000
*                                                                     * 00071100
*                                                                     * 00071200
*      ÝRETCODE=xretcode¨                                             * 00071300
*          is the name (RS-type) of an optional fullword output       * 00071400
*          variable, or register (2)-(12) or (15), into which the     * 00071500
*          return code is to be copied from GPR 15.  If you specify   * 00071600
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00071700
*          the value will be left in GPR 15.                          * 00071800
*                                                                     * 00071900
*                                                                     * 00072000
*                                                                     * 00072100
*                                                                     * 00072200
*      ÝRSNCODE=xrsncode¨                                             * 00072300
*          is the name (RS-type) of an optional fullword output       * 00072400
*          variable into which the reason code is to be copied from   * 00072500
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00072600
*          R0 (within or without parentheses), the value will be left * 00072700
*          in GPR 0.                                                  * 00072800
*                                                                     * 00072900
*                                                                     * 00073000
*                                                                     * 00073100
*                                                                     * 00073200
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00073300
*          is an optional byte input decimal value in the "0-3" range * 00073400
*          that specifies the macro version.  PLISTVER determines     * 00073500
*          which parameter list is generated.  The macro keys         * 00073600
*          associated with each supported version of the macro are    * 00073700
*          listed in MACRO USAGE NOTE 2.  Note that MAX may be        * 00073800
*          specified instead of a number, and the parameter list will * 00073900
*          be of the largest size currently supported. This size may  * 00074000
*          grow from release to release (thus possibly affecting the  * 00074100
*          amount of storage needed by your program).                 * 00074200
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00074300
*          default is the lowest version which allows all of the      * 00074400
*          parameters specified on the invocation to be processed.    * 00074500
*                                                                     * 00074600
*                                                                     * 00074700
*                                                                     * 00074800
*01* ABEND CODES:  None.                                              * 00074900
*                                                                     * 00075000
*01* RETURN CODES:                                                    * 00075100
*                                                                     * 00075200
*                                                                     * 00075300
*            0    Name: IwmRetCodeOk                                  * 00075400
*                                                                     * 00075500
*                 Meaning: Successful completion.                     * 00075600
*                                                                     * 00075700
*                 Action: None required.                              * 00075800
*                                                                     * 00075900
*            4    Name: IwmRetCodeWarning                             * 00076000
*                                                                     * 00076100
*                 Meaning: Successful completion, unusual conditions  * 00076200
*                 noted.                                              * 00076300
*                                                                     * 00076400
*                                                                     * 00076500
*                 HEX REASON  MEANING/ACTION                          * 00076600
*                 CODE                                                * 00076700
*                                                                     * 00076800
*                 xxxx0402    Name: IwmRsnCodeNoMonEnv                * 00076900
*                                                                     * 00077000
*                             Meaning:  Input monitoring token        * 00077100
*                             indicates no monitoring environment was * 00077200
*                             established.                            * 00077300
*                                                                     * 00077400
*                             Action: None required.                  * 00077500
*                                                                     * 00077600
*                                                                     * 00077700
*                                                                     * 00077800
*            8    Name: IwmRetCodeInvocError                          * 00077900
*                                                                     * 00078000
*                 Meaning: Invalid invocation environment or          * 00078100
*                 parameters.                                         * 00078200
*                                                                     * 00078300
*                                                                     * 00078400
*                 HEX REASON  MEANING/ACTION                          * 00078500
*                 CODE                                                * 00078600
*                                                                     * 00078700
*                 xxxx0820    Name: IwmRsnCodeBadMonEnv               * 00078800
*                                                                     * 00078900
*                             Meaning:  Monitoring environment does   * 00079000
*                             not pass short form verification.       * 00079100
*                                                                     * 00079200
*                             Action: Check for possible storage      * 00079300
*                             overlay.                                * 00079400
*                                                                     * 00079500
*                                                                     * 00079600
*                                                                     * 00079700
*                                                                     * 00079800
*                                                                     * 00079900
*01* REASON CODES:                                                    * 00080000
*                                                                     * 00080100
*       A unique reason code will be returned whenever the return     * 00080200
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00080300
*       under their corresponding return code.  Reason code and       * 00080400
*       return code constants are defined within IWMYCON.  Note that  * 00080500
*       the high order halfword of bits 0-31 of register 0, and the   * 00080600
*       reason code variable when specified, may be non-zero and      * 00080700
*       represents diagnostic data which is NOT part of the external  * 00080800
*       interface.  The high order halfword should thus be excluded   * 00080900
*       from comparison with the reason code values described above.  * 00081000
*       The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may   * 00081100
*       be used for this purpose.                                     * 00081200
*                                                                     * 00081300
*01* MODULE TYPE:  ASSEM MACRO                                        * 00081400
*                                                                     * 00081500
*02*   PROCESSOR:  ASSEM                                              * 00081600
*                                                                     * 00081700
*01* COMPONENT:  SCWLM                                                * 00081800
*                                                                     * 00081900
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00082000
*                                                                     * 00082100
*01* EXAMPLES:                                                        * 00082200
*                                                                     * 00082300
*01* MACRO USAGE NOTES:                                               * 00082400
*                                                                     * 00082500
*                                                                     * 00082600
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00082700
*        global macro variable.  Any value other than 'NO' will       * 00082800
*        result in the macro expansion being printed.  The default is * 00082900
*        'YES'.  The following examples illustrate how the ZPRINT     * 00083000
*        variable should be set.                                      * 00083100
*                                                                     * 00083200
*                    GBLC &ZPRINT                                     * 00083300
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00083400
*                                                                     * 00083500
*                                                                     * 00083600
*    2.  The IWM4MCHS macro supports multiple versions. The macro key * 00083700
*        list  below  contains the version level in which the key was * 00083800
*        first  introduced.  Positionals  are  identified by the word * 00083900
*        'Positional'  followed by the numeric value of its position. * 00084000
*        Nested  positionals  are  preceded  by their outer key.  The * 00084100
*        lowest value represents the original version and the highest * 00084200
*        value  represents  the  most  recent version of the IWM4MCHS * 00084300
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00084400
*        least  as high as the highest version number of all the keys * 00084500
*        being used.                                                  * 00084600
*                                                                     * 00084700
*        VERSION   KEY                                                * 00084800
*                                                                     * 00084900
*              0      ASYNC                                           * 00085000
*                     COMPCODE                                        * 00085100
*                     EWLM                                            * 00085200
*                     MONTKN                                          * 00085300
*                     RESOURCE                                        * 00085400
*                     RESTKN                                          * 00085500
*                     RUNTIME_VER                                     * 00085600
*                     STATE                                           * 00085700
*              3      MONTKN64                                        * 00085800
*                                                                     * 00085900
*                                                                     * 00086000
*                                                                     * 00086100
*01* CHANGE ACTIVITY:                                                 * 00086200
*                                                                     * 00086300
*   Flag LineItem  FMID    Date   ID    Comment                       * 00086400
*                                                                     * 00086500
*    $L0=WLMP64W  HBB7709 030515 3241DW:  WLM 64-bit support copied   * 00086600
*                                         from IWM4MCHS with flag L4  * 00086700
*    $L1=PJK0544  HBB7709 030630 3241NN:  Correcting wrong maccal and * 00086800
*                                         a missing comment           * 00086900
*    $L2=PJK0688  HBB7709 030722 3241DW:  High order bit of MONTKN    * 00087000
*                                         removed in 64bit addressing * 00087100
*                                         mode                        * 00087200
*    $P1=ME01176  HBB7720 040713 3241DW:  Doc changes only.  Service  * 00087300
*                                         names changed to reflect    * 00087400
*                                         the 64bit name.             * 00087500
*    $L4=WLMPDBM  HBB7720 040729 3241UH:  Dynamic Buffer Pool         * 00087600
*                                         mangement GA Support        * 00087700
*    $L4=WLMPDBM  HBB7720 040729 3241AA:  Dynamic Buffer Pool         * 00087800
*                                         management GA Support       * 00087900
*    $L5=LEWLMQ   HBB7740 060628 3241KK:  EWLM MQ Support             * 00088000
*    $L6=OA17369  HBB7740 060810 3241GB:  Declare SYSAM64 and         * 00088100
*                                         SYSALVL, REGEN              * 00088200
*    $L7=LPBDEL   HBB7750 070531 3241KHH:  Add more generic PB Delays * 00088300
*    $L4=OA18461  HBB7770 090730 3241PB:  Dynamic Buffer Pool         * 00088400
*                                         management Fixes            * 00088500
*    $P2=ME21372  HBB7780 110324 3241KHH:  High order bit of MONTKN   * 00088600
*                                         cleared in 64bit addressing * 00088700
*                                         mode                        * 00088800
*    $P3=OA36055  HBB7780 110412 3241MG:  Calls service routine only  * 00088900
*                                         if PB_EWLM_ENABLED set      * 00089000
*    $P4=OA39362  HBB7790 120427 3241MG:  Fixes errors in PL/X        * 00089100
*    $L8=LPBABV   HBB7790 111020 3241AH:  PB above 2G                 * 00089200
*    $P5=ME24923  HBB7790 121016 3241AH:  Fix SYSAM64 logic           * 00089300
*    $P6=ME25540  HBB7790 130122 3241AH:  Assembler AMODE switch base * 00089400
*                                         register usage incorrect    * 00089500
*    $P7=OA45023  HBB7790 140422 3241AK:  MONTKN has the wrong        * 00089600
*                                         parameterlist version.      * 00089700
****** END OF SPECIFICATIONS *****************************************/ 00089800
*/********************************************************************* 00089900
         MACRO                                                          00090000
&XLABEL  IWM4MCHS &STATE=,&RESOURCE=,&ASYNC=,&EWLM=,&MONTKN=,          *00090100
               &MONTKN64=,&RESTKN=,&RUNTIME_VER=,&COMPCODE=,&RETCODE=, *00090200
               &RSNCODE=,&PLISTVER=                                     00090300
.*                                                                      00090400
*                    MACDATE -05/20/14-<3>                              00090500
.*                                                                      00090600
.*******************************************************************    00090700
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00090800
.*******************************************************************    00090900
                    GBLC  &ZPRINT     YES=PRINT NO=NO PRINT             00091000
                    GBLC  &ZTEST      YES=TEST NO=NO TEST               00091100
                    GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX       00091200
.*                                                                      00091300
                    GBLC  &ZIWM4MCHS  YES=MACRO USED AT LEAST ONCE      00091400
.*******************************************************************    00091500
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00091600
.*******************************************************************    00091700
                    LCLC  &ZMS        ERROR MESSAGE WORK AREA           00091800
                    LCLC  &ZCNDX      SYSNDX CHARACTERS                 00091900
                    LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED        00092000
                    LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR       00092100
                    LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE       00092200
                    LCLA  &ZAWRK      USED AS A WORK AREA               00092300
                    LCLA  &ZASIZ      USED FOR SIZE OF VALUE            00092400
                    LCLA  &ZN         NUMERIC WORK VARIABLE             00092500
                    LCLC  &ZC         CHARACTER WORK VARIABLE           00092600
                    LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE       00092700
                    LCLA  &ZTLA       VALUE TOO LONG VARIABLE           00092800
                    LCLC  &ZMAC_G     "G" or null                       00092900
&ZMAC_G             SETC  ''                                            00093000
                    LCLC  &ZMAC_LR                                      00093100
&ZMAC_LR            SETC  'LR'                                          00093200
                    LCLC  &ZMAC_L                                       00093300
&ZMAC_L             SETC  'L'                                           00093400
                    LCLC  &ZMAC_ST                                      00093500
&ZMAC_ST            SETC  'ST'                                          00093600
                    LCLC  &ZMAC_LLGT                                    00093700
&ZMAC_LLGT          SETC  'L'                                           00093800
                    LCLC  &ZMAC_LGR                                     00093900
&ZMAC_LGR           SETC  'LR'                                          00094000
                    LCLC  &ZMAC_LG                                      00094100
&ZMAC_LG            SETC  'L'                                           00094200
                    LCLC  &ZMAC_STG                                     00094300
&ZMAC_STG           SETC  'ST'                                          00094400
                    LCLA  &ZMACRET    MACRO RETURN CODE                 00094500
&ZMACRET            SETA  0           ASSUME NO ERRORS                  00094600
.*                                                                      00094700
                    LCLC  &ZCSYSLIST(255)       NONXKEY, POS ARRAY      00094800
                    LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()        00094900
                    LCLA  &ZPLLEN     PARAMETER LIST LENGTH             00095000
                    LCLC  &ZENDBASEPL           End of base PL          00095100
                    LCLA  &ZPLWORKA   PARAMETER LIST LENGTH             00095200
.*******************************************************************    00095300
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00095400
.*******************************************************************    00095500
                    LCLA  &ZI         INDEX FOR ARRAY                   00095600
                    LCLA  &ZJ         INDEX FOR PARMS                   00095700
                    LCLA  &ZK         INDEX FOR PARSE                   00095800
                    LCLA  &ZLO        LOW RANGE VALUE                   00095900
                    LCLA  &ZHI        HIGH RANGE VALUE                  00096000
                    LCLC  &ZW         WORK AREA FOR PARM                00096100
.*******************************************************************    00096200
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00096300
.*******************************************************************    00096400
                    LCLC  &XSTATE     ++ VALUE                          00096500
                    LCLC  &XRESOURCE  ++ VALUE                          00096600
                    LCLC  &XASYNC     ++ VALUE                          00096700
                    LCLC  &XEWLM      ++ VALUE                          00096800
                    LCLC  &XUSEDMONTKNKEY       ++ NAME                 00096900
                    LCLC  &XMONTKN    ++ NAME                           00097000
                    LCLC  &XMONTKN64  ++ NAME                           00097100
                    LCLC  &XRESTKN    ++ NAME                           00097200
                    LCLC  &XRUNTIME_VER         ++ VALUE                00097300
                    LCLC  &XCOMPCODE  ++ VALUE                          00097400
                    LCLC  &XRETCODE   ++ NAME                           00097500
                    LCLC  &XRSNCODE   ++ NAME                           00097600
                    LCLA  &XPLISTVER  ++ VALUE                          00097700
.*******************************************************************    00097800
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00097900
.*******************************************************************    00098000
                    LCLC  &ZXSTATE    ++ INPUT VALUE                    00098100
                    LCLC  &ZXRESOURCE           ++ INPUT VALUE          00098200
                    LCLC  &ZXASYNC    ++ INPUT VALUE                    00098300
                    LCLC  &ZXEWLM     ++ INPUT VALUE                    00098400
                    LCLC  &ZXUSEDMONTKNKEY      ++ INPUT NAME           00098500
                    LCLC  &ZXMONTKN   ++ INPUT NAME                     00098600
                    LCLC  &ZXMONTKN64           ++ INPUT NAME           00098700
                    LCLC  &ZXRESTKN   ++ INPUT NAME                     00098800
                    LCLC  &ZXRUNTIME_VER        ++ INPUT VALUE          00098900
                    LCLC  &ZXCOMPCODE           ++ INPUT VALUE          00099000
                    LCLC  &ZXRETCODE  ++ OUTPUT NAME                    00099100
                    LCLC  &ZXRSNCODE  ++ OUTPUT NAME                    00099200
                    LCLC  &ZXPLISTVER           ++ INPUT VALUE          00099300
.********************************************************************   00099400
.***AC.PLV01  PROCESS PLISTVER                                      *   00099500
.********************************************************************   00099600
&XPLISTVER      SETA  0                                                 00099700
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00099800
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00099900
&XPLISTVER      SETA  3                                                 00100000
.ZPLV0          ANOP  ,                                                 00100100
.*                                                                      00100200
                AIF   ('&MONTKN64' EQ '').ZPLV1E                        00100300
                AIF   (&XPLISTVER GE 3).ZPLV1E                          00100400
&XPLISTVER      SETA  3                                                 00100500
.ZPLV1E         ANOP  ,                                                 00100600
.*                                                                      00100700
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00100800
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00100900
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00101000
.*-------------------------------------------------------------------   00101100
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00101200
&ZMS            SETC  '"PLISTVER='                                      00101300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00101400
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00101500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00101600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00101700
                AGO   .ZPVCK2                                           00101800
.ZPVCK3         ANOP  ,                                                 00101900
.*-------------------------------------------------------------------   00102000
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00102100
&ZMS            SETC  '"PLISTVER='                                      00102200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00102300
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00102400
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00102500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00102600
                AGO   .ZPVCKE                                           00102700
.ZPVCK2         ANOP  ,                                                 00102800
.*-------------------------------------------------------------------   00102900
&ZCVAL          SETC  '&PLISTVER(1)'                                    00103000
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00103100
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00103200
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00103300
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00103400
                AIF   (&ZN LE 3).ZPVCK4A   NOT HIGH                     00103500
.ZPVCK6         ANOP  ,                                                 00103600
&ZMS            SETC  '"PLISTVER='                                      00103700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00103800
&ZMS            SETC  '&ZMS THE RANGE IS "0-3"'                         00103900
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00104000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00104100
&XPLISTVER      SETA  3                                                 00104200
                AGO   .ZPVCKE                                           00104300
.*-------------------------------------------------------------------   00104400
.ZPVCK4A        ANOP  ,                                                 00104500
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00104600
&ZMS            SETC  'PLISTVER='                                       00104700
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00104800
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00104900
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00105000
                MNOTE 8,' &ZMS IS REQUIRED.'                            00105100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00105200
                AGO   .ZPVCK5                                           00105300
.ZPVCK4         ANOP  ,                                                 00105400
&XPLISTVER      SETA  &PLISTVER(1)                                      00105500
.ZPVCK5         ANOP  ,                                                 00105600
.ZPVCKE         ANOP  ,                                                 00105700
.********************************************************************   00105800
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00105900
.********************************************************************   00106000
                    ACTR  10000                                         00106100
.*------------------------------------------------------------------    00106200
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00106300
&XSTATE             SETC  ''          INITIALIZE XVARIABLE              00106400
.*-------------------------------------------------------------------   00106500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00106600
.ZG3                ANOP  ,                                             00106700
                    AIF   (K'&STATE(1) LE 0).ZG3A                       00106800
&ZTLC               SETC 'FREE'                                         00106900
                    AIF   ('&STATE(1)' NE '&ZTLC').ZG4                  00107000
&XSTATE             SETC  'FREE'      SET KEYWORD                       00107100
                    AIF   (N'&STATE LE 1).ZG3A  CK NUM                  00107200
&ZMS                SETC  '"STATE='                                     00107300
&ZMS                SETC  '&ZMS.&STATE"'                                00107400
&ZMS                SETC  '&ZMS "STATE"'                                00107500
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00107600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00107700
.ZG3A               ANOP  ,                                             00107800
.*------------------------------------------------------------------    00107900
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00108000
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00108100
.ZG3A0              AIF   (K'&RESOURCE LE 0).ZG3A1  OK                  00108200
&ZCVAL              SETC '&ZCVAL RESOURCE'      INCORRECT KEY USED      00108300
.ZG3A1              AIF   (K'&ASYNC LE 0).ZG3A2  OK                     00108400
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00108500
.ZG3A2              AIF   (K'&ZCVAL LE 0).ZG3A3  OK                     00108600
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00108700
&ZMS                SETC  '"STATE'                                      00108800
&ZMS                SETC  '&ZMS.=&STATE"'                               00108900
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00109000
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00109100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00109200
.ZG3A3              ANOP  ,                                             00109300
.*-------------------------------------------------------------------   00109400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00109500
.ZG4                ANOP  ,                                             00109600
&ZTLC               SETC 'ACTIVE'                                       00109700
                    AIF   ('&STATE(1)' NE '&ZTLC').ZG5                  00109800
&XSTATE             SETC  'ACTIVE'    SET KEYWORD                       00109900
                    AIF   (N'&STATE LE 1).ZG4A  CK NUM                  00110000
&ZMS                SETC  '"STATE='                                     00110100
&ZMS                SETC  '&ZMS.&STATE"'                                00110200
&ZMS                SETC  '&ZMS "STATE"'                                00110300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00110400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00110500
.ZG4A               ANOP  ,                                             00110600
.*------------------------------------------------------------------    00110700
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00110800
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00110900
.ZG4A0              AIF   (K'&RESOURCE LE 0).ZG4A1  OK                  00111000
&ZCVAL              SETC '&ZCVAL RESOURCE'      INCORRECT KEY USED      00111100
.ZG4A1              AIF   (K'&ASYNC LE 0).ZG4A2  OK                     00111200
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00111300
.ZG4A2              AIF   (K'&ZCVAL LE 0).ZG4A3  OK                     00111400
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00111500
&ZMS                SETC  '"STATE'                                      00111600
&ZMS                SETC  '&ZMS.=&STATE"'                               00111700
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00111800
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00111900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00112000
.ZG4A3              ANOP  ,                                             00112100
.*-------------------------------------------------------------------   00112200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00112300
.ZG5                ANOP  ,                                             00112400
&ZTLC               SETC 'ACTIVE_APPL'                                  00112500
                    AIF   ('&STATE(1)' NE '&ZTLC').ZG6                  00112600
&XSTATE             SETC  'ACTIVE_APPL'         SET KEYWORD             00112700
                    AIF   (N'&STATE LE 1).ZG5A  CK NUM                  00112800
&ZMS                SETC  '"STATE='                                     00112900
&ZMS                SETC  '&ZMS.&STATE"'                                00113000
&ZMS                SETC  '&ZMS "STATE"'                                00113100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00113200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00113300
.ZG5A               ANOP  ,                                             00113400
.*------------------------------------------------------------------    00113500
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00113600
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00113700
.ZG5A0              AIF   (K'&RESOURCE LE 0).ZG5A1  OK                  00113800
&ZCVAL              SETC '&ZCVAL RESOURCE'      INCORRECT KEY USED      00113900
.ZG5A1              AIF   (K'&ASYNC LE 0).ZG5A2  OK                     00114000
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00114100
.ZG5A2              AIF   (K'&ZCVAL LE 0).ZG5A3  OK                     00114200
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00114300
&ZMS                SETC  '"STATE'                                      00114400
&ZMS                SETC  '&ZMS.=&STATE"'                               00114500
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00114600
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00114700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00114800
.ZG5A3              ANOP  ,                                             00114900
.*-------------------------------------------------------------------   00115000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00115100
.ZG6                ANOP  ,                                             00115200
&ZTLC               SETC 'READY'                                        00115300
                    AIF   ('&STATE(1)' NE '&ZTLC').ZG7                  00115400
&XSTATE             SETC  'READY'     SET KEYWORD                       00115500
                    AIF   (N'&STATE LE 1).ZG6A  CK NUM                  00115600
&ZMS                SETC  '"STATE='                                     00115700
&ZMS                SETC  '&ZMS.&STATE"'                                00115800
&ZMS                SETC  '&ZMS "STATE"'                                00115900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00116000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00116100
.ZG6A               ANOP  ,                                             00116200
.*------------------------------------------------------------------    00116300
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00116400
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00116500
.ZG6A0              AIF   (K'&RESOURCE LE 0).ZG6A1  OK                  00116600
&ZCVAL              SETC '&ZCVAL RESOURCE'      INCORRECT KEY USED      00116700
.ZG6A1              AIF   (K'&ASYNC LE 0).ZG6A2  OK                     00116800
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00116900
.ZG6A2              AIF   (K'&ZCVAL LE 0).ZG6A3  OK                     00117000
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00117100
&ZMS                SETC  '"STATE'                                      00117200
&ZMS                SETC  '&ZMS.=&STATE"'                               00117300
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00117400
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00117500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00117600
.ZG6A3              ANOP  ,                                             00117700
.*-------------------------------------------------------------------   00117800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00117900
.ZG7                ANOP  ,                                             00118000
&ZTLC               SETC 'IDLE'                                         00118100
                    AIF   ('&STATE(1)' NE '&ZTLC').ZG8                  00118200
&XSTATE             SETC  'IDLE'      SET KEYWORD                       00118300
                    AIF   (N'&STATE LE 1).ZG7A  CK NUM                  00118400
&ZMS                SETC  '"STATE='                                     00118500
&ZMS                SETC  '&ZMS.&STATE"'                                00118600
&ZMS                SETC  '&ZMS "STATE"'                                00118700
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00118800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00118900
.ZG7A               ANOP  ,                                             00119000
.*------------------------------------------------------------------    00119100
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00119200
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00119300
.ZG7A0              AIF   (K'&RESOURCE LE 0).ZG7A1  OK                  00119400
&ZCVAL              SETC '&ZCVAL RESOURCE'      INCORRECT KEY USED      00119500
.ZG7A1              AIF   (K'&ASYNC LE 0).ZG7A2  OK                     00119600
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00119700
.ZG7A2              AIF   (K'&ZCVAL LE 0).ZG7A3  OK                     00119800
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00119900
&ZMS                SETC  '"STATE'                                      00120000
&ZMS                SETC  '&ZMS.=&STATE"'                               00120100
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00120200
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00120300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00120400
.ZG7A3              ANOP  ,                                             00120500
.*-------------------------------------------------------------------   00120600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00120700
.ZG8                ANOP  ,                                             00120800
&ZTLC               SETC 'WAITING'                                      00120900
                    AIF   ('&STATE(1)' NE '&ZTLC').ZG72                 00121000
&XSTATE             SETC  'WAITING'   SET KEYWORD                       00121100
                    AIF   (N'&STATE LE 1).ZG8A  CK NUM                  00121200
&ZMS                SETC  '"STATE='                                     00121300
&ZMS                SETC  '&ZMS.&STATE"'                                00121400
&ZMS                SETC  '&ZMS "STATE"'                                00121500
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00121600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00121700
.ZG8A               ANOP  ,                                             00121800
.*------------------------------------------------------------------    00121900
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00122000
&XRESOURCE          SETC  ''          INITIALIZE XVARIABLE              00122100
.*-------------------------------------------------------------------   00122200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00122300
.ZG11               ANOP  ,                                             00122400
                    AIF   (K'&RESOURCE(1) LE 0).ZG11A                   00122500
&ZTLC               SETC 'LATCH'                                        00122600
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG12              00122700
&XRESOURCE          SETC  'LATCH'     SET KEYWORD                       00122800
                    AIF   (N'&RESOURCE LE 1).ZG11A  CK NUM              00122900
&ZMS                SETC  '"RESOURCE='                                  00123000
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00123100
&ZMS                SETC  '&ZMS "RESOURCE"'                             00123200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00123300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00123400
.ZG11A              ANOP  ,                                             00123500
.*------------------------------------------------------------------    00123600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00123700
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00123800
.ZG11A0             AIF   (K'&ASYNC LE 0).ZG11A1  OK                    00123900
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00124000
.ZG11A1             AIF   (K'&ZCVAL LE 0).ZG11A2  OK                    00124100
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00124200
&ZMS                SETC  '"RESOURCE'                                   00124300
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00124400
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00124500
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00124600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00124700
.ZG11A2             ANOP  ,                                             00124800
.*-------------------------------------------------------------------   00124900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00125000
.ZG12               ANOP  ,                                             00125100
&ZTLC               SETC 'LOCK'                                         00125200
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG13              00125300
&XRESOURCE          SETC  'LOCK'      SET KEYWORD                       00125400
                    AIF   (N'&RESOURCE LE 1).ZG12A  CK NUM              00125500
&ZMS                SETC  '"RESOURCE='                                  00125600
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00125700
&ZMS                SETC  '&ZMS "RESOURCE"'                             00125800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00125900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00126000
.ZG12A              ANOP  ,                                             00126100
.*------------------------------------------------------------------    00126200
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00126300
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00126400
.ZG12A0             AIF   (K'&ASYNC LE 0).ZG12A1  OK                    00126500
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00126600
.ZG12A1             AIF   (K'&ZCVAL LE 0).ZG12A2  OK                    00126700
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00126800
&ZMS                SETC  '"RESOURCE'                                   00126900
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00127000
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00127100
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00127200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00127300
.ZG12A2             ANOP  ,                                             00127400
.*-------------------------------------------------------------------   00127500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00127600
.ZG13               ANOP  ,                                             00127700
&ZTLC               SETC 'IO'                                           00127800
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG14              00127900
&XRESOURCE          SETC  'IO'        SET KEYWORD                       00128000
                    AIF   (N'&RESOURCE LE 1).ZG13A  CK NUM              00128100
&ZMS                SETC  '"RESOURCE='                                  00128200
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00128300
&ZMS                SETC  '&ZMS "RESOURCE"'                             00128400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00128500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00128600
.ZG13A              ANOP  ,                                             00128700
.*------------------------------------------------------------------    00128800
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00128900
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00129000
.ZG13A0             AIF   (K'&ASYNC LE 0).ZG13A1  OK                    00129100
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00129200
.ZG13A1             AIF   (K'&ZCVAL LE 0).ZG13A2  OK                    00129300
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00129400
&ZMS                SETC  '"RESOURCE'                                   00129500
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00129600
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00129700
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00129800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00129900
.ZG13A2             ANOP  ,                                             00130000
.*-------------------------------------------------------------------   00130100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00130200
.ZG14               ANOP  ,                                             00130300
&ZTLC               SETC 'CONV'                                         00130400
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG20              00130500
&XRESOURCE          SETC  'CONV'      SET KEYWORD                       00130600
                    AIF   (N'&RESOURCE LE 1).ZG14A  CK NUM              00130700
&ZMS                SETC  '"RESOURCE='                                  00130800
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00130900
&ZMS                SETC  '&ZMS "RESOURCE"'                             00131000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00131100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00131200
.ZG14A              ANOP  ,                                             00131300
.*----------------------------------------------------------------***   00131400
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00131500
                    AIF   (N'&ASYNC LE 1).ZG16A  CK NUM                 00131600
&ZMS                SETC  '"ASYNC='                                     00131700
&ZMS                SETC  '&ZMS.&ASYNC"'                                00131800
&ZMS                SETC  '&ZMS "ASYNC"'                                00131900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00132000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00132100
.ZG16A              ANOP  ,                                             00132200
.*-------------------------------------------------------------------   00132300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00132400
&XASYNC             SETC  ''          INITIALIZE XVARIABLE              00132500
.ZG17A   AIF   ('&ASYNC(1)' NE 'NO').ZG18A                              00132600
&XASYNC             SETC  'NO'        SET KEYWORD                       00132700
.*-------------------------------------------------------------------   00132800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00132900
.ZG18A   AIF   ('&ASYNC(1)' NE 'YES').ZG19A                             00133000
&XASYNC             SETC  'YES'       SET KEYWORD                       00133100
.*-------------------------------------------------------------------   00133200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00133300
.ZG19A              AIF   (K'&XASYNC GT 0).ZG19C  KEYWORD               00133400
                    AIF   (K'&ASYNC(1) LE 0).ZG19B                      00133500
&ZMS                SETC  '"ASYNC='                                     00133600
&ZMS                SETC  '&ZMS.&ASYNC"'                                00133700
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00133800
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00133900
&ZMS                SETC  '&ZMS "NO"'                                   00134000
&ZMS                SETC  '&ZMS OR "YES".'                              00134100
                    MNOTE 8,' &ZMS '                                    00134200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00134300
.ZG19B              ANOP  ,                                             00134400
&XASYNC             SETC  'NO'        SET DEFAULT KEYWORD               00134500
.ZG19C              ANOP  ,                                             00134600
&ZXASYNC            SETC  'INPUT'     SET IN/OUTPUT                     00134700
.*-------------------------------------------------------------------   00134800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00134900
.ZG20               ANOP  ,                                             00135000
&ZTLC               SETC 'DISTRIB'                                      00135100
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG26              00135200
&XRESOURCE          SETC  'DISTRIB'   SET KEYWORD                       00135300
                    AIF   (N'&RESOURCE LE 1).ZG20A  CK NUM              00135400
&ZMS                SETC  '"RESOURCE='                                  00135500
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00135600
&ZMS                SETC  '&ZMS "RESOURCE"'                             00135700
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00135800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00135900
.ZG20A              ANOP  ,                                             00136000
.*----------------------------------------------------------------***   00136100
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00136200
                    AIF   (N'&ASYNC LE 1).ZG22A  CK NUM                 00136300
&ZMS                SETC  '"ASYNC='                                     00136400
&ZMS                SETC  '&ZMS.&ASYNC"'                                00136500
&ZMS                SETC  '&ZMS "ASYNC"'                                00136600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00136700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00136800
.ZG22A              ANOP  ,                                             00136900
.*-------------------------------------------------------------------   00137000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00137100
&XASYNC             SETC  ''          INITIALIZE XVARIABLE              00137200
.ZG23A   AIF   ('&ASYNC(1)' NE 'NO').ZG24A                              00137300
&XASYNC             SETC  'NO'        SET KEYWORD                       00137400
.*-------------------------------------------------------------------   00137500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00137600
.ZG24A   AIF   ('&ASYNC(1)' NE 'YES').ZG25A                             00137700
&XASYNC             SETC  'YES'       SET KEYWORD                       00137800
.*-------------------------------------------------------------------   00137900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00138000
.ZG25A              AIF   (K'&XASYNC GT 0).ZG25C  KEYWORD               00138100
                    AIF   (K'&ASYNC(1) LE 0).ZG25B                      00138200
&ZMS                SETC  '"ASYNC='                                     00138300
&ZMS                SETC  '&ZMS.&ASYNC"'                                00138400
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00138500
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00138600
&ZMS                SETC  '&ZMS "NO"'                                   00138700
&ZMS                SETC  '&ZMS OR "YES".'                              00138800
                    MNOTE 8,' &ZMS '                                    00138900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00139000
.ZG25B              ANOP  ,                                             00139100
&XASYNC             SETC  'NO'        SET DEFAULT KEYWORD               00139200
.ZG25C              ANOP  ,                                             00139300
&ZXASYNC            SETC  'INPUT'     SET IN/OUTPUT                     00139400
.*-------------------------------------------------------------------   00139500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00139600
.ZG26               ANOP  ,                                             00139700
&ZTLC               SETC 'SESS_LOCALMVS'                                00139800
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG32              00139900
&XRESOURCE          SETC  'SESS_LOCALMVS'       SET KEYWORD             00140000
                    AIF   (N'&RESOURCE LE 1).ZG26A  CK NUM              00140100
&ZMS                SETC  '"RESOURCE='                                  00140200
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00140300
&ZMS                SETC  '&ZMS "RESOURCE"'                             00140400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00140500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00140600
.ZG26A              ANOP  ,                                             00140700
.*----------------------------------------------------------------***   00140800
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00140900
                    AIF   (N'&ASYNC LE 1).ZG28A  CK NUM                 00141000
&ZMS                SETC  '"ASYNC='                                     00141100
&ZMS                SETC  '&ZMS.&ASYNC"'                                00141200
&ZMS                SETC  '&ZMS "ASYNC"'                                00141300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00141400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00141500
.ZG28A              ANOP  ,                                             00141600
.*-------------------------------------------------------------------   00141700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00141800
&XASYNC             SETC  ''          INITIALIZE XVARIABLE              00141900
.ZG29A   AIF   ('&ASYNC(1)' NE 'NO').ZG30A                              00142000
&XASYNC             SETC  'NO'        SET KEYWORD                       00142100
.*-------------------------------------------------------------------   00142200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00142300
.ZG30A   AIF   ('&ASYNC(1)' NE 'YES').ZG31A                             00142400
&XASYNC             SETC  'YES'       SET KEYWORD                       00142500
.*-------------------------------------------------------------------   00142600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00142700
.ZG31A              AIF   (K'&XASYNC GT 0).ZG31C  KEYWORD               00142800
                    AIF   (K'&ASYNC(1) LE 0).ZG31B                      00142900
&ZMS                SETC  '"ASYNC='                                     00143000
&ZMS                SETC  '&ZMS.&ASYNC"'                                00143100
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00143200
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00143300
&ZMS                SETC  '&ZMS "NO"'                                   00143400
&ZMS                SETC  '&ZMS OR "YES".'                              00143500
                    MNOTE 8,' &ZMS '                                    00143600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00143700
.ZG31B              ANOP  ,                                             00143800
&XASYNC             SETC  'NO'        SET DEFAULT KEYWORD               00143900
.ZG31C              ANOP  ,                                             00144000
&ZXASYNC            SETC  'INPUT'     SET IN/OUTPUT                     00144100
.*-------------------------------------------------------------------   00144200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00144300
.ZG32               ANOP  ,                                             00144400
&ZTLC               SETC 'SESS_NETWORK'                                 00144500
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG38              00144600
&XRESOURCE          SETC  'SESS_NETWORK'        SET KEYWORD             00144700
                    AIF   (N'&RESOURCE LE 1).ZG32A  CK NUM              00144800
&ZMS                SETC  '"RESOURCE='                                  00144900
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00145000
&ZMS                SETC  '&ZMS "RESOURCE"'                             00145100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00145200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00145300
.ZG32A              ANOP  ,                                             00145400
.*----------------------------------------------------------------***   00145500
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00145600
                    AIF   (N'&ASYNC LE 1).ZG34A  CK NUM                 00145700
&ZMS                SETC  '"ASYNC='                                     00145800
&ZMS                SETC  '&ZMS.&ASYNC"'                                00145900
&ZMS                SETC  '&ZMS "ASYNC"'                                00146000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00146100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00146200
.ZG34A              ANOP  ,                                             00146300
.*-------------------------------------------------------------------   00146400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00146500
&XASYNC             SETC  ''          INITIALIZE XVARIABLE              00146600
.ZG35A   AIF   ('&ASYNC(1)' NE 'NO').ZG36A                              00146700
&XASYNC             SETC  'NO'        SET KEYWORD                       00146800
.*-------------------------------------------------------------------   00146900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00147000
.ZG36A   AIF   ('&ASYNC(1)' NE 'YES').ZG37A                             00147100
&XASYNC             SETC  'YES'       SET KEYWORD                       00147200
.*-------------------------------------------------------------------   00147300
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00147400
.ZG37A              AIF   (K'&XASYNC GT 0).ZG37C  KEYWORD               00147500
                    AIF   (K'&ASYNC(1) LE 0).ZG37B                      00147600
&ZMS                SETC  '"ASYNC='                                     00147700
&ZMS                SETC  '&ZMS.&ASYNC"'                                00147800
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00147900
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00148000
&ZMS                SETC  '&ZMS "NO"'                                   00148100
&ZMS                SETC  '&ZMS OR "YES".'                              00148200
                    MNOTE 8,' &ZMS '                                    00148300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00148400
.ZG37B              ANOP  ,                                             00148500
&XASYNC             SETC  'NO'        SET DEFAULT KEYWORD               00148600
.ZG37C              ANOP  ,                                             00148700
&ZXASYNC            SETC  'INPUT'     SET IN/OUTPUT                     00148800
.*-------------------------------------------------------------------   00148900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00149000
.ZG38               ANOP  ,                                             00149100
&ZTLC               SETC 'SESS_SYSPLEX'                                 00149200
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG44              00149300
&XRESOURCE          SETC  'SESS_SYSPLEX'        SET KEYWORD             00149400
                    AIF   (N'&RESOURCE LE 1).ZG38A  CK NUM              00149500
&ZMS                SETC  '"RESOURCE='                                  00149600
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00149700
&ZMS                SETC  '&ZMS "RESOURCE"'                             00149800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00149900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00150000
.ZG38A              ANOP  ,                                             00150100
.*----------------------------------------------------------------***   00150200
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00150300
                    AIF   (N'&ASYNC LE 1).ZG40A  CK NUM                 00150400
&ZMS                SETC  '"ASYNC='                                     00150500
&ZMS                SETC  '&ZMS.&ASYNC"'                                00150600
&ZMS                SETC  '&ZMS "ASYNC"'                                00150700
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00150800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00150900
.ZG40A              ANOP  ,                                             00151000
.*-------------------------------------------------------------------   00151100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00151200
&XASYNC             SETC  ''          INITIALIZE XVARIABLE              00151300
.ZG41A   AIF   ('&ASYNC(1)' NE 'NO').ZG42A                              00151400
&XASYNC             SETC  'NO'        SET KEYWORD                       00151500
.*-------------------------------------------------------------------   00151600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00151700
.ZG42A   AIF   ('&ASYNC(1)' NE 'YES').ZG43A                             00151800
&XASYNC             SETC  'YES'       SET KEYWORD                       00151900
.*-------------------------------------------------------------------   00152000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00152100
.ZG43A              AIF   (K'&XASYNC GT 0).ZG43C  KEYWORD               00152200
                    AIF   (K'&ASYNC(1) LE 0).ZG43B                      00152300
&ZMS                SETC  '"ASYNC='                                     00152400
&ZMS                SETC  '&ZMS.&ASYNC"'                                00152500
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00152600
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00152700
&ZMS                SETC  '&ZMS "NO"'                                   00152800
&ZMS                SETC  '&ZMS OR "YES".'                              00152900
                    MNOTE 8,' &ZMS '                                    00153000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00153100
.ZG43B              ANOP  ,                                             00153200
&XASYNC             SETC  'NO'        SET DEFAULT KEYWORD               00153300
.ZG43C              ANOP  ,                                             00153400
&ZXASYNC            SETC  'INPUT'     SET IN/OUTPUT                     00153500
.*-------------------------------------------------------------------   00153600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00153700
.ZG44               ANOP  ,                                             00153800
&ZTLC               SETC 'TIMER'                                        00153900
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG45              00154000
&XRESOURCE          SETC  'TIMER'     SET KEYWORD                       00154100
                    AIF   (N'&RESOURCE LE 1).ZG44A  CK NUM              00154200
&ZMS                SETC  '"RESOURCE='                                  00154300
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00154400
&ZMS                SETC  '&ZMS "RESOURCE"'                             00154500
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00154600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00154700
.ZG44A              ANOP  ,                                             00154800
.*------------------------------------------------------------------    00154900
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00155000
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00155100
.ZG44A0             AIF   (K'&ASYNC LE 0).ZG44A1  OK                    00155200
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00155300
.ZG44A1             AIF   (K'&ZCVAL LE 0).ZG44A2  OK                    00155400
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00155500
&ZMS                SETC  '"RESOURCE'                                   00155600
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00155700
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00155800
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00155900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00156000
.ZG44A2             ANOP  ,                                             00156100
.*-------------------------------------------------------------------   00156200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00156300
.ZG45               ANOP  ,                                             00156400
&ZTLC               SETC 'OTHER_PRODUCT'                                00156500
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG51              00156600
&XRESOURCE          SETC  'OTHER_PRODUCT'       SET KEYWORD             00156700
                    AIF   (N'&RESOURCE LE 1).ZG45A  CK NUM              00156800
&ZMS                SETC  '"RESOURCE='                                  00156900
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00157000
&ZMS                SETC  '&ZMS "RESOURCE"'                             00157100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00157200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00157300
.ZG45A              ANOP  ,                                             00157400
.*----------------------------------------------------------------***   00157500
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00157600
                    AIF   (N'&ASYNC LE 1).ZG47A  CK NUM                 00157700
&ZMS                SETC  '"ASYNC='                                     00157800
&ZMS                SETC  '&ZMS.&ASYNC"'                                00157900
&ZMS                SETC  '&ZMS "ASYNC"'                                00158000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00158100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00158200
.ZG47A              ANOP  ,                                             00158300
.*-------------------------------------------------------------------   00158400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00158500
&XASYNC             SETC  ''          INITIALIZE XVARIABLE              00158600
.ZG48A   AIF   ('&ASYNC(1)' NE 'NO').ZG49A                              00158700
&XASYNC             SETC  'NO'        SET KEYWORD                       00158800
.*-------------------------------------------------------------------   00158900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00159000
.ZG49A   AIF   ('&ASYNC(1)' NE 'YES').ZG50A                             00159100
&XASYNC             SETC  'YES'       SET KEYWORD                       00159200
.*-------------------------------------------------------------------   00159300
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00159400
.ZG50A              AIF   (K'&XASYNC GT 0).ZG50C  KEYWORD               00159500
                    AIF   (K'&ASYNC(1) LE 0).ZG50B                      00159600
&ZMS                SETC  '"ASYNC='                                     00159700
&ZMS                SETC  '&ZMS.&ASYNC"'                                00159800
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00159900
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00160000
&ZMS                SETC  '&ZMS "NO"'                                   00160100
&ZMS                SETC  '&ZMS OR "YES".'                              00160200
                    MNOTE 8,' &ZMS '                                    00160300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00160400
.ZG50B              ANOP  ,                                             00160500
&XASYNC             SETC  'NO'        SET DEFAULT KEYWORD               00160600
.ZG50C              ANOP  ,                                             00160700
&ZXASYNC            SETC  'INPUT'     SET IN/OUTPUT                     00160800
.*-------------------------------------------------------------------   00160900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00161000
.ZG51               ANOP  ,                                             00161100
&ZTLC               SETC 'MISC'                                         00161200
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG52              00161300
&XRESOURCE          SETC  'MISC'      SET KEYWORD                       00161400
                    AIF   (N'&RESOURCE LE 1).ZG51A  CK NUM              00161500
&ZMS                SETC  '"RESOURCE='                                  00161600
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00161700
&ZMS                SETC  '&ZMS "RESOURCE"'                             00161800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00161900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00162000
.ZG51A              ANOP  ,                                             00162100
.*------------------------------------------------------------------    00162200
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00162300
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00162400
.ZG51A0             AIF   (K'&ASYNC LE 0).ZG51A1  OK                    00162500
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00162600
.ZG51A1             AIF   (K'&ZCVAL LE 0).ZG51A2  OK                    00162700
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00162800
&ZMS                SETC  '"RESOURCE'                                   00162900
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00163000
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00163100
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00163200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00163300
.ZG51A2             ANOP  ,                                             00163400
.*-------------------------------------------------------------------   00163500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00163600
.ZG52               ANOP  ,                                             00163700
&ZTLC               SETC 'SSL_THREAD'                                   00163800
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG53              00163900
&XRESOURCE          SETC  'SSL_THREAD'          SET KEYWORD             00164000
                    AIF   (N'&RESOURCE LE 1).ZG52A  CK NUM              00164100
&ZMS                SETC  '"RESOURCE='                                  00164200
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00164300
&ZMS                SETC  '&ZMS "RESOURCE"'                             00164400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00164500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00164600
.ZG52A              ANOP  ,                                             00164700
.*------------------------------------------------------------------    00164800
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00164900
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00165000
.ZG52A0             AIF   (K'&ASYNC LE 0).ZG52A1  OK                    00165100
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00165200
.ZG52A1             AIF   (K'&ZCVAL LE 0).ZG52A2  OK                    00165300
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00165400
&ZMS                SETC  '"RESOURCE'                                   00165500
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00165600
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00165700
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00165800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00165900
.ZG52A2             ANOP  ,                                             00166000
.*-------------------------------------------------------------------   00166100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00166200
.ZG53               ANOP  ,                                             00166300
&ZTLC               SETC 'REG_THREAD'                                   00166400
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG54              00166500
&XRESOURCE          SETC  'REG_THREAD'          SET KEYWORD             00166600
                    AIF   (N'&RESOURCE LE 1).ZG53A  CK NUM              00166700
&ZMS                SETC  '"RESOURCE='                                  00166800
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00166900
&ZMS                SETC  '&ZMS "RESOURCE"'                             00167000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00167100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00167200
.ZG53A              ANOP  ,                                             00167300
.*------------------------------------------------------------------    00167400
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00167500
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00167600
.ZG53A0             AIF   (K'&ASYNC LE 0).ZG53A1  OK                    00167700
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00167800
.ZG53A1             AIF   (K'&ZCVAL LE 0).ZG53A2  OK                    00167900
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00168000
&ZMS                SETC  '"RESOURCE'                                   00168100
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00168200
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00168300
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00168400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00168500
.ZG53A2             ANOP  ,                                             00168600
.*-------------------------------------------------------------------   00168700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00168800
.ZG54               ANOP  ,                                             00168900
&ZTLC               SETC 'REG_TO_WRKTB'                                 00169000
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG55              00169100
&XRESOURCE          SETC  'REG_TO_WRKTB'        SET KEYWORD             00169200
                    AIF   (N'&RESOURCE LE 1).ZG54A  CK NUM              00169300
&ZMS                SETC  '"RESOURCE='                                  00169400
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00169500
&ZMS                SETC  '&ZMS "RESOURCE"'                             00169600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00169700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00169800
.ZG54A              ANOP  ,                                             00169900
.*------------------------------------------------------------------    00170000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00170100
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00170200
.ZG54A0             AIF   (K'&ASYNC LE 0).ZG54A1  OK                    00170300
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00170400
.ZG54A1             AIF   (K'&ZCVAL LE 0).ZG54A2  OK                    00170500
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00170600
&ZMS                SETC  '"RESOURCE'                                   00170700
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00170800
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00170900
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00171000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00171100
.ZG54A2             ANOP  ,                                             00171200
.*-------------------------------------------------------------------   00171300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00171400
.ZG55               ANOP  ,                                             00171500
&ZTLC               SETC 'TYPE1'                                        00171600
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG56              00171700
&XRESOURCE          SETC  'TYPE1'     SET KEYWORD                       00171800
                    AIF   (N'&RESOURCE LE 1).ZG55A  CK NUM              00171900
&ZMS                SETC  '"RESOURCE='                                  00172000
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00172100
&ZMS                SETC  '&ZMS "RESOURCE"'                             00172200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00172300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00172400
.ZG55A              ANOP  ,                                             00172500
.*------------------------------------------------------------------    00172600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00172700
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00172800
.ZG55A0             AIF   (K'&ASYNC LE 0).ZG55A1  OK                    00172900
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00173000
.ZG55A1             AIF   (K'&ZCVAL LE 0).ZG55A2  OK                    00173100
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00173200
&ZMS                SETC  '"RESOURCE'                                   00173300
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00173400
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00173500
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00173600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00173700
.ZG55A2             ANOP  ,                                             00173800
.*-------------------------------------------------------------------   00173900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00174000
.ZG56               ANOP  ,                                             00174100
&ZTLC               SETC 'TYPE2'                                        00174200
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG57              00174300
&XRESOURCE          SETC  'TYPE2'     SET KEYWORD                       00174400
                    AIF   (N'&RESOURCE LE 1).ZG56A  CK NUM              00174500
&ZMS                SETC  '"RESOURCE='                                  00174600
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00174700
&ZMS                SETC  '&ZMS "RESOURCE"'                             00174800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00174900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00175000
.ZG56A              ANOP  ,                                             00175100
.*------------------------------------------------------------------    00175200
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00175300
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00175400
.ZG56A0             AIF   (K'&ASYNC LE 0).ZG56A1  OK                    00175500
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00175600
.ZG56A1             AIF   (K'&ZCVAL LE 0).ZG56A2  OK                    00175700
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00175800
&ZMS                SETC  '"RESOURCE'                                   00175900
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00176000
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00176100
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00176200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00176300
.ZG56A2             ANOP  ,                                             00176400
.*-------------------------------------------------------------------   00176500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00176600
.ZG57               ANOP  ,                                             00176700
&ZTLC               SETC 'TYPE3'                                        00176800
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG58              00176900
&XRESOURCE          SETC  'TYPE3'     SET KEYWORD                       00177000
                    AIF   (N'&RESOURCE LE 1).ZG57A  CK NUM              00177100
&ZMS                SETC  '"RESOURCE='                                  00177200
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00177300
&ZMS                SETC  '&ZMS "RESOURCE"'                             00177400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00177500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00177600
.ZG57A              ANOP  ,                                             00177700
.*------------------------------------------------------------------    00177800
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00177900
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00178000
.ZG57A0             AIF   (K'&ASYNC LE 0).ZG57A1  OK                    00178100
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00178200
.ZG57A1             AIF   (K'&ZCVAL LE 0).ZG57A2  OK                    00178300
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00178400
&ZMS                SETC  '"RESOURCE'                                   00178500
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00178600
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00178700
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00178800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00178900
.ZG57A2             ANOP  ,                                             00179000
.*-------------------------------------------------------------------   00179100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00179200
.ZG58               ANOP  ,                                             00179300
&ZTLC               SETC 'TYPE4'                                        00179400
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG59              00179500
&XRESOURCE          SETC  'TYPE4'     SET KEYWORD                       00179600
                    AIF   (N'&RESOURCE LE 1).ZG58A  CK NUM              00179700
&ZMS                SETC  '"RESOURCE='                                  00179800
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00179900
&ZMS                SETC  '&ZMS "RESOURCE"'                             00180000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00180100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00180200
.ZG58A              ANOP  ,                                             00180300
.*------------------------------------------------------------------    00180400
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00180500
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00180600
.ZG58A0             AIF   (K'&ASYNC LE 0).ZG58A1  OK                    00180700
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00180800
.ZG58A1             AIF   (K'&ZCVAL LE 0).ZG58A2  OK                    00180900
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00181000
&ZMS                SETC  '"RESOURCE'                                   00181100
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00181200
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00181300
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00181400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00181500
.ZG58A2             ANOP  ,                                             00181600
.*-------------------------------------------------------------------   00181700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00181800
.ZG59               ANOP  ,                                             00181900
&ZTLC               SETC 'TYPE5'                                        00182000
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG60              00182100
&XRESOURCE          SETC  'TYPE5'     SET KEYWORD                       00182200
                    AIF   (N'&RESOURCE LE 1).ZG59A  CK NUM              00182300
&ZMS                SETC  '"RESOURCE='                                  00182400
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00182500
&ZMS                SETC  '&ZMS "RESOURCE"'                             00182600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00182700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00182800
.ZG59A              ANOP  ,                                             00182900
.*------------------------------------------------------------------    00183000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00183100
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00183200
.ZG59A0             AIF   (K'&ASYNC LE 0).ZG59A1  OK                    00183300
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00183400
.ZG59A1             AIF   (K'&ZCVAL LE 0).ZG59A2  OK                    00183500
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00183600
&ZMS                SETC  '"RESOURCE'                                   00183700
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00183800
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00183900
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00184000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00184100
.ZG59A2             ANOP  ,                                             00184200
.*-------------------------------------------------------------------   00184300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00184400
.ZG60               ANOP  ,                                             00184500
&ZTLC               SETC 'TYPE6'                                        00184600
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG61              00184700
&XRESOURCE          SETC  'TYPE6'     SET KEYWORD                       00184800
                    AIF   (N'&RESOURCE LE 1).ZG60A  CK NUM              00184900
&ZMS                SETC  '"RESOURCE='                                  00185000
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00185100
&ZMS                SETC  '&ZMS "RESOURCE"'                             00185200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00185300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00185400
.ZG60A              ANOP  ,                                             00185500
.*------------------------------------------------------------------    00185600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00185700
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00185800
.ZG60A0             AIF   (K'&ASYNC LE 0).ZG60A1  OK                    00185900
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00186000
.ZG60A1             AIF   (K'&ZCVAL LE 0).ZG60A2  OK                    00186100
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00186200
&ZMS                SETC  '"RESOURCE'                                   00186300
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00186400
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00186500
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00186600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00186700
.ZG60A2             ANOP  ,                                             00186800
.*-------------------------------------------------------------------   00186900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00187000
.ZG61               ANOP  ,                                             00187100
&ZTLC               SETC 'TYPE7'                                        00187200
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG62              00187300
&XRESOURCE          SETC  'TYPE7'     SET KEYWORD                       00187400
                    AIF   (N'&RESOURCE LE 1).ZG61A  CK NUM              00187500
&ZMS                SETC  '"RESOURCE='                                  00187600
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00187700
&ZMS                SETC  '&ZMS "RESOURCE"'                             00187800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00187900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00188000
.ZG61A              ANOP  ,                                             00188100
.*------------------------------------------------------------------    00188200
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00188300
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00188400
.ZG61A0             AIF   (K'&ASYNC LE 0).ZG61A1  OK                    00188500
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00188600
.ZG61A1             AIF   (K'&ZCVAL LE 0).ZG61A2  OK                    00188700
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00188800
&ZMS                SETC  '"RESOURCE'                                   00188900
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00189000
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00189100
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00189200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00189300
.ZG61A2             ANOP  ,                                             00189400
.*-------------------------------------------------------------------   00189500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00189600
.ZG62               ANOP  ,                                             00189700
&ZTLC               SETC 'TYPE8'                                        00189800
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG63              00189900
&XRESOURCE          SETC  'TYPE8'     SET KEYWORD                       00190000
                    AIF   (N'&RESOURCE LE 1).ZG62A  CK NUM              00190100
&ZMS                SETC  '"RESOURCE='                                  00190200
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00190300
&ZMS                SETC  '&ZMS "RESOURCE"'                             00190400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00190500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00190600
.ZG62A              ANOP  ,                                             00190700
.*------------------------------------------------------------------    00190800
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00190900
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00191000
.ZG62A0             AIF   (K'&ASYNC LE 0).ZG62A1  OK                    00191100
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00191200
.ZG62A1             AIF   (K'&ZCVAL LE 0).ZG62A2  OK                    00191300
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00191400
&ZMS                SETC  '"RESOURCE'                                   00191500
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00191600
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00191700
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00191800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00191900
.ZG62A2             ANOP  ,                                             00192000
.*-------------------------------------------------------------------   00192100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00192200
.ZG63               ANOP  ,                                             00192300
&ZTLC               SETC 'TYPE9'                                        00192400
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG64              00192500
&XRESOURCE          SETC  'TYPE9'     SET KEYWORD                       00192600
                    AIF   (N'&RESOURCE LE 1).ZG63A  CK NUM              00192700
&ZMS                SETC  '"RESOURCE='                                  00192800
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00192900
&ZMS                SETC  '&ZMS "RESOURCE"'                             00193000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00193100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00193200
.ZG63A              ANOP  ,                                             00193300
.*------------------------------------------------------------------    00193400
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00193500
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00193600
.ZG63A0             AIF   (K'&ASYNC LE 0).ZG63A1  OK                    00193700
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00193800
.ZG63A1             AIF   (K'&ZCVAL LE 0).ZG63A2  OK                    00193900
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00194000
&ZMS                SETC  '"RESOURCE'                                   00194100
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00194200
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00194300
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00194400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00194500
.ZG63A2             ANOP  ,                                             00194600
.*-------------------------------------------------------------------   00194700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00194800
.ZG64               ANOP  ,                                             00194900
&ZTLC               SETC 'TYPE10'                                       00195000
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG65              00195100
&XRESOURCE          SETC  'TYPE10'    SET KEYWORD                       00195200
                    AIF   (N'&RESOURCE LE 1).ZG64A  CK NUM              00195300
&ZMS                SETC  '"RESOURCE='                                  00195400
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00195500
&ZMS                SETC  '&ZMS "RESOURCE"'                             00195600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00195700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00195800
.ZG64A              ANOP  ,                                             00195900
.*------------------------------------------------------------------    00196000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00196100
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00196200
.ZG64A0             AIF   (K'&ASYNC LE 0).ZG64A1  OK                    00196300
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00196400
.ZG64A1             AIF   (K'&ZCVAL LE 0).ZG64A2  OK                    00196500
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00196600
&ZMS                SETC  '"RESOURCE'                                   00196700
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00196800
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00196900
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00197000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00197100
.ZG64A2             ANOP  ,                                             00197200
.*-------------------------------------------------------------------   00197300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00197400
.ZG65               ANOP  ,                                             00197500
&ZTLC               SETC 'TYPE11'                                       00197600
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG66              00197700
&XRESOURCE          SETC  'TYPE11'    SET KEYWORD                       00197800
                    AIF   (N'&RESOURCE LE 1).ZG65A  CK NUM              00197900
&ZMS                SETC  '"RESOURCE='                                  00198000
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00198100
&ZMS                SETC  '&ZMS "RESOURCE"'                             00198200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00198300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00198400
.ZG65A              ANOP  ,                                             00198500
.*------------------------------------------------------------------    00198600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00198700
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00198800
.ZG65A0             AIF   (K'&ASYNC LE 0).ZG65A1  OK                    00198900
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00199000
.ZG65A1             AIF   (K'&ZCVAL LE 0).ZG65A2  OK                    00199100
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00199200
&ZMS                SETC  '"RESOURCE'                                   00199300
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00199400
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00199500
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00199600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00199700
.ZG65A2             ANOP  ,                                             00199800
.*-------------------------------------------------------------------   00199900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00200000
.ZG66               ANOP  ,                                             00200100
&ZTLC               SETC 'TYPE12'                                       00200200
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG67              00200300
&XRESOURCE          SETC  'TYPE12'    SET KEYWORD                       00200400
                    AIF   (N'&RESOURCE LE 1).ZG66A  CK NUM              00200500
&ZMS                SETC  '"RESOURCE='                                  00200600
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00200700
&ZMS                SETC  '&ZMS "RESOURCE"'                             00200800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00200900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00201000
.ZG66A              ANOP  ,                                             00201100
.*------------------------------------------------------------------    00201200
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00201300
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00201400
.ZG66A0             AIF   (K'&ASYNC LE 0).ZG66A1  OK                    00201500
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00201600
.ZG66A1             AIF   (K'&ZCVAL LE 0).ZG66A2  OK                    00201700
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00201800
&ZMS                SETC  '"RESOURCE'                                   00201900
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00202000
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00202100
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00202200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00202300
.ZG66A2             ANOP  ,                                             00202400
.*-------------------------------------------------------------------   00202500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00202600
.ZG67               ANOP  ,                                             00202700
&ZTLC               SETC 'TYPE13'                                       00202800
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG68              00202900
&XRESOURCE          SETC  'TYPE13'    SET KEYWORD                       00203000
                    AIF   (N'&RESOURCE LE 1).ZG67A  CK NUM              00203100
&ZMS                SETC  '"RESOURCE='                                  00203200
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00203300
&ZMS                SETC  '&ZMS "RESOURCE"'                             00203400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00203500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00203600
.ZG67A              ANOP  ,                                             00203700
.*------------------------------------------------------------------    00203800
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00203900
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00204000
.ZG67A0             AIF   (K'&ASYNC LE 0).ZG67A1  OK                    00204100
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00204200
.ZG67A1             AIF   (K'&ZCVAL LE 0).ZG67A2  OK                    00204300
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00204400
&ZMS                SETC  '"RESOURCE'                                   00204500
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00204600
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00204700
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00204800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00204900
.ZG67A2             ANOP  ,                                             00205000
.*-------------------------------------------------------------------   00205100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00205200
.ZG68               ANOP  ,                                             00205300
&ZTLC               SETC 'TYPE14'                                       00205400
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG69              00205500
&XRESOURCE          SETC  'TYPE14'    SET KEYWORD                       00205600
                    AIF   (N'&RESOURCE LE 1).ZG68A  CK NUM              00205700
&ZMS                SETC  '"RESOURCE='                                  00205800
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00205900
&ZMS                SETC  '&ZMS "RESOURCE"'                             00206000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00206100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00206200
.ZG68A              ANOP  ,                                             00206300
.*------------------------------------------------------------------    00206400
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00206500
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00206600
.ZG68A0             AIF   (K'&ASYNC LE 0).ZG68A1  OK                    00206700
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00206800
.ZG68A1             AIF   (K'&ZCVAL LE 0).ZG68A2  OK                    00206900
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00207000
&ZMS                SETC  '"RESOURCE'                                   00207100
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00207200
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00207300
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00207400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00207500
.ZG68A2             ANOP  ,                                             00207600
.*-------------------------------------------------------------------   00207700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00207800
.ZG69               ANOP  ,                                             00207900
&ZTLC               SETC 'TYPE15'                                       00208000
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG70              00208100
&XRESOURCE          SETC  'TYPE15'    SET KEYWORD                       00208200
                    AIF   (N'&RESOURCE LE 1).ZG69A  CK NUM              00208300
&ZMS                SETC  '"RESOURCE='                                  00208400
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00208500
&ZMS                SETC  '&ZMS "RESOURCE"'                             00208600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00208700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00208800
.ZG69A              ANOP  ,                                             00208900
.*------------------------------------------------------------------    00209000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00209100
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00209200
.ZG69A0             AIF   (K'&ASYNC LE 0).ZG69A1  OK                    00209300
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00209400
.ZG69A1             AIF   (K'&ZCVAL LE 0).ZG69A2  OK                    00209500
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00209600
&ZMS                SETC  '"RESOURCE'                                   00209700
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00209800
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00209900
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00210000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00210100
.ZG69A2             ANOP  ,                                             00210200
.*-------------------------------------------------------------------   00210300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00210400
.ZG70               ANOP  ,                                             00210500
&ZTLC               SETC 'BUFFER_POOL_IO'                               00210600
                    AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG71              00210700
&XRESOURCE          SETC  'BUFFER_POOL_IO'      SET KEYWORD             00210800
                    AIF   (N'&RESOURCE LE 1).ZG70A  CK NUM              00210900
&ZMS                SETC  '"RESOURCE='                                  00211000
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00211100
&ZMS                SETC  '&ZMS "RESOURCE"'                             00211200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00211300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00211400
.ZG70A              ANOP  ,                                             00211500
.*------------------------------------------------------------------    00211600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00211700
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00211800
.ZG70A0             AIF   (K'&ASYNC LE 0).ZG70A1  OK                    00211900
&ZCVAL              SETC '&ZCVAL ASYNC'         INCORRECT KEY USED      00212000
.ZG70A1             AIF   (K'&ZCVAL LE 0).ZG70A2  OK                    00212100
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00212200
&ZMS                SETC  '"RESOURCE'                                   00212300
&ZMS                SETC  '&ZMS.=&RESOURCE"'                            00212400
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00212500
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00212600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00212700
.ZG70A2             ANOP  ,                                             00212800
.*------------------------------------------------------------------    00212900
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00213000
.ZG71               ANOP  ,                                             00213100
&ZXRESOURCE         SETC  'INPUT'     SET IN/OUTPUT                     00213200
                    AIF   (K'&XRESOURCE GT 0).ZG71E  VALID ARG          00213300
                    AIF   (T'&RESOURCE EQ 'O').ZG71D  OMITTED           00213400
&ZASYSLNDX          SETA  0                                             00213500
.ZG71A              ANOP  ,           POSITIONAL MACRO KEY              00213600
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00213700
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG71C              00213800
&ZTLC               SETC 'RESOURCE'                                     00213900
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG71A     00214000
.ZG71B              ANOP  ,                                             00214100
&ZXRESOURCE         SETC  ''          RESET IN/OUTPUT                   00214200
&ZMS                SETC  'THE "RESOURCE" KEY'                          00214300
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00214400
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00214500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00214600
                    AGO   .ZG71E                                        00214700
.ZG71C              ANOP  ,                                             00214800
&ZXRESOURCE         SETC  ''          RESET IN/OUTPUT                   00214900
&ZMS                SETC  '"RESOURCE='                                  00215000
&ZMS                SETC  '&ZMS.&RESOURCE"'                             00215100
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00215200
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00215300
&ZMS                SETC  '&ZMS "LATCH",'                               00215400
&ZMS                SETC  '&ZMS "LOCK",'                                00215500
&ZMS                SETC  '&ZMS "IO",'                                  00215600
&ZMS                SETC  '&ZMS "CONV",'                                00215700
&ZMS                SETC  '&ZMS "DISTRIB",'                             00215800
&ZMS                SETC  '&ZMS "SESS_LOCALMVS",'                       00215900
&ZMS                SETC  '&ZMS "SESS_NETWORK",'                        00216000
&ZMS                SETC  '&ZMS "SESS_SYSPLEX",'                        00216100
&ZMS                SETC  '&ZMS "TIMER",'                               00216200
&ZMS                SETC  '&ZMS "OTHER_PRODUCT",'                       00216300
&ZMS                SETC  '&ZMS "MISC",'                                00216400
&ZMS                SETC  '&ZMS "SSL_THREAD",'                          00216500
                    MNOTE 8,' &ZMS '                                    00216600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00216700
&ZMS                SETC  '(CONTINUED) '                                00216800
&ZMS                SETC  '&ZMS "REG_THREAD",'                          00216900
&ZMS                SETC  '&ZMS "REG_TO_WRKTB",'                        00217000
&ZMS                SETC  '&ZMS "TYPE1",'                               00217100
&ZMS                SETC  '&ZMS "TYPE2",'                               00217200
&ZMS                SETC  '&ZMS "TYPE3",'                               00217300
&ZMS                SETC  '&ZMS "TYPE4",'                               00217400
&ZMS                SETC  '&ZMS "TYPE5",'                               00217500
&ZMS                SETC  '&ZMS "TYPE6",'                               00217600
&ZMS                SETC  '&ZMS "TYPE7",'                               00217700
&ZMS                SETC  '&ZMS "TYPE8",'                               00217800
&ZMS                SETC  '&ZMS "TYPE9",'                               00217900
&ZMS                SETC  '&ZMS "TYPE10",'                              00218000
&ZMS                SETC  '&ZMS "TYPE11",'                              00218100
&ZMS                SETC  '&ZMS "TYPE12",'                              00218200
&ZMS                SETC  '&ZMS "TYPE13",'                              00218300
&ZMS                SETC  '&ZMS "TYPE14",'                              00218400
&ZMS                SETC  '&ZMS "TYPE15",'                              00218500
&ZMS                SETC  '&ZMS OR "BUFFER_POOL_IO".'                   00218600
                    MNOTE 8,' &ZMS '                                    00218700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00218800
                    AGO   .ZG71E                                        00218900
.ZG71D              ANOP  ,                                             00219000
&XRESOURCE          SETC  'LATCH'     SET DEFAULT KEYWORD               00219100
.ZG71E              ANOP  ,                                             00219200
.*------------------------------------------------------------------    00219300
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00219400
                    AIF   (K'&RESOURCE(1) GT 0).ZG71F  PARM             00219500
&XRESOURCE          SETC  ''          ENSURE NULL KEYWORD               00219600
&ZXRESOURCE         SETC  ''          RESET IN/OUTPUT                   00219700
&ZMS                SETC  'THE'                                         00219800
&ZMS                SETC  '&ZMS "RESOURCE" KEY AND ITS'                 00219900
&ZMS                SETC  '&ZMS ARGUMENT ARE REQUIRED.'                 00220000
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00220100
&ZMS                SETC  '&ZMS "LATCH",'                               00220200
&ZMS                SETC  '&ZMS "LOCK",'                                00220300
&ZMS                SETC  '&ZMS "IO",'                                  00220400
&ZMS                SETC  '&ZMS "CONV",'                                00220500
&ZMS                SETC  '&ZMS "DISTRIB",'                             00220600
&ZMS                SETC  '&ZMS "SESS_LOCALMVS",'                       00220700
&ZMS                SETC  '&ZMS "SESS_NETWORK",'                        00220800
&ZMS                SETC  '&ZMS "SESS_SYSPLEX",'                        00220900
&ZMS                SETC  '&ZMS "TIMER",'                               00221000
&ZMS                SETC  '&ZMS "OTHER_PRODUCT",'                       00221100
&ZMS                SETC  '&ZMS "MISC",'                                00221200
                    MNOTE 8,' &ZMS '                                    00221300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00221400
&ZMS                SETC  '(CONTINUED) '                                00221500
&ZMS                SETC  '&ZMS "SSL_THREAD",'                          00221600
&ZMS                SETC  '&ZMS "REG_THREAD",'                          00221700
&ZMS                SETC  '&ZMS "REG_TO_WRKTB",'                        00221800
&ZMS                SETC  '&ZMS "TYPE1",'                               00221900
&ZMS                SETC  '&ZMS "TYPE2",'                               00222000
&ZMS                SETC  '&ZMS "TYPE3",'                               00222100
&ZMS                SETC  '&ZMS "TYPE4",'                               00222200
&ZMS                SETC  '&ZMS "TYPE5",'                               00222300
&ZMS                SETC  '&ZMS "TYPE6",'                               00222400
&ZMS                SETC  '&ZMS "TYPE7",'                               00222500
&ZMS                SETC  '&ZMS "TYPE8",'                               00222600
&ZMS                SETC  '&ZMS "TYPE9",'                               00222700
&ZMS                SETC  '&ZMS "TYPE10",'                              00222800
&ZMS                SETC  '&ZMS "TYPE11",'                              00222900
&ZMS                SETC  '&ZMS "TYPE12",'                              00223000
&ZMS                SETC  '&ZMS "TYPE13",'                              00223100
&ZMS                SETC  '&ZMS "TYPE14",'                              00223200
&ZMS                SETC  '&ZMS "TYPE15",'                              00223300
&ZMS                SETC  '&ZMS OR "BUFFER_POOL_IO".'                   00223400
                    MNOTE 8,' &ZMS '                                    00223500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00223600
.ZG71F              ANOP  ,                                             00223700
.*------------------------------------------------------------------    00223800
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00223900
.ZG72               ANOP  ,                                             00224000
&ZXSTATE            SETC  'INPUT'     SET IN/OUTPUT                     00224100
                    AIF   (K'&XSTATE GT 0).ZG72E  VALID ARG             00224200
                    AIF   (T'&STATE EQ 'O').ZG72D  OMITTED              00224300
&ZASYSLNDX          SETA  0                                             00224400
.ZG72A              ANOP  ,           POSITIONAL MACRO KEY              00224500
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00224600
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG72C              00224700
&ZTLC               SETC 'STATE'                                        00224800
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG72A     00224900
.ZG72B              ANOP  ,                                             00225000
&ZXSTATE            SETC  ''          RESET IN/OUTPUT                   00225100
&ZMS                SETC  'THE "STATE" KEY'                             00225200
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00225300
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00225400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00225500
                    AGO   .ZG72E                                        00225600
.ZG72C              ANOP  ,                                             00225700
&ZXSTATE            SETC  ''          RESET IN/OUTPUT                   00225800
&ZMS                SETC  '"STATE='                                     00225900
&ZMS                SETC  '&ZMS.&STATE"'                                00226000
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00226100
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00226200
&ZMS                SETC  '&ZMS "FREE",'                                00226300
&ZMS                SETC  '&ZMS "ACTIVE",'                              00226400
&ZMS                SETC  '&ZMS "ACTIVE_APPL",'                         00226500
&ZMS                SETC  '&ZMS "READY",'                               00226600
&ZMS                SETC  '&ZMS "IDLE",'                                00226700
&ZMS                SETC  '&ZMS OR "WAITING".'                          00226800
                    MNOTE 8,' &ZMS '                                    00226900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00227000
                    AGO   .ZG72E                                        00227100
.ZG72D              ANOP  ,                                             00227200
&XSTATE             SETC  'FREE'      SET DEFAULT KEYWORD               00227300
.ZG72E              ANOP  ,                                             00227400
.*------------------------------------------------------------------    00227500
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00227600
                    AIF   (K'&STATE(1) GT 0).ZG72F  PARM                00227700
&XSTATE             SETC  ''          ENSURE NULL KEYWORD               00227800
&ZXSTATE            SETC  ''          RESET IN/OUTPUT                   00227900
&ZMS                SETC  'THE'                                         00228000
&ZMS                SETC  '&ZMS "STATE" KEY AND ITS'                    00228100
&ZMS                SETC  '&ZMS ARGUMENT ARE REQUIRED.'                 00228200
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00228300
&ZMS                SETC  '&ZMS "FREE",'                                00228400
&ZMS                SETC  '&ZMS "ACTIVE",'                              00228500
&ZMS                SETC  '&ZMS "ACTIVE_APPL",'                         00228600
&ZMS                SETC  '&ZMS "READY",'                               00228700
&ZMS                SETC  '&ZMS "IDLE",'                                00228800
&ZMS                SETC  '&ZMS OR "WAITING".'                          00228900
                    MNOTE 8,' &ZMS '                                    00229000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00229100
.ZG72F              ANOP  ,                                             00229200
.*----------------------------------------------------------------***   00229300
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00229400
                    AIF   (N'&EWLM LE 1).ZG74A  CK NUM                  00229500
&ZMS                SETC  '"EWLM='                                      00229600
&ZMS                SETC  '&ZMS.&EWLM"'                                 00229700
&ZMS                SETC  '&ZMS "EWLM"'                                 00229800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00229900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00230000
.ZG74A              ANOP  ,                                             00230100
.*-------------------------------------------------------------------   00230200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00230300
&XEWLM              SETC  ''          INITIALIZE XVARIABLE              00230400
.ZG75A   AIF   ('&EWLM(1)' NE 'NO').ZG76A                               00230500
&XEWLM              SETC  'NO'        SET KEYWORD                       00230600
.*-------------------------------------------------------------------   00230700
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00230800
.ZG76A              AIF   (K'&XEWLM GT 0).ZG76C  KEYWORD                00230900
                    AIF   (K'&EWLM(1) LE 0).ZG76B                       00231000
&ZMS                SETC  '"EWLM='                                      00231100
&ZMS                SETC  '&ZMS.&EWLM"'                                 00231200
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00231300
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00231400
&ZMS                SETC  '&ZMS "NO".'                                  00231500
                    MNOTE 8,' &ZMS '                                    00231600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00231700
.ZG76B              ANOP  ,                                             00231800
&XEWLM              SETC  'NO'        SET DEFAULT KEYWORD               00231900
.ZG76C              ANOP  ,                                             00232000
&ZXEWLM             SETC  'INPUT'     SET IN/OUTPUT                     00232100
.*----------------------------------------------------------------***   00232200
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00232300
&XUSEDMONTKNKEY     SETC  ''          INITIALIZE XVARIABLE              00232400
                    AIF   (K'&MONTKN LE 0).ZG78C                        00232500
&ZXUSEDMONTKNKEY    SETC  'INPUT'     SET IN/OUTPUT                     00232600
&XUSEDMONTKNKEY     SETC  'MONTKN'    SET XVARIABLE                     00232700
&ZXMONTKN           SETC  'INPUT'     SET IN/OUTPUT                     00232800
&XMONTKN            SETC  '&MONTKN(1)'          SET XVARIABLE PARM      00232900
                    AIF   (N'&MONTKN GT 1).ZG78A                        00233000
&XMONTKN            SETC  '&MONTKN'   SET XVARIABLE PARM                00233100
.ZG78A              AIF   (N'&MONTKN LE 1).ZG78B  CK NUM                00233200
&ZMS                SETC  '"MONTKN='                                    00233300
&ZMS                SETC  '&ZMS.&MONTKN"'                               00233400
&ZMS                SETC  '&ZMS "MONTKN"'                               00233500
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00233600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00233700
.ZG78B              AIF   (K'&XMONTKN GT 0).ZG78C  ONE PARM             00233800
&ZXUSEDMONTKNKEY    SETC  ''          RESET IN/OUTPUT                   00233900
&ZXMONTKN           SETC  ''          RESET IN/OUTPUT                   00234000
&ZMS                SETC  ' '                                           00234100
&ZMS                SETC  '&ZMS "MONTKN" KEY AND ITS'                   00234200
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00234300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00234400
.ZG78C              ANOP  ,                                             00234500
.*----------------------------------------------------------------***   00234600
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00234700
                    AIF   (K'&MONTKN64 LE 0).ZG79D  NO ME KEY           00234800
                    AIF   (N'&MONTKN64 LE 1).ZG79A  CK NUM              00234900
&ZMS                SETC  '"MONTKN64='                                  00235000
&ZMS                SETC  '&ZMS.&MONTKN64"'                             00235100
&ZMS                SETC  '&ZMS "MONTKN64"'                             00235200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00235300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00235400
.ZG79A              AIF   (K'&XUSEDMONTKNKEY LE 0).ZG79B                00235500
&ZMS                SETC  '"MONTKN64'                                   00235600
&ZMS                SETC  '&ZMS.=&MONTKN64"'                            00235700
&ZMS                SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'         00235800
&ZMS                SETC  '&ZMS "&XUSEDMONTKNKEY"'                      00235900
                    MNOTE 8,' &ZMS KEY.'                                00236000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00236100
                    AGO   .ZG79D                                        00236200
.*                                                                      00236300
.ZG79B              ANOP  ,                                             00236400
&ZXUSEDMONTKNKEY    SETC  'INPUT'     SET IN/OUTPUT                     00236500
&XUSEDMONTKNKEY     SETC  'MONTKN64'  SET XVARIABLE                     00236600
&ZXMONTKN64         SETC  'INPUT'     SET IN/OUTPUT                     00236700
&XMONTKN64          SETC  '&MONTKN64(1)'        SET XVARIABLE PARM      00236800
                    AIF   (N'&MONTKN64 GT 1).ZG79C                      00236900
&XMONTKN64          SETC  '&MONTKN64'           SET XVARIABLE PARM      00237000
.ZG79C              AIF   (K'&XMONTKN64 GT 0).ZG79D  ONE PARM           00237100
&ZXUSEDMONTKNKEY    SETC  ''          RESET IN/OUTPUT                   00237200
&ZXMONTKN64         SETC  ''          RESET IN/OUTPUT                   00237300
&ZMS                SETC  ' '                                           00237400
&ZMS                SETC  '&ZMS "MONTKN64" KEY AND ITS'                 00237500
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00237600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00237700
.ZG79D              ANOP  ,                                             00237800
.*------------------------------------------------------------------    00237900
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00238000
                    AIF   (K'&XUSEDMONTKNKEY GT 0).ZG80B                00238100
&ZXUSEDMONTKNKEY    SETC  ''          RESET IN/OUTPUT                   00238200
&ZXMONTKN           SETC  ''          RESET IN/OUTPUT                   00238300
&XUSEDMONTKNKEY     SETC  ''          ENSURE NULL                       00238400
&XMONTKN            SETC  ''          ENSURE NULL                       00238500
&ZMS                SETC  'ONE OF THE FOLLOWING'                        00238600
&ZMS                SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'           00238700
&ZMS                SETC  '&ZMS REQUIRED:'                              00238800
&ZMS                SETC  '&ZMS "MONTKN"'       VALID ME KEY            00238900
&ZMS                SETC  '&ZMS OR "MONTKN64".'  VALID ME KEY           00239000
                    MNOTE 8,' &ZMS '                                    00239100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00239200
.ZG80B              ANOP  ,                                             00239300
.*-------------------------------------------------------------------   00239400
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00239500
.ZG78ZY  AIF    ('&XUSEDMONTKNKEY' NE 'MONTKN').ZG79ZY                  00239600
.*-------------------------------------------------------------------   00239700
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00239800
                    AIF   (K'&ZXMONTKN LE 0).ZG78R  NOT I/O             00239900
                    AIF   ('&XMONTKN'(1,1) NE '(').ZG78R                00240000
&ZCGPR              SETC  '&XMONTKN'(2,K'&XMONTKN-2)                    00240100
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG78P                  00240200
                    AIF   (K'&ZCGPR GT 2).ZG78Q                         00240300
                    AIF   ('&ZCGPR' EQ '0').ZG78Q                       00240400
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00240500
                    AIF   (T'&ZCGPR NE 'N').ZG78Q  INVALID REG NAME     00240600
.ZG78P              ANOP  ,                                             00240700
                    AIF   (T'&ZCGPR NE 'N').ZG78R  NON NUMERIC          00240800
                    AIF   ('&ZCGPR' LT '2').ZG78Q                       00240900
                    AIF   ('&ZCGPR' LE '12').ZG78R                      00241000
.ZG78Q              ANOP  ,                                             00241100
&ZMS                SETC  '"MONTKN='                                    00241200
&ZMS                SETC  '&ZMS.&MONTKN"'                               00241300
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00241400
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00241500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00241600
.ZG78R              ANOP  ,                                             00241700
.*-------------------------------------------------------------------   00241800
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00241900
.ZG79ZY  AIF    ('&XUSEDMONTKNKEY' NE 'MONTKN64').ZG80ZY                00242000
.*-------------------------------------------------------------------   00242100
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00242200
                    AIF   (K'&ZXMONTKN64 LE 0).ZG79R  NOT I/O           00242300
                    AIF   ('&XMONTKN64'(1,1) NE '(').ZG79R              00242400
&ZCGPR              SETC  '&XMONTKN64'(2,K'&XMONTKN64-2)                00242500
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG79P                  00242600
                    AIF   (K'&ZCGPR GT 2).ZG79Q                         00242700
                    AIF   ('&ZCGPR' EQ '0').ZG79Q                       00242800
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00242900
                    AIF   (T'&ZCGPR NE 'N').ZG79Q  INVALID REG NAME     00243000
.ZG79P              ANOP  ,                                             00243100
                    AIF   (T'&ZCGPR NE 'N').ZG79R  NON NUMERIC          00243200
                    AIF   ('&ZCGPR' LT '2').ZG79Q                       00243300
                    AIF   ('&ZCGPR' LE '12').ZG79R                      00243400
.ZG79Q              ANOP  ,                                             00243500
&ZMS                SETC  '"MONTKN64='                                  00243600
&ZMS                SETC  '&ZMS.&MONTKN64"'                             00243700
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00243800
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00243900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00244000
.ZG79R              ANOP  ,                                             00244100
.*-------------------------------------------------------------------   00244200
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00244300
.ZG80ZY             ANOP ,            END MUTUALLY EXCLUSIVE KEYS       00244400
.*----------------------------------------------------------------***   00244500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00244600
                    AIF   (N'&RESTKN LE 1).ZG82A  CK NUM                00244700
&ZMS                SETC  '"RESTKN='                                    00244800
&ZMS                SETC  '&ZMS.&RESTKN"'                               00244900
&ZMS                SETC  '&ZMS "RESTKN"'                               00245000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00245100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00245200
.ZG82A              ANOP  ,                                             00245300
.*-------------------------------------------------------------------   00245400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00245500
&ZXRESTKN           SETC  'INPUT'     SET IN/OUTPUT                     00245600
&XRESTKN            SETC  'NORESTKN'                                    00245700
                    AIF   (K'&RESTKN(1) LE 0).ZG82B  PARM               00245800
&XRESTKN            SETC  '&RESTKN(1)'          SET XVARIABLE           00245900
                    AIF   (N'&RESTKN GT 1).ZG82B  MULTI                 00246000
&XRESTKN            SETC  '&RESTKN'   SET XVARIABLE                     00246100
.ZG82B              ANOP  ,                                             00246200
.*-------------------------------------------------------------------   00246300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00246400
                    AIF   (K'&ZXRESTKN LE 0).ZG82R  NOT I/O             00246500
         AIF   ('&XRESTKN' EQ 'NORESTKN').ZG82R                         00246600
                    AIF   ('&XRESTKN'(1,1) NE '(').ZG82R                00246700
&ZCGPR              SETC  '&XRESTKN'(2,K'&XRESTKN-2)                    00246800
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG82P                  00246900
                    AIF   (K'&ZCGPR GT 2).ZG82Q                         00247000
                    AIF   ('&ZCGPR' EQ '0').ZG82Q                       00247100
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00247200
                    AIF   (T'&ZCGPR NE 'N').ZG82Q  INVALID REG NAME     00247300
.ZG82P              ANOP  ,                                             00247400
                    AIF   (T'&ZCGPR NE 'N').ZG82R  NON NUMERIC          00247500
                    AIF   ('&ZCGPR' LT '2').ZG82Q                       00247600
                    AIF   ('&ZCGPR' LE '12').ZG82R                      00247700
.ZG82Q              ANOP  ,                                             00247800
&ZMS                SETC  '"RESTKN='                                    00247900
&ZMS                SETC  '&ZMS.&RESTKN"'                               00248000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00248100
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00248200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00248300
.ZG82R              ANOP  ,                                             00248400
.*------------------------------------------------------------------    00248500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00248600
&XRUNTIME_VER       SETC  ''          INITIALIZE XVARIABLE              00248700
.*-------------------------------------------------------------------   00248800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00248900
.ZG86               ANOP  ,                                             00249000
                    AIF   (K'&RUNTIME_VER(1) LE 0).ZG86A                00249100
&ZTLC               SETC 'SHORT_FORM'                                   00249200
                    AIF   ('&RUNTIME_VER(1)' NE '&ZTLC').ZG87           00249300
&XRUNTIME_VER       SETC  'SHORT_FORM'          SET KEYWORD             00249400
                    AIF   (N'&RUNTIME_VER LE 1).ZG86A  CK NUM           00249500
&ZMS                SETC  '"RUNTIME_VER='                               00249600
&ZMS                SETC  '&ZMS.&RUNTIME_VER"'                          00249700
&ZMS                SETC  '&ZMS "RUNTIME_VER"'                          00249800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00249900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00250000
.ZG86A              ANOP  ,                                             00250100
.*-------------------------------------------------------------------   00250200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00250300
.ZG87               ANOP  ,                                             00250400
&ZTLC               SETC 'MINIMAL'                                      00250500
                    AIF   ('&RUNTIME_VER(1)' NE '&ZTLC').ZG88           00250600
&XRUNTIME_VER       SETC  'MINIMAL'   SET KEYWORD                       00250700
                    AIF   (N'&RUNTIME_VER LE 1).ZG87A  CK NUM           00250800
&ZMS                SETC  '"RUNTIME_VER='                               00250900
&ZMS                SETC  '&ZMS.&RUNTIME_VER"'                          00251000
&ZMS                SETC  '&ZMS "RUNTIME_VER"'                          00251100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00251200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00251300
.ZG87A              ANOP  ,                                             00251400
.*------------------------------------------------------------------    00251500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00251600
.ZG88               ANOP  ,                                             00251700
&ZXRUNTIME_VER      SETC  'INPUT'     SET IN/OUTPUT                     00251800
                    AIF   (K'&XRUNTIME_VER GT 0).ZG88E  VALID ARG       00251900
                    AIF   (T'&RUNTIME_VER EQ 'O').ZG88D  OMITTED        00252000
&ZASYSLNDX          SETA  0                                             00252100
.ZG88A              ANOP  ,           POSITIONAL MACRO KEY              00252200
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00252300
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG88C              00252400
&ZTLC               SETC 'RUNTIME_VER'                                  00252500
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG88A     00252600
.ZG88B              ANOP  ,                                             00252700
&ZXRUNTIME_VER      SETC  ''          RESET IN/OUTPUT                   00252800
&ZMS                SETC  'THE "RUNTIME_VER" KEY'                       00252900
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00253000
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00253100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00253200
                    AGO   .ZG88E                                        00253300
.ZG88C              ANOP  ,                                             00253400
&ZXRUNTIME_VER      SETC  ''          RESET IN/OUTPUT                   00253500
&ZMS                SETC  '"RUNTIME_VER='                               00253600
&ZMS                SETC  '&ZMS.&RUNTIME_VER"'                          00253700
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00253800
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00253900
&ZMS                SETC  '&ZMS "SHORT_FORM"'                           00254000
&ZMS                SETC  '&ZMS OR "MINIMAL".'                          00254100
                    MNOTE 8,' &ZMS '                                    00254200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00254300
                    AGO   .ZG88E                                        00254400
.ZG88D              ANOP  ,                                             00254500
&XRUNTIME_VER       SETC  'SHORT_FORM'          SET DEFAULT KEYWORD     00254600
.ZG88E              ANOP  ,                                             00254700
.*------------------------------------------------------------------    00254800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00254900
&XCOMPCODE          SETC  ''          INITIALIZE XVARIABLE              00255000
.*-------------------------------------------------------------------   00255100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00255200
.ZG91               ANOP  ,                                             00255300
                    AIF   (K'&COMPCODE(1) LE 0).ZG91A                   00255400
&ZTLC               SETC 'YES'                                          00255500
                    AIF   ('&COMPCODE(1)' NE '&ZTLC').ZG92              00255600
&XCOMPCODE          SETC  'YES'       SET KEYWORD                       00255700
                    AIF   (N'&COMPCODE LE 1).ZG91A  CK NUM              00255800
&ZMS                SETC  '"COMPCODE='                                  00255900
&ZMS                SETC  '&ZMS.&COMPCODE"'                             00256000
&ZMS                SETC  '&ZMS "COMPCODE"'                             00256100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00256200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00256300
.ZG91A              ANOP  ,                                             00256400
.*-------------------------------------------------------------------   00256500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00256600
.ZG92               ANOP  ,                                             00256700
&ZTLC               SETC 'NO'                                           00256800
                    AIF   ('&COMPCODE(1)' NE '&ZTLC').ZG93              00256900
&XCOMPCODE          SETC  'NO'        SET KEYWORD                       00257000
                    AIF   (N'&COMPCODE LE 1).ZG92A  CK NUM              00257100
&ZMS                SETC  '"COMPCODE='                                  00257200
&ZMS                SETC  '&ZMS.&COMPCODE"'                             00257300
&ZMS                SETC  '&ZMS "COMPCODE"'                             00257400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00257500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00257600
.ZG92A              ANOP  ,                                             00257700
.*------------------------------------------------------------------    00257800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00257900
.ZG93               ANOP  ,                                             00258000
&ZXCOMPCODE         SETC  'INPUT'     SET IN/OUTPUT                     00258100
                    AIF   (K'&XCOMPCODE GT 0).ZG93E  VALID ARG          00258200
                    AIF   (T'&COMPCODE EQ 'O').ZG93D  OMITTED           00258300
&ZASYSLNDX          SETA  0                                             00258400
.ZG93A              ANOP  ,           POSITIONAL MACRO KEY              00258500
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00258600
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG93C              00258700
&ZTLC               SETC 'COMPCODE'                                     00258800
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG93A     00258900
.ZG93B              ANOP  ,                                             00259000
&ZXCOMPCODE         SETC  ''          RESET IN/OUTPUT                   00259100
&ZMS                SETC  'THE "COMPCODE" KEY'                          00259200
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00259300
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00259400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00259500
                    AGO   .ZG93E                                        00259600
.ZG93C              ANOP  ,                                             00259700
&ZXCOMPCODE         SETC  ''          RESET IN/OUTPUT                   00259800
&ZMS                SETC  '"COMPCODE='                                  00259900
&ZMS                SETC  '&ZMS.&COMPCODE"'                             00260000
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00260100
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00260200
&ZMS                SETC  '&ZMS "YES"'                                  00260300
&ZMS                SETC  '&ZMS OR "NO".'                               00260400
                    MNOTE 8,' &ZMS '                                    00260500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00260600
                    AGO   .ZG93E                                        00260700
.ZG93D              ANOP  ,                                             00260800
&XCOMPCODE          SETC  'YES'       SET DEFAULT KEYWORD               00260900
.ZG93E              ANOP  ,                                             00261000
.*----------------------------------------------------------------***   00261100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00261200
                    AIF   (N'&RETCODE LE 1).ZG95A  CK NUM               00261300
&ZMS                SETC  '"RETCODE='                                   00261400
&ZMS                SETC  '&ZMS.&RETCODE"'                              00261500
&ZMS                SETC  '&ZMS "RETCODE"'                              00261600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00261700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00261800
.ZG95A              ANOP  ,                                             00261900
.*-------------------------------------------------------------------   00262000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00262100
                    AIF   (K'&RETCODE(1) LE 0).ZG95C  NO PARM           00262200
&ZXRETCODE          SETC  'OUTPUT'    SET OUTPUT                        00262300
&XRETCODE           SETC  '&RETCODE(1)'         SET XVARIABLE           00262400
                    AIF   (N'&RETCODE GT 1).ZG95C                       00262500
&XRETCODE           SETC  '&RETCODE'  SET XVARIABLE                     00262600
.ZG95C              ANOP  ,                                             00262700
.*-------------------------------------------------------------------   00262800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00262900
                    AIF   (K'&ZXRETCODE LE 0).ZG95R  NOT I/O            00263000
                    AIF   ('&XRETCODE'(1,1) NE '(').ZG95R               00263100
&ZCGPR              SETC  '&XRETCODE'(2,K'&XRETCODE-2)                  00263200
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG95P                  00263300
                    AIF   (K'&ZCGPR GT 2).ZG95Q                         00263400
                    AIF   ('&ZCGPR' EQ '0').ZG95Q                       00263500
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00263600
                    AIF   (T'&ZCGPR NE 'N').ZG95Q  INVALID REG NAME     00263700
.ZG95P              ANOP  ,                                             00263800
                    AIF   (T'&ZCGPR NE 'N').ZG95R  NON NUMERIC          00263900
                    AIF   ('&ZCGPR' EQ '15').ZG95R                      00264000
                    AIF   ('&ZCGPR' LT '2').ZG95Q                       00264100
                    AIF   ('&ZCGPR' LE '12').ZG95R                      00264200
.ZG95Q              ANOP  ,                                             00264300
&ZMS                SETC  '"RETCODE='                                   00264400
&ZMS                SETC  '&ZMS.&RETCODE"'                              00264500
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00264600
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'      00264700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00264800
.ZG95R              ANOP  ,                                             00264900
.*----------------------------------------------------------------***   00265000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00265100
                    AIF   (N'&RSNCODE LE 1).ZG98A  CK NUM               00265200
&ZMS                SETC  '"RSNCODE='                                   00265300
&ZMS                SETC  '&ZMS.&RSNCODE"'                              00265400
&ZMS                SETC  '&ZMS "RSNCODE"'                              00265500
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00265600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00265700
.ZG98A              ANOP  ,                                             00265800
.*-------------------------------------------------------------------   00265900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00266000
                    AIF   (K'&RSNCODE(1) LE 0).ZG98C  NO PARM           00266100
&ZXRSNCODE          SETC  'OUTPUT'    SET OUTPUT                        00266200
&XRSNCODE           SETC  '&RSNCODE(1)'         SET XVARIABLE           00266300
                    AIF   (N'&RSNCODE GT 1).ZG98C                       00266400
&XRSNCODE           SETC  '&RSNCODE'  SET XVARIABLE                     00266500
.ZG98C              ANOP  ,                                             00266600
.*-------------------------------------------------------------------   00266700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00266800
                    AIF   (K'&ZXRSNCODE LE 0).ZG98R  NOT I/O            00266900
                    AIF   ('&XRSNCODE'(1,1) NE '(').ZG98R               00267000
&ZCGPR              SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                  00267100
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG98P                  00267200
                    AIF   (K'&ZCGPR GT 2).ZG98Q                         00267300
                    AIF   ('&ZCGPR' EQ '0').ZG98R                       00267400
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00267500
                    AIF   (T'&ZCGPR NE 'N').ZG98Q  INVALID REG NAME     00267600
.ZG98P              ANOP  ,                                             00267700
                    AIF   (T'&ZCGPR NE 'N').ZG98R  NON NUMERIC          00267800
                    AIF   ('&ZCGPR' EQ '0').ZG98R                       00267900
                    AIF   ('&ZCGPR' LT '2').ZG98Q                       00268000
                    AIF   ('&ZCGPR' LE '12').ZG98R                      00268100
.ZG98Q              ANOP  ,                                             00268200
&ZMS                SETC  '"RSNCODE='                                   00268300
&ZMS                SETC  '&ZMS.&RSNCODE"'                              00268400
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00268500
                    MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'       00268600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00268700
.ZG98R              ANOP  ,                                             00268800
.******************************************************************     00268900
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00269000
.******************************************************************     00269100
                    ACTR  10000                                         00269200
.*----------------------------------------------------------------***   00269300
.***AH.P02 EXTRA POSITIONALS                                            00269400
                    AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS          00269500
                    AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL          00269600
                    AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL      00269700
                    AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL       00269800
.ZGLISTX1           ANOP  ,                                             00269900
&ZCVAL              SETC  ''          ERROR FIELD                       00270000
&ZAWRK              SETA  0           POSITIONAL NUMBER                 00270100
.ZGLIST2            ANOP  ,                                             00270200
&ZAWRK              SETA  &ZAWRK+1    NEXT POSITIONAL                   00270300
                    AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE          00270400
&ZCVAL              SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA               00270500
                    AGO   .ZGLIST2                                      00270600
.*                                                                      00270700
.ZGLIST3            ANOP  ,                                             00270800
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA            00270900
&ZMS                SETC  'POSITIONAL ARGUMENT(S),'                     00271000
&ZMS                SETC  '&ZMS "&ZCVAL"'                               00271100
&ZMS                SETC  '&ZMS CANNOT BE USED.'                        00271200
&ZMS                SETC  '&ZMS NO POSITIONAL ARGUMENTS'                00271300
                    MNOTE 8,' &ZMS ARE ALLOWED.'                        00271400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00271500
.ZGLISTX            ANOP  ,                                             00271600
&ZASYSLNDX          SETA  0                                             00271700
.*******************************************************************    00271800
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00271900
.*******************************************************************    00272000
                    AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED          00272100
.*******************************************************************    00272200
.***AE.01  START OF IWM4MCHS MACRO CODE                                 00272300
.*******************************************************************    00272400
                    LCLC  &M0M0001                 NAME                 00272500
&M0M0001            SETC  '&XLABEL'                SET NAME             00272600
                    AIF   (K'&XLABEL NE 0).XLAB2                        00272700
&M0M0001            SETC  'M00M&SYSNDX'            DEFAULT NAME         00272800
.*                                                                      00272900
.XLAB2              ANOP  ,                                             00273000
&M0M0001 DS    0H                             IWM4MCHS-3                00273100
.*******************************************************************    00273200
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00273300
.*******************************************************************    00273400
              PUSH  PRINT                                               00273500
                    AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON    00273600
                    PRINT OFF         ++ PR01                           00273700
                    AGO   .ZPRNTXX                                      00273800
.ZPRINTX            PRINT ON                                            00273900
.ZPRNTXX            ANOP  ,                                             00274000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00274100
         GBLC  &SYSAM64                                       @OA17369  00274200
         GBLA  &SYSALVL                                       @OA17369  00274300
         LCLC  &T1                                                 @L8  00274400
         AIF   ('&XCOMPCODE' EQ 'YES').INLINE                           00274500
         AIF   ('&XRETCODE' EQ '').RSNCODECHK                           00274600
&T1      SETC  'RETCODE, RSNCODE MAY NOT BE USED WITH COMPCODE(NO)'     00274700
         MNOTE 8,'&T1'                                                  00274800
         MEXIT                                                          00274900
.RSNCODECHK ANOP                                                        00275000
         AIF   ('&XRSNCODE' EQ '').INLINE                               00275100
&T1      SETC  'RETCODE, RSNCODE MAY NOT BE USED WITH COMPCODE(NO)'     00275200
         MNOTE 8,'&T1'                                                  00275300
         MEXIT                                                          00275400
.*                                                                      00275500
.INLINE  ANOP                                                           00275600
.*--------------------------------------------------------------------- 00275700
.* Fetch Monitoring Token                                               00275800
.*--------------------------------------------------------------------- 00275900
         AIF ('&MONTKN' EQ '').MONTKNR2                                 00276000
&T1      SETC  '&MONTKN'                                                00276100
         AIF   ('&MONTKN'(1,1) NE '(').MONTKNR1                     @L8 00276200
&T1      SETC  '&MONTKN'(2,K'&MONTKN-2)                                 00276300
&T1      SETC  '0(&T1.)'                                                00276400
.MONTKNR1  ANOP                                                     @L8 00276500
         LLGT  14,&T1                  FETCH 31BIT MONITORING TOKEN @L8 00276600
         LTGR  14,14                   MONITORING TOKEN PROVIDED?   @L8 00276700
         AGO .MONTKNR4                                              @L8 00276800
.MONTKNR2  ANOP                                                     @L8 00276900
&T1      SETC  '&MONTKN64'                                          @L8 00277000
         AIF   ('&MONTKN64'(1,1) NE '(').MONTKNR3                   @L8 00277100
&T1      SETC  '&MONTKN64'(2,K'&MONTKN64-2)                         @L8 00277200
&T1      SETC  '0(&T1.)'                                            @L8 00277300
.MONTKNR3  ANOP                                                     @L8 00277400
         AIF   ('&SYSAM64' EQ 'YES').SWAM64                         @L8 00277500
         SAM64                                                      @L8 00277600
.SWAM64  ANOP                                                       @L8 00277700
         LTG   14,&T1                  FETCH 64BIT MONITORING TOKEN @L8 00277800
.MONTKNR4  ANOP                                                     @L8 00277900
.* GENERATE CODE WHICH DEPENDS ON HOW COMPCODE WAS SPECIFIED            00278000
         AIF   ('&XCOMPCODE' NE 'YES').NOCOMPCODE1                      00278100
         JNZ   MONENV&SYSNDX           BRANCH MON ENV IS PRESENT   @P6C 00278200
         LA    0,IWMRSNCODENOMONENV    SET REASON CODE = NO MON ENV     00278300
         LA    15,IWMRETCODEWARNING    SET WARNING RETURN CODE          00278400
         J     MCHS&SYSNDX._END BRANCH TO END LABEL                @P6C 00278500
MONENV&SYSNDX DS    0H                 BRANCH LABEL FOR MON ENV PRESENT 00278600
         AIF   ('&XRUNTIME_VER' EQ 'MINIMAL').ENDCOMPCODE1              00278700
         LLILF 1,PB_ID_CONST                                       @P6A 00278800
         CL    1,PB_ID-PB(,14)                                     @P6C 00278900
         JE    MONENVOK&SYSNDX         BRANCH WHEN MON ENV PASSES  @P6C 00279000
         LA    0,IWMRSNCODEBADMONENV   SET REASON CODE = BAD MON ENV    00279100
         LA    15,IWMRETCODEINVOCERROR SET INVOCATION ERROR RETURN CODE 00279200
         J     MCHS&SYSNDX._END BRANCH TO END LABEL                @P6C 00279300
MONENVOK&SYSNDX DS    0H               BRANCH LABEL FOR MON ENV OK      00279400
         AGO .ENDCOMPCODE1                                              00279500
.* NOW GENERATE CODE WHEN COMPCODE(NO) WAS SPECIFIED                    00279600
.NOCOMPCODE1    ANOP                                                    00279700
         JZ    MCHS&SYSNDX._END BRANCH TO END LABEL                @P6C 00279800
         AIF   ('&XRUNTIME_VER' EQ 'MINIMAL').ENDCOMPCODE1              00279900
         LLILF 1,PB_ID_CONST                                       @P6A 00280000
         CL    1,PB_ID-PB(,14)                                     @P6C 00280100
         JE    MCHS&SYSNDX._VLDPB                                  @P6C 00280200
         J     MCHS&SYSNDX._END BRANCH TO END LABEL                @P6C 00280300
.ENDCOMPCODE1    ANOP                                                   00280400
MCHS&SYSNDX._VLDPB DS 0H                                            @L8 00280500
         USING PB,14                                                    00280600
.*       RESTKN PROCESSING                                          @L4 00280700
         AIF   ('&XRESTKN' NE 'NORESTKN').RESTKN                    @L4 00280800
         AGO   .ENDRESTKN                                           @L4 00280900
.RESTKN ANOP                                                        @L4 00281000
&T1      SETC  '&RESTKN'                                            @L4 00281100
         AIF   ('&RESTKN'(1,1) NE '(').RESTKNRS                     @L4 00281200
&T1      SETC  '&RESTKN'(2,K'&RESTKN-2)                             @L4 00281300
&T1      SETC  '0(&T1.)'                                            @L4 00281400
.RESTKNRS ANOP                                                      @L4 00281500
.* &T1 IS NOW A VALID BASE-DISPLACEMENT EXPRESSION                  @L4 00281600
         MVC   PB_BP_RESTKN(8),&T1         COPY RESTKN              @L4 00281700
.ENDRESTKN ANOP                                                     @L4 00281800
         AIF   ('&XSTATE' EQ 'WAITING').WAITING                         00281900
         MVI   PB_STATE,PB_STATE_&XSTATE                                00282000
         AGO  .ENDSTATE                                                 00282100
.WAITING       ANOP                                                     00282200
         MVI   PB_STATE,PB_STATE_WAITING_&XRESOURCE                     00282300
.ENDSTATE      ANOP                                                     00282400
         AIF   ('&XCOMPCODE' NE 'YES').NOCOMPCODE2                      00282500
         LA    15,IWMRETCODEOK           SET RETURN CODE = OK           00282600
.NOCOMPCODE2    ANOP                                                    00282700
         AIF   ('&XEWLM' NE 'YES').Mchs_NoEwlm                      @L8 00282800
.*******************************************************************    00282900
.*                    Begin @LEWLMQ                                     00283000
.*       It has been checked that the PB is ok.                         00283100
.*******************************************************************    00283200
         LA    0,0                     SET REASON CODE = 0          @P3 00283300
         LA    15,IWMRETCODEOK         SET RETURN CODE = 0          @P3 00283400
         CLI   PB_VERSION,PB_VERSION7                               @P3 00283500
         JL    MCHS&SYSNDX._END BRANCH IF VERSION LOWER             @L8 00283600
         TM    PB_FLAGS,PB_EWLM_ENABLED                             @P3 00283700
         JNO   MCHS&SYSNDX._END BRANCH IF EWLM NOT ENABLED          @L8 00283800
         AIF   ('&XSTATE' EQ 'WAITING').CHECKBLOCK                      00283900
         MVI   PB_EWLM_REQUEST,PB_EWLM_REQUEST_IWM4MCHS_UNBLOCK         00284000
         AGO   .CALLSRV                                                 00284100
.CHECKBLOCK    ANOP                                                     00284200
.*             STATE=WAITING                                            00284300
         AIF   ('&XRESOURCE' EQ 'CONV').BLOCK                           00284400
         AIF   ('&XRESOURCE' EQ 'DISTRIB').BLOCK                        00284500
         AIF   ('&XRESOURCE' EQ 'SESS_LOCALMVS').BLOCK                  00284600
         AIF   ('&XRESOURCE' EQ 'SESS_NETWORK').BLOCK                   00284700
         AIF   ('&XRESOURCE' EQ 'SESS_SYSPLEX').BLOCK                   00284800
         AIF   ('&XRESOURCE' EQ 'OTHER_PRODUCT').BLOCK                  00284900
         MVI   PB_EWLM_REQUEST,PB_EWLM_REQUEST_IWM4MCHS_UNBLOCK         00285000
         AGO   .CALLSRV                                                 00285100
.BLOCK         ANOP                                                     00285200
.*             STATE=WAITING AND RESOURCE=XXX WHICH INDICATES BLOCKING  00285300
         AIF   ('&XASYNC' EQ 'YES').BLOCKASYNC                          00285400
         MVI   PB_EWLM_REQUEST,PB_EWLM_REQUEST_IWM4MCHS_BLOCK           00285500
         AGO   .CALLSRV                                                 00285600
.BLOCKASYNC    ANOP                                                     00285700
.*             STATE=WAITING AND BLOCKING ASYNCHRONOUSLY                00285800
         MVI   PB_EWLM_REQUEST,PB_EWLM_REQUEST_IWM4MCHS_BLOCK_ASYNC     00285900
.CALLSRV       ANOP                                                     00286000
         SLR   1,1                                                      00286100
         ST    1,PB_EWLM_PARMLIST      CLEAR ADDR OF PARMLIST           00286200
         LGR   1,14                    LOAD ADDR OF PB INTO R01     @L8 00286300
         AIF   ('&SYSAM64' NE 'YES').AMODE31A                           00286400
         LLGT  15,X'10'                ADDRESS THE CVT              @L8 00286500
         LLGT  15,X'8C'(15,0)          ADDRESS THE ECVT             @L8 00286600
         LLGT  15,X'C4'(15,0)          ADDRESS THE WMVT             @L8 00286700
         LLGT  15,X'16C'(15,0)         GET SERVICE ROUTINE ADDR     @L8 00286800
         BASR  14,15                   INVOKE IWMXDIN4              @L8 00286900
         LGR   14,1                    RESTORE ADDRESS OF PB        @L8 00287000
         AGO   .AMODE31E                                            @L8 00287100
.AMODE31A      ANOP                                                 @L8 00287200
         AIF   ('&MONTKN64' EQ '').SWAM311                          @L8 00287300
         SAM31                         SET AM=31                    @L8 00287400
.SWAM311 ANOP                                                       @L8 00287500
         L     15,X'10'                ADDRESS THE CVT                  00287600
         L     15,X'8C'(15,0)          ADDRESS THE ECVT                 00287700
         L     15,X'C4'(15,0)          ADDRESS THE WMVT                 00287800
         L     15,X'168'(15,0)         GET SERVICE ROUTRINE ADDR    @L8 00287900
         BASR  14,15                   INVOKE IWMXDIN1              @L8 00288000
         LGR   14,1                    RESTORE ADDRESS OF PB        @L8 00288100
         J     MCHS&SYSNDX._ENDX                                   @P6C 00288200
.AMODE31E      ANOP                                                 @L8 00288300
.*******************************************************************    00288400
.*                    End   @LEWLMQ                                     00288500
.*******************************************************************    00288600
.Mchs_NoEwlm ANOP                                                   @L8 00288700
*                                                                       00288800
MCHS&SYSNDX._END DS 0H                 END AMODE 64 ENV             @L8 00288900
         AIF   ('&SYSAM64' EQ 'YES').SWAM313                        @L8 00289000
         AIF   ('&MONTKN64' EQ '').SWAM312                          @L8 00289100
         SAM31                                                      @L8 00289200
.SWAM312 ANOP                                                       @L8 00289300
MCHS&SYSNDX._ENDX DS 0H                                             @L8 00289400
.SWAM313 ANOP                                                       @L8 00289500
         DROP  14                                                       00289600
.*******************************************************************    00289700
.***        RETURN CODE PROCESSING                                      00289800
.*******************************************************************    00289900
         AIF   (N'&RETCODE LE 0).IWM4MCHS_ENDRC_EXP                     00290000
         AIF   ('&XRETCODE'(1,1) EQ '(').IWM4MCHS_RC_REG                00290100
         AIF   ('&XRETCODE' EQ 'GPR15').IWM4MCHS_ENDRC_EXP              00290200
         AIF   ('&XRETCODE' EQ 'REG15').IWM4MCHS_ENDRC_EXP              00290300
         AIF   ('&XRETCODE' EQ 'R15').IWM4MCHS_ENDRC_EXP                00290400
         AIF   ('&XRETCODE' EQ '15').IWM4MCHS_ENDRC_EXP                 00290500
         ST    15,&XRETCODE                                             00290600
         AGO  .IWM4MCHS_ENDRC_EXP                                   @L8 00290700
.*                                                                      00290800
.IWM4MCHS_RC_REG      ANOP  ,                                           00290900
&T1      SETC  '&XRETCODE'(2,K'&XRETCODE-2)                             00291000
         AIF   ('&T1' EQ 'GPR15').IWM4MCHS_ENDRC_EXP                    00291100
         AIF   ('&T1' EQ 'REG15').IWM4MCHS_ENDRC_EXP                    00291200
         AIF   ('&T1' EQ 'R15').IWM4MCHS_ENDRC_EXP                      00291300
         AIF   ('&T1' EQ '15').IWM4MCHS_ENDRC_EXP                       00291400
         LR    &T1,15                                                   00291500
.IWM4MCHS_ENDRC_EXP   ANOP  ,                                           00291600
.*******************************************************************    00291700
.***        REASON CODE PROCESSING                                      00291800
.*******************************************************************    00291900
         AIF   (N'&RSNCODE LE 0).IWM4MCHS_ENDRSN_EXP                    00292000
         AIF   ('&XRSNCODE'(1,1) EQ '(').IWM4MCHS_RSN_REG               00292100
         AIF   ('&XRSNCODE' EQ 'GPR0').IWM4MCHS_ENDRSN_EXP              00292200
         AIF   ('&XRSNCODE' EQ 'GPR00').IWM4MCHS_ENDRSN_EXP             00292300
         AIF   ('&XRSNCODE' EQ 'REG0').IWM4MCHS_ENDRSN_EXP              00292400
         AIF   ('&XRSNCODE' EQ 'REG00').IWM4MCHS_ENDRSN_EXP             00292500
         AIF   ('&XRSNCODE' EQ 'R0').IWM4MCHS_ENDRSN_EXP                00292600
         AIF   ('&XRSNCODE' EQ '0').IWM4MCHS_ENDRSN_EXP                 00292700
         AIF   ('&XRSNCODE' EQ '00').IWM4MCHS_ENDRSN_EXP                00292800
         ST    0,&XRSNCODE                                              00292900
         AGO   .IWM4MCHS_ENDRSN_EXP                                     00293000
.*                                                                      00293100
.IWM4MCHS_RSN_REG     ANOP  ,                                           00293200
&T1      SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                             00293300
         AIF   ('&ZCGPR' EQ 'GPR0').IWM4MCHS_ENDRSN_EXP                 00293400
         AIF   ('&ZCGPR' EQ 'GPR00').IWM4MCHS_ENDRSN_EXP                00293500
         AIF   ('&ZCGPR' EQ 'REG0').IWM4MCHS_ENDRSN_EXP                 00293600
         AIF   ('&ZCGPR' EQ 'REG00').IWM4MCHS_ENDRSN_EXP                00293700
         AIF   ('&ZCGPR' EQ 'R0').IWM4MCHS_ENDRSN_EXP                   00293800
         AIF   ('&ZCGPR' EQ '0').IWM4MCHS_ENDRSN_EXP                    00293900
         AIF   ('&ZCGPR' EQ '00').IWM4MCHS_ENDRSN_EXP                   00294000
         LR    &T1,0                                                    00294100
.IWM4MCHS_ENDRSN_EXP  ANOP  ,                                           00294200
.*******************************************************************    00294300
&ZIWM4MCHS            SETC  'YES'          SET IWM4MCHS USED            00294400
         POP   PRINT                                                    00294500
*                                            IWM4MCHS END               00294600
         SPACE 1                                                        00294700
         MEXIT                                                          00294800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00294900
.********************************************************************   00295000
.***AL.A01  INTERNAL ARRAY TO PRODUCE FORMATTED CODE                    00295100
.********************************************************************   00295200
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00295300
                      LCLA  &ZOPN1         INVOCATION INDEX             00295400
                      LCLC  &ZOPL(4095)    LABEL                        00295500
                      LCLC  &ZOPO(4095)    OPERATION                    00295600
                      LCLC  &ZOPV(4095)    VALUE                        00295700
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00295800
.*                                                                      00295900
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00296000
.*******************************************************************    00296100
.***AO.X02  RETURN CODE PROCESSING                                      00296200
.*******************************************************************    00296300
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00296400
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00296500
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00296600
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00296700
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00296800
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00296900
&ZOPN                 SETA  &ZOPN+1                                     00297000
&ZOPL(&ZOPN)          SETC  ' '                                         00297100
&ZOPO(&ZOPN)          SETC  'ST'                                        00297200
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00297300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00297400
                      AGO   .ZMRETX                                     00297500
.*                                                                      00297600
.ZMRET2               ANOP  ,                                           00297700
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00297800
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00297900
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00298000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00298100
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00298200
&ZOPN                 SETA  &ZOPN+1                                     00298300
&ZOPL(&ZOPN)          SETC  ' '                                         00298400
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00298500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00298600
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00298700
.ZMRETX               ANOP  ,                                           00298800
.*******************************************************************    00298900
.***AO.X03  REASON CODE PROCESSING                                      00299000
.*******************************************************************    00299100
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00299200
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00299300
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00299400
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00299500
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00299600
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00299700
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00299800
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00299900
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00300000
&ZOPN                 SETA  &ZOPN+1                                     00300100
&ZOPL(&ZOPN)          SETC  ' '                                         00300200
&ZOPO(&ZOPN)          SETC  'ST'                                        00300300
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00300400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00300500
                      AGO   .ZMRSNX                                     00300600
.*                                                                      00300700
.ZMRSN2               ANOP  ,                                           00300800
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00300900
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00301000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00301100
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00301200
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00301300
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00301400
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00301500
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00301600
&ZOPN                 SETA  &ZOPN+1                                     00301700
&ZOPL(&ZOPN)          SETC  ' '                                         00301800
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00301900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00302000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00302100
.ZMRSNX               ANOP  ,                                           00302200
.*******************************************************************    00302300
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00302400
.*******************************************************************    00302500
                      ACTR  10000                                       00302600
.*                                                                      00302700
                      LCLA  &ZLC           COLUMN POSITION              00302800
                      LCLA  &ZOPX          LIST TABLE INDEX             00302900
                      LCLC  &ZLL           LABEL                        00303000
                      LCLC  &ZLOP          OPERATION                    00303100
                      LCLC  &ZLV           VALUE                        00303200
                      LCLC  &ZLD           DESCRIPTION                  00303300
.*                                                                      00303400
&ZOPX                 SETA  1                                           00303500
.*******************************************************************    00303600
.***AP.X01  FORMAT GENERATED CODE                                       00303700
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00303800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00303900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00304000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00304100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00304200
                      AIF   (K'&ZLD LE 0).ZL51                          00304300
&ZLC                  SETA  35             COMMENT COLUMN               00304400
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00304500
&ZLC                  SETA  33             COMMENT COLUMN               00304600
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00304700
&ZLV                  SETC  '&ZLV'.' '                                  00304800
                      AGO   .ZL31                                       00304900
.*                                                                      00305000
.ZL41                 ANOP  ,                                           00305100
&ZLV                  SETC  '&ZLV'.' '                                  00305200
.ZL51                 ANOP  ,                                           00305300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00305400
.*                                                                      00305500
&ZLL     &ZLOP &ZLV                                                     00305600
.*                                                                      00305700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00305800
                      AGO   .ZL21          CONTINUE LOOPING             00305900
.*                                                                      00306000
.ZLX1                 ANOP  ,                                           00306100
.*******************************************************************    00306200
.***AP.X02  END OF IWM4MCHS MACRO                                       00306300
&ZIWM4MCHS            SETC  'YES'          SET IWM4MCHS USED            00306400
         POP   PRINT                                                    00306500
*                                            IWM4MCHS-3                 00306600
         SPACE 1                                                        00306700
.ZLX2                 ANOP  ,                                           00306800
         MEND                                                           00306900
**********************************************************************/ 00307000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00307100
*%IWM4MCHS: MACRO KEYS(STATE,RESOURCE,ASYNC,EWLM,MONTKN,MONTKN64,       00307200
*                 RESTKN,RUNTIME_VER,COMPCODE,RETCODE,RSNCODE,          00307300
*                 PLISTVER);                                            00307400
*  ANS('?'!!MACLABEL!!' '!!'IWM4MCHP '!!MACLIST!!                       00307500
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00307600
*%END IWM4MCHS;                                                         00307700

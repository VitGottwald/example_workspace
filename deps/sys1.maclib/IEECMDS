*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IEECMDS                               -09/08/31-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Query/Remove Attached Commands                * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 2001, 2010                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7770                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*      This macro provides many of the same functions as the CMDS     * 00002000
*      operator command.                                              * 00002100
*                                                                     * 00002200
*      It can be used to obtain information about MVS commands which  * 00002300
*      are attached, or waiting to be attached, in the *MASTER* or    * 00002400
*      CONSOLE address spaces.                                        * 00002500
*                                                                     * 00002600
*      It can also be used to remove commands which are waiting, but  * 00002700
*      not to terminate commands which are already executing.         * 00002800
*                                                                     * 00002900
*01* EXTERNAL CLASSIFICATION:                                         * 00003000
*                                                                     * 00003100
*02* PI:   BASE                                                       * 00003200
*                                                                     * 00003300
*02* NONE: FIELDS                                                     * 00003400
*          IBMINT, MarkNoABEND, UnmarkNoAbend, MarkCMDSAbend          * 00003500
*                                                                     * 00003600
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003700
*                                                                     * 00003800
*01* ENVIRONMENT:                                                     * 00003900
*                                                                     * 00004000
*                                                                     * 00004100
*      Minimum authorization: Supervisor state or  System PSW key.    * 00004200
*                                                                     * 00004300
*      Dispatchable unit mode: Task mode.                             * 00004400
*                                                                     * 00004500
*      Cross Memory Mode: PASN=HASN=SASN.                             * 00004600
*                                                                     * 00004700
*      AMODE:            31-bit.                                      * 00004800
*                                                                     * 00004900
*      ASC mode:         Primary or Access Register.                  * 00005000
*                                                                     * 00005100
*      Interrupt status: Enabled for I/O and external interrupts.     * 00005200
*                                                                     * 00005300
*      Locks:            No locks held.                               * 00005400
*                                                                     * 00005500
*      Control parameters: Control parameters must be in the primary  * 00005600
*                        address space.                               * 00005700
*                                                                     * 00005800
*                                                                     * 00005900
*                                                                     * 00006000
*01* PROGRAMMING REQUIREMENTS:                                        * 00006100
*                                                                     * 00006200
*    The calling program may include mapping macro IEEZB889 which can * 00006300
*    be used to map the information which is returned in the buffer   * 00006400
*    specified as BUFFER.                                             * 00006500
*                                                                     * 00006600
*01* RESTRICTIONS:                                                    * 00006700
*                                                                     * 00006800
*    The caller cannot be protected by an FRR.                        * 00006900
*                                                                     * 00007000
*01* PERFORMANCE IMPLICATIONS:                                        * 00007100
*                                                                     * 00007200
*    None.                                                            * 00007300
*                                                                     * 00007400
*01* INPUT REGISTER INFORMATION:                                      * 00007500
*                                                                     * 00007600
*    Before issuing the IEECMDS macro, the caller does not have to    * 00007700
*    place any information into any register unless using it in       * 00007800
*    register notation for a particular parameter, or using it as a   * 00007900
*    base register.                                                   * 00008000
*                                                                     * 00008100
*01* OUTPUT REGISTER INFORMATION:                                     * 00008200
*                                                                     * 00008300
*     When control returns to the caller, the GPRs contain:           * 00008400
*                                                                     * 00008500
*                                                                     * 00008600
*    REGISTER  CONTENTS                                               * 00008700
*                                                                     * 00008800
*    0         Reason code                                            * 00008900
*                                                                     * 00009000
*    1         Used as a work register by the system                  * 00009100
*                                                                     * 00009200
*    2-13      Unchanged                                              * 00009300
*                                                                     * 00009400
*    14        Used as a work register by the system                  * 00009500
*                                                                     * 00009600
*    15        Return code                                            * 00009700
*                                                                     * 00009800
*                                                                     * 00009900
*                                                                     * 00010000
*     When control returns to the caller, the ARs contain:            * 00010100
*                                                                     * 00010200
*                                                                     * 00010300
*    REGISTER  CONTENTS                                               * 00010400
*                                                                     * 00010500
*    0-1       Used as work registers by the system                   * 00010600
*                                                                     * 00010700
*    2-13      Unchanged                                              * 00010800
*                                                                     * 00010900
*    14-15     Used as work registers by the system                   * 00011000
*                                                                     * 00011100
*                                                                     * 00011200
*                                                                     * 00011300
*    Some callers depend on register contents remaining the same      * 00011400
*    before and after issuing a service.  If the system changes the   * 00011500
*    contents of registers on which the caller depends, the caller    * 00011600
*    must save them before issuing the service, and restore them      * 00011700
*    after the system returns control.                                * 00011800
*                                                                     * 00011900
*01* SYNTAX:                                                          * 00012000
*                                                                     * 00012100
*Ýxlabel¨  IEECMDS  ÐÝ IBMINT=NO                                      * 00012200
*                   !   ÐÝ,REQUEST=COUNT¨                             * 00012300
*                   !   ÔÝ,REQUEST=INFO                               * 00012400
*                   !   !     ,BUFFER=xbuffer                         * 00012500
*                   !   !     ,BUFSIZE=xbufsize¨                      * 00012600
*                   !   ¿Ý,REQUEST=REMOVE                             * 00012700
*                   !         ,BUFFER=xbuffer                         * 00012800
*                   !         ,BUFSIZE=xbufsize¨                      * 00012900
*                   !    Ý,CLASS=»xclass!ANY_CLASSº¨                  * 00013000
*                   !    Ý,CMD=»xcmd!ANY_CMDº¨                        * 00013100
*                   !    Ý,ID=»xid!ANY_IDº¨                           * 00013200
*                   !    Ý,JOB=»xjob!ANY_JOBº¨                        * 00013300
*                   !     ,COUNT=xcount¨                              * 00013400
*                   ¿Ý,IBMINT=YES                                     * 00013500
*                       Ð ,REQUEST=MARKNOABEND                        * 00013600
*                       Ô ,REQUEST=UNMARKNOABEND                      * 00013700
*                       ¿ ,REQUEST=MARKCMDSABEND                      * 00013800
*                             ,BUFFER=xbuffer                         * 00013900
*                             ,BUFSIZE=xbufsize                       * 00014000
*                             ,CMD=xcmd                               * 00014100
*                             ,ID=xid                                 * 00014200
*                            Ý,CLASS=»xclass!ANY_CLASSº¨              * 00014300
*                            Ý,JOB=»xjob!ANY_JOBº¨¨                   * 00014400
*                    Ý,RETCODE=xretcode¨                              * 00014500
*                    Ý,RSNCODE=xrsncode¨                              * 00014600
*                    Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨          * 00014700
*                   ÐÝ,MF=S¨                                          * 00014800
*                   ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                   * 00014900
*                   ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨             * 00015000
*                   ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨             * 00015100
*                                                                     * 00015200
*                                                                     * 00015300
*      Where:                                                         * 00015400
*                                                                     * 00015500
*                                                                     * 00015600
*      Ýxlabel¨                                                       * 00015700
*          is an optional symbol, starting in column 1, that is the   * 00015800
*          name on the IEECMDS macro invocation.  The name must       * 00015900
*          conform to the rules for an ordinary assembler language    * 00016000
*          symbol.                                                    * 00016100
*          DEFAULT: No name.                                          * 00016200
*                                                                     * 00016300
*                                                                     * 00016400
*                                                                     * 00016500
*                                                                     * 00016600
*      ÝIBMINT=»NO!YESº                                               * 00016700
*          is an optional keyword input that indicates if request is  * 00016800
*          reserved for IBM use only.                                 * 00016900
*          DEFAULT: NO                                                * 00017000
*                                                                     * 00017100
*                                                                     * 00017200
*          ÝIBMINT=NO                                                 * 00017300
*              Request is available to all users.                     * 00017400
*                                                                     * 00017500
*                                                                     * 00017600
*              ÝREQUEST=»COUNT!INFO!REMOVEº¨                          * 00017700
*                  is an optional keyword input that indicates the    * 00017800
*                  type of request.                                   * 00017900
*                  DEFAULT: COUNT                                     * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*                  ÝREQUEST=COUNT¨                                    * 00018300
*                      Return only the count of commands which meet   * 00018400
*                      the search criteria.                           * 00018500
*                                                                     * 00018600
*                      This count is returned for all values of       * 00018700
*                      REQUEST, but if REQUEST= COUNT, no other       * 00018800
*                      information is returned.                       * 00018900
*                                                                     * 00019000
*                  ÝREQUEST=INFO                                      * 00019100
*                      Return information about commands meeting the  * 00019200
*                      search criteria.                               * 00019300
*                                                                     * 00019400
*                      The command names, id numbers, "waiting or     * 00019500
*                      executing" status, jobname and asid of the     * 00019600
*                      command issuer, date/time of issue/execution   * 00019700
*                      are returned for each command.                 * 00019800
*                                                                     * 00019900
*                      The count of matching commands is returned.    * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*                      BUFFER=xbuffer                                 * 00020300
*                          is the name (RS-type), or address in       * 00020400
*                          register (2)-(12), of a required character * 00020500
*                          input that is to contain the response.     * 00020600
*                          request.                                   * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*                      BUFSIZE=xbufsize¨                              * 00021200
*                          is the name (RS-type), or address in       * 00021300
*                          register (2)-(12), of a required fullword  * 00021400
*                          input that contains the size of the output * 00021500
*                          storage buffer.                            * 00021600
*                                                                     * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*                  ÝREQUEST=REMOVE                                    * 00022000
*                      Remove commands from the "waiting for          * 00022100
*                      execution" status, if they meet the search     * 00022200
*                      criteria.                                      * 00022300
*                                                                     * 00022400
*                      The count of matching commands is returned.    * 00022500
*                                                                     * 00022600
*                      The command names, id numbers, "waiting or     * 00022700
*                      executing" status, jobname and asid of the     * 00022800
*                      command issuer, date/time of issue/execution   * 00022900
*                      are returned for each removed command.         * 00023000
*                                                                     * 00023100
*                      Message IEE065I is issued for each removed     * 00023200
*                      command. It is directed to the console which   * 00023300
*                      issued the command.                            * 00023400
*                                                                     * 00023500
*                                                                     * 00023600
*                      BUFFER=xbuffer                                 * 00023700
*                          is the name (RS-type), or address in       * 00023800
*                          register (2)-(12), of a required character * 00023900
*                          input that is to contain the response.     * 00024000
*                          request.                                   * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*                      BUFSIZE=xbufsize¨                              * 00024600
*                          is the name (RS-type), or address in       * 00024700
*                          register (2)-(12), of a required fullword  * 00024800
*                          input that contains the size of the output * 00024900
*                          storage buffer.                            * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*                                                                     * 00025400
*                                                                     * 00025500
*                                                                     * 00025600
*                                                                     * 00025700
*                                                                     * 00025800
*              ÝCLASS=»xclass!ANY_CLASSº¨                             * 00025900
*                  is the name (RS-type), or address in register      * 00026000
*                  (2)-(12), of an optional 4 character input that    * 00026100
*                  indicates the class of commands to be processed.   * 00026200
*                                                                     * 00026300
*                  The currently defined classes are:                 * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                  1.  Class M1 - commands which are attached in      * 00026700
*                      *MASTER*, and may be essential to clearing a   * 00026800
*                      backlog of Class M2 commands.                  * 00026900
*                                                                     * 00027000
*                  2.  Class M2 - ordinary attached commands which    * 00027100
*                      run in the *MASTER* address space.             * 00027200
*                                                                     * 00027300
*                  3.  Class M3 - SEND command only                   * 00027400
*                                                                     * 00027500
*                  4.  Class C1 - commands which are attached in      * 00027600
*                      CONSOLE, and may be essential to clearing a    * 00027700
*                      backlog of Class C2 commands.                  * 00027800
*                                                                     * 00027900
*                  5.  Class C2 - ordinary attached commands which    * 00028000
*                      run in the CONSOLE address space.              * 00028100
*                                                                     * 00028200
*                  6.  Class C3 - ROUTE command only                  * 00028300
*                                                                     * 00028400
*                                                                     * 00028500
*                  DEFAULT: ANY_CLASS                                 * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*              ÝCMD=»xcmd!ANY_CMDº¨                                   * 00029100
*                  is the name (RS-type), or address in register      * 00029200
*                  (2)-(12), of an optional 8 character input that    * 00029300
*                  indicates the name of the command to be processed. * 00029400
*                                                                     * 00029500
*                  The command name must be specified as the full     * 00029600
*                  name, not an abbreviation. If you have previously  * 00029700
*                  executed this macro with a REQUEST of INFO, it has * 00029800
*                  returned the command names in full.                * 00029900
*                  DEFAULT: ANY_CMD                                   * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*              ÝID=»xid!ANY_IDº¨                                      * 00030500
*                  is the name (RS-type), or address in register      * 00030600
*                  (2)-(12), of an optional 4 character input that    * 00030700
*                  indicates the ID of a command to be processed.     * 00030800
*                  This number was returned on a previous CMDS INFO   * 00030900
*                  command.                                           * 00031000
*                  DEFAULT: ANY_ID                                    * 00031100
*                                                                     * 00031200
*                                                                     * 00031300
*                                                                     * 00031400
*                                                                     * 00031500
*              ÝJOB=»xjob!ANY_JOBº¨                                   * 00031600
*                  is the name (RS-type), or address in register      * 00031700
*                  (2)-(12), of an optional 8 character input that    * 00031800
*                  indicates the jobname of the job which issued the  * 00031900
*                  commands.                                          * 00032000
*                  DEFAULT: ANY_JOB                                   * 00032100
*                                                                     * 00032200
*                                                                     * 00032300
*                                                                     * 00032400
*                                                                     * 00032500
*              COUNT=xcount¨                                          * 00032600
*                  is the name (RS-type), or address in register      * 00032700
*                  (2)-(12), of a required 4 byte input that contains * 00032800
*                  the address area that will contain the number of   * 00032900
*                  commands meeting the specified criteria.           * 00033000
*                                                                     * 00033100
*                                                                     * 00033200
*                                                                     * 00033300
*          ÝIBMINT=YES                                                * 00033400
*              Request is only available for IBM use.                 * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*              REQUEST=»MARKNOABEND!UNMARKNOABEND!MARKCMDSABENDº¨     * 00033800
*                  is a required keyword input that indicates the     * 00033900
*                  type of request.                                   * 00034000
*                                                                     * 00034100
*                                                                     * 00034200
*                  REQUEST=MARKNOABEND                                * 00034300
*                      Mark the command as being non-abendable.       * 00034400
*                                                                     * 00034500
*                  REQUEST=UNMARKNOABEND                              * 00034600
*                      Mark the command as being abendable.           * 00034700
*                                                                     * 00034800
*                  REQUEST=MARKCMDSABEND                              * 00034900
*                      Return information about command meeting the   * 00035000
*                      search criteria. Also mark the command as in   * 00035100
*                      the process of being abended.  Note: This      * 00035200
*                      option is to be used only by the CMDS command  * 00035300
*                      processor.                                     * 00035400
*                                                                     * 00035500
*                                                                     * 00035600
*                      BUFFER=xbuffer                                 * 00035700
*                          is the name (RS-type), or address in       * 00035800
*                          register (2)-(12), of a required character * 00035900
*                          input that is to contain the response.     * 00036000
*                                                                     * 00036100
*                                                                     * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*                      BUFSIZE=xbufsize                               * 00036500
*                          is the name (RS-type), or address in       * 00036600
*                          register (2)-(12), of a required fullword  * 00036700
*                          input that contains the size of the output * 00036800
*                          storage buffer.                            * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*                                                                     * 00037300
*                      CMD=xcmd                                       * 00037400
*                          is the name (RS-type), or address in       * 00037500
*                          register (2)-(12), of a required 8         * 00037600
*                          character input that indicates the name of * 00037700
*                          the command to be processed.               * 00037800
*                                                                     * 00037900
*                          The command name must be specified as the  * 00038000
*                          full name, not an abbreviation.            * 00038100
*                                                                     * 00038200
*                                                                     * 00038300
*                                                                     * 00038400
*                                                                     * 00038500
*                      ID=xid                                         * 00038600
*                          is the name (RS-type), or address in       * 00038700
*                          register (2)-(12), of a required 4         * 00038800
*                          character input that indicates the ID of a * 00038900
*                          command to be processed. This number was   * 00039000
*                          returned on a previous CMDS INFO command.  * 00039100
*                                                                     * 00039200
*                                                                     * 00039300
*                                                                     * 00039400
*                                                                     * 00039500
*                      ÝCLASS=»xclass!ANY_CLASSº¨                     * 00039600
*                          is the name (RS-type), or address in       * 00039700
*                          register (2)-(12), of an optional 4        * 00039800
*                          character input that indicates the class   * 00039900
*                          of the command to be processed.            * 00040000
*                                                                     * 00040100
*                          The currently defined classes are:         * 00040200
*                                                                     * 00040300
*                                                                     * 00040400
*                          1.  Class M1 - commands which are attached * 00040500
*                              in *MASTER*, and may be essential to   * 00040600
*                              clearing a backlog of Class M2         * 00040700
*                              commands.                              * 00040800
*                                                                     * 00040900
*                          2.  Class M2 - ordinary attached commands  * 00041000
*                              which run in the *MASTER* address      * 00041100
*                              space.                                 * 00041200
*                                                                     * 00041300
*                          3.  Class M3 - SEND command only           * 00041400
*                                                                     * 00041500
*                          4.  Class C1 - commands which are attached * 00041600
*                              in CONSOLE, and may be essential to    * 00041700
*                              clearing a backlog of Class C2         * 00041800
*                              commands.                              * 00041900
*                                                                     * 00042000
*                          5.  Class C2 - ordinary attached commands  * 00042100
*                              which run in the CONSOLE address       * 00042200
*                              space.                                 * 00042300
*                                                                     * 00042400
*                          6.  Class C3 - ROUTE command only          * 00042500
*                                                                     * 00042600
*                                                                     * 00042700
*                          DEFAULT: ANY_CLASS                         * 00042800
*                                                                     * 00042900
*                                                                     * 00043000
*                                                                     * 00043100
*                                                                     * 00043200
*                      ÝJOB=»xjob!ANY_JOBº¨¨                          * 00043300
*                          is the name (RS-type), or address in       * 00043400
*                          register (2)-(12), of an optional 8        * 00043500
*                          character input that indicates the jobname * 00043600
*                          of the job which issued the commands.      * 00043700
*                          DEFAULT: ANY_JOB                           * 00043800
*                                                                     * 00043900
*                                                                     * 00044000
*                                                                     * 00044100
*                                                                     * 00044200
*                                                                     * 00044300
*                                                                     * 00044400
*                                                                     * 00044500
*                                                                     * 00044600
*                                                                     * 00044700
*                                                                     * 00044800
*                                                                     * 00044900
*                                                                     * 00045000
*      ÝRETCODE=xretcode¨                                             * 00045100
*          is the name (RS-type) of an optional fullword output       * 00045200
*          variable, or register (2)-(12) or (15), into which the     * 00045300
*          return code is to be copied from GPR 15.  If you specify   * 00045400
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00045500
*          the value will be left in GPR 15.                          * 00045600
*                                                                     * 00045700
*                                                                     * 00045800
*                                                                     * 00045900
*                                                                     * 00046000
*      ÝRSNCODE=xrsncode¨                                             * 00046100
*          is the name (RS-type) of an optional fullword output       * 00046200
*          variable into which the reason code is to be copied from   * 00046300
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00046400
*          R0 (within or without parentheses), the value will be left * 00046500
*          in GPR 0.                                                  * 00046600
*                                                                     * 00046700
*                                                                     * 00046800
*                                                                     * 00046900
*                                                                     * 00047000
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00047100
*          is an optional byte input decimal value in the "1-1" range * 00047200
*          that specifies the macro version.  PLISTVER is the only    * 00047300
*          key allowed on the list form of MF and determines which    * 00047400
*          parameter list is generated.  Note that MAX may be         * 00047500
*          specified instead of a number, and the parameter list will * 00047600
*          be of the largest size currently supported. This size may  * 00047700
*          grow from release to release (thus possibly affecting the  * 00047800
*          amount of storage needed by your program).  If your        * 00047900
*          program can tolerate this, IBM recommends that you always  * 00048000
*          specify MAX when creating the list form parameter list as  * 00048100
*          that will ensure that the list form parameter list is      * 00048200
*          always long enough to hold whatever parameters might be    * 00048300
*          specified on the execute form.                             * 00048400
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00048500
*          default is the lowest version which allows all of the      * 00048600
*          parameters specified on the invocation to be processed.    * 00048700
*                                                                     * 00048800
*                                                                     * 00048900
*                                                                     * 00049000
*                                                                     * 00049100
*      ÝMF=»S!L!M!Eº¨                                                 * 00049200
*          is an optional keyword input which specifies the macro     * 00049300
*          form.                                                      * 00049400
*          DEFAULT: S                                                 * 00049500
*                                                                     * 00049600
*                                                                     * 00049700
*          ÝMF=S¨                                                     * 00049800
*              specifies the standard form of the macro.  The "S"     * 00049900
*              form generates code to put the parameters into an      * 00050000
*              in-line parameter list and invoke the desired service. * 00050100
*              Full checking for required macro keys is done along    * 00050200
*              with supplying defaults for omitted optional           * 00050300
*              parameters.                                            * 00050400
*                                                                     * 00050500
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00050600
*              specifies the list form of the macro.  The "L" form    * 00050700
*              defines an area to be used for the parameter list.     * 00050800
*              Only the PLISTVER key may be specified on the          * 00050900
*              invocation.  All other macro parameters are flagged as * 00051000
*              errors.  If PLISTVER is not specified, the original    * 00051100
*              parameter list definition is used.                     * 00051200
*                                                                     * 00051300
*            ,xmfctrl                                                 * 00051400
*              is a required input.  It is the name of a storage area * 00051500
*              for the parameter list.                                * 00051600
*                                                                     * 00051700
*            »,xmfattr!0Dº                                            * 00051800
*              is an optional 60 character input string that varies   * 00051900
*              from 1 to 60 characters. Use it to force boundary      * 00052000
*              alignment of the parameter list. Use only 0F or 0D.    * 00052100
*              DEFAULT: 0D which forces the parameter list to a       * 00052200
*              doubleword boundary.                                   * 00052300
*                                                                     * 00052400
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00052500
*              specifies the modify form of the macro.  The "M" form  * 00052600
*              generates code to put the parameters into the          * 00052700
*              parameter list specified by xmfctrl.                   * 00052800
*                                                                     * 00052900
*            ,xmfctrl                                                 * 00053000
*              is a required input.  It is the name (RS-type), or     * 00053100
*              address in register (1)-(12), of a storage area for    * 00053200
*              the parameter list.                                    * 00053300
*                                                                     * 00053400
*            »,COMPLETE!NOCHECKº¨                                     * 00053500
*              is an optional keyword input which specifies the       * 00053600
*              degree of macro parameter syntax checking.             * 00053700
*              DEFAULT: COMPLETE                                      * 00053800
*                                                                     * 00053900
*                                                                     * 00054000
*              COMPLETE                                               * 00054100
*                  Checking for required macro keys is done and       * 00054200
*                  defaults are supplied for omitted optional         * 00054300
*                  parameters.  (See Macro Usage Note 2).             * 00054400
*                                                                     * 00054500
*              NOCHECK                                                * 00054600
*                  Checking for required macro keys is not done nor   * 00054700
*                  are defaults supplied for omitted optional         * 00054800
*                  parameters.                                        * 00054900
*                                                                     * 00055000
*                                                                     * 00055100
*                                                                     * 00055200
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00055300
*              specifies the execute form of the macro.  The "E" form * 00055400
*              generates code to put the parameters into the          * 00055500
*              parameter list specified by xmfctrl and invoke the     * 00055600
*              desired service.                                       * 00055700
*                                                                     * 00055800
*            ,xmfctrl                                                 * 00055900
*              is a required input.  It is the name (RS-type), or     * 00056000
*              address in register (1)-(12), of a storage area for    * 00056100
*              the parameter list.                                    * 00056200
*                                                                     * 00056300
*            »,COMPLETE!NOCHECKº                                      * 00056400
*              is an optional keyword input which specifies the       * 00056500
*              degree of macro parameter syntax checking.             * 00056600
*              DEFAULT: COMPLETE                                      * 00056700
*                                                                     * 00056800
*                                                                     * 00056900
*              COMPLETE                                               * 00057000
*                  Checking for required macro keys is done and       * 00057100
*                  defaults are supplied for omitted optional         * 00057200
*                  parameters.  (See Macro Usage Note 2).             * 00057300
*                                                                     * 00057400
*              NOCHECK                                                * 00057500
*                  Checking for required macro keys is not done nor   * 00057600
*                  are defaults supplied for omitted optional         * 00057700
*                  parameters.                                        * 00057800
*                                                                     * 00057900
*                                                                     * 00058000
*                                                                     * 00058100
*                                                                     * 00058200
*                                                                     * 00058300
*                                                                     * 00058400
*                                                                     * 00058500
*01* RETURN CODES:                                                    * 00058600
*                                                                     * 00058700
*                                                                     * 00058800
*          X'00'  Name: CMDS_RC_OK                                    * 00058900
*                                                                     * 00059000
*                 Meaning:  Matching commands have been found.  In    * 00059100
*                 the case of a REQUEST type of INFO or REMOVE, the   * 00059200
*                 output buffer was sufficient to hold all of the     * 00059300
*                 information for the commands meeting the search     * 00059400
*                 criteria.                                           * 00059500
*                                                                     * 00059600
*                 Action:  None required.                             * 00059700
*                                                                     * 00059800
*          X'04'  Name: CMDS_RC_NOCMDS                                * 00059900
*                                                                     * 00060000
*                 Meaning:  No commands meet the specified filters.   * 00060100
*                                                                     * 00060200
*                 Action:  None required.                             * 00060300
*                                                                     * 00060400
*          X'08'  Name: CMDS_RC_NOSTOR                                * 00060500
*                                                                     * 00060600
*                 Meaning:  Insufficient return buffer storage to     * 00060700
*                 complete the query operation.                       * 00060800
*                                                                     * 00060900
*                 Action:  Refer to the action provided with the      * 00061000
*                 specific reason code.                               * 00061100
*                                                                     * 00061200
*                                                                     * 00061300
*                 HEX REASON  MEANING/ACTION                          * 00061400
*                 CODE                                                * 00061500
*                                                                     * 00061600
*                 X'04'       Name: CMDS_RS_SOMECMDS                  * 00061700
*                                                                     * 00061800
*                             Meaning: The output buffer is too small * 00061900
*                             to contain all requested information,   * 00062000
*                             but does contain the information for    * 00062100
*                             one or more commands.                   * 00062200
*                                                                     * 00062300
*                             If REQUEST=REMOVE, the system has       * 00062400
*                             removed only the commands for which     * 00062500
*                             information is returned.                * 00062600
*                                                                     * 00062700
*                             Action: The count of matching commands  * 00062800
*                             has been returned. Adjust the buffer    * 00062900
*                             size so that it is at least as large as * 00063000
*                             the count multipled by the output size  * 00063100
*                             for each entry, plus the length of the  * 00063200
*                             header, and issue the macro again.      * 00063300
*                                                                     * 00063400
*                             The constant CMDS_HEADER_LENGTH         * 00063500
*                             represents the amount of storage        * 00063600
*                             required for the buffer header.         * 00063700
*                                                                     * 00063800
*                             The constant CMDS_ENTRY_LENGTH          * 00063900
*                             represents the amount of storage        * 00064000
*                             required per command.                   * 00064100
*                                                                     * 00064200
*                             These constants are declared in mapping * 00064300
*                             macro IEEZB889.                         * 00064400
*                                                                     * 00064500
*                 X'08'       Name: CMDS_RS_NOCMDS                    * 00064600
*                                                                     * 00064700
*                             Meaning: The output buffer is too small * 00064800
*                             to contain the information for even one * 00064900
*                             command.                                * 00065000
*                                                                     * 00065100
*                             Action: The count of matching commands  * 00065200
*                             has been returned. Adjust the buffer    * 00065300
*                             size so that it is at least as large as * 00065400
*                             the count multipled by the output size  * 00065500
*                             for each entry, plus the length of the  * 00065600
*                             header, and issue the macro again.      * 00065700
*                                                                     * 00065800
*                             If REQUEST=REMOVE, the system has not   * 00065900
*                             removed any commands.                   * 00066000
*                                                                     * 00066100
*                             The constant CMDS_HEADER_LENGTH         * 00066200
*                             represents the amount of storage        * 00066300
*                             required for the buffer header.         * 00066400
*                                                                     * 00066500
*                             The constant CMDS_ENTRY_LENGTH          * 00066600
*                             represents the amount of storage        * 00066700
*                             required per command.                   * 00066800
*                                                                     * 00066900
*                             These constants are declared in mapping * 00067000
*                             macro IEEZB889.                         * 00067100
*                                                                     * 00067200
*                                                                     * 00067300
*                                                                     * 00067400
*          X'10'  Name: CMDS_RC_INVPL                                 * 00067500
*                                                                     * 00067600
*                 Meaning:  Invalid parameter list.                   * 00067700
*                                                                     * 00067800
*                 Action:  Refer to the action provided with the      * 00067900
*                 specific reason code.                               * 00068000
*                                                                     * 00068100
*                                                                     * 00068200
*                 HEX REASON  MEANING/ACTION                          * 00068300
*                 CODE                                                * 00068400
*                                                                     * 00068500
*                 X'04'       Name: CMDS_RS_INVACRN                   * 00068600
*                                                                     * 00068700
*                             Meaning:  The acronym in the parameter  * 00068800
*                             list was invalid.                       * 00068900
*                                                                     * 00069000
*                             Action:  Correct the acronym in the     * 00069100
*                             parameter list and issue IEECMDS again. * 00069200
*                                                                     * 00069300
*                 X'08'       Name: CMDS_RS_INVADDR                   * 00069400
*                                                                     * 00069500
*                             Meaning:  An output address is invalid. * 00069600
*                             An ABEND occured while trying to access * 00069700
*                             storage at an address specified in the  * 00069800
*                             parameter list, possibly because that   * 00069900
*                             storage is not accessible by the        * 00070000
*                             caller, or the storage does not exist.  * 00070100
*                                                                     * 00070200
*                             Action:  Correct the invalid address in * 00070300
*                             the parameter list and issue IEECMDS    * 00070400
*                             again.                                  * 00070500
*                                                                     * 00070600
*                 X'0C'       Name: CMDS_RS_INVBUFFER                 * 00070700
*                                                                     * 00070800
*                             Meaning:  The address or length of the  * 00070900
*                             buffer in the parameter list was        * 00071000
*                             invalid.                                * 00071100
*                                                                     * 00071200
*                             Action:  Correct the values of BUFFER   * 00071300
*                             and/or BUFSIZE in the parameter list    * 00071400
*                             and issue IEECMDS again.                * 00071500
*                                                                     * 00071600
*                 X'10'       Name: CMDS_RS_INVLGTH                   * 00071700
*                                                                     * 00071800
*                             Meaning:  The length of the parameter   * 00071900
*                             list is invalid.                        * 00072000
*                                                                     * 00072100
*                             Action:  Correct the length in the      * 00072200
*                             parameter list and issue IEECMDS again. * 00072300
*                                                                     * 00072400
*                 X'14'       Name: CMDS_RS_INVVERS                   * 00072500
*                                                                     * 00072600
*                             Meaning:  The version specified in the  * 00072700
*                             parameter list is invalid.              * 00072800
*                                                                     * 00072900
*                             Action:  Correct the version in the     * 00073000
*                             parameter list and issue IEECMDS again. * 00073100
*                                                                     * 00073200
*                 X'18'       Name: CMDS_RS_INVFUNC                   * 00073300
*                                                                     * 00073400
*                             Meaning:  The REQUEST type specified in * 00073500
*                             the parameter list is not a valid       * 00073600
*                             REQUEST type.                           * 00073700
*                                                                     * 00073800
*                             Action:  Correct the REQUEST type in    * 00073900
*                             the parameter list and issue IEECMDS    * 00074000
*                             again.                                  * 00074100
*                                                                     * 00074200
*                 X'1C'       Name: CMDS_RS_INVCLASS                  * 00074300
*                                                                     * 00074400
*                             Meaning:  The CLASS specified in the    * 00074500
*                             parameter list is not a valid CLASS     * 00074600
*                             name.                                   * 00074700
*                                                                     * 00074800
*                             Action:  Correct the CLASS in the       * 00074900
*                             parameter list and issue IEECMDS again. * 00075000
*                                                                     * 00075100
*                 X'20'       Name: CMDS_RS_INVID                     * 00075200
*                                                                     * 00075300
*                             Meaning: The ID specified in the        * 00075400
*                             parameter list is not a valid ID value. * 00075500
*                             The ID value must be a decimal number   * 00075600
*                             in EBCDIC (printable) characters.       * 00075700
*                                                                     * 00075800
*                             Action:  Correct the ID in the          * 00075900
*                             parameter list and issue IEECMDS again. * 00076000
*                                                                     * 00076100
*                                                                     * 00076200
*                                                                     * 00076300
*          X'40'  Name: CMDS_RC_SYSERR                                * 00076400
*                                                                     * 00076500
*                 Meaning:  System Error.  This return code is for    * 00076600
*                 IBM diagnostic purposes only.                       * 00076700
*                                                                     * 00076800
*                 Action:  Record the return and reason codes and     * 00076900
*                 supply it to the appropriate IBM support personnel. * 00077000
*                                                                     * 00077100
*                                                                     * 00077200
*                 HEX REASON  MEANING/ACTION                          * 00077300
*                 CODE                                                * 00077400
*                                                                     * 00077500
*                 X'04'       Name: CMDS_RS_SYSABEND                  * 00077600
*                                                                     * 00077700
*                             Meaning:  An ABEND occurred during      * 00077800
*                             processing.   This reason code is for   * 00077900
*                             IBM diagnostic purposes only.           * 00078000
*                                                                     * 00078100
*                             Action:  Record the return and reason   * 00078200
*                             codes and supply it to the appropriate  * 00078300
*                             IBM support personnel.                  * 00078400
*                                                                     * 00078500
*                 X'08'       Name: CMDS_RS_SYSERR                    * 00078600
*                                                                     * 00078700
*                             Meaning:  An error occurred during      * 00078800
*                             processing.   This reason code is for   * 00078900
*                             IBM diagnostic purposes only.           * 00079000
*                                                                     * 00079100
*                             Action:  Record the return and reason   * 00079200
*                             codes and supply it to the appropriate  * 00079300
*                             IBM support personnel.                  * 00079400
*                                                                     * 00079500
*                                                                     * 00079600
*                                                                     * 00079700
*          X'F001' Name: CMDS_RC_Cmd_Not_Abendable                    * 00079800
*                                                                     * 00079900
*                 Meaning:  MarkCMDSAbend has been requested but      * 00080000
*                 could not be processed since the command is marked  * 00080100
*                 non-abendable.                                      * 00080200
*                                                                     * 00080300
*                 Action:  None.                                      * 00080400
*                                                                     * 00080500
*                                                                     * 00080600
*                                                                     * 00080700
*01* REASON CODES:                                                    * 00080800
*                                                                     * 00080900
*01* MODULE TYPE:  ASSEM MACRO                                        * 00081000
*                                                                     * 00081100
*02*   PROCESSOR:  ASSEM                                              * 00081200
*                                                                     * 00081300
*01* COMPONENT:  SC1B8                                                * 00081400
*                                                                     * 00081500
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00081600
*                                                                     * 00081700
*01* ABEND CODES:  None.                                              * 00081800
*                                                                     * 00081900
*01* MACRO USAGE NOTES:                                               * 00082000
*                                                                     * 00082100
*                                                                     * 00082200
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00082300
*        global macro variable.  Any value other than 'NO' will       * 00082400
*        result in the macro expansion being printed.  The default is * 00082500
*        'YES'.  The following examples illustrate how the ZPRINT     * 00082600
*        variable should be set.                                      * 00082700
*                                                                     * 00082800
*                    GBLC &ZPRINT                                     * 00082900
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00083000
*                                                                     * 00083100
*                                                                     * 00083200
*    2.  When using the NOCHECK option in conjunction with the Modify * 00083300
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00083400
*        Modify   or  Execute  form  invocation  which  specifies  or * 00083500
*        defaults  to  the  COMPLETE  option.   This insures that the * 00083600
*        parameter  list  is  initialized completely.   The parameter * 00083700
*        list  field which identifies the version number of the macro * 00083800
*        is only set when the Standard form or the Complete option of * 00083900
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00084000
*        explicitly  specified.  Be sure that the resulting parameter * 00084100
*        list version number covers all the keys that you use.        * 00084200
*                                                                     * 00084300
*                                                                     * 00084400
*    3.  All keys currently contained in the IEECMDS macro correspond * 00084500
*        to  version 1.  If you specify PLISTVER, use a value of 1 or * 00084600
*        MAX.                                                         * 00084700
*                                                                     * 00084800
*                                                                     * 00084900
*                                                                     * 00085000
*                                                                     * 00085100
*01* CHANGE ACTIVITY:                                                 * 00085200
*                                                                     * 00085300
*   Flag LineItem  FMID    Date   ID    Comment                       * 00085400
*                                                                     * 00085500
*    $L0=CMDFL    HBB7705 000630 PDHD:  Command Flooding              * 00085600
*    $P1=PXV0182  HBB7705 000630 PDHD:  COUNT should be an input      * 00085700
*                                         parameter                   * 00085800
*    $01=OW52913  HBB7703 020215 PDKP:  Add new command classes       * 00085900
*    $P2=ME12170  HBB7750 080222 PDOH:  Handle dirty AR registers     * 00086000
*                                         while running in AR mode    * 00086100
*    $L1=ME15693  HBB7770 090326 PDSS:  Support internal requests     * 00086200
*    $P3=ME16096  HBB7770 090831 PDSS:  Add cmts about MarkCmdsAbend  * 00086300
****** END OF SPECIFICATIONS *****************************************/ 00086400
*/********************************************************************* 00086500
         MACRO                                                          00086600
&XLABEL  IEECMDS &IBMINT=,&REQUEST=,&BUFFER=,&BUFSIZE=,&CLASS=,&CMD=,  *00086700
               &ID=,&JOB=,&COUNT=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=   00086800
.*                                                                      00086900
*                   MACDATE -09/08/31-<1>                               00087000
.*                                                                      00087100
.*******************************************************************    00087200
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00087300
.*******************************************************************    00087400
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              00087500
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                00087600
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        00087700
.*                                                                      00087800
                   GBLC  &ZIEECMDS   YES=MACRO USED AT LEAST ONCE       00087900
.*******************************************************************    00088000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00088100
.*******************************************************************    00088200
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            00088300
                   LCLC  &ZCNDX      SYSNDX CHARACTERS                  00088400
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         00088500
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        00088600
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        00088700
                   LCLA  &ZAWRK      USED AS A WORK AREA                00088800
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             00088900
                   LCLA  &ZN         NUMERIC WORK VARIABLE              00089000
                   LCLC  &ZC         CHARACTER WORK VARIABLE            00089100
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        00089200
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            00089300
                   LCLC  &ZMAC_G     "G" or null                        00089400
&ZMAC_G            SETC  ''                                             00089500
                   LCLC  &ZMAC_LR                                       00089600
&ZMAC_LR           SETC  'LR'                                           00089700
                   LCLC  &ZMAC_L                                        00089800
&ZMAC_L            SETC  'L'                                            00089900
                   LCLC  &ZMAC_ST                                       00090000
&ZMAC_ST           SETC  'ST'                                           00090100
                   LCLA  &ZMACRET    MACRO RETURN CODE                  00090200
&ZMACRET           SETA  0           ASSUME NO ERRORS                   00090300
.*                                                                      00090400
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      00090500
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         00090600
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              00090700
                   LCLC  &ZENDBASEPL            End of base PL          00090800
                   LCLA  &ZPLWORKA   PARAMETER LIST LENGTH              00090900
.*******************************************************************    00091000
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00091100
.*******************************************************************    00091200
                   LCLA  &ZI         INDEX FOR ARRAY                    00091300
                   LCLA  &ZJ         INDEX FOR PARMS                    00091400
                   LCLA  &ZK         INDEX FOR PARSE                    00091500
                   LCLA  &ZLO        LOW RANGE VALUE                    00091600
                   LCLA  &ZHI        HIGH RANGE VALUE                   00091700
                   LCLC  &ZW         WORK AREA FOR PARM                 00091800
.********************************************************************   00091900
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00092000
.********************************************************************   00092100
                   GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL            00092200
                   GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE     00092300
                   GBLA  &SYSALVL    SYSSTATE ARCHLVL                   00092400
                   GBLC  &SYSAM64    SYSSTATE AMODE64                   00092500
.*                                                                      00092600
                   AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED     00092700
                   AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED      00092800
                   SPLEVEL  TEST                                        00092900
.ZSYS2             ANOP  ,                                              00093000
                   AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1          00093100
                   AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1          00093200
                   SYSSTATE TEST                                        00093300
                   AGO   .ZSYS4                                         00093400
.ZSYS3             ANOP  ,                                              00093500
&SYSASCE           SETC  'P'         ASSUME SYSSTATE PRIMARY            00093600
.ZSYS4             ANOP  ,                                              00093700
.*******************************************************************    00093800
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00093900
.*******************************************************************    00094000
                   LCLC  &XIBMINT    ++ VALUE                           00094100
                   LCLC  &XREQUEST   ++ VALUE                           00094200
                   LCLC  &XBUFFER    ++ NAME                            00094300
                   LCLC  &XBUFSIZE   ++ NAME                            00094400
                   LCLC  &XCLASS     ++ NAME                            00094500
                   LCLC  &XCMD       ++ NAME                            00094600
                   LCLC  &XID        ++ NAME                            00094700
                   LCLC  &XJOB       ++ NAME                            00094800
                   LCLC  &XCOUNT     ++ NAME                            00094900
                   LCLC  &XRETCODE   ++ NAME                            00095000
                   LCLC  &XRSNCODE   ++ NAME                            00095100
                   LCLA  &XPLISTVER  ++ VALUE                           00095200
                   LCLC  &XMF        ++ VALUE                           00095300
                   LCLC  &XMFCTRL    ++ NAME                            00095400
                   LCLC  &XMFATTR    ++ VALUE                           00095500
                   LCLC  &XMFSCK     ++ VALUE                           00095600
.*******************************************************************    00095700
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00095800
.*******************************************************************    00095900
                   LCLC  &ZXIBMINT   ++ INPUT VALUE                     00096000
                   LCLC  &ZXREQUEST  ++ INPUT VALUE                     00096100
                   LCLC  &ZXBUFFER   ++ INPUT NAME                      00096200
                   LCLC  &ZXBUFSIZE  ++ INPUT NAME                      00096300
                   LCLC  &ZXCLASS    ++ INPUT NAME                      00096400
                   LCLC  &ZXCMD      ++ INPUT NAME                      00096500
                   LCLC  &ZXID       ++ INPUT NAME                      00096600
                   LCLC  &ZXJOB      ++ INPUT NAME                      00096700
                   LCLC  &ZXCOUNT    ++ INPUT NAME                      00096800
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     00096900
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     00097000
                   LCLC  &ZXPLISTVER            ++ INPUT VALUE          00097100
                   LCLC  &ZXMF       ++ INPUT VALUE                     00097200
                   LCLC  &ZXMFCTRL   ++ INPUT NAME                      00097300
                   LCLC  &ZXMFATTR   ++ INPUT VALUE                     00097400
                   LCLC  &ZXMFSCK    ++ INPUT VALUE                     00097500
.********************************************************************   00097600
.***AC.PLV01  PROCESS PLISTVER                                      *   00097700
.********************************************************************   00097800
&XPLISTVER      SETA  1                                                 00097900
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00098000
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00098100
&XPLISTVER      SETA  1                                                 00098200
.ZPLV0          ANOP  ,                                                 00098300
.*                                                                      00098400
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00098500
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00098600
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00098700
.*-------------------------------------------------------------------   00098800
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00098900
&ZMS            SETC  '"PLISTVER='                                      00099000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00099100
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00099200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00099300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00099400
                AGO   .ZPVCK2                                           00099500
.ZPVCK3         ANOP  ,                                                 00099600
.*-------------------------------------------------------------------   00099700
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00099800
&ZMS            SETC  '"PLISTVER='                                      00099900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00100000
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00100100
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00100200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00100300
                AGO   .ZPVCKE                                           00100400
.ZPVCK2         ANOP  ,                                                 00100500
.*-------------------------------------------------------------------   00100600
&ZCVAL          SETC  '&PLISTVER(1)'                                    00100700
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00100800
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00100900
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00101000
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00101100
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00101200
.ZPVCK6         ANOP  ,                                                 00101300
&ZMS            SETC  '"PLISTVER='                                      00101400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00101500
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00101600
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00101700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00101800
&XPLISTVER      SETA  1                                                 00101900
                AGO   .ZPVCKE                                           00102000
.*-------------------------------------------------------------------   00102100
.ZPVCK4A        ANOP  ,                                                 00102200
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00102300
&ZMS            SETC  'PLISTVER='                                       00102400
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00102500
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00102600
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00102700
                MNOTE 8,' &ZMS IS REQUIRED.'                            00102800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00102900
                AGO   .ZPVCK5                                           00103000
.ZPVCK4         ANOP  ,                                                 00103100
&XPLISTVER      SETA  &PLISTVER(1)                                      00103200
.ZPVCK5         ANOP  ,                                                 00103300
.ZPVCKE         ANOP  ,                                                 00103400
.********************************************************************   00103500
.***AG.MF01 PROCESS MF MACRO FORMS                                      00103600
.********************************************************************   00103700
                   ACTR  10000                                          00103800
.*------------------------------------------------------------------    00103900
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00104000
&XMF               SETC  ''          INITIALIZE XVARIABLE               00104100
.*-------------------------------------------------------------------   00104200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00104300
.ZG74              ANOP  ,                                              00104400
&ZTLC              SETC 'S'                                             00104500
                   AIF   ('&MF(1)' NE '&ZTLC').ZG75                     00104600
&XMF               SETC  'S'         SET KEYWORD                        00104700
&XMFSCK            SETC  'COMPLETE'  SET XMFSCK                         00104800
                   AIF   (N'&MF LE 1).ZG74A     CK NUM                  00104900
&ZMS               SETC  '"MF='                                         00105000
&ZMS               SETC  '&ZMS.&MF"'                                    00105100
&ZMS               SETC  '&ZMS "MF"'                                    00105200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00105300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00105400
.ZG74A             ANOP  ,                                              00105500
.*-------------------------------------------------------------------   00105600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00105700
.ZG75              ANOP  ,                                              00105800
&ZTLC              SETC 'L'                                             00105900
                   AIF   ('&MF(1)' NE '&ZTLC').ZG82                     00106000
&XMF               SETC  'L'         SET KEYWORD                        00106100
                   AIF   (N'&MF LE 3).ZG75A     CK NUM                  00106200
&ZMS               SETC  '"MF='                                         00106300
&ZMS               SETC  '&ZMS.&MF"'                                    00106400
&ZMS               SETC  '&ZMS "MF"'                                    00106500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00106600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00106700
.ZG75A             ANOP  ,                                              00106800
.*-------------------------------------------------------------------   00106900
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00107000
                   AIF   (N'&SYSLIST NE 0).ZG75B  POSITIONALS?          00107100
                   AIF   ('&IBMINT' NE '').ZG75B  KEYS?                 00107200
                   AIF   ('&REQUEST' NE '').ZG75B  KEYS?                00107300
                   AIF   ('&BUFFER' NE '').ZG75B  KEYS?                 00107400
                   AIF   ('&BUFSIZE' NE '').ZG75B  KEYS?                00107500
                   AIF   ('&CLASS' NE '').ZG75B  KEYS?                  00107600
                   AIF   ('&CMD' NE '').ZG75B   KEYS?                   00107700
                   AIF   ('&ID' NE '').ZG75B    KEYS?                   00107800
                   AIF   ('&JOB' NE '').ZG75B   KEYS?                   00107900
                   AIF   ('&COUNT' NE '').ZG75B  KEYS?                  00108000
                   AIF   ('&RETCODE' NE '').ZG75B  KEYS?                00108100
                   AIF   ('&RSNCODE' NE '').ZG75B  KEYS?                00108200
                   AGO    .ZG75C     INVOCATION OKAY                    00108300
.ZG75B             ANOP  ,                                              00108400
&ZMS               SETC  'THE "L" FORM OF "MF"'                         00108500
&ZMS               SETC  '&ZMS CAN ONLY HAVE'                           00108600
&ZMS               SETC  '&ZMS THE "PLISTVER" KEY'                      00108700
                   MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'         00108800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00108900
.ZG75C             ANOP  ,                                              00109000
.*-------------------------------------------------------------------   00109100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00109200
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00109300
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00109400
                   AIF   (N'&MF(2) GT 1).ZG77B  MULTI PARMS             00109500
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00109600
.ZG77B             AIF   (K'&MF(2) GT 0).ZG77C                          00109700
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00109800
&ZMS               SETC  ' '                                            00109900
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00110000
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00110100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00110200
.ZG77C             ANOP  ,                                              00110300
.*-------------------------------------------------------------------   00110400
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00110500
                   AIF   (K'&ZXMFCTRL LE 0).ZG77P  NOT I/O              00110600
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG77P                 00110700
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00110800
&ZMS               SETC  '"MF='                                         00110900
&ZMS               SETC  '&ZMS.&MF"'                                    00111000
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00111100
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'              00111200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00111300
.ZG77P             ANOP  ,                                              00111400
.*-------------------------------------------------------------------   00111500
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00111600
&ZXMFATTR          SETC  'INPUT'     SET IN/OUTPUT                      00111700
&XMFATTR           SETC  '0D'                                           00111800
                   AIF   (K'&MF(3) LE 0).ZG80B  PARM                    00111900
&XMFATTR           SETC  '&MF(3,1)'  SET XVARIABLE                      00112000
                   AIF   (N'&MF(3) GT 1).ZG80B  MULTI                   00112100
&XMFATTR           SETC  '&MF(3)'    SET XVARIABLE                      00112200
.ZG80B             ANOP  ,                                              00112300
.*-------------------------------------------------------------------   00112400
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00112500
                   AIF   (K'&ZXMFATTR LE 0).ZG80P  NOT I/O              00112600
                   AIF   ('&XMFATTR'(1,1) NE '(').ZG80P                 00112700
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00112800
&ZMS               SETC  '"MF='                                         00112900
&ZMS               SETC  '&ZMS.&MF"'                                    00113000
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00113100
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'              00113200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00113300
.ZG80P             ANOP  ,                                              00113400
.*-------------------------------------------------------------------   00113500
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00113600
                   AIF   (K'&ZXMFATTR LE 0).ZG80S  NOT I/O              00113700
                   AIF   (K'&XMFATTR LE 60).ZG80S  LNG OK               00113800
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00113900
&ZMS               SETC  '"MF='                                         00114000
&ZMS               SETC  '&ZMS.&MF"'                                    00114100
&ZMS               SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'          00114200
                   MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'             00114300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00114400
.ZG80S             ANOP  ,                                              00114500
.*-------------------------------------------------------------------   00114600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00114700
.ZG82              ANOP  ,                                              00114800
&ZTLC              SETC 'M'                                             00114900
                   AIF   ('&MF(1)' NE '&ZTLC').ZG91                     00115000
&XMF               SETC  'M'         SET KEYWORD                        00115100
                   AIF   (N'&MF LE 3).ZG82A     CK NUM                  00115200
&ZMS               SETC  '"MF='                                         00115300
&ZMS               SETC  '&ZMS.&MF"'                                    00115400
&ZMS               SETC  '&ZMS "MF"'                                    00115500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00115600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00115700
.ZG82A             ANOP  ,                                              00115800
.*-------------------------------------------------------------------   00115900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00116000
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00116100
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00116200
                   AIF   (N'&MF(2) GT 1).ZG84B  MULTI PARMS             00116300
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00116400
.ZG84B             AIF   (K'&MF(2) GT 0).ZG84C                          00116500
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00116600
&ZMS               SETC  ' '                                            00116700
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00116800
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00116900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00117000
.ZG84C             ANOP  ,                                              00117100
.*-------------------------------------------------------------------   00117200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00117300
                   AIF   (K'&ZXMFCTRL LE 0).ZG84R  NOT I/O              00117400
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG84R                 00117500
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     00117600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG84P                   00117700
                   AIF   (K'&ZCGPR GT 2).ZG84Q                          00117800
                   AIF   ('&ZCGPR' EQ '0').ZG84Q                        00117900
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00118000
                   AIF   (T'&ZCGPR NE 'N').ZG84Q  INVALID REG NAME      00118100
.ZG84P             ANOP  ,                                              00118200
                   AIF   (T'&ZCGPR NE 'N').ZG84R  NON NUMERIC           00118300
                   AIF   ('&ZCGPR' LT '1').ZG84Q                        00118400
                   AIF   ('&ZCGPR' LE '12').ZG84R                       00118500
.ZG84Q             ANOP  ,                                              00118600
&ZMS               SETC  '"MF='                                         00118700
&ZMS               SETC  '&ZMS.&MF"'                                    00118800
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      00118900
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               00119000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00119100
.ZG84R             ANOP  ,                                              00119200
.*-------------------------------------------------------------------   00119300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00119400
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               00119500
.ZG88A   AIF   ('&MF(3)' NE 'COMPLETE').ZG89A                           00119600
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        00119700
.*-------------------------------------------------------------------   00119800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00119900
.ZG89A   AIF   ('&MF(3)' NE 'NOCHECK').ZG90A                            00120000
&XMFSCK            SETC  'NOCHECK'   SET KEYWORD                        00120100
.*-------------------------------------------------------------------   00120200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00120300
.ZG90A             AIF   (K'&XMFSCK GT 0).ZG90C  KEYWORD                00120400
                   AIF   (K'&MF(3) LE 0).ZG90B                          00120500
&ZMS               SETC  '"MF='                                         00120600
&ZMS               SETC  '&ZMS.&MF"'                                    00120700
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      00120800
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00120900
&ZMS               SETC  '&ZMS "COMPLETE"'                              00121000
&ZMS               SETC  '&ZMS OR "NOCHECK".'                           00121100
                   MNOTE 8,' &ZMS '                                     00121200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00121300
.ZG90B             ANOP  ,                                              00121400
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                00121500
.ZG90C             ANOP  ,                                              00121600
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      00121700
.*-------------------------------------------------------------------   00121800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121900
.ZG91              ANOP  ,                                              00122000
&ZTLC              SETC 'E'                                             00122100
                   AIF   ('&MF(1)' NE '&ZTLC').ZG100                    00122200
&XMF               SETC  'E'         SET KEYWORD                        00122300
                   AIF   (N'&MF LE 3).ZG91A     CK NUM                  00122400
&ZMS               SETC  '"MF='                                         00122500
&ZMS               SETC  '&ZMS.&MF"'                                    00122600
&ZMS               SETC  '&ZMS "MF"'                                    00122700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00122800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00122900
.ZG91A             ANOP  ,                                              00123000
.*-------------------------------------------------------------------   00123100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00123200
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00123300
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00123400
                   AIF   (N'&MF(2) GT 1).ZG93B  MULTI PARMS             00123500
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00123600
.ZG93B             AIF   (K'&MF(2) GT 0).ZG93C                          00123700
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00123800
&ZMS               SETC  ' '                                            00123900
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00124000
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00124100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00124200
.ZG93C             ANOP  ,                                              00124300
.*-------------------------------------------------------------------   00124400
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00124500
                   AIF   (K'&ZXMFCTRL LE 0).ZG93R  NOT I/O              00124600
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG93R                 00124700
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     00124800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG93P                   00124900
                   AIF   (K'&ZCGPR GT 2).ZG93Q                          00125000
                   AIF   ('&ZCGPR' EQ '0').ZG93Q                        00125100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00125200
                   AIF   (T'&ZCGPR NE 'N').ZG93Q  INVALID REG NAME      00125300
.ZG93P             ANOP  ,                                              00125400
                   AIF   (T'&ZCGPR NE 'N').ZG93R  NON NUMERIC           00125500
                   AIF   ('&ZCGPR' LT '1').ZG93Q                        00125600
                   AIF   ('&ZCGPR' LE '12').ZG93R                       00125700
.ZG93Q             ANOP  ,                                              00125800
&ZMS               SETC  '"MF='                                         00125900
&ZMS               SETC  '&ZMS.&MF"'                                    00126000
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      00126100
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               00126200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00126300
.ZG93R             ANOP  ,                                              00126400
.*-------------------------------------------------------------------   00126500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00126600
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               00126700
.ZG97A   AIF   ('&MF(3)' NE 'COMPLETE').ZG98A                           00126800
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        00126900
.*-------------------------------------------------------------------   00127000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00127100
.ZG98A   AIF   ('&MF(3)' NE 'NOCHECK').ZG99A                            00127200
&XMFSCK            SETC  'NOCHECK'   SET KEYWORD                        00127300
.*-------------------------------------------------------------------   00127400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00127500
.ZG99A             AIF   (K'&XMFSCK GT 0).ZG99C  KEYWORD                00127600
                   AIF   (K'&MF(3) LE 0).ZG99B                          00127700
&ZMS               SETC  '"MF='                                         00127800
&ZMS               SETC  '&ZMS.&MF"'                                    00127900
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      00128000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00128100
&ZMS               SETC  '&ZMS "COMPLETE"'                              00128200
&ZMS               SETC  '&ZMS OR "NOCHECK".'                           00128300
                   MNOTE 8,' &ZMS '                                     00128400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00128500
.ZG99B             ANOP  ,                                              00128600
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                00128700
.ZG99C             ANOP  ,                                              00128800
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      00128900
.*------------------------------------------------------------------    00129000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00129100
.ZG100             ANOP  ,                                              00129200
&ZXMF              SETC  'INPUT'     SET IN/OUTPUT                      00129300
                   AIF   (K'&XMF GT 0).ZG100E   VALID ARG               00129400
                   AIF   (T'&MF EQ 'O').ZG100D  OMITTED                 00129500
&ZASYSLNDX         SETA  0                                              00129600
.ZG100A            ANOP  ,           POSITIONAL MACRO KEY               00129700
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00129800
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG100C              00129900
&ZTLC              SETC 'MF'                                            00130000
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG100A     00130100
.ZG100B            ANOP  ,                                              00130200
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00130300
&ZMS               SETC  'THE "MF" KEY'                                 00130400
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00130500
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00130600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00130700
                   AGO   .ZG100E                                        00130800
.ZG100C            ANOP  ,                                              00130900
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00131000
&ZMS               SETC  '"MF='                                         00131100
&ZMS               SETC  '&ZMS.&MF"'                                    00131200
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00131300
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00131400
&ZMS               SETC  '&ZMS "S",'                                    00131500
&ZMS               SETC  '&ZMS "L",'                                    00131600
&ZMS               SETC  '&ZMS "M",'                                    00131700
&ZMS               SETC  '&ZMS OR "E".'                                 00131800
                   MNOTE 8,' &ZMS '                                     00131900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00132000
                   AGO   .ZG100E                                        00132100
.ZG100D            ANOP  ,                                              00132200
&XMF               SETC  'S'         SET DEFAULT KEYWORD                00132300
&XMFSCK            SETC  'COMPLETE'  COMPLETE CHECKING                  00132400
.ZG100E            ANOP  ,                                              00132500
.********************************************************************   00132600
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00132700
.********************************************************************   00132800
                   ACTR  10000                                          00132900
.*-------------------------------------------------------------------   00133000
.***AG.MF03 MF=(SLME)                                                   00133100
                   AIF   ('&XMF' EQ 'L').ZGMFX                          00133200
                   AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                00133300
.*------------------------------------------------------------------    00133400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00133500
&XIBMINT           SETC  ''          INITIALIZE XVARIABLE               00133600
.*-------------------------------------------------------------------   00133700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00133800
.ZG3               ANOP  ,                                              00133900
                   AIF   (K'&IBMINT(1) LE 0).ZG3A                       00134000
&ZTLC              SETC 'NO'                                            00134100
                   AIF   ('&IBMINT(1)' NE '&ZTLC').ZG37                 00134200
&XIBMINT           SETC  'NO'        SET KEYWORD                        00134300
                   AIF   (N'&IBMINT LE 1).ZG3A  CK NUM                  00134400
&ZMS               SETC  '"IBMINT='                                     00134500
&ZMS               SETC  '&ZMS.&IBMINT"'                                00134600
&ZMS               SETC  '&ZMS "IBMINT"'                                00134700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00134800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00134900
.ZG3A              ANOP  ,                                              00135000
.*------------------------------------------------------------------    00135100
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00135200
&XREQUEST          SETC  ''          INITIALIZE XVARIABLE               00135300
.*-------------------------------------------------------------------   00135400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00135500
.ZG6               ANOP  ,                                              00135600
                   AIF   (K'&REQUEST(1) LE 0).ZG6A                      00135700
&ZTLC              SETC 'COUNT'                                         00135800
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZG7                 00135900
&XREQUEST          SETC  'COUNT'     SET KEYWORD                        00136000
                   AIF   (N'&REQUEST LE 1).ZG6A  CK NUM                 00136100
&ZMS               SETC  '"REQUEST='                                    00136200
&ZMS               SETC  '&ZMS.&REQUEST"'                               00136300
&ZMS               SETC  '&ZMS "REQUEST"'                               00136400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00136500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00136600
.ZG6A              ANOP  ,                                              00136700
.*------------------------------------------------------------------    00136800
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00136900
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00137000
.ZG6A0             AIF   (K'&BUFFER LE 0).ZG6A1  OK                     00137100
&ZCVAL             SETC '&ZCVAL BUFFER'         INCORRECT KEY USED      00137200
.ZG6A1             AIF   (K'&BUFSIZE LE 0).ZG6A2  OK                    00137300
&ZCVAL             SETC '&ZCVAL BUFSIZE'        INCORRECT KEY USED      00137400
.ZG6A2             AIF   (K'&ZCVAL LE 0).ZG6A3  OK                      00137500
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00137600
&ZMS               SETC  '"REQUEST'                                     00137700
&ZMS               SETC  '&ZMS.=&REQUEST"'                              00137800
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00137900
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00138000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00138100
.ZG6A3             ANOP  ,                                              00138200
.*-------------------------------------------------------------------   00138300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00138400
.ZG7               ANOP  ,                                              00138500
&ZTLC              SETC 'INFO'                                          00138600
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZG14                00138700
&XREQUEST          SETC  'INFO'      SET KEYWORD                        00138800
                   AIF   (N'&REQUEST LE 1).ZG7A  CK NUM                 00138900
&ZMS               SETC  '"REQUEST='                                    00139000
&ZMS               SETC  '&ZMS.&REQUEST"'                               00139100
&ZMS               SETC  '&ZMS "REQUEST"'                               00139200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00139300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00139400
.ZG7A              ANOP  ,                                              00139500
.*----------------------------------------------------------------***   00139600
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00139700
                   AIF   (N'&BUFFER LE 1).ZG9A  CK NUM                  00139800
&ZMS               SETC  '"BUFFER='                                     00139900
&ZMS               SETC  '&ZMS.&BUFFER"'                                00140000
&ZMS               SETC  '&ZMS "BUFFER"'                                00140100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00140200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00140300
.ZG9A              ANOP  ,                                              00140400
.*-------------------------------------------------------------------   00140500
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00140600
&ZXBUFFER          SETC  'INPUT'     SET IN/OUTPUT                      00140700
&XBUFFER           SETC  '&BUFFER(1)'           SET XVARIABLE           00140800
                   AIF   (N'&BUFFER GT 1).ZG9B  MULTI PARMS             00140900
&XBUFFER           SETC  '&BUFFER'   SET XVARIABLE                      00141000
.ZG9B              AIF   (K'&BUFFER(1) GT 0).ZG9C                       00141100
&ZXBUFFER          SETC  ''          RESET IN/OUTPUT                    00141200
&ZMS               SETC  ' '                                            00141300
&ZMS               SETC  '&ZMS "BUFFER" KEY AND ITS'                    00141400
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00141500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00141600
.ZG9C              ANOP  ,                                              00141700
.*-------------------------------------------------------------------   00141800
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00141900
                   AIF   (K'&ZXBUFFER LE 0).ZG9R  NOT I/O               00142000
                   AIF   ('&XBUFFER'(1,1) NE '(').ZG9R                  00142100
&ZCGPR             SETC  '&XBUFFER'(2,K'&XBUFFER-2)                     00142200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG9P                    00142300
                   AIF   (K'&ZCGPR GT 2).ZG9Q                           00142400
                   AIF   ('&ZCGPR' EQ '0').ZG9Q                         00142500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00142600
                   AIF   (T'&ZCGPR NE 'N').ZG9Q  INVALID REG NAME       00142700
.ZG9P              ANOP  ,                                              00142800
                   AIF   (T'&ZCGPR NE 'N').ZG9R  NON NUMERIC            00142900
                   AIF   ('&ZCGPR' LT '2').ZG9Q                         00143000
                   AIF   ('&ZCGPR' LE '12').ZG9R                        00143100
.ZG9Q              ANOP  ,                                              00143200
&ZMS               SETC  '"BUFFER='                                     00143300
&ZMS               SETC  '&ZMS.&BUFFER"'                                00143400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00143500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00143600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00143700
.ZG9R              ANOP  ,                                              00143800
.*----------------------------------------------------------------***   00143900
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00144000
                   AIF   (N'&BUFSIZE LE 1).ZG12A  CK NUM                00144100
&ZMS               SETC  '"BUFSIZE='                                    00144200
&ZMS               SETC  '&ZMS.&BUFSIZE"'                               00144300
&ZMS               SETC  '&ZMS "BUFSIZE"'                               00144400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00144500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00144600
.ZG12A             ANOP  ,                                              00144700
.*-------------------------------------------------------------------   00144800
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00144900
&ZXBUFSIZE         SETC  'INPUT'     SET IN/OUTPUT                      00145000
&XBUFSIZE          SETC  '&BUFSIZE(1)'          SET XVARIABLE           00145100
                   AIF   (N'&BUFSIZE GT 1).ZG12B  MULTI PARMS           00145200
&XBUFSIZE          SETC  '&BUFSIZE'  SET XVARIABLE                      00145300
.ZG12B             AIF   (K'&BUFSIZE(1) GT 0).ZG12C                     00145400
&ZXBUFSIZE         SETC  ''          RESET IN/OUTPUT                    00145500
&ZMS               SETC  ' '                                            00145600
&ZMS               SETC  '&ZMS "BUFSIZE" KEY AND ITS'                   00145700
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00145800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00145900
.ZG12C             ANOP  ,                                              00146000
.*-------------------------------------------------------------------   00146100
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00146200
                   AIF   (K'&ZXBUFSIZE LE 0).ZG12R  NOT I/O             00146300
                   AIF   ('&XBUFSIZE'(1,1) NE '(').ZG12R                00146400
&ZCGPR             SETC  '&XBUFSIZE'(2,K'&XBUFSIZE-2)                   00146500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG12P                   00146600
                   AIF   (K'&ZCGPR GT 2).ZG12Q                          00146700
                   AIF   ('&ZCGPR' EQ '0').ZG12Q                        00146800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00146900
                   AIF   (T'&ZCGPR NE 'N').ZG12Q  INVALID REG NAME      00147000
.ZG12P             ANOP  ,                                              00147100
                   AIF   (T'&ZCGPR NE 'N').ZG12R  NON NUMERIC           00147200
                   AIF   ('&ZCGPR' LT '2').ZG12Q                        00147300
                   AIF   ('&ZCGPR' LE '12').ZG12R                       00147400
.ZG12Q             ANOP  ,                                              00147500
&ZMS               SETC  '"BUFSIZE='                                    00147600
&ZMS               SETC  '&ZMS.&BUFSIZE"'                               00147700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00147800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00147900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00148000
.ZG12R             ANOP  ,                                              00148100
.*-------------------------------------------------------------------   00148200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00148300
.ZG14              ANOP  ,                                              00148400
&ZTLC              SETC 'REMOVE'                                        00148500
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZG21                00148600
&XREQUEST          SETC  'REMOVE'    SET KEYWORD                        00148700
                   AIF   (N'&REQUEST LE 1).ZG14A  CK NUM                00148800
&ZMS               SETC  '"REQUEST='                                    00148900
&ZMS               SETC  '&ZMS.&REQUEST"'                               00149000
&ZMS               SETC  '&ZMS "REQUEST"'                               00149100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00149200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00149300
.ZG14A             ANOP  ,                                              00149400
.*----------------------------------------------------------------***   00149500
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00149600
                   AIF   (N'&BUFFER LE 1).ZG16A  CK NUM                 00149700
&ZMS               SETC  '"BUFFER='                                     00149800
&ZMS               SETC  '&ZMS.&BUFFER"'                                00149900
&ZMS               SETC  '&ZMS "BUFFER"'                                00150000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00150100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00150200
.ZG16A             ANOP  ,                                              00150300
.*-------------------------------------------------------------------   00150400
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00150500
&ZXBUFFER          SETC  'INPUT'     SET IN/OUTPUT                      00150600
&XBUFFER           SETC  '&BUFFER(1)'           SET XVARIABLE           00150700
                   AIF   (N'&BUFFER GT 1).ZG16B  MULTI PARMS            00150800
&XBUFFER           SETC  '&BUFFER'   SET XVARIABLE                      00150900
.ZG16B             AIF   (K'&BUFFER(1) GT 0).ZG16C                      00151000
&ZXBUFFER          SETC  ''          RESET IN/OUTPUT                    00151100
&ZMS               SETC  ' '                                            00151200
&ZMS               SETC  '&ZMS "BUFFER" KEY AND ITS'                    00151300
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00151400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00151500
.ZG16C             ANOP  ,                                              00151600
.*-------------------------------------------------------------------   00151700
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00151800
                   AIF   (K'&ZXBUFFER LE 0).ZG16R  NOT I/O              00151900
                   AIF   ('&XBUFFER'(1,1) NE '(').ZG16R                 00152000
&ZCGPR             SETC  '&XBUFFER'(2,K'&XBUFFER-2)                     00152100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG16P                   00152200
                   AIF   (K'&ZCGPR GT 2).ZG16Q                          00152300
                   AIF   ('&ZCGPR' EQ '0').ZG16Q                        00152400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00152500
                   AIF   (T'&ZCGPR NE 'N').ZG16Q  INVALID REG NAME      00152600
.ZG16P             ANOP  ,                                              00152700
                   AIF   (T'&ZCGPR NE 'N').ZG16R  NON NUMERIC           00152800
                   AIF   ('&ZCGPR' LT '2').ZG16Q                        00152900
                   AIF   ('&ZCGPR' LE '12').ZG16R                       00153000
.ZG16Q             ANOP  ,                                              00153100
&ZMS               SETC  '"BUFFER='                                     00153200
&ZMS               SETC  '&ZMS.&BUFFER"'                                00153300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00153400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00153500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00153600
.ZG16R             ANOP  ,                                              00153700
.*----------------------------------------------------------------***   00153800
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00153900
                   AIF   (N'&BUFSIZE LE 1).ZG19A  CK NUM                00154000
&ZMS               SETC  '"BUFSIZE='                                    00154100
&ZMS               SETC  '&ZMS.&BUFSIZE"'                               00154200
&ZMS               SETC  '&ZMS "BUFSIZE"'                               00154300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00154400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00154500
.ZG19A             ANOP  ,                                              00154600
.*-------------------------------------------------------------------   00154700
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00154800
&ZXBUFSIZE         SETC  'INPUT'     SET IN/OUTPUT                      00154900
&XBUFSIZE          SETC  '&BUFSIZE(1)'          SET XVARIABLE           00155000
                   AIF   (N'&BUFSIZE GT 1).ZG19B  MULTI PARMS           00155100
&XBUFSIZE          SETC  '&BUFSIZE'  SET XVARIABLE                      00155200
.ZG19B             AIF   (K'&BUFSIZE(1) GT 0).ZG19C                     00155300
&ZXBUFSIZE         SETC  ''          RESET IN/OUTPUT                    00155400
&ZMS               SETC  ' '                                            00155500
&ZMS               SETC  '&ZMS "BUFSIZE" KEY AND ITS'                   00155600
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00155700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00155800
.ZG19C             ANOP  ,                                              00155900
.*-------------------------------------------------------------------   00156000
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00156100
                   AIF   (K'&ZXBUFSIZE LE 0).ZG19R  NOT I/O             00156200
                   AIF   ('&XBUFSIZE'(1,1) NE '(').ZG19R                00156300
&ZCGPR             SETC  '&XBUFSIZE'(2,K'&XBUFSIZE-2)                   00156400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                   00156500
                   AIF   (K'&ZCGPR GT 2).ZG19Q                          00156600
                   AIF   ('&ZCGPR' EQ '0').ZG19Q                        00156700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00156800
                   AIF   (T'&ZCGPR NE 'N').ZG19Q  INVALID REG NAME      00156900
.ZG19P             ANOP  ,                                              00157000
                   AIF   (T'&ZCGPR NE 'N').ZG19R  NON NUMERIC           00157100
                   AIF   ('&ZCGPR' LT '2').ZG19Q                        00157200
                   AIF   ('&ZCGPR' LE '12').ZG19R                       00157300
.ZG19Q             ANOP  ,                                              00157400
&ZMS               SETC  '"BUFSIZE='                                    00157500
&ZMS               SETC  '&ZMS.&BUFSIZE"'                               00157600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00157700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00157800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00157900
.ZG19R             ANOP  ,                                              00158000
.*------------------------------------------------------------------    00158100
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00158200
.ZG21              ANOP  ,                                              00158300
&ZXREQUEST         SETC  'INPUT'     SET IN/OUTPUT                      00158400
                   AIF   (K'&XREQUEST GT 0).ZG21E  VALID ARG            00158500
                   AIF   (T'&REQUEST EQ 'O').ZG21D  OMITTED             00158600
&ZASYSLNDX         SETA  0                                              00158700
.ZG21A             ANOP  ,           POSITIONAL MACRO KEY               00158800
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00158900
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG21C               00159000
&ZTLC              SETC 'REQUEST'                                       00159100
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG21A      00159200
.ZG21B             ANOP  ,                                              00159300
&ZXREQUEST         SETC  ''          RESET IN/OUTPUT                    00159400
&ZMS               SETC  'THE "REQUEST" KEY'                            00159500
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00159600
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00159700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00159800
                   AGO   .ZG21E                                         00159900
.ZG21C             ANOP  ,                                              00160000
&ZXREQUEST         SETC  ''          RESET IN/OUTPUT                    00160100
&ZMS               SETC  '"REQUEST='                                    00160200
&ZMS               SETC  '&ZMS.&REQUEST"'                               00160300
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00160400
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00160500
&ZMS               SETC  '&ZMS "COUNT",'                                00160600
&ZMS               SETC  '&ZMS "INFO",'                                 00160700
&ZMS               SETC  '&ZMS OR "REMOVE".'                            00160800
                   MNOTE 8,' &ZMS '                                     00160900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00161000
                   AGO   .ZG21E                                         00161100
.ZG21D             ANOP  ,                                              00161200
&XREQUEST          SETC  'COUNT'     SET DEFAULT KEYWORD                00161300
.ZG21E             ANOP  ,                                              00161400
.*----------------------------------------------------------------***   00161500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00161600
                   AIF   (N'&CLASS LE 1).ZG23A  CK NUM                  00161700
&ZMS               SETC  '"CLASS='                                      00161800
&ZMS               SETC  '&ZMS.&CLASS"'                                 00161900
&ZMS               SETC  '&ZMS "CLASS"'                                 00162000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00162100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00162200
.ZG23A             ANOP  ,                                              00162300
.*-------------------------------------------------------------------   00162400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00162500
&ZXCLASS           SETC  'INPUT'     SET IN/OUTPUT                      00162600
&XCLASS            SETC  'ANY_CLASS'                                    00162700
                   AIF   (K'&CLASS(1) LE 0).ZG23B  PARM                 00162800
&XCLASS            SETC  '&CLASS(1)'            SET XVARIABLE           00162900
                   AIF   (N'&CLASS GT 1).ZG23B  MULTI                   00163000
&XCLASS            SETC  '&CLASS'    SET XVARIABLE                      00163100
.ZG23B             ANOP  ,                                              00163200
.*-------------------------------------------------------------------   00163300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00163400
                   AIF   (K'&ZXCLASS LE 0).ZG23R  NOT I/O               00163500
         AIF   ('&XCLASS' EQ 'ANY_CLASS').ZG23R                         00163600
                   AIF   ('&XCLASS'(1,1) NE '(').ZG23R                  00163700
&ZCGPR             SETC  '&XCLASS'(2,K'&XCLASS-2)                       00163800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                   00163900
                   AIF   (K'&ZCGPR GT 2).ZG23Q                          00164000
                   AIF   ('&ZCGPR' EQ '0').ZG23Q                        00164100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00164200
                   AIF   (T'&ZCGPR NE 'N').ZG23Q  INVALID REG NAME      00164300
.ZG23P             ANOP  ,                                              00164400
                   AIF   (T'&ZCGPR NE 'N').ZG23R  NON NUMERIC           00164500
                   AIF   ('&ZCGPR' LT '2').ZG23Q                        00164600
                   AIF   ('&ZCGPR' LE '12').ZG23R                       00164700
.ZG23Q             ANOP  ,                                              00164800
&ZMS               SETC  '"CLASS='                                      00164900
&ZMS               SETC  '&ZMS.&CLASS"'                                 00165000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00165100
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00165200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00165300
.ZG23R             ANOP  ,                                              00165400
.*----------------------------------------------------------------***   00165500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00165600
                   AIF   (N'&CMD LE 1).ZG26A    CK NUM                  00165700
&ZMS               SETC  '"CMD='                                        00165800
&ZMS               SETC  '&ZMS.&CMD"'                                   00165900
&ZMS               SETC  '&ZMS "CMD"'                                   00166000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00166100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00166200
.ZG26A             ANOP  ,                                              00166300
.*-------------------------------------------------------------------   00166400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00166500
&ZXCMD             SETC  'INPUT'     SET IN/OUTPUT                      00166600
&XCMD              SETC  'ANY_CMD'                                      00166700
                   AIF   (K'&CMD(1) LE 0).ZG26B  PARM                   00166800
&XCMD              SETC  '&CMD(1)'   SET XVARIABLE                      00166900
                   AIF   (N'&CMD GT 1).ZG26B    MULTI                   00167000
&XCMD              SETC  '&CMD'      SET XVARIABLE                      00167100
.ZG26B             ANOP  ,                                              00167200
.*-------------------------------------------------------------------   00167300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00167400
                   AIF   (K'&ZXCMD LE 0).ZG26R  NOT I/O                 00167500
         AIF   ('&XCMD' EQ 'ANY_CMD').ZG26R                             00167600
                   AIF   ('&XCMD'(1,1) NE '(').ZG26R                    00167700
&ZCGPR             SETC  '&XCMD'(2,K'&XCMD-2)                           00167800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                   00167900
                   AIF   (K'&ZCGPR GT 2).ZG26Q                          00168000
                   AIF   ('&ZCGPR' EQ '0').ZG26Q                        00168100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00168200
                   AIF   (T'&ZCGPR NE 'N').ZG26Q  INVALID REG NAME      00168300
.ZG26P             ANOP  ,                                              00168400
                   AIF   (T'&ZCGPR NE 'N').ZG26R  NON NUMERIC           00168500
                   AIF   ('&ZCGPR' LT '2').ZG26Q                        00168600
                   AIF   ('&ZCGPR' LE '12').ZG26R                       00168700
.ZG26Q             ANOP  ,                                              00168800
&ZMS               SETC  '"CMD='                                        00168900
&ZMS               SETC  '&ZMS.&CMD"'                                   00169000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00169100
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00169200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00169300
.ZG26R             ANOP  ,                                              00169400
.*----------------------------------------------------------------***   00169500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00169600
                   AIF   (N'&ID LE 1).ZG29A     CK NUM                  00169700
&ZMS               SETC  '"ID='                                         00169800
&ZMS               SETC  '&ZMS.&ID"'                                    00169900
&ZMS               SETC  '&ZMS "ID"'                                    00170000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00170100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00170200
.ZG29A             ANOP  ,                                              00170300
.*-------------------------------------------------------------------   00170400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00170500
&ZXID              SETC  'INPUT'     SET IN/OUTPUT                      00170600
&XID               SETC  'ANY_ID'                                       00170700
                   AIF   (K'&ID(1) LE 0).ZG29B  PARM                    00170800
&XID               SETC  '&ID(1)'    SET XVARIABLE                      00170900
                   AIF   (N'&ID GT 1).ZG29B     MULTI                   00171000
&XID               SETC  '&ID'       SET XVARIABLE                      00171100
.ZG29B             ANOP  ,                                              00171200
.*-------------------------------------------------------------------   00171300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00171400
                   AIF   (K'&ZXID LE 0).ZG29R   NOT I/O                 00171500
         AIF   ('&XID' EQ 'ANY_ID').ZG29R                               00171600
                   AIF   ('&XID'(1,1) NE '(').ZG29R                     00171700
&ZCGPR             SETC  '&XID'(2,K'&XID-2)                             00171800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                   00171900
                   AIF   (K'&ZCGPR GT 2).ZG29Q                          00172000
                   AIF   ('&ZCGPR' EQ '0').ZG29Q                        00172100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00172200
                   AIF   (T'&ZCGPR NE 'N').ZG29Q  INVALID REG NAME      00172300
.ZG29P             ANOP  ,                                              00172400
                   AIF   (T'&ZCGPR NE 'N').ZG29R  NON NUMERIC           00172500
                   AIF   ('&ZCGPR' LT '2').ZG29Q                        00172600
                   AIF   ('&ZCGPR' LE '12').ZG29R                       00172700
.ZG29Q             ANOP  ,                                              00172800
&ZMS               SETC  '"ID='                                         00172900
&ZMS               SETC  '&ZMS.&ID"'                                    00173000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00173100
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00173200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00173300
.ZG29R             ANOP  ,                                              00173400
.*----------------------------------------------------------------***   00173500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00173600
                   AIF   (N'&JOB LE 1).ZG32A    CK NUM                  00173700
&ZMS               SETC  '"JOB='                                        00173800
&ZMS               SETC  '&ZMS.&JOB"'                                   00173900
&ZMS               SETC  '&ZMS "JOB"'                                   00174000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00174100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00174200
.ZG32A             ANOP  ,                                              00174300
.*-------------------------------------------------------------------   00174400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00174500
&ZXJOB             SETC  'INPUT'     SET IN/OUTPUT                      00174600
&XJOB              SETC  'ANY_JOB'                                      00174700
                   AIF   (K'&JOB(1) LE 0).ZG32B  PARM                   00174800
&XJOB              SETC  '&JOB(1)'   SET XVARIABLE                      00174900
                   AIF   (N'&JOB GT 1).ZG32B    MULTI                   00175000
&XJOB              SETC  '&JOB'      SET XVARIABLE                      00175100
.ZG32B             ANOP  ,                                              00175200
.*-------------------------------------------------------------------   00175300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00175400
                   AIF   (K'&ZXJOB LE 0).ZG32R  NOT I/O                 00175500
         AIF   ('&XJOB' EQ 'ANY_JOB').ZG32R                             00175600
                   AIF   ('&XJOB'(1,1) NE '(').ZG32R                    00175700
&ZCGPR             SETC  '&XJOB'(2,K'&XJOB-2)                           00175800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                   00175900
                   AIF   (K'&ZCGPR GT 2).ZG32Q                          00176000
                   AIF   ('&ZCGPR' EQ '0').ZG32Q                        00176100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00176200
                   AIF   (T'&ZCGPR NE 'N').ZG32Q  INVALID REG NAME      00176300
.ZG32P             ANOP  ,                                              00176400
                   AIF   (T'&ZCGPR NE 'N').ZG32R  NON NUMERIC           00176500
                   AIF   ('&ZCGPR' LT '2').ZG32Q                        00176600
                   AIF   ('&ZCGPR' LE '12').ZG32R                       00176700
.ZG32Q             ANOP  ,                                              00176800
&ZMS               SETC  '"JOB='                                        00176900
&ZMS               SETC  '&ZMS.&JOB"'                                   00177000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00177100
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00177200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00177300
.ZG32R             ANOP  ,                                              00177400
.*----------------------------------------------------------------***   00177500
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00177600
                   AIF   (N'&COUNT LE 1).ZG35A  CK NUM                  00177700
&ZMS               SETC  '"COUNT='                                      00177800
&ZMS               SETC  '&ZMS.&COUNT"'                                 00177900
&ZMS               SETC  '&ZMS "COUNT"'                                 00178000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00178100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00178200
.ZG35A             ANOP  ,                                              00178300
.*-------------------------------------------------------------------   00178400
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00178500
&ZXCOUNT           SETC  'INPUT'     SET IN/OUTPUT                      00178600
&XCOUNT            SETC  '&COUNT(1)'            SET XVARIABLE           00178700
                   AIF   (N'&COUNT GT 1).ZG35B  MULTI PARMS             00178800
&XCOUNT            SETC  '&COUNT'    SET XVARIABLE                      00178900
.ZG35B             AIF   (K'&COUNT(1) GT 0).ZG35C                       00179000
&ZXCOUNT           SETC  ''          RESET IN/OUTPUT                    00179100
&ZMS               SETC  ' '                                            00179200
&ZMS               SETC  '&ZMS "COUNT" KEY AND ITS'                     00179300
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00179400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00179500
.ZG35C             ANOP  ,                                              00179600
.*-------------------------------------------------------------------   00179700
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00179800
                   AIF   (K'&ZXCOUNT LE 0).ZG35R  NOT I/O               00179900
                   AIF   ('&XCOUNT'(1,1) NE '(').ZG35R                  00180000
&ZCGPR             SETC  '&XCOUNT'(2,K'&XCOUNT-2)                       00180100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                   00180200
                   AIF   (K'&ZCGPR GT 2).ZG35Q                          00180300
                   AIF   ('&ZCGPR' EQ '0').ZG35Q                        00180400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00180500
                   AIF   (T'&ZCGPR NE 'N').ZG35Q  INVALID REG NAME      00180600
.ZG35P             ANOP  ,                                              00180700
                   AIF   (T'&ZCGPR NE 'N').ZG35R  NON NUMERIC           00180800
                   AIF   ('&ZCGPR' LT '2').ZG35Q                        00180900
                   AIF   ('&ZCGPR' LE '12').ZG35R                       00181000
.ZG35Q             ANOP  ,                                              00181100
&ZMS               SETC  '"COUNT='                                      00181200
&ZMS               SETC  '&ZMS.&COUNT"'                                 00181300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00181400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00181500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00181600
.ZG35R             ANOP  ,                                              00181700
.*-------------------------------------------------------------------   00181800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00181900
.ZG37              ANOP  ,                                              00182000
&ZTLC              SETC 'YES'                                           00182100
                   AIF   ('&IBMINT(1)' NE '&ZTLC').ZG62                 00182200
&XIBMINT           SETC  'YES'       SET KEYWORD                        00182300
                   AIF   (N'&IBMINT LE 1).ZG37A  CK NUM                 00182400
&ZMS               SETC  '"IBMINT='                                     00182500
&ZMS               SETC  '&ZMS.&IBMINT"'                                00182600
&ZMS               SETC  '&ZMS "IBMINT"'                                00182700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00182800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00182900
.ZG37A             ANOP  ,                                              00183000
.*------------------------------------------------------------------    00183100
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00183200
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00183300
.ZG37A0            AIF   (K'&COUNT LE 0).ZG37A1  OK                     00183400
&ZCVAL             SETC '&ZCVAL COUNT'          INCORRECT KEY USED      00183500
.ZG37A1            AIF   (K'&ZCVAL LE 0).ZG37A2  OK                     00183600
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00183700
&ZMS               SETC  '"IBMINT'                                      00183800
&ZMS               SETC  '&ZMS.=&IBMINT"'                               00183900
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00184000
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00184100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00184200
.ZG37A2            ANOP  ,                                              00184300
.*------------------------------------------------------------------    00184400
.***AG.KKCTL01 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00184500
&XREQUEST          SETC  ''          INITIALIZE XVARIABLE               00184600
.*-------------------------------------------------------------------   00184700
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00184800
.ZG40              ANOP  ,                                              00184900
                   AIF   (K'&REQUEST(1) LE 0).ZG40A                     00185000
&ZTLC              SETC 'MARKNOABEND'                                   00185100
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZG41                00185200
&XREQUEST          SETC  'MARKNOABEND'          SET KEYWORD             00185300
                   AIF   (N'&REQUEST LE 1).ZG40A  CK NUM                00185400
&ZMS               SETC  '"REQUEST='                                    00185500
&ZMS               SETC  '&ZMS.&REQUEST"'                               00185600
&ZMS               SETC  '&ZMS "REQUEST"'                               00185700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00185800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00185900
.ZG40A             ANOP  ,                                              00186000
.*------------------------------------------------------------------    00186100
.***AG.KKCTL03 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00186200
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00186300
.ZG40A0            AIF   (K'&BUFFER LE 0).ZG40A1  OK                    00186400
&ZCVAL             SETC '&ZCVAL BUFFER'         INCORRECT KEY USED      00186500
.ZG40A1            AIF   (K'&BUFSIZE LE 0).ZG40A2  OK                   00186600
&ZCVAL             SETC '&ZCVAL BUFSIZE'        INCORRECT KEY USED      00186700
.ZG40A2            AIF   (K'&CMD LE 0).ZG40A3   OK                      00186800
&ZCVAL             SETC '&ZCVAL CMD'            INCORRECT KEY USED      00186900
.ZG40A3            AIF   (K'&ID LE 0).ZG40A4    OK                      00187000
&ZCVAL             SETC '&ZCVAL ID'  INCORRECT KEY USED                 00187100
.ZG40A4            AIF   (K'&CLASS LE 0).ZG40A5  OK                     00187200
&ZCVAL             SETC '&ZCVAL CLASS'          INCORRECT KEY USED      00187300
.ZG40A5            AIF   (K'&JOB LE 0).ZG40A6   OK                      00187400
&ZCVAL             SETC '&ZCVAL JOB'            INCORRECT KEY USED      00187500
.ZG40A6            AIF   (K'&ZCVAL LE 0).ZG40A7  OK                     00187600
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00187700
&ZMS               SETC  '"REQUEST'                                     00187800
&ZMS               SETC  '&ZMS.=&REQUEST"'                              00187900
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00188000
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00188100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00188200
.ZG40A7            ANOP  ,                                              00188300
.*-------------------------------------------------------------------   00188400
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00188500
.ZG41              ANOP  ,                                              00188600
&ZTLC              SETC 'UNMARKNOABEND'                                 00188700
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZG42                00188800
&XREQUEST          SETC  'UNMARKNOABEND'        SET KEYWORD             00188900
                   AIF   (N'&REQUEST LE 1).ZG41A  CK NUM                00189000
&ZMS               SETC  '"REQUEST='                                    00189100
&ZMS               SETC  '&ZMS.&REQUEST"'                               00189200
&ZMS               SETC  '&ZMS "REQUEST"'                               00189300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00189400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00189500
.ZG41A             ANOP  ,                                              00189600
.*------------------------------------------------------------------    00189700
.***AG.KKCTL03 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00189800
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00189900
.ZG41A0            AIF   (K'&BUFFER LE 0).ZG41A1  OK                    00190000
&ZCVAL             SETC '&ZCVAL BUFFER'         INCORRECT KEY USED      00190100
.ZG41A1            AIF   (K'&BUFSIZE LE 0).ZG41A2  OK                   00190200
&ZCVAL             SETC '&ZCVAL BUFSIZE'        INCORRECT KEY USED      00190300
.ZG41A2            AIF   (K'&CMD LE 0).ZG41A3   OK                      00190400
&ZCVAL             SETC '&ZCVAL CMD'            INCORRECT KEY USED      00190500
.ZG41A3            AIF   (K'&ID LE 0).ZG41A4    OK                      00190600
&ZCVAL             SETC '&ZCVAL ID'  INCORRECT KEY USED                 00190700
.ZG41A4            AIF   (K'&CLASS LE 0).ZG41A5  OK                     00190800
&ZCVAL             SETC '&ZCVAL CLASS'          INCORRECT KEY USED      00190900
.ZG41A5            AIF   (K'&JOB LE 0).ZG41A6   OK                      00191000
&ZCVAL             SETC '&ZCVAL JOB'            INCORRECT KEY USED      00191100
.ZG41A6            AIF   (K'&ZCVAL LE 0).ZG41A7  OK                     00191200
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00191300
&ZMS               SETC  '"REQUEST'                                     00191400
&ZMS               SETC  '&ZMS.=&REQUEST"'                              00191500
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00191600
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00191700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00191800
.ZG41A7            ANOP  ,                                              00191900
.*-------------------------------------------------------------------   00192000
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00192100
.ZG42              ANOP  ,                                              00192200
&ZTLC              SETC 'MARKCMDSABEND'                                 00192300
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZG61                00192400
&XREQUEST          SETC  'MARKCMDSABEND'        SET KEYWORD             00192500
                   AIF   (N'&REQUEST LE 1).ZG42A  CK NUM                00192600
&ZMS               SETC  '"REQUEST='                                    00192700
&ZMS               SETC  '&ZMS.&REQUEST"'                               00192800
&ZMS               SETC  '&ZMS "REQUEST"'                               00192900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00193000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00193100
.ZG42A             ANOP  ,                                              00193200
.*----------------------------------------------------------------***   00193300
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00193400
                   AIF   (N'&BUFFER LE 1).ZG44A  CK NUM                 00193500
&ZMS               SETC  '"BUFFER='                                     00193600
&ZMS               SETC  '&ZMS.&BUFFER"'                                00193700
&ZMS               SETC  '&ZMS "BUFFER"'                                00193800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00193900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00194000
.ZG44A             ANOP  ,                                              00194100
.*-------------------------------------------------------------------   00194200
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00194300
&ZXBUFFER          SETC  'INPUT'     SET IN/OUTPUT                      00194400
&XBUFFER           SETC  '&BUFFER(1)'           SET XVARIABLE           00194500
                   AIF   (N'&BUFFER GT 1).ZG44B  MULTI PARMS            00194600
&XBUFFER           SETC  '&BUFFER'   SET XVARIABLE                      00194700
.ZG44B             AIF   (K'&BUFFER(1) GT 0).ZG44C                      00194800
&ZXBUFFER          SETC  ''          RESET IN/OUTPUT                    00194900
&ZMS               SETC  ' '                                            00195000
&ZMS               SETC  '&ZMS "BUFFER" KEY AND ITS'                    00195100
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00195200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00195300
.ZG44C             ANOP  ,                                              00195400
.*-------------------------------------------------------------------   00195500
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00195600
                   AIF   (K'&ZXBUFFER LE 0).ZG44R  NOT I/O              00195700
                   AIF   ('&XBUFFER'(1,1) NE '(').ZG44R                 00195800
&ZCGPR             SETC  '&XBUFFER'(2,K'&XBUFFER-2)                     00195900
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG44P                   00196000
                   AIF   (K'&ZCGPR GT 2).ZG44Q                          00196100
                   AIF   ('&ZCGPR' EQ '0').ZG44Q                        00196200
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00196300
                   AIF   (T'&ZCGPR NE 'N').ZG44Q  INVALID REG NAME      00196400
.ZG44P             ANOP  ,                                              00196500
                   AIF   (T'&ZCGPR NE 'N').ZG44R  NON NUMERIC           00196600
                   AIF   ('&ZCGPR' LT '2').ZG44Q                        00196700
                   AIF   ('&ZCGPR' LE '12').ZG44R                       00196800
.ZG44Q             ANOP  ,                                              00196900
&ZMS               SETC  '"BUFFER='                                     00197000
&ZMS               SETC  '&ZMS.&BUFFER"'                                00197100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00197200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00197300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00197400
.ZG44R             ANOP  ,                                              00197500
.*----------------------------------------------------------------***   00197600
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00197700
                   AIF   (N'&BUFSIZE LE 1).ZG47A  CK NUM                00197800
&ZMS               SETC  '"BUFSIZE='                                    00197900
&ZMS               SETC  '&ZMS.&BUFSIZE"'                               00198000
&ZMS               SETC  '&ZMS "BUFSIZE"'                               00198100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00198200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00198300
.ZG47A             ANOP  ,                                              00198400
.*-------------------------------------------------------------------   00198500
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00198600
&ZXBUFSIZE         SETC  'INPUT'     SET IN/OUTPUT                      00198700
&XBUFSIZE          SETC  '&BUFSIZE(1)'          SET XVARIABLE           00198800
                   AIF   (N'&BUFSIZE GT 1).ZG47B  MULTI PARMS           00198900
&XBUFSIZE          SETC  '&BUFSIZE'  SET XVARIABLE                      00199000
.ZG47B             AIF   (K'&BUFSIZE(1) GT 0).ZG47C                     00199100
&ZXBUFSIZE         SETC  ''          RESET IN/OUTPUT                    00199200
&ZMS               SETC  ' '                                            00199300
&ZMS               SETC  '&ZMS "BUFSIZE" KEY AND ITS'                   00199400
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00199500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00199600
.ZG47C             ANOP  ,                                              00199700
.*-------------------------------------------------------------------   00199800
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00199900
                   AIF   (K'&ZXBUFSIZE LE 0).ZG47R  NOT I/O             00200000
                   AIF   ('&XBUFSIZE'(1,1) NE '(').ZG47R                00200100
&ZCGPR             SETC  '&XBUFSIZE'(2,K'&XBUFSIZE-2)                   00200200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG47P                   00200300
                   AIF   (K'&ZCGPR GT 2).ZG47Q                          00200400
                   AIF   ('&ZCGPR' EQ '0').ZG47Q                        00200500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00200600
                   AIF   (T'&ZCGPR NE 'N').ZG47Q  INVALID REG NAME      00200700
.ZG47P             ANOP  ,                                              00200800
                   AIF   (T'&ZCGPR NE 'N').ZG47R  NON NUMERIC           00200900
                   AIF   ('&ZCGPR' LT '2').ZG47Q                        00201000
                   AIF   ('&ZCGPR' LE '12').ZG47R                       00201100
.ZG47Q             ANOP  ,                                              00201200
&ZMS               SETC  '"BUFSIZE='                                    00201300
&ZMS               SETC  '&ZMS.&BUFSIZE"'                               00201400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00201500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00201600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00201700
.ZG47R             ANOP  ,                                              00201800
.*----------------------------------------------------------------***   00201900
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00202000
                   AIF   (N'&CMD LE 1).ZG50A    CK NUM                  00202100
&ZMS               SETC  '"CMD='                                        00202200
&ZMS               SETC  '&ZMS.&CMD"'                                   00202300
&ZMS               SETC  '&ZMS "CMD"'                                   00202400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00202500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00202600
.ZG50A             ANOP  ,                                              00202700
.*-------------------------------------------------------------------   00202800
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00202900
&ZXCMD             SETC  'INPUT'     SET IN/OUTPUT                      00203000
&XCMD              SETC  '&CMD(1)'   SET XVARIABLE                      00203100
                   AIF   (N'&CMD GT 1).ZG50B    MULTI PARMS             00203200
&XCMD              SETC  '&CMD'      SET XVARIABLE                      00203300
.ZG50B             AIF   (K'&CMD(1) GT 0).ZG50C                         00203400
&ZXCMD             SETC  ''          RESET IN/OUTPUT                    00203500
&ZMS               SETC  ' '                                            00203600
&ZMS               SETC  '&ZMS "CMD" KEY AND ITS'                       00203700
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00203800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00203900
.ZG50C             ANOP  ,                                              00204000
.*-------------------------------------------------------------------   00204100
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00204200
                   AIF   (K'&ZXCMD LE 0).ZG50R  NOT I/O                 00204300
                   AIF   ('&XCMD'(1,1) NE '(').ZG50R                    00204400
&ZCGPR             SETC  '&XCMD'(2,K'&XCMD-2)                           00204500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG50P                   00204600
                   AIF   (K'&ZCGPR GT 2).ZG50Q                          00204700
                   AIF   ('&ZCGPR' EQ '0').ZG50Q                        00204800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00204900
                   AIF   (T'&ZCGPR NE 'N').ZG50Q  INVALID REG NAME      00205000
.ZG50P             ANOP  ,                                              00205100
                   AIF   (T'&ZCGPR NE 'N').ZG50R  NON NUMERIC           00205200
                   AIF   ('&ZCGPR' LT '2').ZG50Q                        00205300
                   AIF   ('&ZCGPR' LE '12').ZG50R                       00205400
.ZG50Q             ANOP  ,                                              00205500
&ZMS               SETC  '"CMD='                                        00205600
&ZMS               SETC  '&ZMS.&CMD"'                                   00205700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00205800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00205900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00206000
.ZG50R             ANOP  ,                                              00206100
.*----------------------------------------------------------------***   00206200
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00206300
                   AIF   (N'&ID LE 1).ZG53A     CK NUM                  00206400
&ZMS               SETC  '"ID='                                         00206500
&ZMS               SETC  '&ZMS.&ID"'                                    00206600
&ZMS               SETC  '&ZMS "ID"'                                    00206700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00206800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00206900
.ZG53A             ANOP  ,                                              00207000
.*-------------------------------------------------------------------   00207100
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00207200
&ZXID              SETC  'INPUT'     SET IN/OUTPUT                      00207300
&XID               SETC  '&ID(1)'    SET XVARIABLE                      00207400
                   AIF   (N'&ID GT 1).ZG53B     MULTI PARMS             00207500
&XID               SETC  '&ID'       SET XVARIABLE                      00207600
.ZG53B             AIF   (K'&ID(1) GT 0).ZG53C                          00207700
&ZXID              SETC  ''          RESET IN/OUTPUT                    00207800
&ZMS               SETC  ' '                                            00207900
&ZMS               SETC  '&ZMS "ID" KEY AND ITS'                        00208000
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00208100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00208200
.ZG53C             ANOP  ,                                              00208300
.*-------------------------------------------------------------------   00208400
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00208500
                   AIF   (K'&ZXID LE 0).ZG53R   NOT I/O                 00208600
                   AIF   ('&XID'(1,1) NE '(').ZG53R                     00208700
&ZCGPR             SETC  '&XID'(2,K'&XID-2)                             00208800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG53P                   00208900
                   AIF   (K'&ZCGPR GT 2).ZG53Q                          00209000
                   AIF   ('&ZCGPR' EQ '0').ZG53Q                        00209100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00209200
                   AIF   (T'&ZCGPR NE 'N').ZG53Q  INVALID REG NAME      00209300
.ZG53P             ANOP  ,                                              00209400
                   AIF   (T'&ZCGPR NE 'N').ZG53R  NON NUMERIC           00209500
                   AIF   ('&ZCGPR' LT '2').ZG53Q                        00209600
                   AIF   ('&ZCGPR' LE '12').ZG53R                       00209700
.ZG53Q             ANOP  ,                                              00209800
&ZMS               SETC  '"ID='                                         00209900
&ZMS               SETC  '&ZMS.&ID"'                                    00210000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00210100
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00210200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00210300
.ZG53R             ANOP  ,                                              00210400
.*----------------------------------------------------------------***   00210500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00210600
                   AIF   (N'&CLASS LE 1).ZG56A  CK NUM                  00210700
&ZMS               SETC  '"CLASS='                                      00210800
&ZMS               SETC  '&ZMS.&CLASS"'                                 00210900
&ZMS               SETC  '&ZMS "CLASS"'                                 00211000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00211100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00211200
.ZG56A             ANOP  ,                                              00211300
.*-------------------------------------------------------------------   00211400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00211500
&ZXCLASS           SETC  'INPUT'     SET IN/OUTPUT                      00211600
&XCLASS            SETC  'ANY_CLASS'                                    00211700
                   AIF   (K'&CLASS(1) LE 0).ZG56B  PARM                 00211800
&XCLASS            SETC  '&CLASS(1)'            SET XVARIABLE           00211900
                   AIF   (N'&CLASS GT 1).ZG56B  MULTI                   00212000
&XCLASS            SETC  '&CLASS'    SET XVARIABLE                      00212100
.ZG56B             ANOP  ,                                              00212200
.*-------------------------------------------------------------------   00212300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00212400
                   AIF   (K'&ZXCLASS LE 0).ZG56R  NOT I/O               00212500
         AIF   ('&XCLASS' EQ 'ANY_CLASS').ZG56R                         00212600
                   AIF   ('&XCLASS'(1,1) NE '(').ZG56R                  00212700
&ZCGPR             SETC  '&XCLASS'(2,K'&XCLASS-2)                       00212800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG56P                   00212900
                   AIF   (K'&ZCGPR GT 2).ZG56Q                          00213000
                   AIF   ('&ZCGPR' EQ '0').ZG56Q                        00213100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00213200
                   AIF   (T'&ZCGPR NE 'N').ZG56Q  INVALID REG NAME      00213300
.ZG56P             ANOP  ,                                              00213400
                   AIF   (T'&ZCGPR NE 'N').ZG56R  NON NUMERIC           00213500
                   AIF   ('&ZCGPR' LT '2').ZG56Q                        00213600
                   AIF   ('&ZCGPR' LE '12').ZG56R                       00213700
.ZG56Q             ANOP  ,                                              00213800
&ZMS               SETC  '"CLASS='                                      00213900
&ZMS               SETC  '&ZMS.&CLASS"'                                 00214000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00214100
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00214200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00214300
.ZG56R             ANOP  ,                                              00214400
.*----------------------------------------------------------------***   00214500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00214600
                   AIF   (N'&JOB LE 1).ZG59A    CK NUM                  00214700
&ZMS               SETC  '"JOB='                                        00214800
&ZMS               SETC  '&ZMS.&JOB"'                                   00214900
&ZMS               SETC  '&ZMS "JOB"'                                   00215000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00215100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00215200
.ZG59A             ANOP  ,                                              00215300
.*-------------------------------------------------------------------   00215400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00215500
&ZXJOB             SETC  'INPUT'     SET IN/OUTPUT                      00215600
&XJOB              SETC  'ANY_JOB'                                      00215700
                   AIF   (K'&JOB(1) LE 0).ZG59B  PARM                   00215800
&XJOB              SETC  '&JOB(1)'   SET XVARIABLE                      00215900
                   AIF   (N'&JOB GT 1).ZG59B    MULTI                   00216000
&XJOB              SETC  '&JOB'      SET XVARIABLE                      00216100
.ZG59B             ANOP  ,                                              00216200
.*-------------------------------------------------------------------   00216300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00216400
                   AIF   (K'&ZXJOB LE 0).ZG59R  NOT I/O                 00216500
         AIF   ('&XJOB' EQ 'ANY_JOB').ZG59R                             00216600
                   AIF   ('&XJOB'(1,1) NE '(').ZG59R                    00216700
&ZCGPR             SETC  '&XJOB'(2,K'&XJOB-2)                           00216800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG59P                   00216900
                   AIF   (K'&ZCGPR GT 2).ZG59Q                          00217000
                   AIF   ('&ZCGPR' EQ '0').ZG59Q                        00217100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00217200
                   AIF   (T'&ZCGPR NE 'N').ZG59Q  INVALID REG NAME      00217300
.ZG59P             ANOP  ,                                              00217400
                   AIF   (T'&ZCGPR NE 'N').ZG59R  NON NUMERIC           00217500
                   AIF   ('&ZCGPR' LT '2').ZG59Q                        00217600
                   AIF   ('&ZCGPR' LE '12').ZG59R                       00217700
.ZG59Q             ANOP  ,                                              00217800
&ZMS               SETC  '"JOB='                                        00217900
&ZMS               SETC  '&ZMS.&JOB"'                                   00218000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00218100
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00218200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00218300
.ZG59R             ANOP  ,                                              00218400
.*------------------------------------------------------------------    00218500
.***AG.KKCTL04 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00218600
.ZG61              ANOP  ,                                              00218700
&ZXREQUEST         SETC  'INPUT'     SET IN/OUTPUT                      00218800
                   AIF   (K'&XREQUEST GT 0).ZG61E  VALID ARG            00218900
                   AIF   (T'&REQUEST EQ 'O').ZG61D  OMITTED             00219000
&ZASYSLNDX         SETA  0                                              00219100
.ZG61A             ANOP  ,           POSITIONAL MACRO KEY               00219200
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00219300
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG61C               00219400
&ZTLC              SETC 'REQUEST'                                       00219500
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG61A      00219600
.ZG61B             ANOP  ,                                              00219700
&ZXREQUEST         SETC  ''          RESET IN/OUTPUT                    00219800
&ZMS               SETC  'THE "REQUEST" KEY'                            00219900
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00220000
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00220100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00220200
                   AGO   .ZG61E                                         00220300
.ZG61C             ANOP  ,                                              00220400
&ZXREQUEST         SETC  ''          RESET IN/OUTPUT                    00220500
&ZMS               SETC  '"REQUEST='                                    00220600
&ZMS               SETC  '&ZMS.&REQUEST"'                               00220700
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00220800
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00220900
&ZMS               SETC  '&ZMS "MARKNOABEND",'                          00221000
&ZMS               SETC  '&ZMS "UNMARKNOABEND",'                        00221100
&ZMS               SETC  '&ZMS OR "MARKCMDSABEND".'                     00221200
                   MNOTE 8,' &ZMS '                                     00221300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00221400
                   AGO   .ZG61E                                         00221500
.ZG61D             ANOP  ,                                              00221600
&XREQUEST          SETC  'MARKNOABEND'          SET DEFAULT KEYWORD     00221700
.ZG61E             ANOP  ,                                              00221800
.*------------------------------------------------------------------    00221900
.***AG.KKCTL05 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00222000
                   AIF   (K'&REQUEST(1) GT 0).ZG61F  PARM               00222100
&XREQUEST          SETC  ''          ENSURE NULL KEYWORD                00222200
&ZXREQUEST         SETC  ''          RESET IN/OUTPUT                    00222300
&ZMS               SETC  'THE'                                          00222400
&ZMS               SETC  '&ZMS "REQUEST" KEY AND ITS'                   00222500
&ZMS               SETC  '&ZMS ARGUMENT ARE REQUIRED.'                  00222600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00222700
&ZMS               SETC  '&ZMS "MARKNOABEND",'                          00222800
&ZMS               SETC  '&ZMS "UNMARKNOABEND",'                        00222900
&ZMS               SETC  '&ZMS OR "MARKCMDSABEND".'                     00223000
                   MNOTE 8,' &ZMS '                                     00223100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00223200
.ZG61F             ANOP  ,                                              00223300
.*------------------------------------------------------------------    00223400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00223500
.ZG62              ANOP  ,                                              00223600
&ZXIBMINT          SETC  'INPUT'     SET IN/OUTPUT                      00223700
                   AIF   (K'&XIBMINT GT 0).ZG62E  VALID ARG             00223800
                   AIF   (T'&IBMINT EQ 'O').ZG62D  OMITTED              00223900
&ZASYSLNDX         SETA  0                                              00224000
.ZG62A             ANOP  ,           POSITIONAL MACRO KEY               00224100
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00224200
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG62C               00224300
&ZTLC              SETC 'IBMINT'                                        00224400
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG62A      00224500
.ZG62B             ANOP  ,                                              00224600
&ZXIBMINT          SETC  ''          RESET IN/OUTPUT                    00224700
&ZMS               SETC  'THE "IBMINT" KEY'                             00224800
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00224900
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00225000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00225100
                   AGO   .ZG62E                                         00225200
.ZG62C             ANOP  ,                                              00225300
&ZXIBMINT          SETC  ''          RESET IN/OUTPUT                    00225400
&ZMS               SETC  '"IBMINT='                                     00225500
&ZMS               SETC  '&ZMS.&IBMINT"'                                00225600
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00225700
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00225800
&ZMS               SETC  '&ZMS "NO"'                                    00225900
&ZMS               SETC  '&ZMS OR "YES".'                               00226000
                   MNOTE 8,' &ZMS '                                     00226100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00226200
                   AGO   .ZG62E                                         00226300
.ZG62D             ANOP  ,                                              00226400
&XIBMINT           SETC  'NO'        SET DEFAULT KEYWORD                00226500
.ZG62E             ANOP  ,                                              00226600
.*----------------------------------------------------------------***   00226700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00226800
                   AIF   (N'&RETCODE LE 1).ZG64A  CK NUM                00226900
&ZMS               SETC  '"RETCODE='                                    00227000
&ZMS               SETC  '&ZMS.&RETCODE"'                               00227100
&ZMS               SETC  '&ZMS "RETCODE"'                               00227200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00227300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00227400
.ZG64A             ANOP  ,                                              00227500
.*-------------------------------------------------------------------   00227600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00227700
                   AIF   (K'&RETCODE(1) LE 0).ZG64C  NO PARM            00227800
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         00227900
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00228000
                   AIF   (N'&RETCODE GT 1).ZG64C                        00228100
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00228200
.ZG64C             ANOP  ,                                              00228300
.*-------------------------------------------------------------------   00228400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00228500
                   AIF   (K'&ZXRETCODE LE 0).ZG64R  NOT I/O             00228600
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG64R                00228700
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00228800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG64P                   00228900
                   AIF   (K'&ZCGPR GT 2).ZG64Q                          00229000
                   AIF   ('&ZCGPR' EQ '0').ZG64Q                        00229100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00229200
                   AIF   (T'&ZCGPR NE 'N').ZG64Q  INVALID REG NAME      00229300
.ZG64P             ANOP  ,                                              00229400
                   AIF   (T'&ZCGPR NE 'N').ZG64R  NON NUMERIC           00229500
                   AIF   ('&ZCGPR' EQ '15').ZG64R                       00229600
                   AIF   ('&ZCGPR' LT '2').ZG64Q                        00229700
                   AIF   ('&ZCGPR' LE '12').ZG64R                       00229800
.ZG64Q             ANOP  ,                                              00229900
&ZMS               SETC  '"RETCODE='                                    00230000
&ZMS               SETC  '&ZMS.&RETCODE"'                               00230100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00230200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'       00230300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00230400
.ZG64R             ANOP  ,                                              00230500
.*----------------------------------------------------------------***   00230600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00230700
                   AIF   (N'&RSNCODE LE 1).ZG67A  CK NUM                00230800
&ZMS               SETC  '"RSNCODE='                                    00230900
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00231000
&ZMS               SETC  '&ZMS "RSNCODE"'                               00231100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00231200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00231300
.ZG67A             ANOP  ,                                              00231400
.*-------------------------------------------------------------------   00231500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00231600
                   AIF   (K'&RSNCODE(1) LE 0).ZG67C  NO PARM            00231700
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         00231800
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00231900
                   AIF   (N'&RSNCODE GT 1).ZG67C                        00232000
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00232100
.ZG67C             ANOP  ,                                              00232200
.*-------------------------------------------------------------------   00232300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00232400
                   AIF   (K'&ZXRSNCODE LE 0).ZG67R  NOT I/O             00232500
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG67R                00232600
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00232700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG67P                   00232800
                   AIF   (K'&ZCGPR GT 2).ZG67Q                          00232900
                   AIF   ('&ZCGPR' EQ '0').ZG67R                        00233000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00233100
                   AIF   (T'&ZCGPR NE 'N').ZG67Q  INVALID REG NAME      00233200
.ZG67P             ANOP  ,                                              00233300
                   AIF   (T'&ZCGPR NE 'N').ZG67R  NON NUMERIC           00233400
                   AIF   ('&ZCGPR' EQ '0').ZG67R                        00233500
                   AIF   ('&ZCGPR' LT '2').ZG67Q                        00233600
                   AIF   ('&ZCGPR' LE '12').ZG67R                       00233700
.ZG67Q             ANOP  ,                                              00233800
&ZMS               SETC  '"RSNCODE='                                    00233900
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00234000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00234100
                   MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'        00234200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00234300
.ZG67R             ANOP  ,                                              00234400
.******************************************************************     00234500
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00234600
.******************************************************************     00234700
                   ACTR  10000                                          00234800
.*----------------------------------------------------------------***   00234900
.***AH.P02 EXTRA POSITIONALS                                            00235000
                   AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS           00235100
                   AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL           00235200
                   AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL       00235300
                   AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL        00235400
.ZGLISTX1          ANOP  ,                                              00235500
&ZCVAL             SETC  ''          ERROR FIELD                        00235600
&ZAWRK             SETA  0           POSITIONAL NUMBER                  00235700
.ZGLIST2           ANOP  ,                                              00235800
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00235900
                   AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE           00236000
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                00236100
                   AGO   .ZGLIST2                                       00236200
.*                                                                      00236300
.ZGLIST3           ANOP  ,                                              00236400
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00236500
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'                      00236600
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00236700
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00236800
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00236900
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00237000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00237100
.ZGLISTX           ANOP  ,                                              00237200
&ZASYSLNDX         SETA  0                                              00237300
.*-------------------------------------------------------------------   00237400
.***AG.MF04 MF=(SLME)                                                   00237500
.ZGMFX             ANOP  ,           END OF FULL SYNTAX CHECK           00237600
.********************************************************************   00237700
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00237800
.********************************************************************   00237900
                   ACTR  10000                                          00238000
.*-------------------------------------------------------------------   00238100
.***AE.MF01 MF=(SLME)                                                   00238200
                   AIF   ('&XMF' EQ 'L').ZEMFX                          00238300
                   AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                 00238400
.********************************************************************   00238500
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00238600
.********************************************************************   00238700
&XIBMINT           SETC  ''          INITIALIZE XVARIABLE               00238800
&XREQUEST          SETC  ''          INITIALIZE XVARIABLE               00238900
.*-------------------------------------------------------------------   00239000
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00239100
&ZTLC              SETC 'NO'                                            00239200
                   AIF   ('&IBMINT(1)' NE '&ZTLC').ZE3A                 00239300
&XIBMINT           SETC  'NO'        SET KEYWORD                        00239400
                   AIF   (N'&IBMINT LE 1).ZE3A  CK NUM                  00239500
&ZMS               SETC  '"IBMINT='                                     00239600
&ZMS               SETC  '&ZMS.&IBMINT"'                                00239700
&ZMS               SETC  '&ZMS "IBMINT"'                                00239800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00239900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00240000
.ZE3A              ANOP  ,                                              00240100
.*-------------------------------------------------------------------   00240200
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00240300
&ZTLC              SETC 'COUNT'                                         00240400
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZE6A                00240500
&XREQUEST          SETC  'COUNT'     SET KEYWORD                        00240600
                   AIF   (N'&REQUEST LE 1).ZE6A  CK NUM                 00240700
&ZMS               SETC  '"REQUEST='                                    00240800
&ZMS               SETC  '&ZMS.&REQUEST"'                               00240900
&ZMS               SETC  '&ZMS "REQUEST"'                               00241000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00241100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00241200
.ZE6A              ANOP  ,                                              00241300
.*-------------------------------------------------------------------   00241400
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00241500
&ZTLC              SETC 'INFO'                                          00241600
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZE7A                00241700
&XREQUEST          SETC  'INFO'      SET KEYWORD                        00241800
                   AIF   (N'&REQUEST LE 1).ZE7A  CK NUM                 00241900
&ZMS               SETC  '"REQUEST='                                    00242000
&ZMS               SETC  '&ZMS.&REQUEST"'                               00242100
&ZMS               SETC  '&ZMS "REQUEST"'                               00242200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00242300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00242400
.ZE7A              ANOP  ,                                              00242500
.*----------------------------------------------------------------***   00242600
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00242700
                   AIF   (N'&BUFFER LE 1).ZE9A  CK NUM                  00242800
&ZMS               SETC  '"BUFFER='                                     00242900
&ZMS               SETC  '&ZMS.&BUFFER"'                                00243000
&ZMS               SETC  '&ZMS "BUFFER"'                                00243100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00243200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00243300
.ZE9A              ANOP  ,                                              00243400
.*-------------------------------------------------------------------   00243500
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00243600
                   AIF   (K'&BUFFER(1) LE 0).ZE9B NO PRM                00243700
&ZXBUFFER          SETC  'INPUT'     SET IN/OUTPUT                      00243800
&XBUFFER           SETC  '&BUFFER(1)'           SET XVARIABLE           00243900
                   AIF   (N'&BUFFER GT 1).ZE9B                          00244000
.*                 ANOP                                                 00244100
&XBUFFER           SETC  '&BUFFER'   SET XVARIABLE                      00244200
.ZE9B              ANOP  ,                                              00244300
.*-------------------------------------------------------------------   00244400
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00244500
                   AIF   (K'&ZXBUFFER LE 0).ZE9R  NOT I/O               00244600
                   AIF   ('&XBUFFER'(1,1) NE '(').ZE9R                  00244700
&ZCGPR             SETC  '&XBUFFER'(2,K'&XBUFFER-2)                     00244800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE9P                    00244900
                   AIF   (K'&ZCGPR GT 2).ZE9Q                           00245000
                   AIF   ('&ZCGPR' EQ '0').ZE9Q                         00245100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00245200
                   AIF   (T'&ZCGPR NE 'N').ZE9Q  INVALID REG NAME       00245300
.ZE9P              ANOP  ,                                              00245400
                   AIF   (T'&ZCGPR NE 'N').ZE9R  NON NUMERIC            00245500
                   AIF   ('&ZCGPR' LT '2').ZE9Q                         00245600
                   AIF   ('&ZCGPR' LE '12').ZE9R                        00245700
.ZE9Q              ANOP  ,                                              00245800
&ZMS               SETC  '"BUFFER='                                     00245900
&ZMS               SETC  '&ZMS.&BUFFER"'                                00246000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00246100
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00246200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00246300
.ZE9R              ANOP  ,                                              00246400
.*----------------------------------------------------------------***   00246500
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00246600
                   AIF   (N'&BUFSIZE LE 1).ZE12A  CK NUM                00246700
&ZMS               SETC  '"BUFSIZE='                                    00246800
&ZMS               SETC  '&ZMS.&BUFSIZE"'                               00246900
&ZMS               SETC  '&ZMS "BUFSIZE"'                               00247000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00247100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00247200
.ZE12A             ANOP  ,                                              00247300
.*-------------------------------------------------------------------   00247400
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00247500
                   AIF   (K'&BUFSIZE(1) LE 0).ZE12B NO PRM              00247600
&ZXBUFSIZE         SETC  'INPUT'     SET IN/OUTPUT                      00247700
&XBUFSIZE          SETC  '&BUFSIZE(1)'          SET XVARIABLE           00247800
                   AIF   (N'&BUFSIZE GT 1).ZE12B                        00247900
.*                 ANOP                                                 00248000
&XBUFSIZE          SETC  '&BUFSIZE'  SET XVARIABLE                      00248100
.ZE12B             ANOP  ,                                              00248200
.*-------------------------------------------------------------------   00248300
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00248400
                   AIF   (K'&ZXBUFSIZE LE 0).ZE12R  NOT I/O             00248500
                   AIF   ('&XBUFSIZE'(1,1) NE '(').ZE12R                00248600
&ZCGPR             SETC  '&XBUFSIZE'(2,K'&XBUFSIZE-2)                   00248700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE12P                   00248800
                   AIF   (K'&ZCGPR GT 2).ZE12Q                          00248900
                   AIF   ('&ZCGPR' EQ '0').ZE12Q                        00249000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00249100
                   AIF   (T'&ZCGPR NE 'N').ZE12Q  INVALID REG NAME      00249200
.ZE12P             ANOP  ,                                              00249300
                   AIF   (T'&ZCGPR NE 'N').ZE12R  NON NUMERIC           00249400
                   AIF   ('&ZCGPR' LT '2').ZE12Q                        00249500
                   AIF   ('&ZCGPR' LE '12').ZE12R                       00249600
.ZE12Q             ANOP  ,                                              00249700
&ZMS               SETC  '"BUFSIZE='                                    00249800
&ZMS               SETC  '&ZMS.&BUFSIZE"'                               00249900
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00250000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00250100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00250200
.ZE12R             ANOP  ,                                              00250300
.*-------------------------------------------------------------------   00250400
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00250500
&ZTLC              SETC 'REMOVE'                                        00250600
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZE14A               00250700
&XREQUEST          SETC  'REMOVE'    SET KEYWORD                        00250800
                   AIF   (N'&REQUEST LE 1).ZE14A  CK NUM                00250900
&ZMS               SETC  '"REQUEST='                                    00251000
&ZMS               SETC  '&ZMS.&REQUEST"'                               00251100
&ZMS               SETC  '&ZMS "REQUEST"'                               00251200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00251300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00251400
.ZE14A             ANOP  ,                                              00251500
.*----------------------------------------------------------------***   00251600
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00251700
                   AIF   (N'&BUFFER LE 1).ZE16A  CK NUM                 00251800
&ZMS               SETC  '"BUFFER='                                     00251900
&ZMS               SETC  '&ZMS.&BUFFER"'                                00252000
&ZMS               SETC  '&ZMS "BUFFER"'                                00252100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00252200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00252300
.ZE16A             ANOP  ,                                              00252400
.*-------------------------------------------------------------------   00252500
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00252600
                   AIF   (K'&BUFFER(1) LE 0).ZE16B NO PRM               00252700
&ZXBUFFER          SETC  'INPUT'     SET IN/OUTPUT                      00252800
&XBUFFER           SETC  '&BUFFER(1)'           SET XVARIABLE           00252900
                   AIF   (N'&BUFFER GT 1).ZE16B                         00253000
.*                 ANOP                                                 00253100
&XBUFFER           SETC  '&BUFFER'   SET XVARIABLE                      00253200
.ZE16B             ANOP  ,                                              00253300
.*-------------------------------------------------------------------   00253400
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00253500
                   AIF   (K'&ZXBUFFER LE 0).ZE16R  NOT I/O              00253600
                   AIF   ('&XBUFFER'(1,1) NE '(').ZE16R                 00253700
&ZCGPR             SETC  '&XBUFFER'(2,K'&XBUFFER-2)                     00253800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE16P                   00253900
                   AIF   (K'&ZCGPR GT 2).ZE16Q                          00254000
                   AIF   ('&ZCGPR' EQ '0').ZE16Q                        00254100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00254200
                   AIF   (T'&ZCGPR NE 'N').ZE16Q  INVALID REG NAME      00254300
.ZE16P             ANOP  ,                                              00254400
                   AIF   (T'&ZCGPR NE 'N').ZE16R  NON NUMERIC           00254500
                   AIF   ('&ZCGPR' LT '2').ZE16Q                        00254600
                   AIF   ('&ZCGPR' LE '12').ZE16R                       00254700
.ZE16Q             ANOP  ,                                              00254800
&ZMS               SETC  '"BUFFER='                                     00254900
&ZMS               SETC  '&ZMS.&BUFFER"'                                00255000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00255100
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00255200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00255300
.ZE16R             ANOP  ,                                              00255400
.*----------------------------------------------------------------***   00255500
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00255600
                   AIF   (N'&BUFSIZE LE 1).ZE19A  CK NUM                00255700
&ZMS               SETC  '"BUFSIZE='                                    00255800
&ZMS               SETC  '&ZMS.&BUFSIZE"'                               00255900
&ZMS               SETC  '&ZMS "BUFSIZE"'                               00256000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00256100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00256200
.ZE19A             ANOP  ,                                              00256300
.*-------------------------------------------------------------------   00256400
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00256500
                   AIF   (K'&BUFSIZE(1) LE 0).ZE19B NO PRM              00256600
&ZXBUFSIZE         SETC  'INPUT'     SET IN/OUTPUT                      00256700
&XBUFSIZE          SETC  '&BUFSIZE(1)'          SET XVARIABLE           00256800
                   AIF   (N'&BUFSIZE GT 1).ZE19B                        00256900
.*                 ANOP                                                 00257000
&XBUFSIZE          SETC  '&BUFSIZE'  SET XVARIABLE                      00257100
.ZE19B             ANOP  ,                                              00257200
.*-------------------------------------------------------------------   00257300
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00257400
                   AIF   (K'&ZXBUFSIZE LE 0).ZE19R  NOT I/O             00257500
                   AIF   ('&XBUFSIZE'(1,1) NE '(').ZE19R                00257600
&ZCGPR             SETC  '&XBUFSIZE'(2,K'&XBUFSIZE-2)                   00257700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE19P                   00257800
                   AIF   (K'&ZCGPR GT 2).ZE19Q                          00257900
                   AIF   ('&ZCGPR' EQ '0').ZE19Q                        00258000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00258100
                   AIF   (T'&ZCGPR NE 'N').ZE19Q  INVALID REG NAME      00258200
.ZE19P             ANOP  ,                                              00258300
                   AIF   (T'&ZCGPR NE 'N').ZE19R  NON NUMERIC           00258400
                   AIF   ('&ZCGPR' LT '2').ZE19Q                        00258500
                   AIF   ('&ZCGPR' LE '12').ZE19R                       00258600
.ZE19Q             ANOP  ,                                              00258700
&ZMS               SETC  '"BUFSIZE='                                    00258800
&ZMS               SETC  '&ZMS.&BUFSIZE"'                               00258900
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00259000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00259100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00259200
.ZE19R             ANOP  ,                                              00259300
.*----------------------------------------------------------------***   00259400
.***AE.KKCTL06 Additional value checks                                  00259500
.ZE21A             ANOP                                                 00259600
&ZTLC              SETC 'MARKNOABEND'                                   00259700
         AIF   ('&REQUEST(1)' NE '&ZTLC').ZE21A1                        00259800
&XREQUEST          SETC  'MARKNOABEND'          SET KEYWORD             00259900
.ZE21A1  ANOP                                                           00260000
.*----------------------------------------------------------------***   00260100
.***AE.KKCTL06 Additional value checks                                  00260200
.ZE0P5Q40A         ANOP                                                 00260300
&ZTLC              SETC 'UNMARKNOABEND'                                 00260400
         AIF   ('&REQUEST(1)' NE '&ZTLC').ZE0P5Q40A1                    00260500
&XREQUEST          SETC  'UNMARKNOABEND'        SET KEYWORD             00260600
.ZE0P5Q40A1  ANOP                                                       00260700
.*----------------------------------------------------------------***   00260800
.***AE.KKCTL06 Additional value checks                                  00260900
.ZE0P5Q41A         ANOP                                                 00261000
&ZTLC              SETC 'MARKCMDSABEND'                                 00261100
         AIF   ('&REQUEST(1)' NE '&ZTLC').ZE0P5Q41A1                    00261200
&XREQUEST          SETC  'MARKCMDSABEND'        SET KEYWORD             00261300
.ZE0P5Q41A1  ANOP                                                       00261400
.*------------------------------------------------------------------    00261500
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00261600
.ZE0P5Q42          AIF   (K'&XREQUEST GT 0).ZE0P5Q42A                   00261700
                   AIF   (K'&REQUEST(1) LE 0).ZE0P5Q42B                 00261800
&ZMS               SETC  '"REQUEST='                                    00261900
&ZMS               SETC  '&ZMS.&REQUEST"'                               00262000
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00262100
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00262200
&ZMS               SETC  '&ZMS "COUNT",'                                00262300
&ZMS               SETC  '&ZMS "INFO",'                                 00262400
&ZMS               SETC  '&ZMS OR "REMOVE".'                            00262500
                   MNOTE 8,' &ZMS '                                     00262600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00262700
                   AGO   .ZE0P5Q42B                                     00262800
.*                                                                      00262900
.ZE0P5Q42A         ANOP  ,                                              00263000
&ZXREQUEST         SETC  'INPUT'     SET IN/OUTPUT                      00263100
.ZE0P5Q42B         ANOP  ,                                              00263200
.*----------------------------------------------------------------***   00263300
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00263400
                   AIF   (N'&CLASS LE 1).ZE23A  CK NUM                  00263500
&ZMS               SETC  '"CLASS='                                      00263600
&ZMS               SETC  '&ZMS.&CLASS"'                                 00263700
&ZMS               SETC  '&ZMS "CLASS"'                                 00263800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00263900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00264000
.ZE23A             ANOP  ,                                              00264100
.*-------------------------------------------------------------------   00264200
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00264300
                   AIF   (K'&CLASS(1) LE 0).ZE23B NO PRM                00264400
&ZXCLASS           SETC  'INPUT'     SET IN/OUTPUT                      00264500
&XCLASS            SETC  '&CLASS(1)'            SET XVARIABLE           00264600
                   AIF   (N'&CLASS GT 1).ZE23B                          00264700
.*                 ANOP                                                 00264800
&XCLASS            SETC  '&CLASS'    SET XVARIABLE                      00264900
.ZE23B             ANOP  ,                                              00265000
.*-------------------------------------------------------------------   00265100
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00265200
                   AIF   (K'&ZXCLASS LE 0).ZE23R  NOT I/O               00265300
                   AIF   ('&XCLASS'(1,1) NE '(').ZE23R                  00265400
&ZCGPR             SETC  '&XCLASS'(2,K'&XCLASS-2)                       00265500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE23P                   00265600
                   AIF   (K'&ZCGPR GT 2).ZE23Q                          00265700
                   AIF   ('&ZCGPR' EQ '0').ZE23Q                        00265800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00265900
                   AIF   (T'&ZCGPR NE 'N').ZE23Q  INVALID REG NAME      00266000
.ZE23P             ANOP  ,                                              00266100
                   AIF   (T'&ZCGPR NE 'N').ZE23R  NON NUMERIC           00266200
                   AIF   ('&ZCGPR' LT '2').ZE23Q                        00266300
                   AIF   ('&ZCGPR' LE '12').ZE23R                       00266400
.ZE23Q             ANOP  ,                                              00266500
&ZMS               SETC  '"CLASS='                                      00266600
&ZMS               SETC  '&ZMS.&CLASS"'                                 00266700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00266800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00266900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00267000
.ZE23R             ANOP  ,                                              00267100
.*----------------------------------------------------------------***   00267200
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00267300
                   AIF   (N'&CMD LE 1).ZE26A    CK NUM                  00267400
&ZMS               SETC  '"CMD='                                        00267500
&ZMS               SETC  '&ZMS.&CMD"'                                   00267600
&ZMS               SETC  '&ZMS "CMD"'                                   00267700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00267800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00267900
.ZE26A             ANOP  ,                                              00268000
.*-------------------------------------------------------------------   00268100
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00268200
                   AIF   (K'&CMD(1) LE 0).ZE26B NO PRM                  00268300
&ZXCMD             SETC  'INPUT'     SET IN/OUTPUT                      00268400
&XCMD              SETC  '&CMD(1)'   SET XVARIABLE                      00268500
                   AIF   (N'&CMD GT 1).ZE26B                            00268600
.*                 ANOP                                                 00268700
&XCMD              SETC  '&CMD'      SET XVARIABLE                      00268800
.ZE26B             ANOP  ,                                              00268900
.*-------------------------------------------------------------------   00269000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00269100
                   AIF   (K'&ZXCMD LE 0).ZE26R  NOT I/O                 00269200
                   AIF   ('&XCMD'(1,1) NE '(').ZE26R                    00269300
&ZCGPR             SETC  '&XCMD'(2,K'&XCMD-2)                           00269400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE26P                   00269500
                   AIF   (K'&ZCGPR GT 2).ZE26Q                          00269600
                   AIF   ('&ZCGPR' EQ '0').ZE26Q                        00269700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00269800
                   AIF   (T'&ZCGPR NE 'N').ZE26Q  INVALID REG NAME      00269900
.ZE26P             ANOP  ,                                              00270000
                   AIF   (T'&ZCGPR NE 'N').ZE26R  NON NUMERIC           00270100
                   AIF   ('&ZCGPR' LT '2').ZE26Q                        00270200
                   AIF   ('&ZCGPR' LE '12').ZE26R                       00270300
.ZE26Q             ANOP  ,                                              00270400
&ZMS               SETC  '"CMD='                                        00270500
&ZMS               SETC  '&ZMS.&CMD"'                                   00270600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00270700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00270800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00270900
.ZE26R             ANOP  ,                                              00271000
.*----------------------------------------------------------------***   00271100
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00271200
                   AIF   (N'&ID LE 1).ZE29A     CK NUM                  00271300
&ZMS               SETC  '"ID='                                         00271400
&ZMS               SETC  '&ZMS.&ID"'                                    00271500
&ZMS               SETC  '&ZMS "ID"'                                    00271600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00271700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00271800
.ZE29A             ANOP  ,                                              00271900
.*-------------------------------------------------------------------   00272000
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00272100
                   AIF   (K'&ID(1) LE 0).ZE29B  NO PRM                  00272200
&ZXID              SETC  'INPUT'     SET IN/OUTPUT                      00272300
&XID               SETC  '&ID(1)'    SET XVARIABLE                      00272400
                   AIF   (N'&ID GT 1).ZE29B                             00272500
.*                 ANOP                                                 00272600
&XID               SETC  '&ID'       SET XVARIABLE                      00272700
.ZE29B             ANOP  ,                                              00272800
.*-------------------------------------------------------------------   00272900
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00273000
                   AIF   (K'&ZXID LE 0).ZE29R   NOT I/O                 00273100
                   AIF   ('&XID'(1,1) NE '(').ZE29R                     00273200
&ZCGPR             SETC  '&XID'(2,K'&XID-2)                             00273300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE29P                   00273400
                   AIF   (K'&ZCGPR GT 2).ZE29Q                          00273500
                   AIF   ('&ZCGPR' EQ '0').ZE29Q                        00273600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00273700
                   AIF   (T'&ZCGPR NE 'N').ZE29Q  INVALID REG NAME      00273800
.ZE29P             ANOP  ,                                              00273900
                   AIF   (T'&ZCGPR NE 'N').ZE29R  NON NUMERIC           00274000
                   AIF   ('&ZCGPR' LT '2').ZE29Q                        00274100
                   AIF   ('&ZCGPR' LE '12').ZE29R                       00274200
.ZE29Q             ANOP  ,                                              00274300
&ZMS               SETC  '"ID='                                         00274400
&ZMS               SETC  '&ZMS.&ID"'                                    00274500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00274600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00274700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00274800
.ZE29R             ANOP  ,                                              00274900
.*----------------------------------------------------------------***   00275000
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00275100
                   AIF   (N'&JOB LE 1).ZE32A    CK NUM                  00275200
&ZMS               SETC  '"JOB='                                        00275300
&ZMS               SETC  '&ZMS.&JOB"'                                   00275400
&ZMS               SETC  '&ZMS "JOB"'                                   00275500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00275600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00275700
.ZE32A             ANOP  ,                                              00275800
.*-------------------------------------------------------------------   00275900
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00276000
                   AIF   (K'&JOB(1) LE 0).ZE32B NO PRM                  00276100
&ZXJOB             SETC  'INPUT'     SET IN/OUTPUT                      00276200
&XJOB              SETC  '&JOB(1)'   SET XVARIABLE                      00276300
                   AIF   (N'&JOB GT 1).ZE32B                            00276400
.*                 ANOP                                                 00276500
&XJOB              SETC  '&JOB'      SET XVARIABLE                      00276600
.ZE32B             ANOP  ,                                              00276700
.*-------------------------------------------------------------------   00276800
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00276900
                   AIF   (K'&ZXJOB LE 0).ZE32R  NOT I/O                 00277000
                   AIF   ('&XJOB'(1,1) NE '(').ZE32R                    00277100
&ZCGPR             SETC  '&XJOB'(2,K'&XJOB-2)                           00277200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE32P                   00277300
                   AIF   (K'&ZCGPR GT 2).ZE32Q                          00277400
                   AIF   ('&ZCGPR' EQ '0').ZE32Q                        00277500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00277600
                   AIF   (T'&ZCGPR NE 'N').ZE32Q  INVALID REG NAME      00277700
.ZE32P             ANOP  ,                                              00277800
                   AIF   (T'&ZCGPR NE 'N').ZE32R  NON NUMERIC           00277900
                   AIF   ('&ZCGPR' LT '2').ZE32Q                        00278000
                   AIF   ('&ZCGPR' LE '12').ZE32R                       00278100
.ZE32Q             ANOP  ,                                              00278200
&ZMS               SETC  '"JOB='                                        00278300
&ZMS               SETC  '&ZMS.&JOB"'                                   00278400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00278500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00278600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00278700
.ZE32R             ANOP  ,                                              00278800
.*----------------------------------------------------------------***   00278900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00279000
                   AIF   (N'&COUNT LE 1).ZE35A  CK NUM                  00279100
&ZMS               SETC  '"COUNT='                                      00279200
&ZMS               SETC  '&ZMS.&COUNT"'                                 00279300
&ZMS               SETC  '&ZMS "COUNT"'                                 00279400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00279500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00279600
.ZE35A             ANOP  ,                                              00279700
.*-------------------------------------------------------------------   00279800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00279900
                   AIF   (K'&COUNT(1) LE 0).ZE35B NO PRM                00280000
&ZXCOUNT           SETC  'INPUT'     SET IN/OUTPUT                      00280100
&XCOUNT            SETC  '&COUNT(1)'            SET XVARIABLE           00280200
                   AIF   (N'&COUNT GT 1).ZE35B                          00280300
.*                 ANOP                                                 00280400
&XCOUNT            SETC  '&COUNT'    SET XVARIABLE                      00280500
.ZE35B             ANOP  ,                                              00280600
.*-------------------------------------------------------------------   00280700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00280800
                   AIF   (K'&ZXCOUNT LE 0).ZE35R  NOT I/O               00280900
                   AIF   ('&XCOUNT'(1,1) NE '(').ZE35R                  00281000
&ZCGPR             SETC  '&XCOUNT'(2,K'&XCOUNT-2)                       00281100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE35P                   00281200
                   AIF   (K'&ZCGPR GT 2).ZE35Q                          00281300
                   AIF   ('&ZCGPR' EQ '0').ZE35Q                        00281400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00281500
                   AIF   (T'&ZCGPR NE 'N').ZE35Q  INVALID REG NAME      00281600
.ZE35P             ANOP  ,                                              00281700
                   AIF   (T'&ZCGPR NE 'N').ZE35R  NON NUMERIC           00281800
                   AIF   ('&ZCGPR' LT '2').ZE35Q                        00281900
                   AIF   ('&ZCGPR' LE '12').ZE35R                       00282000
.ZE35Q             ANOP  ,                                              00282100
&ZMS               SETC  '"COUNT='                                      00282200
&ZMS               SETC  '&ZMS.&COUNT"'                                 00282300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00282400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00282500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00282600
.ZE35R             ANOP  ,                                              00282700
.*-------------------------------------------------------------------   00282800
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00282900
&ZTLC              SETC 'YES'                                           00283000
                   AIF   ('&IBMINT(1)' NE '&ZTLC').ZE37A                00283100
&XIBMINT           SETC  'YES'       SET KEYWORD                        00283200
                   AIF   (N'&IBMINT LE 1).ZE37A  CK NUM                 00283300
&ZMS               SETC  '"IBMINT='                                     00283400
&ZMS               SETC  '&ZMS.&IBMINT"'                                00283500
&ZMS               SETC  '&ZMS "IBMINT"'                                00283600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00283700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00283800
.ZE37A             ANOP  ,                                              00283900
.*-------------------------------------------------------------------   00284000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00284100
&ZTLC              SETC 'MARKNOABEND'                                   00284200
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZE40A               00284300
&XREQUEST          SETC  'MARKNOABEND'          SET KEYWORD             00284400
                   AIF   (N'&REQUEST LE 1).ZE40A  CK NUM                00284500
&ZMS               SETC  '"REQUEST='                                    00284600
&ZMS               SETC  '&ZMS.&REQUEST"'                               00284700
&ZMS               SETC  '&ZMS "REQUEST"'                               00284800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00284900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00285000
.ZE40A             ANOP  ,                                              00285100
.*-------------------------------------------------------------------   00285200
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00285300
&ZTLC              SETC 'UNMARKNOABEND'                                 00285400
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZE41A               00285500
&XREQUEST          SETC  'UNMARKNOABEND'        SET KEYWORD             00285600
                   AIF   (N'&REQUEST LE 1).ZE41A  CK NUM                00285700
&ZMS               SETC  '"REQUEST='                                    00285800
&ZMS               SETC  '&ZMS.&REQUEST"'                               00285900
&ZMS               SETC  '&ZMS "REQUEST"'                               00286000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00286100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00286200
.ZE41A             ANOP  ,                                              00286300
.*-------------------------------------------------------------------   00286400
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00286500
&ZTLC              SETC 'MARKCMDSABEND'                                 00286600
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZE42A               00286700
&XREQUEST          SETC  'MARKCMDSABEND'        SET KEYWORD             00286800
                   AIF   (N'&REQUEST LE 1).ZE42A  CK NUM                00286900
&ZMS               SETC  '"REQUEST='                                    00287000
&ZMS               SETC  '&ZMS.&REQUEST"'                               00287100
&ZMS               SETC  '&ZMS "REQUEST"'                               00287200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00287300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00287400
.ZE42A             ANOP  ,                                              00287500
.*----------------------------------------------------------------***   00287600
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00287700
                   AIF   (N'&BUFFER LE 1).ZE44A  CK NUM                 00287800
&ZMS               SETC  '"BUFFER='                                     00287900
&ZMS               SETC  '&ZMS.&BUFFER"'                                00288000
&ZMS               SETC  '&ZMS "BUFFER"'                                00288100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00288200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00288300
.ZE44A             ANOP  ,                                              00288400
.*-------------------------------------------------------------------   00288500
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00288600
                   AIF   (K'&BUFFER(1) LE 0).ZE44B NO PRM               00288700
&ZXBUFFER          SETC  'INPUT'     SET IN/OUTPUT                      00288800
&XBUFFER           SETC  '&BUFFER(1)'           SET XVARIABLE           00288900
                   AIF   (N'&BUFFER GT 1).ZE44B                         00289000
.*                 ANOP                                                 00289100
&XBUFFER           SETC  '&BUFFER'   SET XVARIABLE                      00289200
.ZE44B             ANOP  ,                                              00289300
.*-------------------------------------------------------------------   00289400
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00289500
                   AIF   (K'&ZXBUFFER LE 0).ZE44R  NOT I/O              00289600
                   AIF   ('&XBUFFER'(1,1) NE '(').ZE44R                 00289700
&ZCGPR             SETC  '&XBUFFER'(2,K'&XBUFFER-2)                     00289800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE44P                   00289900
                   AIF   (K'&ZCGPR GT 2).ZE44Q                          00290000
                   AIF   ('&ZCGPR' EQ '0').ZE44Q                        00290100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00290200
                   AIF   (T'&ZCGPR NE 'N').ZE44Q  INVALID REG NAME      00290300
.ZE44P             ANOP  ,                                              00290400
                   AIF   (T'&ZCGPR NE 'N').ZE44R  NON NUMERIC           00290500
                   AIF   ('&ZCGPR' LT '2').ZE44Q                        00290600
                   AIF   ('&ZCGPR' LE '12').ZE44R                       00290700
.ZE44Q             ANOP  ,                                              00290800
&ZMS               SETC  '"BUFFER='                                     00290900
&ZMS               SETC  '&ZMS.&BUFFER"'                                00291000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00291100
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00291200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00291300
.ZE44R             ANOP  ,                                              00291400
.*----------------------------------------------------------------***   00291500
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00291600
                   AIF   (N'&BUFSIZE LE 1).ZE47A  CK NUM                00291700
&ZMS               SETC  '"BUFSIZE='                                    00291800
&ZMS               SETC  '&ZMS.&BUFSIZE"'                               00291900
&ZMS               SETC  '&ZMS "BUFSIZE"'                               00292000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00292100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00292200
.ZE47A             ANOP  ,                                              00292300
.*-------------------------------------------------------------------   00292400
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00292500
                   AIF   (K'&BUFSIZE(1) LE 0).ZE47B NO PRM              00292600
&ZXBUFSIZE         SETC  'INPUT'     SET IN/OUTPUT                      00292700
&XBUFSIZE          SETC  '&BUFSIZE(1)'          SET XVARIABLE           00292800
                   AIF   (N'&BUFSIZE GT 1).ZE47B                        00292900
.*                 ANOP                                                 00293000
&XBUFSIZE          SETC  '&BUFSIZE'  SET XVARIABLE                      00293100
.ZE47B             ANOP  ,                                              00293200
.*-------------------------------------------------------------------   00293300
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00293400
                   AIF   (K'&ZXBUFSIZE LE 0).ZE47R  NOT I/O             00293500
                   AIF   ('&XBUFSIZE'(1,1) NE '(').ZE47R                00293600
&ZCGPR             SETC  '&XBUFSIZE'(2,K'&XBUFSIZE-2)                   00293700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE47P                   00293800
                   AIF   (K'&ZCGPR GT 2).ZE47Q                          00293900
                   AIF   ('&ZCGPR' EQ '0').ZE47Q                        00294000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00294100
                   AIF   (T'&ZCGPR NE 'N').ZE47Q  INVALID REG NAME      00294200
.ZE47P             ANOP  ,                                              00294300
                   AIF   (T'&ZCGPR NE 'N').ZE47R  NON NUMERIC           00294400
                   AIF   ('&ZCGPR' LT '2').ZE47Q                        00294500
                   AIF   ('&ZCGPR' LE '12').ZE47R                       00294600
.ZE47Q             ANOP  ,                                              00294700
&ZMS               SETC  '"BUFSIZE='                                    00294800
&ZMS               SETC  '&ZMS.&BUFSIZE"'                               00294900
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00295000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00295100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00295200
.ZE47R             ANOP  ,                                              00295300
.*----------------------------------------------------------------***   00295400
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00295500
                   AIF   (N'&CMD LE 1).ZE50A    CK NUM                  00295600
&ZMS               SETC  '"CMD='                                        00295700
&ZMS               SETC  '&ZMS.&CMD"'                                   00295800
&ZMS               SETC  '&ZMS "CMD"'                                   00295900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00296000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00296100
.ZE50A             ANOP  ,                                              00296200
.*-------------------------------------------------------------------   00296300
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00296400
                   AIF   (K'&CMD(1) LE 0).ZE50B NO PRM                  00296500
&ZXCMD             SETC  'INPUT'     SET IN/OUTPUT                      00296600
&XCMD              SETC  '&CMD(1)'   SET XVARIABLE                      00296700
                   AIF   (N'&CMD GT 1).ZE50B                            00296800
.*                 ANOP                                                 00296900
&XCMD              SETC  '&CMD'      SET XVARIABLE                      00297000
.ZE50B             ANOP  ,                                              00297100
.*-------------------------------------------------------------------   00297200
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00297300
                   AIF   (K'&ZXCMD LE 0).ZE50R  NOT I/O                 00297400
                   AIF   ('&XCMD'(1,1) NE '(').ZE50R                    00297500
&ZCGPR             SETC  '&XCMD'(2,K'&XCMD-2)                           00297600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE50P                   00297700
                   AIF   (K'&ZCGPR GT 2).ZE50Q                          00297800
                   AIF   ('&ZCGPR' EQ '0').ZE50Q                        00297900
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00298000
                   AIF   (T'&ZCGPR NE 'N').ZE50Q  INVALID REG NAME      00298100
.ZE50P             ANOP  ,                                              00298200
                   AIF   (T'&ZCGPR NE 'N').ZE50R  NON NUMERIC           00298300
                   AIF   ('&ZCGPR' LT '2').ZE50Q                        00298400
                   AIF   ('&ZCGPR' LE '12').ZE50R                       00298500
.ZE50Q             ANOP  ,                                              00298600
&ZMS               SETC  '"CMD='                                        00298700
&ZMS               SETC  '&ZMS.&CMD"'                                   00298800
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00298900
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00299000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00299100
.ZE50R             ANOP  ,                                              00299200
.*----------------------------------------------------------------***   00299300
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00299400
                   AIF   (N'&ID LE 1).ZE53A     CK NUM                  00299500
&ZMS               SETC  '"ID='                                         00299600
&ZMS               SETC  '&ZMS.&ID"'                                    00299700
&ZMS               SETC  '&ZMS "ID"'                                    00299800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00299900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00300000
.ZE53A             ANOP  ,                                              00300100
.*-------------------------------------------------------------------   00300200
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00300300
                   AIF   (K'&ID(1) LE 0).ZE53B  NO PRM                  00300400
&ZXID              SETC  'INPUT'     SET IN/OUTPUT                      00300500
&XID               SETC  '&ID(1)'    SET XVARIABLE                      00300600
                   AIF   (N'&ID GT 1).ZE53B                             00300700
.*                 ANOP                                                 00300800
&XID               SETC  '&ID'       SET XVARIABLE                      00300900
.ZE53B             ANOP  ,                                              00301000
.*-------------------------------------------------------------------   00301100
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00301200
                   AIF   (K'&ZXID LE 0).ZE53R   NOT I/O                 00301300
                   AIF   ('&XID'(1,1) NE '(').ZE53R                     00301400
&ZCGPR             SETC  '&XID'(2,K'&XID-2)                             00301500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE53P                   00301600
                   AIF   (K'&ZCGPR GT 2).ZE53Q                          00301700
                   AIF   ('&ZCGPR' EQ '0').ZE53Q                        00301800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00301900
                   AIF   (T'&ZCGPR NE 'N').ZE53Q  INVALID REG NAME      00302000
.ZE53P             ANOP  ,                                              00302100
                   AIF   (T'&ZCGPR NE 'N').ZE53R  NON NUMERIC           00302200
                   AIF   ('&ZCGPR' LT '2').ZE53Q                        00302300
                   AIF   ('&ZCGPR' LE '12').ZE53R                       00302400
.ZE53Q             ANOP  ,                                              00302500
&ZMS               SETC  '"ID='                                         00302600
&ZMS               SETC  '&ZMS.&ID"'                                    00302700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00302800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00302900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00303000
.ZE53R             ANOP  ,                                              00303100
.*----------------------------------------------------------------***   00303200
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00303300
                   AIF   (N'&CLASS LE 1).ZE56A  CK NUM                  00303400
&ZMS               SETC  '"CLASS='                                      00303500
&ZMS               SETC  '&ZMS.&CLASS"'                                 00303600
&ZMS               SETC  '&ZMS "CLASS"'                                 00303700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00303800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00303900
.ZE56A             ANOP  ,                                              00304000
.*-------------------------------------------------------------------   00304100
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00304200
                   AIF   (K'&CLASS(1) LE 0).ZE56B NO PRM                00304300
&ZXCLASS           SETC  'INPUT'     SET IN/OUTPUT                      00304400
&XCLASS            SETC  '&CLASS(1)'            SET XVARIABLE           00304500
                   AIF   (N'&CLASS GT 1).ZE56B                          00304600
.*                 ANOP                                                 00304700
&XCLASS            SETC  '&CLASS'    SET XVARIABLE                      00304800
.ZE56B             ANOP  ,                                              00304900
.*-------------------------------------------------------------------   00305000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00305100
                   AIF   (K'&ZXCLASS LE 0).ZE56R  NOT I/O               00305200
                   AIF   ('&XCLASS'(1,1) NE '(').ZE56R                  00305300
&ZCGPR             SETC  '&XCLASS'(2,K'&XCLASS-2)                       00305400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE56P                   00305500
                   AIF   (K'&ZCGPR GT 2).ZE56Q                          00305600
                   AIF   ('&ZCGPR' EQ '0').ZE56Q                        00305700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00305800
                   AIF   (T'&ZCGPR NE 'N').ZE56Q  INVALID REG NAME      00305900
.ZE56P             ANOP  ,                                              00306000
                   AIF   (T'&ZCGPR NE 'N').ZE56R  NON NUMERIC           00306100
                   AIF   ('&ZCGPR' LT '2').ZE56Q                        00306200
                   AIF   ('&ZCGPR' LE '12').ZE56R                       00306300
.ZE56Q             ANOP  ,                                              00306400
&ZMS               SETC  '"CLASS='                                      00306500
&ZMS               SETC  '&ZMS.&CLASS"'                                 00306600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00306700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00306800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00306900
.ZE56R             ANOP  ,                                              00307000
.*----------------------------------------------------------------***   00307100
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00307200
                   AIF   (N'&JOB LE 1).ZE59A    CK NUM                  00307300
&ZMS               SETC  '"JOB='                                        00307400
&ZMS               SETC  '&ZMS.&JOB"'                                   00307500
&ZMS               SETC  '&ZMS "JOB"'                                   00307600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00307700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00307800
.ZE59A             ANOP  ,                                              00307900
.*-------------------------------------------------------------------   00308000
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00308100
                   AIF   (K'&JOB(1) LE 0).ZE59B NO PRM                  00308200
&ZXJOB             SETC  'INPUT'     SET IN/OUTPUT                      00308300
&XJOB              SETC  '&JOB(1)'   SET XVARIABLE                      00308400
                   AIF   (N'&JOB GT 1).ZE59B                            00308500
.*                 ANOP                                                 00308600
&XJOB              SETC  '&JOB'      SET XVARIABLE                      00308700
.ZE59B             ANOP  ,                                              00308800
.*-------------------------------------------------------------------   00308900
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00309000
                   AIF   (K'&ZXJOB LE 0).ZE59R  NOT I/O                 00309100
                   AIF   ('&XJOB'(1,1) NE '(').ZE59R                    00309200
&ZCGPR             SETC  '&XJOB'(2,K'&XJOB-2)                           00309300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE59P                   00309400
                   AIF   (K'&ZCGPR GT 2).ZE59Q                          00309500
                   AIF   ('&ZCGPR' EQ '0').ZE59Q                        00309600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00309700
                   AIF   (T'&ZCGPR NE 'N').ZE59Q  INVALID REG NAME      00309800
.ZE59P             ANOP  ,                                              00309900
                   AIF   (T'&ZCGPR NE 'N').ZE59R  NON NUMERIC           00310000
                   AIF   ('&ZCGPR' LT '2').ZE59Q                        00310100
                   AIF   ('&ZCGPR' LE '12').ZE59R                       00310200
.ZE59Q             ANOP  ,                                              00310300
&ZMS               SETC  '"JOB='                                        00310400
&ZMS               SETC  '&ZMS.&JOB"'                                   00310500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00310600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00310700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00310800
.ZE59R             ANOP  ,                                              00310900
.*------------------------------------------------------------------    00311000
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00311100
.ZE61              AIF   (K'&XREQUEST GT 0).ZE61A                       00311200
                   AIF   (K'&REQUEST(1) LE 0).ZE61B                     00311300
&ZMS               SETC  '"REQUEST='                                    00311400
&ZMS               SETC  '&ZMS.&REQUEST"'                               00311500
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00311600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00311700
&ZMS               SETC  '&ZMS "MARKNOABEND",'                          00311800
&ZMS               SETC  '&ZMS "UNMARKNOABEND",'                        00311900
&ZMS               SETC  '&ZMS OR "MARKCMDSABEND".'                     00312000
                   MNOTE 8,' &ZMS '                                     00312100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00312200
                   AGO   .ZE61B                                         00312300
.*                                                                      00312400
.ZE61A             ANOP  ,                                              00312500
&ZXREQUEST         SETC  'INPUT'     SET IN/OUTPUT                      00312600
.ZE61B             ANOP  ,                                              00312700
.*------------------------------------------------------------------    00312800
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00312900
.ZE62              AIF   (K'&XIBMINT GT 0).ZE62A                        00313000
                   AIF   (K'&IBMINT(1) LE 0).ZE62B                      00313100
&ZMS               SETC  '"IBMINT='                                     00313200
&ZMS               SETC  '&ZMS.&IBMINT"'                                00313300
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00313400
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00313500
&ZMS               SETC  '&ZMS "NO"'                                    00313600
&ZMS               SETC  '&ZMS OR "YES".'                               00313700
                   MNOTE 8,' &ZMS '                                     00313800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00313900
                   AGO   .ZE62B                                         00314000
.*                                                                      00314100
.ZE62A             ANOP  ,                                              00314200
&ZXIBMINT          SETC  'INPUT'     SET IN/OUTPUT                      00314300
.ZE62B             ANOP  ,                                              00314400
.*----------------------------------------------------------------***   00314500
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00314600
                   AIF   (N'&RETCODE LE 1).ZE64A  CK NUM                00314700
&ZMS               SETC  '"RETCODE='                                    00314800
&ZMS               SETC  '&ZMS.&RETCODE"'                               00314900
&ZMS               SETC  '&ZMS "RETCODE"'                               00315000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00315100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00315200
.ZE64A             ANOP  ,                                              00315300
.*-------------------------------------------------------------------   00315400
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00315500
                   AIF   (K'&RETCODE(1) LE 0).ZE64B NO PRM              00315600
&ZXRETCODE         SETC  'OUTPUT'    SET IN/OUTPUT                      00315700
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00315800
                   AIF   (N'&RETCODE GT 1).ZE64B                        00315900
.*                 ANOP                                                 00316000
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00316100
.ZE64B             ANOP  ,                                              00316200
.*-------------------------------------------------------------------   00316300
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00316400
                   AIF   (K'&ZXRETCODE LE 0).ZE64R  NOT I/O             00316500
                   AIF   ('&XRETCODE'(1,1) NE '(').ZE64R                00316600
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00316700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE64P                   00316800
                   AIF   (K'&ZCGPR GT 2).ZE64Q                          00316900
                   AIF   ('&ZCGPR' EQ '0').ZE64Q                        00317000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00317100
                   AIF   (T'&ZCGPR NE 'N').ZE64Q  INVALID REG NAME      00317200
.ZE64P             ANOP  ,                                              00317300
                   AIF   (T'&ZCGPR NE 'N').ZE64R  NON NUMERIC           00317400
                   AIF   ('&ZCGPR' LT '2').ZE64Q                        00317500
                   AIF   ('&ZCGPR' LE '12').ZE64R                       00317600
.ZE64Q             ANOP  ,                                              00317700
&ZMS               SETC  '"RETCODE='                                    00317800
&ZMS               SETC  '&ZMS.&RETCODE"'                               00317900
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00318000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00318100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00318200
.ZE64R             ANOP  ,                                              00318300
.*----------------------------------------------------------------***   00318400
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00318500
                   AIF   (N'&RSNCODE LE 1).ZE67A  CK NUM                00318600
&ZMS               SETC  '"RSNCODE='                                    00318700
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00318800
&ZMS               SETC  '&ZMS "RSNCODE"'                               00318900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00319000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00319100
.ZE67A             ANOP  ,                                              00319200
.*-------------------------------------------------------------------   00319300
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00319400
                   AIF   (K'&RSNCODE(1) LE 0).ZE67B NO PRM              00319500
&ZXRSNCODE         SETC  'OUTPUT'    SET IN/OUTPUT                      00319600
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00319700
                   AIF   (N'&RSNCODE GT 1).ZE67B                        00319800
.*                 ANOP                                                 00319900
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00320000
.ZE67B             ANOP  ,                                              00320100
.*-------------------------------------------------------------------   00320200
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00320300
                   AIF   (K'&ZXRSNCODE LE 0).ZE67R  NOT I/O             00320400
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZE67R                00320500
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00320600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE67P                   00320700
                   AIF   (K'&ZCGPR GT 2).ZE67Q                          00320800
                   AIF   ('&ZCGPR' EQ '0').ZE67Q                        00320900
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00321000
                   AIF   (T'&ZCGPR NE 'N').ZE67Q  INVALID REG NAME      00321100
.ZE67P             ANOP  ,                                              00321200
                   AIF   (T'&ZCGPR NE 'N').ZE67R  NON NUMERIC           00321300
                   AIF   ('&ZCGPR' LT '2').ZE67Q                        00321400
                   AIF   ('&ZCGPR' LE '12').ZE67R                       00321500
.ZE67Q             ANOP  ,                                              00321600
&ZMS               SETC  '"RSNCODE='                                    00321700
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00321800
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00321900
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00322000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00322100
.ZE67R             ANOP  ,                                              00322200
.******************************************************************     00322300
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00322400
.******************************************************************     00322500
                   ACTR  10000                                          00322600
.*----------------------------------------------------------------***   00322700
.***AF.P02 EXTRA POSITIONALS                                            00322800
                   AIF   (N'&SYSLIST LE 0).ZELISTX  NO EXTRAS           00322900
&ZCVAL             SETC  ''          ERROR FIELD                        00323000
&ZAWRK             SETA  0           POSITIONAL NUMBER                  00323100
.ZELIST2           ANOP  ,                                              00323200
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00323300
                   AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE           00323400
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                00323500
                   AGO   .ZELIST2                                       00323600
.*                                                                      00323700
.ZELIST3           ANOP  ,                                              00323800
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00323900
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'                      00324000
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00324100
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00324200
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00324300
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00324400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00324500
.ZELISTX           ANOP  ,                                              00324600
&ZASYSLNDX         SETA  0                                              00324700
.*-------------------------------------------------------------------   00324800
.***AE.MF02 MF=(SLME)                                                   00324900
.ZEMFX             ANOP  ,           END OF PARTIAL SYNTAX CHECK        00325000
.*******************************************************************    00325100
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00325200
.*******************************************************************    00325300
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          00325400
.*******************************************************************    00325500
.***AE.01  START OF IEECMDS MACRO CODE                                  00325600
.*******************************************************************    00325700
                   LCLC  &M0M0001                 NAME                  00325800
&M0M0001           SETC  '&XLABEL'                SET NAME              00325900
                   AIF   (K'&XLABEL NE 0).XLAB2                         00326000
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          00326100
.*                                                                      00326200
.XLAB2             ANOP  ,                                              00326300
                   AIF   ('&XMF' EQ 'L').XLAB3                          00326400
&M0M0001 DS    0H                             IEECMDS-1                 00326500
.XLAB3             ANOP  ,                                              00326600
.*******************************************************************    00326700
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00326800
.*******************************************************************    00326900
              PUSH  PRINT                                               00327000
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     00327100
                   PRINT OFF         ++ PR01                            00327200
                   AGO   .ZPRNTXX                                       00327300
.ZPRINTX           PRINT ON                                             00327400
.ZPRNTXX           ANOP  ,                                              00327500
.********************************************************************   00327600
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00327700
.********************************************************************   00327800
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00327900
                      LCLA  &ZOPN1         INVOCATION INDEX             00328000
                      LCLC  &ZOPL(4095)    LABEL                        00328100
                      LCLC  &ZOPO(4095)    OPERATION                    00328200
                      LCLC  &ZOPV(4095)    VALUE                        00328300
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00328400
.*                                                                      00328500
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00328600
.******************************************************************     00328700
.***AL.L10 IEECMDS FMT=LIST MF=S!L PARAMETERS                           00328800
.******************************************************************     00328900
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00329000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00329100
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00329200
&XMFATTR              SETC  '0D'                                        00329300
.*                                                                      00329400
&ZOPN                 SETA  &ZOPN+1                                     00329500
&ZOPL(&ZOPN)          SETC  ' '                                         00329600
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00329700
&ZOPO(&ZOPN)          SETC  'B'                                         00329800
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00329900
                      AGO   .ZALVL6B                                    00330000
.ZALVL6A              ANOP                                              00330100
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00330200
&ZOPV(&ZOPN)          SETC  '4,8'                                       00330300
&ZOPN                 SETA  &ZOPN+1                                     00330400
&ZOPL(&ZOPN)          SETC  ' '                                         00330500
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00330600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00330700
.ZALVL6B              ANOP                                              00330800
&ZOPD(&ZOPN)          SETC  '++ IEECMDS ARG PARMS'                      00330900
.*                                                                      00331000
&ZOPN                 SETA  &ZOPN+1                                     00331100
&ZOPL(&ZOPN)          SETC  ' '                                         00331200
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00331300
&ZOPV(&ZOPN)          SETC  '1'                                         00331400
&ZOPD(&ZOPN)          SETC  ' '                                         00331500
.*                                                                      00331600
.ZLMFSL2              ANOP  ,                                           00331700
.*-------------------------------------------------------------------   00331800
.***AM.L00  IEECMDS FMT=LIST name                                       00331900
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00332000
&ZOPN                 SETA &ZOPN+1                                      00332100
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00332200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00332300
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00332400
&ZOPD(&ZOPN)          SETC '++ IEECMDS NAME'                            00332500
.ZLMFSL2M             ANOP  ,                                           00332600
.*-------------------------------------------------------------------   00332700
.***AM.L01  IEECMDS FMT=LIST PARAMETERS                                 00332800
&ZOPN                 SETA &ZOPN+1                                      00332900
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00333000
&ZOPO(&ZOPN)          SETC 'DS'                                         00333100
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00333200
&ZOPD(&ZOPN)          SETC '++ IEECMDS PARM LIST'                       00333300
.*-------------------------------------------------------------------   00333400
.***AM.L09  XCSPLACRN CL4                                               00333500
&ZOPN                 SETA &ZOPN+1                                      00333600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCSPLACRN'                        00333700
&ZOPO(&ZOPN)          SETC 'DS'                                         00333800
&ZOPV(&ZOPN)          SETC 'CL4'                                        00333900
&ZOPD(&ZOPN)          SETC '++ CONSTANT '                               00334000
.*-------------------------------------------------------------------   00334100
.***AM.L09  XPLISTLEN XL2                                               00334200
&ZOPN                 SETA &ZOPN+1                                      00334300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00334400
&ZOPO(&ZOPN)          SETC 'DS'                                         00334500
&ZOPV(&ZOPN)          SETC 'XL2'                                        00334600
&ZOPD(&ZOPN)          SETC '++ INPUT '                                  00334700
.*-------------------------------------------------------------------   00334800
.***AM.L02 XVERSION XL1                                                 00334900
&ZOPN                 SETA &ZOPN+1                                      00335000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00335100
&ZOPO(&ZOPN)          SETC 'DS'                                         00335200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00335300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00335400
.*-------------------------------------------------------------------   00335500
.***AM.L05 XREQUEST XL1                                                 00335600
&ZOPN                 SETA &ZOPN+1                                      00335700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         00335800
&ZOPO(&ZOPN)          SETC 'DS'                                         00335900
&ZOPV(&ZOPN)          SETC 'XL1'                                        00336000
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     00336100
.*                                                                      00336200
&ZOPN                 SETA  &ZOPN+1                                     00336300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._COUNT'                           00336400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00336500
&ZOPV(&ZOPN)          SETC  '1'                                         00336600
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00336700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).COUNT'                        00336800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00336900
.*                                                                      00337000
&ZOPN                 SETA  &ZOPN+1                                     00337100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._INFO'                            00337200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00337300
&ZOPV(&ZOPN)          SETC  '2'                                         00337400
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00337500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).INFO'                         00337600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00337700
.*                                                                      00337800
&ZOPN                 SETA  &ZOPN+1                                     00337900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._REMOVE'                          00338000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00338100
&ZOPV(&ZOPN)          SETC  '3'                                         00338200
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00338300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).REMOVE'                       00338400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00338500
.*                                                                      00338600
&ZOPN                 SETA  &ZOPN+1                                     00338700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._MARKNOABEND'                     00338800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00338900
&ZOPV(&ZOPN)          SETC  '4'                                         00339000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00339100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MARKNOABEND'                  00339200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00339300
.*                                                                      00339400
&ZOPN                 SETA  &ZOPN+1                                     00339500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._UNMARKNOABEND'                   00339600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00339700
&ZOPV(&ZOPN)          SETC  '5'                                         00339800
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00339900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UNMARKNOABEND'                00340000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00340100
.*                                                                      00340200
&ZOPN                 SETA  &ZOPN+1                                     00340300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._MARKCMDSABEND'                   00340400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00340500
&ZOPV(&ZOPN)          SETC  '6'                                         00340600
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00340700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MARKCMDSABEND'                00340800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00340900
.*-------------------------------------------------------------------   00341000
.***AM.L03 XFLAG1 BL.8                                                  00341100
&ZOPN                 SETA &ZOPN+1                                      00341200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAG1'                           00341300
&ZOPO(&ZOPN)          SETC 'DS'                                         00341400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00341500
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00341600
.*                                                                      00341700
&ZOPN                 SETA  &ZOPN+1                                     00341800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CLASS'                   00341900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00342000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00342100
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00342200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CLASS'                        00342300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00342400
.*                                                                      00342500
&ZOPN                 SETA  &ZOPN+1                                     00342600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CMD'                     00342700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00342800
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00342900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00343000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CMD'                          00343100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00343200
.*                                                                      00343300
&ZOPN                 SETA  &ZOPN+1                                     00343400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_ID'                      00343500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00343600
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00343700
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00343800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ID'                           00343900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00344000
.*                                                                      00344100
&ZOPN                 SETA  &ZOPN+1                                     00344200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_JOB'                     00344300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00344400
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00344500
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00344600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).JOB'                          00344700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00344800
.*-------------------------------------------------------------------   00344900
.***AM.L09  XRSV0001 CL3                                                00345000
&ZOPN                 SETA &ZOPN+1                                      00345100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00345200
&ZOPO(&ZOPN)          SETC 'DS'                                         00345300
&ZOPV(&ZOPN)          SETC 'CL3'                                        00345400
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00345500
.*-------------------------------------------------------------------   00345600
.***AM.L09  XCLASS CL4                                                  00345700
&ZOPN                 SETA &ZOPN+1                                      00345800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCLASS'                           00345900
&ZOPO(&ZOPN)          SETC 'DS'                                         00346000
&ZOPV(&ZOPN)          SETC 'CL4'                                        00346100
&ZOPD(&ZOPN)          SETC '++ &ZXCLASS '                               00346200
.*-------------------------------------------------------------------   00346300
.***AM.L09  XCMD CL8                                                    00346400
&ZOPN                 SETA &ZOPN+1                                      00346500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCMD'                             00346600
&ZOPO(&ZOPN)          SETC 'DS'                                         00346700
&ZOPV(&ZOPN)          SETC 'CL8'                                        00346800
&ZOPD(&ZOPN)          SETC '++ &ZXCMD '                                 00346900
.*-------------------------------------------------------------------   00347000
.***AM.L09  XID CL4                                                     00347100
&ZOPN                 SETA &ZOPN+1                                      00347200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XID'                              00347300
&ZOPO(&ZOPN)          SETC 'DS'                                         00347400
&ZOPV(&ZOPN)          SETC 'CL4'                                        00347500
&ZOPD(&ZOPN)          SETC '++ &ZXID '                                  00347600
.*-------------------------------------------------------------------   00347700
.***AM.L09  XJOB CL8                                                    00347800
&ZOPN                 SETA &ZOPN+1                                      00347900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XJOB'                             00348000
&ZOPO(&ZOPN)          SETC 'DS'                                         00348100
&ZOPV(&ZOPN)          SETC 'CL8'                                        00348200
&ZOPD(&ZOPN)          SETC '++ &ZXJOB '                                 00348300
.*-------------------------------------------------------------------   00348400
.***AM.L09 ADDR XBUFFER A                                               00348500
&ZOPN                 SETA &ZOPN+1                                      00348600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER_ADDR'                     00348700
&ZOPO(&ZOPN)          SETC 'DS'                                         00348800
&ZOPV(&ZOPN)          SETC 'A'                                          00348900
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER ADDR'                          00349000
.*-------------------------------------------------------------------   00349100
.***AM.L09 ALET XBUFFER F                                               00349200
&ZOPN                 SETA &ZOPN+1                                      00349300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER_ALET'                     00349400
&ZOPO(&ZOPN)          SETC 'DS'                                         00349500
&ZOPV(&ZOPN)          SETC 'F'                                          00349600
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER ALET'                          00349700
.*-------------------------------------------------------------------   00349800
.***AM.L09  XBUFSIZE F                                                  00349900
&ZOPN                 SETA &ZOPN+1                                      00350000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFSIZE'                         00350100
&ZOPO(&ZOPN)          SETC 'DS'                                         00350200
&ZOPV(&ZOPN)          SETC 'F'                                          00350300
&ZOPD(&ZOPN)          SETC '++ &ZXBUFSIZE '                             00350400
.*-------------------------------------------------------------------   00350500
.***AM.L09 ADDR XCOUNT A                                                00350600
&ZOPN                 SETA &ZOPN+1                                      00350700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCOUNT_ADDR'                      00350800
&ZOPO(&ZOPN)          SETC 'DS'                                         00350900
&ZOPV(&ZOPN)          SETC 'A'                                          00351000
&ZOPD(&ZOPN)          SETC '++ &ZXCOUNT ADDR'                           00351100
.*-------------------------------------------------------------------   00351200
.***AM.L10 END OF IEECMDS LIST PARAMETERS                               00351300
&ZOPN                 SETA &ZOPN+1                                      00351400
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00351500
&ZOPO(&ZOPN)          SETC 'EQU'                                        00351600
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00351700
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00351800
.*                                                                      00351900
&ZOPN                 SETA &ZOPN+1                                      00352000
&ZOPL(&ZOPN)          SETC ' '                                          00352100
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00352200
&ZOPV(&ZOPN)          SETC '1'                                          00352300
&ZOPD(&ZOPN)          SETC ' '                                          00352400
.*-------------------------------------------------------------------   00352500
.***AL.L12 IEECMDS FMT=LIST MF=S!L PARAMETERS                           00352600
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00352700
.*                                                                      00352800
&ZOPN                 SETA  &ZOPN+1                                     00352900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00353000
&ZOPO(&ZOPN)          SETC  'DC'                                        00353100
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00353200
&ZOPD(&ZOPN)          SETC  '++ IEECMDS ARG PARMS'                      00353300
.*                                                                      00353400
.ZLMFSLX              ANOP  ,                                           00353500
.*-------------------------------------------------------------------   00353600
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00353700
&ZPLLEN               SETA 52                                           00353800
.*                                                                      00353900
.******************************************************************     00354000
.***AI.L01 IEECMDS FMT=LIST FILL IN PARAMETER AREA                      00354100
.******************************************************************     00354200
                      ACTR  10000                                       00354300
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00354400
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00354500
&ZCVAL                SETC  'LAE'          XAX MODE                     00354600
.ZIMFXA               ANOP ,                                            00354700
.*                                                                      00354800
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00354900
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00355000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00355100
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00355200
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00355300
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00355400
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00355500
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00355600
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00355700
&ZOPN                 SETA  &ZOPN+1                                     00355800
&ZOPL(&ZOPN)          SETC  ' '                                         00355900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00356000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00356100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00356200
                      AGO   .ZIMFNX                                     00356300
.*                                                                      00356400
.ZIMFN2               ANOP ,                                            00356500
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00356600
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00356700
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00356800
&ZOPN                 SETA  &ZOPN+1                                     00356900
&ZOPL(&ZOPN)          SETC  ' '                                         00357000
&ZOPO(&ZOPN)          SETC  'LAE'                                       00357100
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00357200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00357300
                      AGO   .ZIMFNX                                     00357400
.ZIMFNX1              ANOP ,                                            00357500
&ZOPN                 SETA  &ZOPN+1                                     00357600
&ZOPL(&ZOPN)          SETC  ' '                                         00357700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00357800
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00357900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00358000
.ZIMFNX               ANOP ,                                            00358100
.********************************************************************   00358200
.***AI.L02 IEECMDS FMT=LIST INITIALIZE PARAMETER AREA                   00358300
.********************************************************************   00358400
.***AI.L03 MF=(SLME)                                                    00358500
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00358600
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00358700
.*                                                                      00358800
&ZOPN                 SETA  &ZOPN+1                                     00358900
&ZOPL(&ZOPN)          SETC  ' '                                         00359000
&ZOPO(&ZOPN)          SETC  'XC'                                        00359100
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00359200
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00359300
.ZIMFLX               ANOP  ,                                           00359400
.*-------------------------------------------------------------------   00359500
.***AI.L60 XCSPLACRN CL4                                                00359600
&ZOPN                 SETA  &ZOPN+1                                     00359700
&ZOPL(&ZOPN)          SETC  ' '                                         00359800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00359900
&ZOPV(&ZOPN)          SETC  '0(4,1),=CL4''CSPL'''                       00360000
&ZOPD(&ZOPN)          SETC  '++ CL4 CONSTANT'                           00360100
.*-------------------------------------------------------------------   00360200
.***AI.L04 XPLISTLEN XL2                                                00360300
&ZOPN                 SETA  &ZOPN+1                                     00360400
&ZOPL(&ZOPN)          SETC  ' '                                         00360500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00360600
&ZOPV(&ZOPN)          SETC  '4(2,1),=AL2(&ZPLLEN)'                      00360700
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00360800
.*-------------------------------------------------------------------   00360900
.***AI.L04B XVERSION XL1                                                00361000
                      AIF   (&XPLISTVER EQ 0).ZIMFVX                    00361100
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVY            00361200
.ZIMFVX               ANOP  ,                                           00361300
                      AIF   ('&PLISTVER' EQ '').ZIMFVZ                  00361400
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVZ            00361500
.ZIMFVY               ANOP  ,                                           00361600
&ZOPN                 SETA  &ZOPN+1                                     00361700
&ZOPL(&ZOPN)          SETC  ' '                                         00361800
&ZOPO(&ZOPN)          SETC  'MVI'                                       00361900
&ZOPV(&ZOPN)          SETC  '6(1),&XPLISTVER'                           00362000
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00362100
.ZIMFVZ               ANOP  ,                                           00362200
.*-------------------------------------------------------------------   00362300
.***AI.L07 XREQUEST AL1                                                 00362400
&ZW                   SETC  ''                                          00362500
.*-------------------------------------------------------------------   00362600
.***AI.L15 XREQUEST "COUNT" AL1                                         00362700
         AIF   ('&XREQUEST' NE 'COUNT').ZI5A                            00362800
&ZW                   SETC  '1'                                         00362900
.ZI5A                 ANOP  ,                                           00363000
.*-------------------------------------------------------------------   00363100
.***AI.L15 XREQUEST "INFO" AL1                                          00363200
         AIF   ('&XREQUEST' NE 'INFO').ZI6A                             00363300
&ZW                   SETC  '2'                                         00363400
.ZI6A                 ANOP  ,                                           00363500
.*-------------------------------------------------------------------   00363600
.***AI.L15 XREQUEST "REMOVE" AL1                                        00363700
         AIF   ('&XREQUEST' NE 'REMOVE').ZI7A                           00363800
&ZW                   SETC  '3'                                         00363900
.ZI7A                 ANOP  ,                                           00364000
.*-------------------------------------------------------------------   00364100
.***AI.L15 XREQUEST "MARKNOABEND" AL1                                   00364200
         AIF   ('&XREQUEST' NE 'MARKNOABEND').ZI8A                      00364300
&ZW                   SETC  '4'                                         00364400
.ZI8A                 ANOP  ,                                           00364500
.*-------------------------------------------------------------------   00364600
.***AI.L15 XREQUEST "UNMARKNOABEND" AL1                                 00364700
         AIF   ('&XREQUEST' NE 'UNMARKNOABEND').ZI9A                    00364800
&ZW                   SETC  '5'                                         00364900
.ZI9A                 ANOP  ,                                           00365000
.*-------------------------------------------------------------------   00365100
.***AI.L15 XREQUEST "MARKCMDSABEND" AL1                                 00365200
         AIF   ('&XREQUEST' NE 'MARKCMDSABEND').ZI10A                   00365300
&ZW                   SETC  '6'                                         00365400
.ZI10A                ANOP  ,                                           00365500
.*-------------------------------------------------------------------   00365600
.***AI.L17 XREQUEST AL1                                                 00365700
                      AIF   ('&ZW' NE '0').ZI10C                        00365800
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI10B             00365900
.ZI10C                ANOP  ,                                           00366000
                      AIF   ('&ZW' EQ '').ZI10B                         00366100
.*                                                                      00366200
&ZOPN                 SETA  &ZOPN+1                                     00366300
&ZOPL(&ZOPN)          SETC  ' '                                         00366400
&ZOPO(&ZOPN)          SETC  'MVI'                                       00366500
&ZOPV(&ZOPN)          SETC  '7(1),&ZW'                                  00366600
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST'                    00366700
.ZI10B                ANOP  ,                                           00366800
.*-------------------------------------------------------------------   00366900
.***AI.L05 XFLAG1 BL1                                                   00367000
&ZW                   SETC  ''                                          00367100
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00367200
&ZMS                  SETC  ''                                          00367300
&ZC                   SETC  ''                                          00367400
.*-------------------------------------------------------------------   00367500
.***AI.L08 XFLAG1 "CLASS"                                               00367600
.***      BL1'1XXXXXXX'                                                 00367700
         AIF   ('&CLASS' EQ '').ZI12A                                   00367800
         AIF   ('&CLASS' EQ 'ANY_CLASS').ZI12A                          00367900
         AIF   ('&CLASS' EQ 'ANY_CLASS').ZI12A                          00368000
&ZW                   SETC  '&ZW.1'                                     00368100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00368200
&ZMS                  SETC  '&ZMS.0'                                    00368300
                      AGO   .ZI12C                                      00368400
.*                                                                      00368500
.ZI12A                ANOP  ,                                           00368600
&ZW                   SETC  '&ZW.0'                                     00368700
&ZMS                  SETC  '&ZMS.1'                                    00368800
.ZI12C                ANOP  ,                                           00368900
.*-------------------------------------------------------------------   00369000
.***AI.L08 XFLAG1 "CMD"                                                 00369100
.***      BL1'X1XXXXXX'                                                 00369200
         AIF   ('&CMD' EQ '').ZI13A                                     00369300
         AIF   ('&CMD' EQ 'ANY_CMD').ZI13A                              00369400
&ZW                   SETC  '&ZW.1'                                     00369500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00369600
&ZMS                  SETC  '&ZMS.0'                                    00369700
                      AGO   .ZI13C                                      00369800
.*                                                                      00369900
.ZI13A                ANOP  ,                                           00370000
&ZW                   SETC  '&ZW.0'                                     00370100
&ZMS                  SETC  '&ZMS.1'                                    00370200
.ZI13C                ANOP  ,                                           00370300
.*-------------------------------------------------------------------   00370400
.***AI.L08 XFLAG1 "ID"                                                  00370500
.***      BL1'XX1XXXXX'                                                 00370600
         AIF   ('&ID' EQ '').ZI14A                                      00370700
         AIF   ('&ID' EQ 'ANY_ID').ZI14A                                00370800
&ZW                   SETC  '&ZW.1'                                     00370900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00371000
&ZMS                  SETC  '&ZMS.0'                                    00371100
                      AGO   .ZI14C                                      00371200
.*                                                                      00371300
.ZI14A                ANOP  ,                                           00371400
&ZW                   SETC  '&ZW.0'                                     00371500
&ZMS                  SETC  '&ZMS.1'                                    00371600
.ZI14C                ANOP  ,                                           00371700
.*-------------------------------------------------------------------   00371800
.***AI.L08 XFLAG1 "JOB"                                                 00371900
.***      BL1'XXX1XXXX'                                                 00372000
         AIF   ('&JOB' EQ '').ZI15A                                     00372100
         AIF   ('&JOB' EQ 'ANY_JOB').ZI15A                              00372200
         AIF   ('&JOB' EQ 'ANY_JOB').ZI15A                              00372300
&ZW                   SETC  '&ZW.10000'                                 00372400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00372500
&ZMS                  SETC  '&ZMS.01111'                                00372600
                      AGO   .ZI15C                                      00372700
.*                                                                      00372800
.ZI15A                ANOP  ,                                           00372900
&ZW                   SETC  '&ZW.00000'                                 00373000
&ZMS                  SETC  '&ZMS.11111'                                00373100
.ZI15C                ANOP  ,                                           00373200
.*-------------------------------------------------------------------   00373300
.***AI.L11 XFLAG1 BL1                                                   00373400
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI15D              00373500
                      AIF   ('&ZC' NE 'YES').ZI15D                      00373600
&ZOPN                 SETA  &ZOPN+1                                     00373700
&ZOPL(&ZOPN)          SETC  ' '                                         00373800
&ZOPO(&ZOPN)          SETC  'NI'                                        00373900
&ZOPV(&ZOPN)          SETC  '8(1),B''&ZMS'''                            00374000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00374100
.ZI15D                ANOP  ,                                           00374200
                      AIF   ('&ZCLNG' NE 'YES').ZI15E  ALL ZERO BITS    00374300
&ZOPN                 SETA  &ZOPN+1                                     00374400
&ZOPL(&ZOPN)          SETC  ' '                                         00374500
&ZOPO(&ZOPN)          SETC  'OI'                                        00374600
&ZOPV(&ZOPN)          SETC  '8(1),B''&ZW'''                             00374700
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00374800
.ZI15E                ANOP  ,                                           00374900
.*-------------------------------------------------------------------   00375000
.***AI.L18  XCLASS CL4                                                  00375100
         AIF   ('&XCLASS' NE 'ANY_CLASS').ZI17                          00375200
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI17  CK *        00375300
&ZXCLASS              SETC  ''             RESET INPUT/OUTPUT           00375400
.ZI17                 ANOP  ,                                           00375500
.*-------------------------------------------------------------------   00375600
.***AI.L25  XCLASS CL4                                                  00375700
                      AIF   ('&ZXCLASS' EQ '').ZI17E                    00375800
                      AIF   ('&ZXCLASS' EQ 'OUTPUT').ZI17E              00375900
&ZCGPR                SETC  '&XCLASS'                                   00376000
         AIF   ('&XCLASS' NE 'ANY_CLASS').ZI17A                         00376100
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI17E                          00376200
.*                                                                      00376300
&ZCGPR                SETC  '=XL4''00'''                                00376400
.ZI17A                ANOP  ,                                           00376500
.*                                                                      00376600
                      AIF   ('&XCLASS'(1,1) NE '(').ZI17B               00376700
&ZCGPR   SETC  '0('.'&XCLASS'(2,K'&XCLASS-2).')'                        00376800
.ZI17B                ANOP  ,                                           00376900
.*                                                                      00377000
&ZOPN                 SETA  &ZOPN+1                                     00377100
&ZOPL(&ZOPN)          SETC  ' '                                         00377200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00377300
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00377400
&ZOPD(&ZOPN)          SETC  '++ &ZXCLASS XCLASS'                        00377500
.*                                                                      00377600
.ZI17E                ANOP  ,                                           00377700
.*-------------------------------------------------------------------   00377800
.***AI.L18  XCMD CL8                                                    00377900
         AIF   ('&XCMD' NE 'ANY_CMD').ZI18                              00378000
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI18  CK *        00378100
&ZXCMD                SETC  ''             RESET INPUT/OUTPUT           00378200
.ZI18                 ANOP  ,                                           00378300
.*-------------------------------------------------------------------   00378400
.***AI.L25  XCMD CL8                                                    00378500
                      AIF   ('&ZXCMD' EQ '').ZI18E                      00378600
                      AIF   ('&ZXCMD' EQ 'OUTPUT').ZI18E                00378700
&ZCGPR                SETC  '&XCMD'                                     00378800
         AIF   ('&XCMD' NE 'ANY_CMD').ZI18A                             00378900
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI18E                          00379000
.*                                                                      00379100
&ZCGPR                SETC  '=XL8''00'''                                00379200
.ZI18A                ANOP  ,                                           00379300
.*                                                                      00379400
                      AIF   ('&XCMD'(1,1) NE '(').ZI18B                 00379500
&ZCGPR   SETC  '0('.'&XCMD'(2,K'&XCMD-2).')'                            00379600
.ZI18B                ANOP  ,                                           00379700
.*                                                                      00379800
&ZOPN                 SETA  &ZOPN+1                                     00379900
&ZOPL(&ZOPN)          SETC  ' '                                         00380000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00380100
&ZOPV(&ZOPN)          SETC  '16(8,1),&ZCGPR'                            00380200
&ZOPD(&ZOPN)          SETC  '++ &ZXCMD XCMD'                            00380300
.*                                                                      00380400
.ZI18E                ANOP  ,                                           00380500
.*-------------------------------------------------------------------   00380600
.***AI.L18  XID CL4                                                     00380700
         AIF   ('&XID' NE 'ANY_ID').ZI19                                00380800
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI19  CK *        00380900
&ZXID                 SETC  ''             RESET INPUT/OUTPUT           00381000
.ZI19                 ANOP  ,                                           00381100
.*-------------------------------------------------------------------   00381200
.***AI.L25  XID CL4                                                     00381300
                      AIF   ('&ZXID' EQ '').ZI19E                       00381400
                      AIF   ('&ZXID' EQ 'OUTPUT').ZI19E                 00381500
&ZCGPR                SETC  '&XID'                                      00381600
         AIF   ('&XID' NE 'ANY_ID').ZI19A                               00381700
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI19E                          00381800
.*                                                                      00381900
&ZCGPR                SETC  '=XL4''00'''                                00382000
.ZI19A                ANOP  ,                                           00382100
.*                                                                      00382200
                      AIF   ('&XID'(1,1) NE '(').ZI19B                  00382300
&ZCGPR   SETC  '0('.'&XID'(2,K'&XID-2).')'                              00382400
.ZI19B                ANOP  ,                                           00382500
.*                                                                      00382600
&ZOPN                 SETA  &ZOPN+1                                     00382700
&ZOPL(&ZOPN)          SETC  ' '                                         00382800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00382900
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            00383000
&ZOPD(&ZOPN)          SETC  '++ &ZXID XID'                              00383100
.*                                                                      00383200
.ZI19E                ANOP  ,                                           00383300
.*-------------------------------------------------------------------   00383400
.***AI.L18  XJOB CL8                                                    00383500
         AIF   ('&XJOB' NE 'ANY_JOB').ZI20                              00383600
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI20  CK *        00383700
&ZXJOB                SETC  ''             RESET INPUT/OUTPUT           00383800
.ZI20                 ANOP  ,                                           00383900
.*-------------------------------------------------------------------   00384000
.***AI.L25  XJOB CL8                                                    00384100
                      AIF   ('&ZXJOB' EQ '').ZI20E                      00384200
                      AIF   ('&ZXJOB' EQ 'OUTPUT').ZI20E                00384300
&ZCGPR                SETC  '&XJOB'                                     00384400
         AIF   ('&XJOB' NE 'ANY_JOB').ZI20A                             00384500
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI20E                          00384600
.*                                                                      00384700
&ZCGPR                SETC  '=XL8''00'''                                00384800
.ZI20A                ANOP  ,                                           00384900
.*                                                                      00385000
                      AIF   ('&XJOB'(1,1) NE '(').ZI20B                 00385100
&ZCGPR   SETC  '0('.'&XJOB'(2,K'&XJOB-2).')'                            00385200
.ZI20B                ANOP  ,                                           00385300
.*                                                                      00385400
&ZOPN                 SETA  &ZOPN+1                                     00385500
&ZOPL(&ZOPN)          SETC  ' '                                         00385600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00385700
&ZOPV(&ZOPN)          SETC  '28(8,1),&ZCGPR'                            00385800
&ZOPD(&ZOPN)          SETC  '++ &ZXJOB XJOB'                            00385900
.*                                                                      00386000
.ZI20E                ANOP  ,                                           00386100
.*-------------------------------------------------------------------   00386200
.***AI.L19 ADDR XBUFFER A                                               00386300
                      AIF   ('&ZXBUFFER' EQ '').ZI21H                   00386400
&ZCLNG                SETC  '&XBUFFER'                                  00386500
&ZCGPR                SETC  '14'                                        00386600
         AIF   ('&XBUFFER'(1,1) EQ '(').ZI21F  IN GPR                   00386700
.*                                                                      00386800
&ZOPN                 SETA  &ZOPN+1                                     00386900
&ZOPL(&ZOPN)          SETC  ' '                                         00387000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00387100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00387200
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00387300
.*                                                                      00387400
                      AGO   .ZI21G                                      00387500
.*                                                                      00387600
.ZI21F                ANOP  ,                                           00387700
&ZCGPR   SETC  '&XBUFFER'(2,K'&XBUFFER-2)                               00387800
.*                                                                      00387900
.ZI21G                ANOP  ,                                           00388000
.*                                                                      00388100
&ZOPN                 SETA  &ZOPN+1                                     00388200
&ZOPL(&ZOPN)          SETC  ' '                                         00388300
&ZOPO(&ZOPN)          SETC  'ST'                                        00388400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,36(,1)'                             00388500
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00388600
.*                                                                      00388700
.ZI21H                ANOP  ,                                           00388800
.*-------------------------------------------------------------------   00388900
.***AI.L23 ALET XBUFFER F                                               00389000
         AIF   ('&ZXBUFFER' EQ '').ZI22G                                00389100
         AIF   ('&SYSASCE' EQ 'P').ZI22G   SYSSTATE PRIMARY             00389200
&ZCLNG                SETC  '&XBUFFER'                                  00389300
         AIF   ('&XBUFFER'(1,1) EQ '(').ZI22E  IN AR                    00389400
.*                                                                      00389500
&ZCGPR                SETC  '14'                                        00389600
                      AGO   .ZI22F                                      00389700
.*                                                                      00389800
.ZI22E                ANOP  ,                                           00389900
&ZCGPR   SETC  '&XBUFFER'(2,K'&XBUFFER-2)                               00390000
.*                                                                      00390100
.ZI22F                ANOP  ,                                           00390200
.*                                                                      00390300
&ZOPN                 SETA  &ZOPN+1                                     00390400
&ZOPL(&ZOPN)          SETC  ' '                                         00390500
&ZOPO(&ZOPN)          SETC  'STAM'                                      00390600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,40(1)'                       00390700
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00390800
.*                                                                      00390900
.ZI22G                ANOP  ,                                           00391000
.*-------------------------------------------------------------------   00391100
.***AI.L25  XBUFSIZE F                                                  00391200
                      AIF   ('&ZXBUFSIZE' EQ '').ZI23E                  00391300
                      AIF   ('&ZXBUFSIZE' EQ 'OUTPUT').ZI23E            00391400
&ZCGPR                SETC  '&XBUFSIZE'                                 00391500
.*                                                                      00391600
                      AIF   ('&XBUFSIZE'(1,1) NE '(').ZI23B             00391700
&ZCGPR   SETC  '0('.'&XBUFSIZE'(2,K'&XBUFSIZE-2).')'                    00391800
                      AGO   .ZI23D                                      00391900
.ZI23B                ANOP  ,                                           00392000
.*                                                                      00392100
&ZC                   SETC  '&XBUFSIZE'(1,1)                            00392200
                      AIF   (T'&ZC NE 'N').ZI23D                        00392300
&ZC                   SETC  '&XBUFSIZE'                                 00392400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI23D               00392500
&ZCGPR                SETC  '=FL4''&XBUFSIZE'''                         00392600
.*                                                                      00392700
.ZI23D                ANOP  ,                                           00392800
.*                                                                      00392900
&ZOPN                 SETA  &ZOPN+1                                     00393000
&ZOPL(&ZOPN)          SETC  ' '                                         00393100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00393200
&ZOPV(&ZOPN)          SETC  '44(4,1),&ZCGPR'                            00393300
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFSIZE XBUFSIZE'                    00393400
.*                                                                      00393500
.ZI23E                ANOP  ,                                           00393600
.*-------------------------------------------------------------------   00393700
.***AI.L19 ADDR XCOUNT A                                                00393800
                      AIF   ('&ZXCOUNT' EQ '').ZI24H                    00393900
&ZCLNG                SETC  '&XCOUNT'                                   00394000
&ZCGPR                SETC  '14'                                        00394100
         AIF   ('&XCOUNT'(1,1) EQ '(').ZI24F  IN GPR                    00394200
.*                                                                      00394300
&ZOPN                 SETA  &ZOPN+1                                     00394400
&ZOPL(&ZOPN)          SETC  ' '                                         00394500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00394600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00394700
&ZOPD(&ZOPN)          SETC  '++ &ZXCOUNT XCOUNT'                        00394800
.*                                                                      00394900
                      AGO   .ZI24G                                      00395000
.*                                                                      00395100
.ZI24F                ANOP  ,                                           00395200
&ZCGPR   SETC  '&XCOUNT'(2,K'&XCOUNT-2)                                 00395300
.*                                                                      00395400
.ZI24G                ANOP  ,                                           00395500
.*                                                                      00395600
&ZOPN                 SETA  &ZOPN+1                                     00395700
&ZOPL(&ZOPN)          SETC  ' '                                         00395800
&ZOPO(&ZOPN)          SETC  'ST'                                        00395900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,48(,1)'                             00396000
&ZOPD(&ZOPN)          SETC  '++ &ZXCOUNT XCOUNT'                        00396100
.*                                                                      00396200
.ZI24H                ANOP  ,                                           00396300
.*-------------------------------------------------------------------   00396400
&ZOPN1                SETA &ZOPN                                        00396500
.*-------------------------------------------------------------------   00396600
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00396700
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00396800
.*******************************************************************    00396900
.***  PROCESS IEECMDS OUTPUT PARAMETERS                                 00397000
.*******************************************************************    00397100
                      ACTR  10000                                       00397200
.*******************************************************************    00397300
.***AO.X02  RETURN CODE PROCESSING                                      00397400
.*******************************************************************    00397500
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00397600
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00397700
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00397800
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00397900
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00398000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00398100
&ZOPN                 SETA  &ZOPN+1                                     00398200
&ZOPL(&ZOPN)          SETC  ' '                                         00398300
&ZOPO(&ZOPN)          SETC  'ST'                                        00398400
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00398500
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00398600
                      AGO   .ZMRETX                                     00398700
.*                                                                      00398800
.ZMRET2               ANOP  ,                                           00398900
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00399000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00399100
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00399200
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00399300
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00399400
&ZOPN                 SETA  &ZOPN+1                                     00399500
&ZOPL(&ZOPN)          SETC  ' '                                         00399600
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00399700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00399800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00399900
.ZMRETX               ANOP  ,                                           00400000
.*******************************************************************    00400100
.***AO.X03  REASON CODE PROCESSING                                      00400200
.*******************************************************************    00400300
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00400400
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00400500
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00400600
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00400700
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00400800
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00400900
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00401000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00401100
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00401200
&ZOPN                 SETA  &ZOPN+1                                     00401300
&ZOPL(&ZOPN)          SETC  ' '                                         00401400
&ZOPO(&ZOPN)          SETC  'ST'                                        00401500
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00401600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00401700
                      AGO   .ZMRSNX                                     00401800
.*                                                                      00401900
.ZMRSN2               ANOP  ,                                           00402000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00402100
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00402200
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00402300
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00402400
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00402500
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00402600
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00402700
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00402800
&ZOPN                 SETA  &ZOPN+1                                     00402900
&ZOPL(&ZOPN)          SETC  ' '                                         00403000
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00403100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00403200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00403300
.ZMRSNX               ANOP  ,                                           00403400
.*******************************************************************    00403500
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00403600
.*******************************************************************    00403700
.ZMFLX                ANOP  ,              MF=L PROCESSING              00403800
.*******************************************************************    00403900
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00404000
.*******************************************************************    00404100
                      ACTR  10000                                       00404200
.*                                                                      00404300
                      LCLA  &ZLC           COLUMN POSITION              00404400
                      LCLA  &ZOPX          LIST TABLE INDEX             00404500
                      LCLC  &ZLL           LABEL                        00404600
                      LCLC  &ZLOP          OPERATION                    00404700
                      LCLC  &ZLV           VALUE                        00404800
                      LCLC  &ZLD           DESCRIPTION                  00404900
.*                                                                      00405000
&ZOPX                 SETA  1                                           00405100
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00405200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00405300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00405400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00405500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00405600
                      AIF   (K'&ZLD LE 0).ZL5                           00405700
&ZLC                  SETA  35             COMMENT COLUMN               00405800
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00405900
&ZLC                  SETA  33             COMMMENT COLUMN              00406000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00406100
&ZLV                  SETC  '&ZLV'.' '                                  00406200
                      AGO   .ZL3                                        00406300
.*                                                                      00406400
.ZL4                  ANOP  ,                                           00406500
&ZLV                  SETC  '&ZLV'.' '                                  00406600
.ZL5                  ANOP  ,                                           00406700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00406800
.*                                                                      00406900
&ZLL     &ZLOP &ZLV                                                     00407000
.*                                                                      00407100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00407200
                      AGO   .ZL2           CONTINUE LOOPING             00407300
.*                                                                      00407400
.ZLX                  ANOP  ,                                           00407500
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00407600
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00407700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00407800
         AIF   ('&IBMINT' NE 'YES').NOIBMINT                       @L1A 00407900
&ZMS     SETC  'IBMINT=YES MUST NOT BE SPECIFIED'                  @L1A 00408000
         MNOTE 8,'&ZMS'                                            @L1A 00408100
         POP   PRINT                                               @L1A 00408200
         MEXIT                                                     @L1A 00408300
.NOIBMINT ANOP                                                     @L1A 00408400
.*-----------BAL invocation code-------------                           00408500
.********************************************************************** 00408600
.*                                                                    * 00408700
.*  Invoke PC for IEECMDS Interface Routine                           * 00408800
.*                                                                    * 00408900
.********************************************************************** 00409000
         L     15,16(0,0)         GET ADDRESS OF CVT FROM PSA           00409100
         L     15,772(15)         GET ADDRESS OF SFT FROM CVT      @P2C 00409200
         LA    14,21(0,0)         GET IEECMDS INDEX IN LINKAGE TABLE    00409300
         AL    14,100(15)         POINT REG14 TO IEECMDS ETD ENTRY @P2C 00409400
         PC    0(14)              PC TO IEECMDS SERVICE                 00409500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00409600
.ZLINKX               ANOP  ,                                           00409700
.*******************************************************************    00409800
.***AP.X01  FORMAT GENERATED CODE                                       00409900
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00410000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00410100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00410200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00410300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00410400
                      AIF   (K'&ZLD LE 0).ZL51                          00410500
&ZLC                  SETA  35             COMMENT COLUMN               00410600
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00410700
&ZLC                  SETA  33             COMMENT COLUMN               00410800
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00410900
&ZLV                  SETC  '&ZLV'.' '                                  00411000
                      AGO   .ZL31                                       00411100
.*                                                                      00411200
.ZL41                 ANOP  ,                                           00411300
&ZLV                  SETC  '&ZLV'.' '                                  00411400
.ZL51                 ANOP  ,                                           00411500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00411600
.*                                                                      00411700
&ZLL     &ZLOP &ZLV                                                     00411800
.*                                                                      00411900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00412000
                      AGO   .ZL21          CONTINUE LOOPING             00412100
.*                                                                      00412200
.ZLX1                 ANOP  ,                                           00412300
.*******************************************************************    00412400
.***AP.X02  END OF IEECMDS MACRO                                        00412500
&ZIEECMDS             SETC  'YES'          SET IEECMDS USED             00412600
         POP   PRINT                                                    00412700
*                                            IEECMDS-1                  00412800
         SPACE 1                                                        00412900
.ZLX2                 ANOP  ,                                           00413000
         MEND                                                           00413100
**********************************************************************/ 00413200
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00413300
*%IEECMDS: MACRO KEYS(IBMINT,REQUEST,BUFFER,BUFSIZE,CLASS,CMD,ID,JOB,   00413400
*                 COUNT,RETCODE,RSNCODE,PLISTVER,MF);                   00413500
*  ANS('?'!!MACLABEL!!' '!!'IEECMDSP '!!MACLIST!!                       00413600
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00413700
*%END IEECMDS;                                                          00413800

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IOSCDR                                -06/30/09-<2> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  I/O Configuration Data Record Interface       * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 1993, 2010                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7770                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*      IOSCDR provides a service which authorized callers can use to  * 00002000
*      retrieve Configuration Data Records (CDRs), Node Descriptors   * 00002100
*      (NDs), and WorldWide Port Names (WWPNs).  The caller can       * 00002200
*      retrieve the last CDR and ND known to MVS or can have this     * 00002300
*      service read the CDR and ND directly from the device for a     * 00002400
*      specified device and a specified CHPID.  The last CDR and ND   * 00002500
*      known to MVS may not be current and therefore may not match    * 00002600
*      those that the device would provide currently.  In addition    * 00002700
*      the last CDR known to MVS may not contain certain records      * 00002800
*      present in the CDR read directly from the device.  For         * 00002900
*      example, level NEDs will have been filtered and blank records  * 00003000
*      removed.  The caller can only retrieve the last WWPN known to  * 00003100
*      MVS.  This service cannot read a WWPN.                         * 00003200
*                                                                     * 00003300
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00003400
*                                                                     * 00003500
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003600
*                                                                     * 00003700
*01* ENVIRONMENT:                                                     * 00003800
*                                                                     * 00003900
*                                                                     * 00004000
*      Dispatchable unit mode: Task mode.                             * 00004100
*                                                                     * 00004200
*      Minimum authorization:                                         * 00004300
*                                                                     * 00004400
*                                                                     * 00004500
*                        LINKAGE=LINK                                 * 00004600
*                            Supervisor state, any PSW key            * 00004700
*                                                                     * 00004800
*                        LINKAGE=SYSTEM                               * 00004900
*                            One of the following:                    * 00005000
*                                                                     * 00005100
*                                                                     * 00005200
*                            o   Supervisor state                     * 00005300
*                                                                     * 00005400
*                            o   PKM 0-7                              * 00005500
*                                                                     * 00005600
*                            o   APF authorized                       * 00005700
*                                                                     * 00005800
*                            o   RACF authorized to class FACILITY    * 00005900
*                                and entity IOSCDR                    * 00006000
*                                                                     * 00006100
*                                                                     * 00006200
*                                                                     * 00006300
*                                                                     * 00006400
*                                                                     * 00006500
*      AMODE:                                                         * 00006600
*                                                                     * 00006700
*                                                                     * 00006800
*                        LINKAGE=LINK                                 * 00006900
*                            AMODE 31                                 * 00007000
*                                                                     * 00007100
*                        LINKAGE=SYSTEM                               * 00007200
*                            AMODE 24 or AMODE 31                     * 00007300
*                                                                     * 00007400
*                                                                     * 00007500
*                                                                     * 00007600
*      ASC mode:         Primary.                                     * 00007700
*                                                                     * 00007800
*      Serialization:    Enabled.  Unlocked                           * 00007900
*                                                                     * 00008000
*                                                                     * 00008100
*                                                                     * 00008200
*01* INPUT REGISTERS:  GR0-GR15    Undefined                          * 00008300
*                                                                     * 00008400
*01* OUTPUT REGISTERS: GR0         Reason code                        * 00008500
*                      GR1         Used by service                    * 00008600
*                      GR2-GR13    Unchanged                          * 00008700
*                      GR14        Used by service                    * 00008800
*                      GR15        Return code                        * 00008900
*                                                                     * 00009000
*01* SYNTAX:                                                          * 00009100
*                                                                     * 00009200
*Ýxlabel¨  IOSCDR     DEVN=xdevn                                      * 00009300
*                   Ý,SCHSET=»xschset!0º¨                             * 00009400
*                    ,CHPID=xchpid                                    * 00009500
*                    ,CDRAREA=xcdrarea                                * 00009600
*                    ,CDRLEN=xcdrlen                                  * 00009700
*                   Ý,CDRSIZE=xcdrsize¨                               * 00009800
*                    ,READ=»NOIO!IO!CONDº                             * 00009900
*                   Ý,STATUS=»xstatus!NONEº¨                          * 00010000
*                   Ý,TIME=»xtime!5º¨                                 * 00010100
*                   Ý,IOCTOKEN=»xioctoken!NONEº¨                      * 00010200
*                   Ý,NODE_DESCRIPTOR=»xnode_descriptor!0º¨           * 00010300
*                   Ý,WWPN=xwwpn¨                                     * 00010400
*                   Ý,LINKAGE=»LINK!SYSTEMº¨                          * 00010500
*                   Ý,RETCODE=xretcode¨                               * 00010600
*                   Ý,RSNCODE=xrsncode¨                               * 00010700
*                   Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨           * 00010800
*                  ÐÝ,MF=S¨                                           * 00010900
*                  ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                    * 00011000
*                  ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                      * 00011100
*                                                                     * 00011200
*                                                                     * 00011300
*      Where:                                                         * 00011400
*                                                                     * 00011500
*                                                                     * 00011600
*      Ýxlabel¨                                                       * 00011700
*          is an optional symbol, starting in column 1, that is the   * 00011800
*          name on the IOSCDR macro invocation.  The name must        * 00011900
*          conform to the rules for an ordinary assembler language    * 00012000
*          symbol.                                                    * 00012100
*          DEFAULT: No name.                                          * 00012200
*                                                                     * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*                                                                     * 00012600
*      DEVN=xdevn                                                     * 00012700
*          is the name (RS-type), or address in register (2)-(12), of * 00012800
*          a required halfword input which specifies the device       * 00012900
*          number in binary of the device for which a CDR is to be    * 00013000
*          retrieved.  The device will be pinned and unpinned by this * 00013100
*          service when this keyword is specified.                    * 00013200
*                                                                     * 00013300
*                                                                     * 00013400
*                                                                     * 00013500
*                                                                     * 00013600
*      ÝSCHSET=»xschset!0º¨                                           * 00013700
*          is the name (RS-type), or address in register (2)-(12), of * 00013800
*          an optional byte input which specifies the subchannel set  * 00013900
*          of the device.                                             * 00014000
*          DEFAULT: 0.                                                * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*      CHPID=xchpid                                                   * 00014600
*          is the name (RS-type), or address in register (2)-(12), of * 00014700
*          a required byte input that contains the channel path ID    * 00014800
*          for which the CDR is to be retrieved.                      * 00014900
*                                                                     * 00015000
*                                                                     * 00015100
*                                                                     * 00015200
*                                                                     * 00015300
*      CDRAREA=xcdrarea                                               * 00015400
*          is a required input.  It is the name (RS-type), or address * 00015500
*          in register (2)-(12), of the work area which is to receive * 00015600
*          a copy of the CDR for the requested device-path.  The      * 00015700
*          caller must specify the CDRLEN keyword to indicate the     * 00015800
*          length of the CDRAREA.                                     * 00015900
*                                                                     * 00016000
*                                                                     * 00016100
*                                                                     * 00016200
*                                                                     * 00016300
*      CDRLEN=xcdrlen                                                 * 00016400
*          is the name (RS-type), or address in register (2)-(12), of * 00016500
*          a required fullword input variable which specifies the     * 00016600
*          length of the CDRAREA.  Value specified must be no larger  * 00016700
*          than 65535 bytes.                                          * 00016800
*                                                                     * 00016900
*                                                                     * 00017000
*                                                                     * 00017100
*                                                                     * 00017200
*      ÝCDRSIZE=xcdrsize¨                                             * 00017300
*          is the name (RS-type), or address in register (2)-(12), of * 00017400
*          an optional fullword output variable which specifies the   * 00017500
*          actual size of the CDR for the specified device and path.  * 00017600
*          No more than the number of bytes specified on the CDRLEN   * 00017700
*          keyword will be copied into CDRAREA.                       * 00017800
*                                                                     * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*      READ=»NOIO!IO!CONDº                                            * 00018300
*          is a required keyword input indicating the desired source  * 00018400
*          for the CDR and ND.  (Only the last WWPN known to MVS can  * 00018500
*          be returned.)                                              * 00018600
*                                                                     * 00018700
*                                                                     * 00018800
*          READ=NOIO                                                  * 00018900
*              Indicates that the last CDR and ND known to MVS will   * 00019000
*              be returned to the caller for the specified device and * 00019100
*              path.  This CDR or ND may not be current.  Note that   * 00019200
*              MVS may not have a last known CDR or ND.  No I/O       * 00019300
*              operations are performed when this option is           * 00019400
*              specified.                                             * 00019500
*                                                                     * 00019600
*          READ=IO                                                    * 00019700
*              Indicates that the CDR and ND will be read directly    * 00019800
*              from the device and returned to the caller for the     * 00019900
*              specified device and path.  Use of this option will    * 00020000
*              NOT cause the last CDR or ND known to MVS for a        * 00020100
*              particular device and path to be updated.  When this   * 00020200
*              option is specified, I/O operations will be performed  * 00020300
*              to the device.                                         * 00020400
*                                                                     * 00020500
*          READ=COND                                                  * 00020600
*              Indicates that if the device and path are online, the  * 00020700
*              last CDR and ND known to MVS will be returned to the   * 00020800
*              caller for the specified device and path.  Otherwise,  * 00020900
*              the CDR and ND will be obtained directly from the      * 00021000
*              device as in the IO option.                            * 00021100
*                                                                     * 00021200
*                                                                     * 00021300
*                                                                     * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*                                                                     * 00021700
*      ÝSTATUS=»xstatus!NONEº¨                                        * 00021800
*          is the name (RS-type), or address in register (2)-(12), of * 00021900
*          an optional 8 bit input/output that contains status        * 00022000
*          information for successful invocations of this service.  A * 00022100
*          description of the bit positions are as follows:           * 00022200
*                                                                     * 00022300
*                                                                     * 00022400
*          X'80'     Source of CDR.                                   * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*                    OFF       CDR returned was the last CDR known to * 00022800
*                              MVS.                                   * 00022900
*                                                                     * 00023000
*                    ON        CDR returned was read from the device. * 00023100
*                                                                     * 00023200
*                                                                     * 00023300
*                                                                     * 00023400
*          X'40'     Path status                                      * 00023500
*                                                                     * 00023600
*                                                                     * 00023700
*                    OFF       Specified CHPID was logically offline  * 00023800
*                              to device.                             * 00023900
*                                                                     * 00024000
*                    ON        Specified CHPID was logically online   * 00024100
*                              to device.                             * 00024200
*                                                                     * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*          X'20'     Device status                                    * 00024600
*                                                                     * 00024700
*                                                                     * 00024800
*                    OFF       Specified device was offline.          * 00024900
*                                                                     * 00025000
*                    ON        Specified device was online.           * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*                                                                     * 00025400
*                                                                     * 00025500
*          DEFAULT: NONE                                              * 00025600
*                                                                     * 00025700
*                                                                     * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*      ÝTIME=»xtime!5º¨                                               * 00026100
*          is the name (RS-type), or address in register (2)-(12), of * 00026200
*          an optional 8 character input that contains an upper bound * 00026300
*          on the allowable length of I/O operations performed by     * 00026400
*          this service.  The time interval should be specified as on * 00026500
*          the DINTVL keyword of the STIMER macro.  Any I/O operation * 00026600
*          exceeding this time will be purged.  The actual time for   * 00026700
*          I/O operations performed by this service will be the       * 00026800
*          smaller of the following:                                  * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*          o   Actual time for I/O to complete when no time limit is  * 00027200
*              exceeded.  The I/O operation did not time-out and      * 00027300
*              completes either successfully or unsuccessfully.       * 00027400
*                                                                     * 00027500
*          o   I/O is cancelled due to Missing Interupt Handler (MIH) * 00027600
*              interval or I/O Timing interval expiration.  I/O is    * 00027700
*              not successful.  The length of the I/O operation       * 00027800
*              exceeded the time interval monitored by MIH or I/O     * 00027900
*              Timing and was purged.  The interval specified on the  * 00028000
*              TIME keyword must therefore have been greater than the * 00028100
*              MIH interval.                                          * 00028200
*                                                                     * 00028300
*          o   I/O is cancelled due to expiration of time interval    * 00028400
*              specified on this parameter.  I/O is not successful.   * 00028500
*              The length of the I/O operation exceeded the time      * 00028600
*              interval on the TIME keyword and was purged.           * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*          This keyword is used for the READ IO option or the READ    * 00029100
*          COND option when I/O is performed to the device.           * 00029200
*          DEFAULT: 5 seconds.                                        * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*                                                                     * 00029600
*                                                                     * 00029700
*      ÝIOCTOKEN=»xioctoken!NONEº¨                                    * 00029800
*          is the name (RS-type), or address in register (2)-(12), of * 00029900
*          an optional 48 character input/output which specifies the  * 00030000
*          I/O configuration token. If the UCB definition represented * 00030100
*          by this token is inconsistent with the current UCB         * 00030200
*          definition, IOSCDR will notify the caller via a return     * 00030300
*          code.                                                      * 00030400
*                                                                     * 00030500
*          If the input IOCTOKEN is set to binary zeroes, then this   * 00030600
*          service will set IOCTOKEN to the current I/O configuration * 00030700
*          token at the start of the IOSCDR processing.               * 00030800
*          DEFAULT: NONE                                              * 00030900
*                                                                     * 00031000
*                                                                     * 00031100
*                                                                     * 00031200
*                                                                     * 00031300
*      ÝNODE_DESCRIPTOR=»xnode_descriptor!0º¨                         * 00031400
*          is an optional input.  It is the name (RS-type), or        * 00031500
*          address in register (2)-(12), of the 32 bytes of storage   * 00031600
*          for one node descriptor to be returned by the service. The * 00031700
*          node descriptor is associated with the control unit that   * 00031800
*          is attached to the specified path in the input mask.       * 00031900
*          DEFAULT: 0                                                 * 00032000
*                                                                     * 00032100
*                                                                     * 00032200
*                                                                     * 00032300
*                                                                     * 00032400
*      ÝWWPN=xwwpn¨                                                   * 00032500
*          is the name (RS-type), or address in register (2)-(12), of * 00032600
*          an optional 64 bit output for the Worldwide Port Name      * 00032700
*          (WWPN) for the port on the control unit for the specified  * 00032800
*          channel path.  If the WWPN is not available, zeroes will   * 00032900
*          be returned.                                               * 00033000
*                                                                     * 00033100
*                                                                     * 00033200
*                                                                     * 00033300
*                                                                     * 00033400
*      ÝLINKAGE=»LINK!SYSTEMº¨                                        * 00033500
*          is an optional keyword input that indicates whether a link * 00033600
*          macro should be generated or a Program Call should be      * 00033700
*          issued for the routine invocation.  See the environment    * 00033800
*          section for the environments allowed for each choice.      * 00033900
*          DEFAULT: LINK                                              * 00034000
*                                                                     * 00034100
*                                                                     * 00034200
*          LINKAGE=LINK                                               * 00034300
*              requests that a LINK be issued to invoke the service   * 00034400
*              routine.                                               * 00034500
*                                                                     * 00034600
*          LINKAGE=SYSTEM                                             * 00034700
*              requests a PC instruction be issued to invoke the      * 00034800
*              service routine.                                       * 00034900
*                                                                     * 00035000
*                                                                     * 00035100
*                                                                     * 00035200
*                                                                     * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*      ÝRETCODE=xretcode¨                                             * 00035600
*          is the name (RS-type) of an optional fullword output       * 00035700
*          variable, or register (2)-(12) or (15), into which the     * 00035800
*          return code is to be copied from GPR 15.  If you specify   * 00035900
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00036000
*          the value will be left in GPR 15.                          * 00036100
*                                                                     * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*      ÝRSNCODE=xrsncode¨                                             * 00036600
*          is the name (RS-type) of an optional fullword output       * 00036700
*          variable into which the reason code is to be copied from   * 00036800
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00036900
*          R0 (within or without parentheses), the value will be left * 00037000
*          in GPR 0.                                                  * 00037100
*                                                                     * 00037200
*                                                                     * 00037300
*                                                                     * 00037400
*                                                                     * 00037500
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00037600
*          is an optional byte input decimal value in the "1-2" range * 00037700
*          that specifies the macro version.  PLISTVER is the only    * 00037800
*          key allowed on the list form of MF and determines which    * 00037900
*          parameter list is generated.  The macro keys associated    * 00038000
*          with each supported version of the macro are listed in     * 00038100
*          MACRO USAGE NOTE 2.  Note that MAX may be specified        * 00038200
*          instead of a number, and the parameter list will be of the * 00038300
*          largest size currently supported. This size may grow from  * 00038400
*          release to release (thus possibly affecting the amount of  * 00038500
*          storage needed by your program).  If your program can      * 00038600
*          tolerate this, IBM recommends that you always specify MAX  * 00038700
*          when creating the list form parameter list as that will    * 00038800
*          ensure that the list form parameter list is always long    * 00038900
*          enough to hold whatever parameters might be specified on   * 00039000
*          the execute form.                                          * 00039100
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00039200
*          default is the lowest version which allows all of the      * 00039300
*          parameters specified on the invocation to be processed.    * 00039400
*                                                                     * 00039500
*                                                                     * 00039600
*                                                                     * 00039700
*                                                                     * 00039800
*      ÝMF=»S!L!Eº¨                                                   * 00039900
*          is an optional keyword input which specifies the macro     * 00040000
*          form.                                                      * 00040100
*          DEFAULT: S                                                 * 00040200
*                                                                     * 00040300
*                                                                     * 00040400
*          ÝMF=S¨                                                     * 00040500
*              specifies the standard form of the macro.  The "S"     * 00040600
*              form generates code to put the parameters into an      * 00040700
*              in-line parameter list and invoke the desired service. * 00040800
*              Full checking for required macro keys is done along    * 00040900
*              with supplying defaults for omitted optional           * 00041000
*              parameters.                                            * 00041100
*                                                                     * 00041200
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00041300
*              specifies the list form of the macro.  The "L" form    * 00041400
*              defines an area to be used for the parameter list.     * 00041500
*              Only the PLISTVER key may be specified on the          * 00041600
*              invocation.  All other macro parameters are flagged as * 00041700
*              errors.  If PLISTVER is not specified, the original    * 00041800
*              parameter list definition is used.                     * 00041900
*                                                                     * 00042000
*            ,xmfctrl                                                 * 00042100
*              is a required input.  It is the name of a storage area * 00042200
*              for the parameter list.                                * 00042300
*                                                                     * 00042400
*            »,xmfattr!0Dº                                            * 00042500
*              is an optional 60 character input string that varies   * 00042600
*              from 1 to 60 characters. Use it to force boundary      * 00042700
*              alignment of the parameter list. Use only 0F or 0D.    * 00042800
*              DEFAULT: 0D which forces the parameter list to a       * 00042900
*              doubleword boundary.                                   * 00043000
*                                                                     * 00043100
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00043200
*              specifies the execute form of the macro.  The "E" form * 00043300
*              generates code to put the parameters into the          * 00043400
*              parameter list specified by xmfctrl and provides full  * 00043500
*              syntax checking with default setting.                  * 00043600
*                                                                     * 00043700
*            ,xmfctrl                                                 * 00043800
*              is a required input.  It is the name (RS-type), or     * 00043900
*              address in register (1)-(12), of a storage area for    * 00044000
*              the parameter list.                                    * 00044100
*                                                                     * 00044200
*            »,COMPLETEº                                              * 00044300
*              is an optional keyword input which specifies the       * 00044400
*              degree of macro parameter syntax checking.             * 00044500
*              DEFAULT: COMPLETE                                      * 00044600
*                                                                     * 00044700
*                                                                     * 00044800
*              COMPLETE                                               * 00044900
*                  Checking for required macro keys is done and       * 00045000
*                  defaults are supplied for omitted optional         * 00045100
*                  parameters.                                        * 00045200
*                                                                     * 00045300
*                                                                     * 00045400
*                                                                     * 00045500
*                                                                     * 00045600
*                                                                     * 00045700
*                                                                     * 00045800
*                                                                     * 00045900
*01* RETURN CODES:                                                    * 00046000
*                                                                     * 00046100
*                                                                     * 00046200
*                 The following is a list of return and reason codes: * 00046300
*                                                                     * 00046400
*                                                                     * 00046500
*                 X'00'     Function completed successfully.  The CDR * 00046600
*                           was successfully retrieved on the         * 00046700
*                           specified device and path.                * 00046800
*                                                                     * 00046900
*                 X'04'     The CDR for the specified device and path * 00047000
*                           could not be retrieved.                   * 00047100
*                                                                     * 00047200
*                           Reason codes                              * 00047300
*                                                                     * 00047400
*                                                                     * 00047500
*                           X'04'     The CDR was retrieved, but the  * 00047600
*                                     CDRAREA specified was not large * 00047700
*                                     enough to receive it.  The      * 00047800
*                                     number of bytes specified on    * 00047900
*                                     the CDRLEN keyword specifies    * 00048000
*                                     the length of the CDRAREA.  If  * 00048100
*                                     the CDRSIZE keyword was         * 00048200
*                                     specified, the size that        * 00048300
*                                     CDRAREA would have needed to be * 00048400
*                                     will be returned in the area    * 00048500
*                                     specified on CDRSIZE.           * 00048600
*                                                                     * 00048700
*                           X'08'     Request failed, unable to       * 00048800
*                                     retrieve CDR.  Subchannel or    * 00048900
*                                     I/O error.                      * 00049000
*                                                                     * 00049100
*                           X'0C'     I/O was attempted to the        * 00049200
*                                     device, but the user specified  * 00049300
*                                     timer interval as specified on  * 00049400
*                                     the TIME keyword expired before * 00049500
*                                     the I/O completed.              * 00049600
*                                                                     * 00049700
*                           X'10'     MVS does not have a last known  * 00049800
*                                     CDR to return.  No I/O was      * 00049900
*                                     attempted.                      * 00050000
*                                                                     * 00050100
*                           X'14'     Unable to retrieve last known   * 00050200
*                                     CDR.  No I/O was attempted.     * 00050300
*                                                                     * 00050400
*                                                                     * 00050500
*                                                                     * 00050600
*                 X'08'     Unable to perform function.               * 00050700
*                                                                     * 00050800
*                                                                     * 00050900
*                           X'04'     The device specified does not   * 00051000
*                                     support the CCWs used to obtain * 00051100
*                                     configuration data records.     * 00051200
*                                                                     * 00051300
*                           X'08'     Device number specified on DEVN * 00051400
*                                     keyword is not valid.           * 00051500
*                                                                     * 00051600
*                           X'0C'     CHPID secified on CHPID keyword * 00051700
*                                     is not valid.                   * 00051800
*                                                                     * 00051900
*                           X'10'     An invalid time was specified.  * 00052000
*                                                                     * 00052100
*                           X'14'     An invalid CDRLEN was           * 00052200
*                                     specified.                      * 00052300
*                                                                     * 00052400
*                           X'20'     The UCB definition for the      * 00052500
*                                     device represented by the       * 00052600
*                                     look-up argument has changed    * 00052700
*                                     and is no longer consistent     * 00052800
*                                     with the UCB definition         * 00052900
*                                     represented by the input I/O    * 00053000
*                                     configuration token.  (This     * 00053100
*                                     return code is valid only for   * 00053200
*                                     callers using the IOCTOKEN      * 00053300
*                                     keyword.)                       * 00053400
*                                                                     * 00053500
*                           X'24'     Processing cannot be performed  * 00053600
*                                     before the IOS address space is * 00053700
*                                     available.                      * 00053800
*                                                                     * 00053900
*                           X'28'     Could not establish ESTAE.      * 00054000
*                                                                     * 00054100
*                           X'2C'     The value specified on the      * 00054200
*                                     SCHSET keyword is not valid.    * 00054300
*                                                                     * 00054400
*                                                                     * 00054500
*                                                                     * 00054600
*                 X'0C'     An unexpected error occurred.             * 00054700
*                                                                     * 00054800
*                                                                     * 00054900
*                                                                     * 00055000
*                                                                     * 00055100
*                                                                     * 00055200
*01* REASON CODES:                                                    * 00055300
*         Refer to the return codes section.                          * 00055400
*                                                                     * 00055500
*01* ABEND CODES:                                                     * 00055600
*                                                                     * 00055700
*                                                                     * 00055800
*       2C6       Failure occurred during validation checking or      * 00055900
*                 while using a caller passed variable.               * 00056000
*                                                                     * 00056100
*                                                                     * 00056200
*                                                                     * 00056300
*01* ABEND REASON CODES:                                              * 00056400
*                                                                     * 00056500
*       REASON    ABEND                                               * 00056600
*       CODE      CODE      DESCRIPTION                               * 00056700
*       ××××××××  ××××××××  ×××××××××××                               * 00056800
*                                                                     * 00056900
*                                                                     * 00057000
*       00000100  2C6       Invalid authorization.  For LINKAGE=LINK  * 00057100
*                           callers, the caller is not in supervisor  * 00057200
*                           state.  For LINKAGE=SYSTEM callers, the   * 00057300
*                           caller is not supervisor state, PKM 0-7,  * 00057400
*                           APF authorized, or RACF authorized to     * 00057500
*                           class FACILITY and entity IOSCDR.         * 00057600
*                                                                     * 00057700
*       00000101  2C6       Invalid dispatchable unit mode.  Caller   * 00057800
*                           is not in task mode or is holding an EUT  * 00057900
*                           FRR.                                      * 00058000
*                                                                     * 00058100
*       00000102  2C6       Invalid serialization.  Caller is locked. * 00058200
*                                                                     * 00058300
*       00000103  2C6       Invalid AMODE.  Caller is not in 31-bit   * 00058400
*                           mode.                                     * 00058500
*                                                                     * 00058600
*       00000200  2C6       Invalid parameter list.  Caller passed an * 00058700
*                           invalid version of the parameter list.    * 00058800
*                                                                     * 00058900
*       00000201  2C6       Invalid parameter list.  Parameter list   * 00059000
*                           integrity compromised.  (For example,     * 00059100
*                           more than one in a list of mutually       * 00059200
*                           exclusive keywords was specified.)        * 00059300
*                                                                     * 00059400
*       00000202  2C6       Invalid parameter list. Caller passed an  * 00059500
*                           invalid parameter list and error occurred * 00059600
*                           reading the list.                         * 00059700
*                                                                     * 00059800
*       00000203  2C6       Invalid parameter list. Caller passed an  * 00059900
*                           invalid parameter list and error occurred * 00060000
*                           updating the list.                        * 00060100
*                                                                     * 00060200
*       00000204  2C6       Invalid IOCTOKEN storage. Caller passed   * 00060300
*                           an invalid IOCTOKEN and error occurred    * 00060400
*                           reading.                                  * 00060500
*                                                                     * 00060600
*       00000205  2C6       Invalid IOCTOKEN storage. Caller passed   * 00060700
*                           an invalid IOCTOKEN and error occurred    * 00060800
*                           updating.                                 * 00060900
*                                                                     * 00061000
*       00000206  2C6       Invalid CDRAREA storage. Caller passed an * 00061100
*                           invalid CDRAREA and error occurred        * 00061200
*                           updating.                                 * 00061300
*                                                                     * 00061400
*                                                                     * 00061500
*                                                                     * 00061600
*01* MODULE TYPE:  ASSEM MACRO                                        * 00061700
*                                                                     * 00061800
*02*   PROCESSOR:  ASSEM                                              * 00061900
*                                                                     * 00062000
*01* COMPONENT:  SC1C3                                                * 00062100
*                                                                     * 00062200
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00062300
*                                                                     * 00062400
*01* MACRO USAGE NOTES:                                               * 00062500
*                                                                     * 00062600
*                                                                     * 00062700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00062800
*        global macro variable.  Any value other than 'NO' will       * 00062900
*        result in the macro expansion being printed.  The default is * 00063000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00063100
*        variable should be set.                                      * 00063200
*                                                                     * 00063300
*                    GBLC &ZPRINT                                     * 00063400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00063500
*                                                                     * 00063600
*                                                                     * 00063700
*    2.  The  IOSCDR  macro supports multiple versions. The macro key * 00063800
*        list  below  contains the version level in which the key was * 00063900
*        first  introduced.  Positionals  are  identified by the word * 00064000
*        'Positional'  followed by the numeric value of its position. * 00064100
*        Nested  positionals  are  preceded  by their outer key.  The * 00064200
*        lowest value represents the original version and the highest * 00064300
*        value  represents  the  most  recent  version  of the IOSCDR * 00064400
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00064500
*        least  as high as the highest version number of all the keys * 00064600
*        being used.                                                  * 00064700
*                                                                     * 00064800
*        VERSION   KEY                                                * 00064900
*                                                                     * 00065000
*              1      CDRAREA                                         * 00065100
*                     CDRLEN                                          * 00065200
*                     CDRSIZE                                         * 00065300
*                     CHPID                                           * 00065400
*                     DEVN                                            * 00065500
*                     IOCTOKEN                                        * 00065600
*                     LINKAGE                                         * 00065700
*                     NODE_DESCRIPTOR                                 * 00065800
*                     READ                                            * 00065900
*                     SCHSET                                          * 00066000
*                     STATUS                                          * 00066100
*                     TIME                                            * 00066200
*              2      WWPN                                            * 00066300
*                                                                     * 00066400
*    3.  Invokers of this service must not hold any EUT FRRs.         * 00066500
*                                                                     * 00066600
*                                                                     * 00066700
*                                                                     * 00066800
*01* CHANGE ACTIVITY:                                                 * 00066900
*                                                                     * 00067000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00067100
*                                                                     * 00067200
*    $L0=DEVSD    HBB5510 930305 PDLU:  Configuration Data Record     * 00067300
*                                         Service                     * 00067400
*    $L1=SCHSET   HBB7720 040315 PDSC:  Subchannel sets               * 00067500
*    $L2=IOSFLR   HBB7730 050930 PDWV:  FICON RAS/Flapping links      * 00067600
*                                         support. Changes flagged by * 00067700
*                                         OA10906.                    * 00067800
*    $L3=SCHSET2  HBB7750 080331 PDON:  Add KEYUSED.SCHSET. Changes   * 00067900
*                                         flagged by OA24142.         * 00068000
*    $L4=SMI-S    HBB7770 090630 PDHC:  SMI-S Support : Add WWPN      * 00068100
*    $A6=OA24142  HBB7740 080831 PDON:  Subchannel Sets for PPRC      * 00068200
*    $P1=PIG1966  HBB5510 930715 PDLU:  Documentation updates         * 00068300
*    $P2=PN70653  HBB5520 940602 PDLU:  Changed to use Standard       * 00068400
*                                         Assembler form of LINK for  * 00068500
*                                         PLAS invocations so that    * 00068600
*                                         the EPILOG area is not      * 00068700
*                                         used.                       * 00068800
*    $P3=PN71096  HBB5520 941020 PDLU:  Allow authorized callers who  * 00068900
*                                         run in problem state to     * 00069000
*                                         invoke IOSCDR.              * 00069100
*    $P4=PN71743  HBB5520 941020 PDLP:  Add External Classification   * 00069200
*                                         in the PROLOG               * 00069300
*    $01=OA10906  HBB7707 050930 PDWV:  FICON RAS/Flapping links      * 00069400
*                                         support. Added              * 00069500
*                                         NODE_DESCRIPTOR parameter.  * 00069600
****** END OF SPECIFICATIONS *****************************************/ 00069700
*/********************************************************************* 00069800
         MACRO                                                          00069900
&XLABEL  IOSCDR &DEVN=,&SCHSET=,&CHPID=,&CDRAREA=,&CDRLEN=,&CDRSIZE=,  *00070000
               &READ=,&STATUS=,&TIME=,&IOCTOKEN=,&NODE_DESCRIPTOR=,    *00070100
               &WWPN=,&LINKAGE=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=     00070200
.*                                                                      00070300
*                     MACDATE -06/30/09-<2>                             00070400
.*                                                                      00070500
.*******************************************************************    00070600
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00070700
.*******************************************************************    00070800
                     GBLC  &ZPRINT     YES=PRINT NO=NO PRINT            00070900
                     GBLC  &ZTEST      YES=TEST NO=NO TEST              00071000
                     GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX      00071100
.*                                                                      00071200
                     GBLC  &ZIOSCDR    YES=MACRO USED AT LEAST ONCE     00071300
.*******************************************************************    00071400
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00071500
.*******************************************************************    00071600
                     LCLC  &ZMS        ERROR MESSAGE WORK AREA          00071700
                     LCLC  &ZCNDX      SYSNDX CHARACTERS                00071800
                     LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED       00071900
                     LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR      00072000
                     LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE      00072100
                     LCLA  &ZAWRK      USED AS A WORK AREA              00072200
                     LCLA  &ZASIZ      USED FOR SIZE OF VALUE           00072300
                     LCLA  &ZN         NUMERIC WORK VARIABLE            00072400
                     LCLC  &ZC         CHARACTER WORK VARIABLE          00072500
                     LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE      00072600
                     LCLA  &ZTLA       VALUE TOO LONG VARIABLE          00072700
                     LCLC  &ZMAC_G     "G" or null                      00072800
&ZMAC_G              SETC  ''                                           00072900
                     LCLC  &ZMAC_LR                                     00073000
&ZMAC_LR             SETC  'LR'                                         00073100
                     LCLC  &ZMAC_L                                      00073200
&ZMAC_L              SETC  'L'                                          00073300
                     LCLC  &ZMAC_ST                                     00073400
&ZMAC_ST             SETC  'ST'                                         00073500
                     LCLA  &ZMACRET    MACRO RETURN CODE                00073600
&ZMACRET             SETA  0           ASSUME NO ERRORS                 00073700
.*                                                                      00073800
                     LCLC  &ZCSYSLIST(255)      NONXKEY, POS ARRAY      00073900
                     LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()       00074000
                     LCLA  &ZPLLEN     PARAMETER LIST LENGTH            00074100
                     LCLC  &ZENDBASEPL          End of base PL          00074200
                     LCLA  &ZPLWORKA   PARAMETER LIST LENGTH            00074300
.*******************************************************************    00074400
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00074500
.*******************************************************************    00074600
                     LCLA  &ZI         INDEX FOR ARRAY                  00074700
                     LCLA  &ZJ         INDEX FOR PARMS                  00074800
                     LCLA  &ZK         INDEX FOR PARSE                  00074900
                     LCLA  &ZLO        LOW RANGE VALUE                  00075000
                     LCLA  &ZHI        HIGH RANGE VALUE                 00075100
                     LCLC  &ZW         WORK AREA FOR PARM               00075200
.********************************************************************   00075300
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00075400
.********************************************************************   00075500
                     GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL          00075600
                     GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE   00075700
                     GBLA  &SYSALVL    SYSSTATE ARCHLVL                 00075800
                     GBLC  &SYSAM64    SYSSTATE AMODE64                 00075900
.*                                                                      00076000
                     AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED   00076100
                     AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED    00076200
                     SPLEVEL  TEST                                      00076300
.ZSYS2               ANOP  ,                                            00076400
                     AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1        00076500
                     AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1        00076600
                     SYSSTATE TEST                                      00076700
                     AGO   .ZSYS4                                       00076800
.ZSYS3               ANOP  ,                                            00076900
&SYSASCE             SETC  'P'         ASSUME SYSSTATE PRIMARY          00077000
.ZSYS4               ANOP  ,                                            00077100
.*******************************************************************    00077200
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00077300
.*******************************************************************    00077400
                     LCLC  &XDEVN      ++ NAME                          00077500
                     LCLC  &XSCHSET    ++ NAME                          00077600
                     LCLC  &XCHPID     ++ NAME                          00077700
                     LCLC  &XCDRAREA   ++ NAME                          00077800
                     LCLC  &XCDRLEN    ++ NAME                          00077900
                     LCLC  &XCDRSIZE   ++ NAME                          00078000
                     LCLC  &XREAD      ++ VALUE                         00078100
                     LCLC  &XSTATUS    ++ NAME                          00078200
                     LCLC  &XTIME      ++ NAME                          00078300
                     LCLC  &XIOCTOKEN  ++ NAME                          00078400
                     LCLC  &XNODE_DESCRIPTOR    ++ NAME                 00078500
                     LCLC  &XWWPN      ++ NAME                          00078600
                     LCLC  &XLINKAGE   ++ VALUE                         00078700
                     LCLC  &XRETCODE   ++ NAME                          00078800
                     LCLC  &XRSNCODE   ++ NAME                          00078900
                     LCLA  &XPLISTVER  ++ VALUE                         00079000
                     LCLC  &XMF        ++ VALUE                         00079100
                     LCLC  &XMFCTRL    ++ NAME                          00079200
                     LCLC  &XMFATTR    ++ VALUE                         00079300
                     LCLC  &XMFSCK     ++ VALUE                         00079400
.*******************************************************************    00079500
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00079600
.*******************************************************************    00079700
                     LCLC  &ZXDEVN     ++ INPUT NAME                    00079800
                     LCLC  &ZXSCHSET   ++ INPUT NAME                    00079900
                     LCLC  &ZXCHPID    ++ INPUT NAME                    00080000
                     LCLC  &ZXCDRAREA  ++ INPUT NAME                    00080100
                     LCLC  &ZXCDRLEN   ++ INPUT NAME                    00080200
                     LCLC  &ZXCDRSIZE  ++ OUTPUT NAME                   00080300
                     LCLC  &ZXREAD     ++ INPUT VALUE                   00080400
                     LCLC  &ZXSTATUS   ++ INOUT NAME                    00080500
                     LCLC  &ZXTIME     ++ INPUT NAME                    00080600
                     LCLC  &ZXIOCTOKEN          ++ INOUT NAME           00080700
                     LCLC  &ZXNODE_DESCRIPTOR   ++ INPUT NAME           00080800
                     LCLC  &ZXWWPN     ++ OUTPUT NAME                   00080900
                     LCLC  &ZXLINKAGE  ++ INPUT VALUE                   00081000
                     LCLC  &ZXRETCODE  ++ OUTPUT NAME                   00081100
                     LCLC  &ZXRSNCODE  ++ OUTPUT NAME                   00081200
                     LCLC  &ZXPLISTVER          ++ INPUT VALUE          00081300
                     LCLC  &ZXMF       ++ INPUT VALUE                   00081400
                     LCLC  &ZXMFCTRL   ++ INPUT NAME                    00081500
                     LCLC  &ZXMFATTR   ++ INPUT VALUE                   00081600
                     LCLC  &ZXMFSCK    ++ INPUT VALUE                   00081700
.********************************************************************   00081800
.***AC.PLV01  PROCESS PLISTVER                                      *   00081900
.********************************************************************   00082000
&XPLISTVER      SETA  1                                                 00082100
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00082200
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00082300
&XPLISTVER      SETA  2                                                 00082400
.ZPLV0          ANOP  ,                                                 00082500
.*                                                                      00082600
                AIF   ('&WWPN' EQ '').ZPLV1E                            00082700
                AIF   (&XPLISTVER GE 2).ZPLV1E                          00082800
&XPLISTVER      SETA  2                                                 00082900
.ZPLV1E         ANOP  ,                                                 00083000
.*                                                                      00083100
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00083200
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00083300
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00083400
.*-------------------------------------------------------------------   00083500
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00083600
&ZMS            SETC  '"PLISTVER='                                      00083700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00083800
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00083900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00084000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00084100
                AGO   .ZPVCK2                                           00084200
.ZPVCK3         ANOP  ,                                                 00084300
.*-------------------------------------------------------------------   00084400
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00084500
&ZMS            SETC  '"PLISTVER='                                      00084600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00084700
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00084800
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00084900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00085000
                AGO   .ZPVCKE                                           00085100
.ZPVCK2         ANOP  ,                                                 00085200
.*-------------------------------------------------------------------   00085300
&ZCVAL          SETC  '&PLISTVER(1)'                                    00085400
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00085500
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00085600
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00085700
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00085800
                AIF   (&ZN LE 2).ZPVCK4A   NOT HIGH                     00085900
.ZPVCK6         ANOP  ,                                                 00086000
&ZMS            SETC  '"PLISTVER='                                      00086100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00086200
&ZMS            SETC  '&ZMS THE RANGE IS "1-2"'                         00086300
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00086400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00086500
&XPLISTVER      SETA  2                                                 00086600
                AGO   .ZPVCKE                                           00086700
.*-------------------------------------------------------------------   00086800
.ZPVCK4A        ANOP  ,                                                 00086900
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00087000
&ZMS            SETC  'PLISTVER='                                       00087100
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00087200
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00087300
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00087400
                MNOTE 8,' &ZMS IS REQUIRED.'                            00087500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00087600
                AGO   .ZPVCK5                                           00087700
.ZPVCK4         ANOP  ,                                                 00087800
&XPLISTVER      SETA  &PLISTVER(1)                                      00087900
.ZPVCK5         ANOP  ,                                                 00088000
.ZPVCKE         ANOP  ,                                                 00088100
.********************************************************************   00088200
.***AG.MF01 PROCESS MF MACRO FORMS                                      00088300
.********************************************************************   00088400
                     ACTR  10000                                        00088500
.*------------------------------------------------------------------    00088600
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00088700
&XMF                 SETC  ''          INITIALIZE XVARIABLE             00088800
.*-------------------------------------------------------------------   00088900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00089000
.ZG56                ANOP  ,                                            00089100
&ZTLC                SETC 'S'                                           00089200
                     AIF   ('&MF(1)' NE '&ZTLC').ZG57                   00089300
&XMF                 SETC  'S'         SET KEYWORD                      00089400
                     AIF   (N'&MF LE 1).ZG56A   CK NUM                  00089500
&ZMS                 SETC  '"MF='                                       00089600
&ZMS                 SETC  '&ZMS.&MF"'                                  00089700
&ZMS                 SETC  '&ZMS "MF"'                                  00089800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00089900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00090000
.ZG56A               ANOP  ,                                            00090100
.*-------------------------------------------------------------------   00090200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00090300
.ZG57                ANOP  ,                                            00090400
&ZTLC                SETC 'L'                                           00090500
                     AIF   ('&MF(1)' NE '&ZTLC').ZG64                   00090600
&XMF                 SETC  'L'         SET KEYWORD                      00090700
                     AIF   (N'&MF LE 3).ZG57A   CK NUM                  00090800
&ZMS                 SETC  '"MF='                                       00090900
&ZMS                 SETC  '&ZMS.&MF"'                                  00091000
&ZMS                 SETC  '&ZMS "MF"'                                  00091100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00091200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00091300
.ZG57A               ANOP  ,                                            00091400
.*-------------------------------------------------------------------   00091500
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00091600
                     AIF   (N'&SYSLIST NE 0).ZG57B  POSITIONALS?        00091700
                     AIF   ('&DEVN' NE '').ZG57B  KEYS?                 00091800
                     AIF   ('&SCHSET' NE '').ZG57B  KEYS?               00091900
                     AIF   ('&CHPID' NE '').ZG57B  KEYS?                00092000
                     AIF   ('&CDRAREA' NE '').ZG57B  KEYS?              00092100
                     AIF   ('&CDRLEN' NE '').ZG57B  KEYS?               00092200
                     AIF   ('&CDRSIZE' NE '').ZG57B  KEYS?              00092300
                     AIF   ('&READ' NE '').ZG57B  KEYS?                 00092400
                     AIF   ('&STATUS' NE '').ZG57B  KEYS?               00092500
                     AIF   ('&TIME' NE '').ZG57B  KEYS?                 00092600
                     AIF   ('&IOCTOKEN' NE '').ZG57B  KEYS?             00092700
                     AIF   ('&NODE_DESCRIPTOR' NE '').ZG57B  KEYS?      00092800
                     AIF   ('&WWPN' NE '').ZG57B  KEYS?                 00092900
                     AIF   ('&LINKAGE' NE '').ZG57B  KEYS?              00093000
                     AIF   ('&RETCODE' NE '').ZG57B  KEYS?              00093100
                     AIF   ('&RSNCODE' NE '').ZG57B  KEYS?              00093200
                     AGO    .ZG57C     INVOCATION OKAY                  00093300
.ZG57B               ANOP  ,                                            00093400
&ZMS                 SETC  'THE "L" FORM OF "MF"'                       00093500
&ZMS                 SETC  '&ZMS CAN ONLY HAVE'                         00093600
&ZMS                 SETC  '&ZMS THE "PLISTVER" KEY'                    00093700
                     MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'       00093800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00093900
.ZG57C               ANOP  ,                                            00094000
.*-------------------------------------------------------------------   00094100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00094200
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00094300
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00094400
                     AIF   (N'&MF(2) GT 1).ZG59B  MULTI PARMS           00094500
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00094600
.ZG59B               AIF   (K'&MF(2) GT 0).ZG59C                        00094700
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00094800
&ZMS                 SETC  'WHEN "L" IS SPECIFIED'                      00094900
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00095000
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00095100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00095200
.ZG59C               ANOP  ,                                            00095300
.*-------------------------------------------------------------------   00095400
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00095500
                     AIF   (K'&ZXMFCTRL LE 0).ZG59P  NOT I/O            00095600
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG59P               00095700
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00095800
&ZMS                 SETC  '"MF='                                       00095900
&ZMS                 SETC  '&ZMS.&MF"'                                  00096000
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00096100
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'            00096200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00096300
.ZG59P               ANOP  ,                                            00096400
.*-------------------------------------------------------------------   00096500
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00096600
&ZXMFATTR            SETC  'INPUT'     SET IN/OUTPUT                    00096700
&XMFATTR             SETC  '0D'                                         00096800
                     AIF   (K'&MF(3) LE 0).ZG62B  PARM                  00096900
&XMFATTR             SETC  '&MF(3,1)'  SET XVARIABLE                    00097000
                     AIF   (N'&MF(3) GT 1).ZG62B  MULTI                 00097100
&XMFATTR             SETC  '&MF(3)'    SET XVARIABLE                    00097200
.ZG62B               ANOP  ,                                            00097300
.*-------------------------------------------------------------------   00097400
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00097500
                     AIF   (K'&ZXMFATTR LE 0).ZG62P  NOT I/O            00097600
                     AIF   ('&XMFATTR'(1,1) NE '(').ZG62P               00097700
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00097800
&ZMS                 SETC  '"MF='                                       00097900
&ZMS                 SETC  '&ZMS.&MF"'                                  00098000
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00098100
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'            00098200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00098300
.ZG62P               ANOP  ,                                            00098400
.*-------------------------------------------------------------------   00098500
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00098600
                     AIF   (K'&ZXMFATTR LE 0).ZG62S  NOT I/O            00098700
                     AIF   (K'&XMFATTR LE 60).ZG62S  LNG OK             00098800
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00098900
&ZMS                 SETC  '"MF='                                       00099000
&ZMS                 SETC  '&ZMS.&MF"'                                  00099100
&ZMS                 SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'        00099200
                     MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'           00099300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00099400
.ZG62S               ANOP  ,                                            00099500
.*-------------------------------------------------------------------   00099600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00099700
.ZG64                ANOP  ,                                            00099800
&ZTLC                SETC 'E'                                           00099900
                     AIF   ('&MF(1)' NE '&ZTLC').ZG72                   00100000
&XMF                 SETC  'E'         SET KEYWORD                      00100100
                     AIF   (N'&MF LE 3).ZG64A   CK NUM                  00100200
&ZMS                 SETC  '"MF='                                       00100300
&ZMS                 SETC  '&ZMS.&MF"'                                  00100400
&ZMS                 SETC  '&ZMS "MF"'                                  00100500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00100600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00100700
.ZG64A               ANOP  ,                                            00100800
.*-------------------------------------------------------------------   00100900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00101000
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00101100
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00101200
                     AIF   (N'&MF(2) GT 1).ZG66B  MULTI PARMS           00101300
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00101400
.ZG66B               AIF   (K'&MF(2) GT 0).ZG66C                        00101500
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00101600
&ZMS                 SETC  'WHEN "E" IS SPECIFIED'                      00101700
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00101800
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00101900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00102000
.ZG66C               ANOP  ,                                            00102100
.*-------------------------------------------------------------------   00102200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00102300
                     AIF   (K'&ZXMFCTRL LE 0).ZG66R  NOT I/O            00102400
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG66R               00102500
&ZCGPR               SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                   00102600
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG66P                 00102700
                     AIF   (K'&ZCGPR GT 2).ZG66Q                        00102800
                     AIF   ('&ZCGPR' EQ '0').ZG66Q                      00102900
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00103000
                     AIF   (T'&ZCGPR NE 'N').ZG66Q  INVALID REG NAME    00103100
.ZG66P               ANOP  ,                                            00103200
                     AIF   (T'&ZCGPR NE 'N').ZG66R  NON NUMERIC         00103300
                     AIF   ('&ZCGPR' LT '1').ZG66Q                      00103400
                     AIF   ('&ZCGPR' LE '12').ZG66R                     00103500
.ZG66Q               ANOP  ,                                            00103600
&ZMS                 SETC  '"MF='                                       00103700
&ZMS                 SETC  '&ZMS.&MF"'                                  00103800
&ZMS                 SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'    00103900
                     MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'             00104000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00104100
.ZG66R               ANOP  ,                                            00104200
.*-------------------------------------------------------------------   00104300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00104400
&XMFSCK              SETC  ''          INITIALIZE XVARIABLE             00104500
.ZG70A   AIF   ('&MF(3)' NE 'COMPLETE').ZG71A                           00104600
&XMFSCK              SETC  'COMPLETE'  SET KEYWORD                      00104700
.*-------------------------------------------------------------------   00104800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00104900
.ZG71A               AIF   (K'&XMFSCK GT 0).ZG71C  KEYWORD              00105000
                     AIF   (K'&MF(3) LE 0).ZG71B                        00105100
&ZMS                 SETC  '"MF='                                       00105200
&ZMS                 SETC  '&ZMS.&MF"'                                  00105300
&ZMS                 SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '    00105400
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00105500
&ZMS                 SETC  '&ZMS "COMPLETE".'                           00105600
                     MNOTE 8,' &ZMS '                                   00105700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00105800
.ZG71B               ANOP  ,                                            00105900
&XMFSCK              SETC  'COMPLETE'  SET DEFAULT KEYWORD              00106000
.ZG71C               ANOP  ,                                            00106100
&ZXMFSCK             SETC  'INPUT'     SET IN/OUTPUT                    00106200
.*------------------------------------------------------------------    00106300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00106400
.ZG72                ANOP  ,                                            00106500
&ZXMF                SETC  'INPUT'     SET IN/OUTPUT                    00106600
                     AIF   (K'&XMF GT 0).ZG72E  VALID ARG               00106700
                     AIF   (T'&MF EQ 'O').ZG72D  OMITTED                00106800
&ZASYSLNDX           SETA  0                                            00106900
.ZG72A               ANOP  ,           POSITIONAL MACRO KEY             00107000
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00107100
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG72C             00107200
&ZTLC                SETC 'MF'                                          00107300
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG72A    00107400
.ZG72B               ANOP  ,                                            00107500
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00107600
&ZMS                 SETC  'THE "MF" KEY'                               00107700
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00107800
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00107900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00108000
                     AGO   .ZG72E                                       00108100
.ZG72C               ANOP  ,                                            00108200
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00108300
&ZMS                 SETC  '"MF='                                       00108400
&ZMS                 SETC  '&ZMS.&MF"'                                  00108500
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00108600
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00108700
&ZMS                 SETC  '&ZMS "S",'                                  00108800
&ZMS                 SETC  '&ZMS "L",'                                  00108900
&ZMS                 SETC  '&ZMS OR "E".'                               00109000
                     MNOTE 8,' &ZMS '                                   00109100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00109200
                     AGO   .ZG72E                                       00109300
.ZG72D               ANOP  ,                                            00109400
&XMF                 SETC  'S'         SET DEFAULT KEYWORD              00109500
&XMFSCK              SETC  'COMPLETE'  COMPLETE CHECKING                00109600
.ZG72E               ANOP  ,                                            00109700
.********************************************************************   00109800
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00109900
.********************************************************************   00110000
                     ACTR  10000                                        00110100
.*-------------------------------------------------------------------   00110200
.***AG.MF03 MF=(SLE)                                                    00110300
                     AIF   ('&XMF' EQ 'L').ZGMFX                        00110400
.*----------------------------------------------------------------***   00110500
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00110600
                     AIF   (N'&DEVN LE 1).ZG2A  CK NUM                  00110700
&ZMS                 SETC  '"DEVN='                                     00110800
&ZMS                 SETC  '&ZMS.&DEVN"'                                00110900
&ZMS                 SETC  '&ZMS "DEVN"'                                00111000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00111100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00111200
.ZG2A                ANOP  ,                                            00111300
.*-------------------------------------------------------------------   00111400
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00111500
&ZXDEVN              SETC  'INPUT'     SET IN/OUTPUT                    00111600
&XDEVN               SETC  '&DEVN(1)'  SET XVARIABLE                    00111700
                     AIF   (N'&DEVN GT 1).ZG2B  MULTI PARMS             00111800
&XDEVN               SETC  '&DEVN'     SET XVARIABLE                    00111900
.ZG2B                AIF   (K'&DEVN(1) GT 0).ZG2C                       00112000
&ZXDEVN              SETC  ''          RESET IN/OUTPUT                  00112100
&ZMS                 SETC  ' '                                          00112200
&ZMS                 SETC  '&ZMS "DEVN" KEY AND ITS'                    00112300
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00112400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00112500
.ZG2C                ANOP  ,                                            00112600
.*-------------------------------------------------------------------   00112700
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00112800
                     AIF   (K'&ZXDEVN LE 0).ZG2R  NOT I/O               00112900
                     AIF   ('&XDEVN'(1,1) NE '(').ZG2R                  00113000
&ZCGPR               SETC  '&XDEVN'(2,K'&XDEVN-2)                       00113100
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                  00113200
                     AIF   (K'&ZCGPR GT 2).ZG2Q                         00113300
                     AIF   ('&ZCGPR' EQ '0').ZG2Q                       00113400
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00113500
                     AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME     00113600
.ZG2P                ANOP  ,                                            00113700
                     AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC          00113800
                     AIF   ('&ZCGPR' LT '2').ZG2Q                       00113900
                     AIF   ('&ZCGPR' LE '12').ZG2R                      00114000
.ZG2Q                ANOP  ,                                            00114100
&ZMS                 SETC  '"DEVN='                                     00114200
&ZMS                 SETC  '&ZMS.&DEVN"'                                00114300
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00114400
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00114500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00114600
.ZG2R                ANOP  ,                                            00114700
.*----------------------------------------------------------------***   00114800
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00114900
                     AIF   (N'&SCHSET LE 1).ZG5A  CK NUM                00115000
&ZMS                 SETC  '"SCHSET='                                   00115100
&ZMS                 SETC  '&ZMS.&SCHSET"'                              00115200
&ZMS                 SETC  '&ZMS "SCHSET"'                              00115300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00115400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00115500
.ZG5A                ANOP  ,                                            00115600
.*-------------------------------------------------------------------   00115700
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00115800
&ZXSCHSET            SETC  'INPUT'     SET IN/OUTPUT                    00115900
&XSCHSET             SETC  '0'                                          00116000
                     AIF   (K'&SCHSET(1) LE 0).ZG5B  PARM               00116100
&XSCHSET             SETC  '&SCHSET(1)'         SET XVARIABLE           00116200
                     AIF   (N'&SCHSET GT 1).ZG5B  MULTI                 00116300
&XSCHSET             SETC  '&SCHSET'   SET XVARIABLE                    00116400
.ZG5B                ANOP  ,                                            00116500
.*-------------------------------------------------------------------   00116600
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00116700
                     AIF   (K'&ZXSCHSET LE 0).ZG5R  NOT I/O             00116800
                     AIF   ('&XSCHSET'(1,1) NE '(').ZG5R                00116900
&ZCGPR               SETC  '&XSCHSET'(2,K'&XSCHSET-2)                   00117000
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                  00117100
                     AIF   (K'&ZCGPR GT 2).ZG5Q                         00117200
                     AIF   ('&ZCGPR' EQ '0').ZG5Q                       00117300
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00117400
                     AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME     00117500
.ZG5P                ANOP  ,                                            00117600
                     AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC          00117700
                     AIF   ('&ZCGPR' LT '2').ZG5Q                       00117800
                     AIF   ('&ZCGPR' LE '12').ZG5R                      00117900
.ZG5Q                ANOP  ,                                            00118000
&ZMS                 SETC  '"SCHSET='                                   00118100
&ZMS                 SETC  '&ZMS.&SCHSET"'                              00118200
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00118300
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00118400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00118500
.ZG5R                ANOP  ,                                            00118600
.*----------------------------------------------------------------***   00118700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00118800
                     AIF   (N'&CHPID LE 1).ZG8A  CK NUM                 00118900
&ZMS                 SETC  '"CHPID='                                    00119000
&ZMS                 SETC  '&ZMS.&CHPID"'                               00119100
&ZMS                 SETC  '&ZMS "CHPID"'                               00119200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00119300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00119400
.ZG8A                ANOP  ,                                            00119500
.*-------------------------------------------------------------------   00119600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00119700
&ZXCHPID             SETC  'INPUT'     SET IN/OUTPUT                    00119800
&XCHPID              SETC  '&CHPID(1)'          SET XVARIABLE           00119900
                     AIF   (N'&CHPID GT 1).ZG8B  MULTI PARMS            00120000
&XCHPID              SETC  '&CHPID'    SET XVARIABLE                    00120100
.ZG8B                AIF   (K'&CHPID(1) GT 0).ZG8C                      00120200
&ZXCHPID             SETC  ''          RESET IN/OUTPUT                  00120300
&ZMS                 SETC  ' '                                          00120400
&ZMS                 SETC  '&ZMS "CHPID" KEY AND ITS'                   00120500
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00120600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00120700
.ZG8C                ANOP  ,                                            00120800
.*-------------------------------------------------------------------   00120900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00121000
                     AIF   (K'&ZXCHPID LE 0).ZG8R  NOT I/O              00121100
                     AIF   ('&XCHPID'(1,1) NE '(').ZG8R                 00121200
&ZCGPR               SETC  '&XCHPID'(2,K'&XCHPID-2)                     00121300
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                  00121400
                     AIF   (K'&ZCGPR GT 2).ZG8Q                         00121500
                     AIF   ('&ZCGPR' EQ '0').ZG8Q                       00121600
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00121700
                     AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME     00121800
.ZG8P                ANOP  ,                                            00121900
                     AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC          00122000
                     AIF   ('&ZCGPR' LT '2').ZG8Q                       00122100
                     AIF   ('&ZCGPR' LE '12').ZG8R                      00122200
.ZG8Q                ANOP  ,                                            00122300
&ZMS                 SETC  '"CHPID='                                    00122400
&ZMS                 SETC  '&ZMS.&CHPID"'                               00122500
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00122600
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00122700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00122800
.ZG8R                ANOP  ,                                            00122900
.*----------------------------------------------------------------***   00123000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00123100
                     AIF   (N'&CDRAREA LE 1).ZG11A  CK NUM              00123200
&ZMS                 SETC  '"CDRAREA='                                  00123300
&ZMS                 SETC  '&ZMS.&CDRAREA"'                             00123400
&ZMS                 SETC  '&ZMS "CDRAREA"'                             00123500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00123600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00123700
.ZG11A               ANOP  ,                                            00123800
.*-------------------------------------------------------------------   00123900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00124000
&ZXCDRAREA           SETC  'INPUT'     SET IN/OUTPUT                    00124100
&XCDRAREA            SETC  '&CDRAREA(1)'        SET XVARIABLE           00124200
                     AIF   (N'&CDRAREA GT 1).ZG11B  MULTI PARMS         00124300
&XCDRAREA            SETC  '&CDRAREA'  SET XVARIABLE                    00124400
.ZG11B               AIF   (K'&CDRAREA(1) GT 0).ZG11C                   00124500
&ZXCDRAREA           SETC  ''          RESET IN/OUTPUT                  00124600
&ZMS                 SETC  ' '                                          00124700
&ZMS                 SETC  '&ZMS "CDRAREA" KEY AND ITS'                 00124800
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00124900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00125000
.ZG11C               ANOP  ,                                            00125100
.*-------------------------------------------------------------------   00125200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00125300
                     AIF   (K'&ZXCDRAREA LE 0).ZG11R  NOT I/O           00125400
                     AIF   ('&XCDRAREA'(1,1) NE '(').ZG11R              00125500
&ZCGPR               SETC  '&XCDRAREA'(2,K'&XCDRAREA-2)                 00125600
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                 00125700
                     AIF   (K'&ZCGPR GT 2).ZG11Q                        00125800
                     AIF   ('&ZCGPR' EQ '0').ZG11Q                      00125900
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00126000
                     AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME    00126100
.ZG11P               ANOP  ,                                            00126200
                     AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC         00126300
                     AIF   ('&ZCGPR' LT '2').ZG11Q                      00126400
                     AIF   ('&ZCGPR' LE '12').ZG11R                     00126500
.ZG11Q               ANOP  ,                                            00126600
&ZMS                 SETC  '"CDRAREA='                                  00126700
&ZMS                 SETC  '&ZMS.&CDRAREA"'                             00126800
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00126900
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00127000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00127100
.ZG11R               ANOP  ,                                            00127200
.*----------------------------------------------------------------***   00127300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00127400
                     AIF   (N'&CDRLEN LE 1).ZG14A  CK NUM               00127500
&ZMS                 SETC  '"CDRLEN='                                   00127600
&ZMS                 SETC  '&ZMS.&CDRLEN"'                              00127700
&ZMS                 SETC  '&ZMS "CDRLEN"'                              00127800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00127900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00128000
.ZG14A               ANOP  ,                                            00128100
.*-------------------------------------------------------------------   00128200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00128300
&ZXCDRLEN            SETC  'INPUT'     SET IN/OUTPUT                    00128400
&XCDRLEN             SETC  '&CDRLEN(1)'         SET XVARIABLE           00128500
                     AIF   (N'&CDRLEN GT 1).ZG14B  MULTI PARMS          00128600
&XCDRLEN             SETC  '&CDRLEN'   SET XVARIABLE                    00128700
.ZG14B               AIF   (K'&CDRLEN(1) GT 0).ZG14C                    00128800
&ZXCDRLEN            SETC  ''          RESET IN/OUTPUT                  00128900
&ZMS                 SETC  ' '                                          00129000
&ZMS                 SETC  '&ZMS "CDRLEN" KEY AND ITS'                  00129100
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00129200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00129300
.ZG14C               ANOP  ,                                            00129400
.*-------------------------------------------------------------------   00129500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00129600
                     AIF   (K'&ZXCDRLEN LE 0).ZG14R  NOT I/O            00129700
                     AIF   ('&XCDRLEN'(1,1) NE '(').ZG14R               00129800
&ZCGPR               SETC  '&XCDRLEN'(2,K'&XCDRLEN-2)                   00129900
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                 00130000
                     AIF   (K'&ZCGPR GT 2).ZG14Q                        00130100
                     AIF   ('&ZCGPR' EQ '0').ZG14Q                      00130200
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00130300
                     AIF   (T'&ZCGPR NE 'N').ZG14Q  INVALID REG NAME    00130400
.ZG14P               ANOP  ,                                            00130500
                     AIF   (T'&ZCGPR NE 'N').ZG14R  NON NUMERIC         00130600
                     AIF   ('&ZCGPR' LT '2').ZG14Q                      00130700
                     AIF   ('&ZCGPR' LE '12').ZG14R                     00130800
.ZG14Q               ANOP  ,                                            00130900
&ZMS                 SETC  '"CDRLEN='                                   00131000
&ZMS                 SETC  '&ZMS.&CDRLEN"'                              00131100
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00131200
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00131300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00131400
.ZG14R               ANOP  ,                                            00131500
.*----------------------------------------------------------------***   00131600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00131700
                     AIF   (N'&CDRSIZE LE 1).ZG17A  CK NUM              00131800
&ZMS                 SETC  '"CDRSIZE='                                  00131900
&ZMS                 SETC  '&ZMS.&CDRSIZE"'                             00132000
&ZMS                 SETC  '&ZMS "CDRSIZE"'                             00132100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00132200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00132300
.ZG17A               ANOP  ,                                            00132400
.*-------------------------------------------------------------------   00132500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00132600
                     AIF   (K'&CDRSIZE(1) LE 0).ZG17C  NO PARM          00132700
&ZXCDRSIZE           SETC  'OUTPUT'    SET OUTPUT                       00132800
&XCDRSIZE            SETC  '&CDRSIZE(1)'        SET XVARIABLE           00132900
                     AIF   (N'&CDRSIZE GT 1).ZG17C                      00133000
&XCDRSIZE            SETC  '&CDRSIZE'  SET XVARIABLE                    00133100
.ZG17C               ANOP  ,                                            00133200
.*-------------------------------------------------------------------   00133300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00133400
                     AIF   (K'&ZXCDRSIZE LE 0).ZG17R  NOT I/O           00133500
                     AIF   ('&XCDRSIZE'(1,1) NE '(').ZG17R              00133600
&ZCGPR               SETC  '&XCDRSIZE'(2,K'&XCDRSIZE-2)                 00133700
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                 00133800
                     AIF   (K'&ZCGPR GT 2).ZG17Q                        00133900
                     AIF   ('&ZCGPR' EQ '0').ZG17Q                      00134000
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00134100
                     AIF   (T'&ZCGPR NE 'N').ZG17Q  INVALID REG NAME    00134200
.ZG17P               ANOP  ,                                            00134300
                     AIF   (T'&ZCGPR NE 'N').ZG17R  NON NUMERIC         00134400
                     AIF   ('&ZCGPR' LT '2').ZG17Q                      00134500
                     AIF   ('&ZCGPR' LE '12').ZG17R                     00134600
.ZG17Q               ANOP  ,                                            00134700
&ZMS                 SETC  '"CDRSIZE='                                  00134800
&ZMS                 SETC  '&ZMS.&CDRSIZE"'                             00134900
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00135000
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00135100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00135200
.ZG17R               ANOP  ,                                            00135300
.*----------------------------------------------------------------***   00135400
.***AG.KKWRD01 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00135500
                     AIF   (N'&READ LE 1).ZG20A  CK NUM                 00135600
&ZMS                 SETC  '"READ='                                     00135700
&ZMS                 SETC  '&ZMS.&READ"'                                00135800
&ZMS                 SETC  '&ZMS "READ"'                                00135900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00136000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00136100
.ZG20A               ANOP  ,                                            00136200
.*-------------------------------------------------------------------   00136300
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00136400
&XREAD               SETC  ''          INITIALIZE XVARIABLE             00136500
.ZG21A   AIF   ('&READ(1)' NE 'NOIO').ZG22A                             00136600
&XREAD               SETC  'NOIO'      SET KEYWORD                      00136700
.*-------------------------------------------------------------------   00136800
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00136900
.ZG22A   AIF   ('&READ(1)' NE 'IO').ZG23A                               00137000
&XREAD               SETC  'IO'        SET KEYWORD                      00137100
.*-------------------------------------------------------------------   00137200
.***AG.KKWRD02 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00137300
.ZG23A   AIF   ('&READ(1)' NE 'COND').ZG24A                             00137400
&XREAD               SETC  'COND'      SET KEYWORD                      00137500
.*-------------------------------------------------------------------   00137600
.***AG.KKWRD03 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00137700
.ZG24A               AIF   (K'&XREAD GT 0).ZG24C  KEYWORD               00137800
                     AIF   (K'&READ(1) LE 0).ZG24B                      00137900
&ZMS                 SETC  '"READ='                                     00138000
&ZMS                 SETC  '&ZMS.&READ"'                                00138100
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00138200
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00138300
&ZMS                 SETC  '&ZMS "NOIO",'                               00138400
&ZMS                 SETC  '&ZMS "IO",'                                 00138500
&ZMS                 SETC  '&ZMS OR "COND".'                            00138600
                     MNOTE 8,' &ZMS '                                   00138700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00138800
.ZG24B               ANOP  ,                                            00138900
&XREAD               SETC  'NOIO'      SET DEFAULT KEYWORD              00139000
.ZG24C               ANOP  ,                                            00139100
&ZXREAD              SETC  'INPUT'     SET IN/OUTPUT                    00139200
.*-------------------------------------------------------------------   00139300
.***AG.KKWRD04 VALUE, RQD INPUT, ME KEYWORD -SINGLE KEYWORD             00139400
                     AIF   (K'&READ(1) GT 0).ZG24D  VALID               00139500
&ZXREAD              SETC  ''          RESET IN/OUTPUT                  00139600
&ZMS                 SETC  'THE'                                        00139700
&ZMS                 SETC  '&ZMS "READ" KEY AND ITS'                    00139800
&ZMS                 SETC  '&ZMS ARGUMENT ARE REQUIRED.'                00139900
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00140000
&ZMS                 SETC  '&ZMS "NOIO",'                               00140100
&ZMS                 SETC  '&ZMS "IO",'                                 00140200
&ZMS                 SETC  '&ZMS OR "COND".'                            00140300
                     MNOTE 8,' &ZMS '                                   00140400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00140500
.ZG24D               ANOP  ,                                            00140600
.*----------------------------------------------------------------***   00140700
.***AG.KXVAR05 NAME, OPT INOUT, KEYS -XVARIABLE KEY                     00140800
                     AIF   (N'&STATUS LE 1).ZG26A  CK NUM               00140900
&ZMS                 SETC  '"STATUS='                                   00141000
&ZMS                 SETC  '&ZMS.&STATUS"'                              00141100
&ZMS                 SETC  '&ZMS "STATUS"'                              00141200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00141300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00141400
.ZG26A               ANOP  ,                                            00141500
.*-------------------------------------------------------------------   00141600
.***AG.KXVAR13 NAME, OPT INOUT, KEYS -XVARIABLE                         00141700
&ZXSTATUS            SETC  'INOUT'     SET IN/OUTPUT                    00141800
&XSTATUS             SETC  'NONE'                                       00141900
                     AIF   (K'&STATUS(1) LE 0).ZG26B  PARM              00142000
&XSTATUS             SETC  '&STATUS(1)'         SET XVARIABLE           00142100
                     AIF   (N'&STATUS GT 1).ZG26B  MULTI                00142200
&XSTATUS             SETC  '&STATUS'   SET XVARIABLE                    00142300
.ZG26B               ANOP  ,                                            00142400
.*-------------------------------------------------------------------   00142500
.***AG.KCK02 NAME, OPT INOUT, KEYS -GPR OUT OF RANGE                    00142600
                     AIF   (K'&ZXSTATUS LE 0).ZG26R  NOT I/O            00142700
         AIF   ('&XSTATUS' EQ 'NONE').ZG26R                             00142800
                     AIF   ('&XSTATUS'(1,1) NE '(').ZG26R               00142900
&ZCGPR               SETC  '&XSTATUS'(2,K'&XSTATUS-2)                   00143000
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                 00143100
                     AIF   (K'&ZCGPR GT 2).ZG26Q                        00143200
                     AIF   ('&ZCGPR' EQ '0').ZG26Q                      00143300
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00143400
                     AIF   (T'&ZCGPR NE 'N').ZG26Q  INVALID REG NAME    00143500
.ZG26P               ANOP  ,                                            00143600
                     AIF   (T'&ZCGPR NE 'N').ZG26R  NON NUMERIC         00143700
                     AIF   ('&ZCGPR' LT '2').ZG26Q                      00143800
                     AIF   ('&ZCGPR' LE '12').ZG26R                     00143900
.ZG26Q               ANOP  ,                                            00144000
&ZMS                 SETC  '"STATUS='                                   00144100
&ZMS                 SETC  '&ZMS.&STATUS"'                              00144200
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00144300
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00144400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00144500
.ZG26R               ANOP  ,                                            00144600
.*----------------------------------------------------------------***   00144700
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00144800
                     AIF   (N'&TIME LE 1).ZG29A  CK NUM                 00144900
&ZMS                 SETC  '"TIME='                                     00145000
&ZMS                 SETC  '&ZMS.&TIME"'                                00145100
&ZMS                 SETC  '&ZMS "TIME"'                                00145200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00145300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00145400
.ZG29A               ANOP  ,                                            00145500
.*-------------------------------------------------------------------   00145600
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00145700
&ZXTIME              SETC  'INPUT'     SET IN/OUTPUT                    00145800
&XTIME               SETC  '5'                                          00145900
                     AIF   (K'&TIME(1) LE 0).ZG29B  PARM                00146000
&XTIME               SETC  '&TIME(1)'  SET XVARIABLE                    00146100
                     AIF   (N'&TIME GT 1).ZG29B  MULTI                  00146200
&XTIME               SETC  '&TIME'     SET XVARIABLE                    00146300
.ZG29B               ANOP  ,                                            00146400
.*-------------------------------------------------------------------   00146500
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00146600
                     AIF   (K'&ZXTIME LE 0).ZG29R  NOT I/O              00146700
                     AIF   ('&XTIME'(1,1) NE '(').ZG29R                 00146800
&ZCGPR               SETC  '&XTIME'(2,K'&XTIME-2)                       00146900
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                 00147000
                     AIF   (K'&ZCGPR GT 2).ZG29Q                        00147100
                     AIF   ('&ZCGPR' EQ '0').ZG29Q                      00147200
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00147300
                     AIF   (T'&ZCGPR NE 'N').ZG29Q  INVALID REG NAME    00147400
.ZG29P               ANOP  ,                                            00147500
                     AIF   (T'&ZCGPR NE 'N').ZG29R  NON NUMERIC         00147600
                     AIF   ('&ZCGPR' LT '2').ZG29Q                      00147700
                     AIF   ('&ZCGPR' LE '12').ZG29R                     00147800
.ZG29Q               ANOP  ,                                            00147900
&ZMS                 SETC  '"TIME='                                     00148000
&ZMS                 SETC  '&ZMS.&TIME"'                                00148100
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00148200
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00148300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00148400
.ZG29R               ANOP  ,                                            00148500
.*----------------------------------------------------------------***   00148600
.***AG.KXVAR05 NAME, OPT INOUT, KEYS -XVARIABLE KEY                     00148700
                     AIF   (N'&IOCTOKEN LE 1).ZG32A  CK NUM             00148800
&ZMS                 SETC  '"IOCTOKEN='                                 00148900
&ZMS                 SETC  '&ZMS.&IOCTOKEN"'                            00149000
&ZMS                 SETC  '&ZMS "IOCTOKEN"'                            00149100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00149200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00149300
.ZG32A               ANOP  ,                                            00149400
.*-------------------------------------------------------------------   00149500
.***AG.KXVAR13 NAME, OPT INOUT, KEYS -XVARIABLE                         00149600
&ZXIOCTOKEN          SETC  'INOUT'     SET IN/OUTPUT                    00149700
&XIOCTOKEN           SETC  'NONE'                                       00149800
                     AIF   (K'&IOCTOKEN(1) LE 0).ZG32B  PARM            00149900
&XIOCTOKEN           SETC  '&IOCTOKEN(1)'       SET XVARIABLE           00150000
                     AIF   (N'&IOCTOKEN GT 1).ZG32B  MULTI              00150100
&XIOCTOKEN           SETC  '&IOCTOKEN'          SET XVARIABLE           00150200
.ZG32B               ANOP  ,                                            00150300
.*-------------------------------------------------------------------   00150400
.***AG.KCK02 NAME, OPT INOUT, KEYS -GPR OUT OF RANGE                    00150500
                     AIF   (K'&ZXIOCTOKEN LE 0).ZG32R  NOT I/O          00150600
         AIF   ('&XIOCTOKEN' EQ 'NONE').ZG32R                           00150700
                     AIF   ('&XIOCTOKEN'(1,1) NE '(').ZG32R             00150800
&ZCGPR               SETC  '&XIOCTOKEN'(2,K'&XIOCTOKEN-2)               00150900
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                 00151000
                     AIF   (K'&ZCGPR GT 2).ZG32Q                        00151100
                     AIF   ('&ZCGPR' EQ '0').ZG32Q                      00151200
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00151300
                     AIF   (T'&ZCGPR NE 'N').ZG32Q  INVALID REG NAME    00151400
.ZG32P               ANOP  ,                                            00151500
                     AIF   (T'&ZCGPR NE 'N').ZG32R  NON NUMERIC         00151600
                     AIF   ('&ZCGPR' LT '2').ZG32Q                      00151700
                     AIF   ('&ZCGPR' LE '12').ZG32R                     00151800
.ZG32Q               ANOP  ,                                            00151900
&ZMS                 SETC  '"IOCTOKEN='                                 00152000
&ZMS                 SETC  '&ZMS.&IOCTOKEN"'                            00152100
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00152200
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00152300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00152400
.ZG32R               ANOP  ,                                            00152500
.*----------------------------------------------------------------***   00152600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00152700
                     AIF   (N'&NODE_DESCRIPTOR LE 1).ZG35A  CK NUM      00152800
&ZMS                 SETC  '"NODE_DESCRIPTOR='                          00152900
&ZMS                 SETC  '&ZMS.&NODE_DESCRIPTOR"'                     00153000
&ZMS                 SETC  '&ZMS "NODE_DESCRIPTOR"'                     00153100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00153200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00153300
.ZG35A               ANOP  ,                                            00153400
.*-------------------------------------------------------------------   00153500
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00153600
&ZXNODE_DESCRIPTOR   SETC  'INPUT'     SET IN/OUTPUT                    00153700
&XNODE_DESCRIPTOR    SETC  '0'                                          00153800
                     AIF   (K'&NODE_DESCRIPTOR(1) LE 0).ZG35B  PARM     00153900
&XNODE_DESCRIPTOR    SETC  '&NODE_DESCRIPTOR(1)'  SET XVARIABLE         00154000
                     AIF   (N'&NODE_DESCRIPTOR GT 1).ZG35B  MULTI       00154100
&XNODE_DESCRIPTOR    SETC  '&NODE_DESCRIPTOR'   SET XVARIABLE           00154200
.ZG35B               ANOP  ,                                            00154300
.*-------------------------------------------------------------------   00154400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00154500
                     AIF   (K'&ZXNODE_DESCRIPTOR LE 0).ZG35R  NOT I/O   00154600
                     AIF   ('&XNODE_DESCRIPTOR'(1,1) NE '(').ZG35R      00154700
&ZCGPR               SETC  '&XNODE_DESCRIPTOR'(2,K'&XNODE_DESCRIPTOR-2) 00154800
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                 00154900
                     AIF   (K'&ZCGPR GT 2).ZG35Q                        00155000
                     AIF   ('&ZCGPR' EQ '0').ZG35Q                      00155100
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00155200
                     AIF   (T'&ZCGPR NE 'N').ZG35Q  INVALID REG NAME    00155300
.ZG35P               ANOP  ,                                            00155400
                     AIF   (T'&ZCGPR NE 'N').ZG35R  NON NUMERIC         00155500
                     AIF   ('&ZCGPR' LT '2').ZG35Q                      00155600
                     AIF   ('&ZCGPR' LE '12').ZG35R                     00155700
.ZG35Q               ANOP  ,                                            00155800
&ZMS                 SETC  '"NODE_DESCRIPTOR='                          00155900
&ZMS                 SETC  '&ZMS.&NODE_DESCRIPTOR"'                     00156000
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00156100
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00156200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00156300
.ZG35R               ANOP  ,                                            00156400
.*----------------------------------------------------------------***   00156500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00156600
                     AIF   (N'&WWPN LE 1).ZG38A  CK NUM                 00156700
&ZMS                 SETC  '"WWPN='                                     00156800
&ZMS                 SETC  '&ZMS.&WWPN"'                                00156900
&ZMS                 SETC  '&ZMS "WWPN"'                                00157000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00157100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00157200
.ZG38A               ANOP  ,                                            00157300
.*-------------------------------------------------------------------   00157400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00157500
                     AIF   (K'&WWPN(1) LE 0).ZG38C  NO PARM             00157600
&ZXWWPN              SETC  'OUTPUT'    SET OUTPUT                       00157700
&XWWPN               SETC  '&WWPN(1)'  SET XVARIABLE                    00157800
                     AIF   (N'&WWPN GT 1).ZG38C                         00157900
&XWWPN               SETC  '&WWPN'     SET XVARIABLE                    00158000
.ZG38C               ANOP  ,                                            00158100
.*-------------------------------------------------------------------   00158200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00158300
                     AIF   (K'&ZXWWPN LE 0).ZG38R  NOT I/O              00158400
                     AIF   ('&XWWPN'(1,1) NE '(').ZG38R                 00158500
&ZCGPR               SETC  '&XWWPN'(2,K'&XWWPN-2)                       00158600
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                 00158700
                     AIF   (K'&ZCGPR GT 2).ZG38Q                        00158800
                     AIF   ('&ZCGPR' EQ '0').ZG38Q                      00158900
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00159000
                     AIF   (T'&ZCGPR NE 'N').ZG38Q  INVALID REG NAME    00159100
.ZG38P               ANOP  ,                                            00159200
                     AIF   (T'&ZCGPR NE 'N').ZG38R  NON NUMERIC         00159300
                     AIF   ('&ZCGPR' LT '2').ZG38Q                      00159400
                     AIF   ('&ZCGPR' LE '12').ZG38R                     00159500
.ZG38Q               ANOP  ,                                            00159600
&ZMS                 SETC  '"WWPN='                                     00159700
&ZMS                 SETC  '&ZMS.&WWPN"'                                00159800
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00159900
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00160000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00160100
.ZG38R               ANOP  ,                                            00160200
.*----------------------------------------------------------------***   00160300
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00160400
                     AIF   (N'&LINKAGE LE 1).ZG41A  CK NUM              00160500
&ZMS                 SETC  '"LINKAGE='                                  00160600
&ZMS                 SETC  '&ZMS.&LINKAGE"'                             00160700
&ZMS                 SETC  '&ZMS "LINKAGE"'                             00160800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00160900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00161000
.ZG41A               ANOP  ,                                            00161100
.*-------------------------------------------------------------------   00161200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00161300
&XLINKAGE            SETC  ''          INITIALIZE XVARIABLE             00161400
.ZG42A   AIF   ('&LINKAGE(1)' NE 'LINK').ZG43A                          00161500
&XLINKAGE            SETC  'LINK'      SET KEYWORD                      00161600
.*-------------------------------------------------------------------   00161700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00161800
.ZG43A   AIF   ('&LINKAGE(1)' NE 'SYSTEM').ZG44A                        00161900
&XLINKAGE            SETC  'SYSTEM'    SET KEYWORD                      00162000
.*-------------------------------------------------------------------   00162100
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00162200
.ZG44A               AIF   (K'&XLINKAGE GT 0).ZG44C  KEYWORD            00162300
                     AIF   (K'&LINKAGE(1) LE 0).ZG44B                   00162400
&ZMS                 SETC  '"LINKAGE='                                  00162500
&ZMS                 SETC  '&ZMS.&LINKAGE"'                             00162600
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00162700
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00162800
&ZMS                 SETC  '&ZMS "LINK"'                                00162900
&ZMS                 SETC  '&ZMS OR "SYSTEM".'                          00163000
                     MNOTE 8,' &ZMS '                                   00163100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00163200
.ZG44B               ANOP  ,                                            00163300
&XLINKAGE            SETC  'LINK'      SET DEFAULT KEYWORD              00163400
.ZG44C               ANOP  ,                                            00163500
&ZXLINKAGE           SETC  'INPUT'     SET IN/OUTPUT                    00163600
.*----------------------------------------------------------------***   00163700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00163800
                     AIF   (N'&RETCODE LE 1).ZG46A  CK NUM              00163900
&ZMS                 SETC  '"RETCODE='                                  00164000
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00164100
&ZMS                 SETC  '&ZMS "RETCODE"'                             00164200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00164300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00164400
.ZG46A               ANOP  ,                                            00164500
.*-------------------------------------------------------------------   00164600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00164700
                     AIF   (K'&RETCODE(1) LE 0).ZG46C  NO PARM          00164800
&ZXRETCODE           SETC  'OUTPUT'    SET OUTPUT                       00164900
&XRETCODE            SETC  '&RETCODE(1)'        SET XVARIABLE           00165000
                     AIF   (N'&RETCODE GT 1).ZG46C                      00165100
&XRETCODE            SETC  '&RETCODE'  SET XVARIABLE                    00165200
.ZG46C               ANOP  ,                                            00165300
.*-------------------------------------------------------------------   00165400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00165500
                     AIF   (K'&ZXRETCODE LE 0).ZG46R  NOT I/O           00165600
                     AIF   ('&XRETCODE'(1,1) NE '(').ZG46R              00165700
&ZCGPR               SETC  '&XRETCODE'(2,K'&XRETCODE-2)                 00165800
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG46P                 00165900
                     AIF   (K'&ZCGPR GT 2).ZG46Q                        00166000
                     AIF   ('&ZCGPR' EQ '0').ZG46Q                      00166100
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00166200
                     AIF   (T'&ZCGPR NE 'N').ZG46Q  INVALID REG NAME    00166300
.ZG46P               ANOP  ,                                            00166400
                     AIF   (T'&ZCGPR NE 'N').ZG46R  NON NUMERIC         00166500
                     AIF   ('&ZCGPR' EQ '15').ZG46R                     00166600
                     AIF   ('&ZCGPR' LT '2').ZG46Q                      00166700
                     AIF   ('&ZCGPR' LE '12').ZG46R                     00166800
.ZG46Q               ANOP  ,                                            00166900
&ZMS                 SETC  '"RETCODE='                                  00167000
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00167100
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00167200
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'     00167300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00167400
.ZG46R               ANOP  ,                                            00167500
.*----------------------------------------------------------------***   00167600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00167700
                     AIF   (N'&RSNCODE LE 1).ZG49A  CK NUM              00167800
&ZMS                 SETC  '"RSNCODE='                                  00167900
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00168000
&ZMS                 SETC  '&ZMS "RSNCODE"'                             00168100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00168200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00168300
.ZG49A               ANOP  ,                                            00168400
.*-------------------------------------------------------------------   00168500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00168600
                     AIF   (K'&RSNCODE(1) LE 0).ZG49C  NO PARM          00168700
&ZXRSNCODE           SETC  'OUTPUT'    SET OUTPUT                       00168800
&XRSNCODE            SETC  '&RSNCODE(1)'        SET XVARIABLE           00168900
                     AIF   (N'&RSNCODE GT 1).ZG49C                      00169000
&XRSNCODE            SETC  '&RSNCODE'  SET XVARIABLE                    00169100
.ZG49C               ANOP  ,                                            00169200
.*-------------------------------------------------------------------   00169300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00169400
                     AIF   (K'&ZXRSNCODE LE 0).ZG49R  NOT I/O           00169500
                     AIF   ('&XRSNCODE'(1,1) NE '(').ZG49R              00169600
&ZCGPR               SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                 00169700
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG49P                 00169800
                     AIF   (K'&ZCGPR GT 2).ZG49Q                        00169900
                     AIF   ('&ZCGPR' EQ '0').ZG49R                      00170000
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00170100
                     AIF   (T'&ZCGPR NE 'N').ZG49Q  INVALID REG NAME    00170200
.ZG49P               ANOP  ,                                            00170300
                     AIF   (T'&ZCGPR NE 'N').ZG49R  NON NUMERIC         00170400
                     AIF   ('&ZCGPR' EQ '0').ZG49R                      00170500
                     AIF   ('&ZCGPR' LT '2').ZG49Q                      00170600
                     AIF   ('&ZCGPR' LE '12').ZG49R                     00170700
.ZG49Q               ANOP  ,                                            00170800
&ZMS                 SETC  '"RSNCODE='                                  00170900
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00171000
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00171100
                     MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'      00171200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00171300
.ZG49R               ANOP  ,                                            00171400
.******************************************************************     00171500
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00171600
.******************************************************************     00171700
                     ACTR  10000                                        00171800
.*----------------------------------------------------------------***   00171900
.***AH.P02 EXTRA POSITIONALS                                            00172000
                     AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS         00172100
                     AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL         00172200
                     AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL     00172300
                     AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL      00172400
.ZGLISTX1            ANOP  ,                                            00172500
&ZCVAL               SETC  ''          ERROR FIELD                      00172600
&ZAWRK               SETA  0           POSITIONAL NUMBER                00172700
.ZGLIST2             ANOP  ,                                            00172800
&ZAWRK               SETA  &ZAWRK+1    NEXT POSITIONAL                  00172900
                     AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE         00173000
&ZCVAL               SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA              00173100
                     AGO   .ZGLIST2                                     00173200
.*                                                                      00173300
.ZGLIST3             ANOP  ,                                            00173400
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA           00173500
&ZMS                 SETC  'POSITIONAL ARGUMENT(S),'                    00173600
&ZMS                 SETC  '&ZMS "&ZCVAL"'                              00173700
&ZMS                 SETC  '&ZMS CANNOT BE USED.'                       00173800
&ZMS                 SETC  '&ZMS NO POSITIONAL ARGUMENTS'               00173900
                     MNOTE 8,' &ZMS ARE ALLOWED.'                       00174000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00174100
.ZGLISTX             ANOP  ,                                            00174200
&ZASYSLNDX           SETA  0                                            00174300
.*-------------------------------------------------------------------   00174400
.***AG.MF04 MF=(SLE)                                                    00174500
.ZGMFX               ANOP  ,           END OF FULL SYNTAX CHECK         00174600
.*******************************************************************    00174700
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00174800
.*******************************************************************    00174900
                     AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED         00175000
.*******************************************************************    00175100
.***AE.01  START OF IOSCDR MACRO CODE                                   00175200
.*******************************************************************    00175300
                     LCLC  &M0M0001                 NAME                00175400
&M0M0001             SETC  '&XLABEL'                SET NAME            00175500
                     AIF   (K'&XLABEL NE 0).XLAB2                       00175600
&M0M0001             SETC  'M00M&SYSNDX'            DEFAULT NAME        00175700
.*                                                                      00175800
.XLAB2               ANOP  ,                                            00175900
                     AIF   ('&XMF' EQ 'L').XLAB3                        00176000
&M0M0001 DS    0H                             IOSCDR-2                  00176100
.XLAB3               ANOP  ,                                            00176200
.*******************************************************************    00176300
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00176400
.*******************************************************************    00176500
              PUSH  PRINT                                               00176600
                     AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON   00176700
                     PRINT OFF         ++ PR01                          00176800
                     AGO   .ZPRNTXX                                     00176900
.ZPRINTX             PRINT ON                                           00177000
.ZPRNTXX             ANOP  ,                                            00177100
.********************************************************************   00177200
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00177300
.********************************************************************   00177400
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00177500
                      LCLA  &ZOPN1         INVOCATION INDEX             00177600
                      LCLC  &ZOPL(4095)    LABEL                        00177700
                      LCLC  &ZOPO(4095)    OPERATION                    00177800
                      LCLC  &ZOPV(4095)    VALUE                        00177900
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00178000
.*                                                                      00178100
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00178200
.******************************************************************     00178300
.***AL.L10 IOSCDR FMT=LIST MF=S!L PARAMETERS                            00178400
.******************************************************************     00178500
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00178600
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00178700
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00178800
&XMFATTR              SETC  '0D'                                        00178900
.*                                                                      00179000
&ZOPN                 SETA  &ZOPN+1                                     00179100
&ZOPL(&ZOPN)          SETC  ' '                                         00179200
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00179300
&ZOPO(&ZOPN)          SETC  'B'                                         00179400
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00179500
                      AGO   .ZALVL6B                                    00179600
.ZALVL6A              ANOP                                              00179700
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00179800
&ZOPV(&ZOPN)          SETC  '4,8'                                       00179900
&ZOPN                 SETA  &ZOPN+1                                     00180000
&ZOPL(&ZOPN)          SETC  ' '                                         00180100
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00180200
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00180300
.ZALVL6B              ANOP                                              00180400
&ZOPD(&ZOPN)          SETC  '++ IOSCDR ARG PARMS'                       00180500
.*                                                                      00180600
&ZOPN                 SETA  &ZOPN+1                                     00180700
&ZOPL(&ZOPN)          SETC  ' '                                         00180800
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00180900
&ZOPV(&ZOPN)          SETC  '1'                                         00181000
&ZOPD(&ZOPN)          SETC  ' '                                         00181100
.*                                                                      00181200
.ZLMFSL2              ANOP  ,                                           00181300
.*-------------------------------------------------------------------   00181400
.***AM.L00  IOSCDR FMT=LIST name                                        00181500
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00181600
&ZOPN                 SETA &ZOPN+1                                      00181700
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00181800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00181900
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00182000
&ZOPD(&ZOPN)          SETC '++ IOSCDR NAME'                             00182100
.ZLMFSL2M             ANOP  ,                                           00182200
.*-------------------------------------------------------------------   00182300
.***AM.L01  IOSCDR FMT=LIST PARAMETERS                                  00182400
&ZOPN                 SETA &ZOPN+1                                      00182500
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00182600
&ZOPO(&ZOPN)          SETC 'DS'                                         00182700
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00182800
&ZOPD(&ZOPN)          SETC '++ IOSCDR PARM LIST'                        00182900
.*-------------------------------------------------------------------   00183000
.***AM.L02 XVERSION XL1                                                 00183100
&ZOPN                 SETA &ZOPN+1                                      00183200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00183300
&ZOPO(&ZOPN)          SETC 'DS'                                         00183400
&ZOPV(&ZOPN)          SETC 'XL1'                                        00183500
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00183600
.*-------------------------------------------------------------------   00183700
.***AM.L03 XKEYUSEDFLAGS BL.8                                           00183800
&ZOPN                 SETA &ZOPN+1                                      00183900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XKEYUSEDFLAGS'                    00184000
&ZOPO(&ZOPN)          SETC 'DS'                                         00184100
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00184200
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00184300
.*                                                                      00184400
&ZOPN                 SETA  &ZOPN+1                                     00184500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_TIME'                    00184600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00184700
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00184800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00184900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).TIME'                         00185000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00185100
.*                                                                      00185200
&ZOPN                 SETA  &ZOPN+1                                     00185300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_IOCTOKEN'                00185400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00185500
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00185600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00185700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).IOCTOKEN'                     00185800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00185900
.*                                                                      00186000
&ZOPN                 SETA  &ZOPN+1                                     00186100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_STATUS'                  00186200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00186300
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00186400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00186500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).STATUS'                       00186600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00186700
.*                                                                      00186800
&ZOPN                 SETA  &ZOPN+1                                     00186900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CDRSIZE'                 00187000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00187100
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00187200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00187300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CDRSIZE'                      00187400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00187500
.*                                                                      00187600
&ZOPN                 SETA  &ZOPN+1                                     00187700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREAD_IO'                        00187800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00187900
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00188000
&ZOPD(&ZOPN)          SETC  '++ XREAD.'                                 00188100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).IO'                           00188200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00188300
.*                                                                      00188400
&ZOPN                 SETA  &ZOPN+1                                     00188500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREAD_COND'                      00188600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00188700
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00188800
&ZOPD(&ZOPN)          SETC  '++ XREAD.'                                 00188900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).COND'                         00189000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00189100
.*                                                                      00189200
&ZOPN                 SETA  &ZOPN+1                                     00189300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREAD_NOIO'                      00189400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00189500
&ZOPV(&ZOPN)          SETC  'B''00000010'''                             00189600
&ZOPD(&ZOPN)          SETC  '++ XREAD.'                                 00189700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NOIO'                         00189800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00189900
.*                                                                      00190000
&ZOPN                 SETA  &ZOPN+1                                     00190100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_NODE_DESCRIPTOR'         00190200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00190300
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00190400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00190500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NODE_DESCRIPTOR'              00190600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00190700
.*-------------------------------------------------------------------   00190800
.***AM.L09  XDEVN XL2                                                   00190900
&ZOPN                 SETA &ZOPN+1                                      00191000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDEVN'                            00191100
&ZOPO(&ZOPN)          SETC 'DS'                                         00191200
&ZOPV(&ZOPN)          SETC 'XL2'                                        00191300
&ZOPD(&ZOPN)          SETC '++ &ZXDEVN '                                00191400
.*-------------------------------------------------------------------   00191500
.***AM.L09  XTIME CL8                                                   00191600
&ZOPN                 SETA &ZOPN+1                                      00191700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTIME'                            00191800
&ZOPO(&ZOPN)          SETC 'DS'                                         00191900
&ZOPV(&ZOPN)          SETC 'CL8'                                        00192000
&ZOPD(&ZOPN)          SETC '++ &ZXTIME '                                00192100
.*-------------------------------------------------------------------   00192200
.***AM.L09 ADDR XIOCTOKEN A                                             00192300
&ZOPN                 SETA &ZOPN+1                                      00192400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XIOCTOKEN_ADDR'                   00192500
&ZOPO(&ZOPN)          SETC 'DS'                                         00192600
&ZOPV(&ZOPN)          SETC 'A'                                          00192700
&ZOPD(&ZOPN)          SETC '++ &ZXIOCTOKEN ADDR'                        00192800
.*-------------------------------------------------------------------   00192900
.***AM.L09  XCDRAREA A                                                  00193000
&ZOPN                 SETA &ZOPN+1                                      00193100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCDRAREA'                         00193200
&ZOPO(&ZOPN)          SETC 'DS'                                         00193300
&ZOPV(&ZOPN)          SETC 'A'                                          00193400
&ZOPD(&ZOPN)          SETC '++ &ZXCDRAREA '                             00193500
.*-------------------------------------------------------------------   00193600
.***AM.L09  XCDRLEN F                                                   00193700
&ZOPN                 SETA &ZOPN+1                                      00193800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCDRLEN'                          00193900
&ZOPO(&ZOPN)          SETC 'DS'                                         00194000
&ZOPV(&ZOPN)          SETC 'F'                                          00194100
&ZOPD(&ZOPN)          SETC '++ &ZXCDRLEN '                              00194200
.*-------------------------------------------------------------------   00194300
.***AM.L09  XCDRSIZE F                                                  00194400
&ZOPN                 SETA &ZOPN+1                                      00194500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCDRSIZE'                         00194600
&ZOPO(&ZOPN)          SETC 'DS'                                         00194700
&ZOPV(&ZOPN)          SETC 'F'                                          00194800
&ZOPD(&ZOPN)          SETC '++ &ZXCDRSIZE '                             00194900
.*-------------------------------------------------------------------   00195000
.***AM.L09  XSTATUS BL.8                                                00195100
&ZOPN                 SETA &ZOPN+1                                      00195200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTATUS'                          00195300
&ZOPO(&ZOPN)          SETC 'DS'                                         00195400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00195500
&ZOPD(&ZOPN)          SETC '++ &ZXSTATUS '                              00195600
.*-------------------------------------------------------------------   00195700
.***AM.L09  XSCHSET XL1                                                 00195800
&ZOPN                 SETA &ZOPN+1                                      00195900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSCHSET'                          00196000
&ZOPO(&ZOPN)          SETC 'DS'                                         00196100
&ZOPV(&ZOPN)          SETC 'XL1'                                        00196200
&ZOPD(&ZOPN)          SETC '++ &ZXSCHSET '                              00196300
.*-------------------------------------------------------------------   00196400
.***AM.L09  XCHPID XL1                                                  00196500
&ZOPN                 SETA &ZOPN+1                                      00196600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCHPID'                           00196700
&ZOPO(&ZOPN)          SETC 'DS'                                         00196800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00196900
&ZOPD(&ZOPN)          SETC '++ &ZXCHPID '                               00197000
.*-------------------------------------------------------------------   00197100
.***AM.L03 XKEYUSEDFLAGS2 BL.8                                          00197200
&ZOPN                 SETA &ZOPN+1                                      00197300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XKEYUSEDFLAGS2'                   00197400
&ZOPO(&ZOPN)          SETC 'DS'                                         00197500
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00197600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00197700
.*                                                                      00197800
&ZOPN                 SETA  &ZOPN+1                                     00197900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_SCHSET'                  00198000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00198100
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00198200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00198300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SCHSET'                       00198400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00198500
.*                                                                      00198600
&ZOPN                 SETA  &ZOPN+1                                     00198700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_WWPN'                    00198800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00198900
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00199000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00199100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).WWPN'                         00199200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00199300
.*-------------------------------------------------------------------   00199400
.***AM.L09  XNODE_DESCRIPTOR A                                          00199500
&ZOPN                 SETA &ZOPN+1                                      00199600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNODE_DESCRIPTOR'                 00199700
&ZOPO(&ZOPN)          SETC 'DS'                                         00199800
&ZOPV(&ZOPN)          SETC 'A'                                          00199900
&ZOPD(&ZOPN)          SETC '++ &ZXNODE_DESCRIPTOR '                     00200000
.*-------------------------------------------------------------------   00200100
.***AM.MLM2 SAVED LOCATION COUNTER                                      00200200
                      AIF  (&XPLISTVER GE 2).ZL24LA                     00200300
                      AIF  ('&ZENDBASEPL' NE '').ZL24LA                 00200400
&ZENDBASEPL           SETC 'YES'                                        00200500
&ZOPN                 SETA &ZOPN+1                                      00200600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00200700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00200800
&ZOPV(&ZOPN)          SETC '*'                                          00200900
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00201000
.ZL24LA               ANOP  ,                                           00201100
.*-------------------------------------------------------------------   00201200
.***AM.LVER1                                                            00201300
                      AIF  (&XPLISTVER LT 2).ZL24L                      00201400
.*-------------------------------------------------------------------   00201500
.*-------------------------------------------------------------------   00201600
.***AM.L09  XWWPN BL.64                                                 00201700
&ZOPN                 SETA &ZOPN+1                                      00201800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XWWPN'                            00201900
&ZOPO(&ZOPN)          SETC 'DS'                                         00202000
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00202100
&ZOPD(&ZOPN)          SETC '++ &ZXWWPN '                                00202200
.*-------------------------------------------------------------------   00202300
.***AM.LVER2                                                            00202400
.ZL24L                ANOP  ,                                           00202500
.*-------------------------------------------------------------------   00202600
.*-------------------------------------------------------------------   00202700
.***AM.LVER1                                                            00202800
                      AIF  (&XPLISTVER LT 2).ZL25L                      00202900
.*-------------------------------------------------------------------   00203000
.*-------------------------------------------------------------------   00203100
.***AM.L09  XRESERVED1 CL8                                              00203200
&ZOPN                 SETA &ZOPN+1                                      00203300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       00203400
&ZOPO(&ZOPN)          SETC 'DS'                                         00203500
&ZOPV(&ZOPN)          SETC 'CL8'                                        00203600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00203700
.*-------------------------------------------------------------------   00203800
.***AM.LVER2                                                            00203900
.ZL25L                ANOP  ,                                           00204000
.*-------------------------------------------------------------------   00204100
.*-------------------------------------------------------------------   00204200
.***AM.L10 END OF IOSCDR LIST PARAMETERS                                00204300
&ZOPN                 SETA &ZOPN+1                                      00204400
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00204500
&ZOPO(&ZOPN)          SETC 'EQU'                                        00204600
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00204700
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00204800
.*                                                                      00204900
&ZOPN                 SETA &ZOPN+1                                      00205000
&ZOPL(&ZOPN)          SETC ' '                                          00205100
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00205200
&ZOPV(&ZOPN)          SETC '1'                                          00205300
&ZOPD(&ZOPN)          SETC ' '                                          00205400
.*-------------------------------------------------------------------   00205500
.***AL.L12 IOSCDR FMT=LIST MF=S!L PARAMETERS                            00205600
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00205700
.*                                                                      00205800
&ZOPN                 SETA  &ZOPN+1                                     00205900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00206000
&ZOPO(&ZOPN)          SETC  'DC'                                        00206100
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00206200
&ZOPD(&ZOPN)          SETC  '++ IOSCDR ARG PARMS'                       00206300
.*                                                                      00206400
.ZLMFSLX              ANOP  ,                                           00206500
.*-------------------------------------------------------------------   00206600
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00206700
&ZPLLEN               SETA 36                                           00206800
.*                                                                      00206900
                      AIF  (&XPLISTVER LT 2).ZLLEN2Z                    00207000
&ZPLLEN               SETA 52                                           00207100
.ZLLEN2Z              ANOP  ,                                           00207200
.*                                                                      00207300
.******************************************************************     00207400
.***AI.L01 IOSCDR FMT=LIST FILL IN PARAMETER AREA                       00207500
.******************************************************************     00207600
                      ACTR  10000                                       00207700
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00207800
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00207900
&ZCVAL                SETC  'LAE'          XAX MODE                     00208000
.ZIMFXA               ANOP ,                                            00208100
.*                                                                      00208200
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00208300
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00208400
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00208500
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00208600
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00208700
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00208800
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00208900
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00209000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00209100
&ZOPN                 SETA  &ZOPN+1                                     00209200
&ZOPL(&ZOPN)          SETC  ' '                                         00209300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00209400
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00209500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00209600
                      AGO   .ZIMFNX                                     00209700
.*                                                                      00209800
.ZIMFN2               ANOP ,                                            00209900
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00210000
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00210100
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00210200
&ZOPN                 SETA  &ZOPN+1                                     00210300
&ZOPL(&ZOPN)          SETC  ' '                                         00210400
&ZOPO(&ZOPN)          SETC  'LAE'                                       00210500
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00210600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00210700
                      AGO   .ZIMFNX                                     00210800
.ZIMFNX1              ANOP ,                                            00210900
&ZOPN                 SETA  &ZOPN+1                                     00211000
&ZOPL(&ZOPN)          SETC  ' '                                         00211100
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00211200
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00211300
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00211400
.ZIMFNX               ANOP ,                                            00211500
.********************************************************************   00211600
.***AI.L02 IOSCDR FMT=LIST INITIALIZE PARAMETER AREA                    00211700
.********************************************************************   00211800
.***AI.L03 MF=(SLE)                                                     00211900
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00212000
.*                                                                      00212100
&ZOPN                 SETA  &ZOPN+1                                     00212200
&ZOPL(&ZOPN)          SETC  ' '                                         00212300
&ZOPO(&ZOPN)          SETC  'XC'                                        00212400
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00212500
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00212600
.ZIMFLX               ANOP  ,                                           00212700
.*-------------------------------------------------------------------   00212800
.***AI.L04B XVERSION XL1                                                00212900
                      AIF   (&XPLISTVER EQ 0).ZIMFVZ                    00213000
&ZOPN                 SETA  &ZOPN+1                                     00213100
&ZOPL(&ZOPN)          SETC  ' '                                         00213200
&ZOPO(&ZOPN)          SETC  'MVI'                                       00213300
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00213400
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00213500
.ZIMFVZ               ANOP  ,                                           00213600
.*-------------------------------------------------------------------   00213700
.***AI.L05 XKEYUSEDFLAGS BL1                                            00213800
&ZW                   SETC  ''                                          00213900
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00214000
.*-------------------------------------------------------------------   00214100
.***AI.L08 XKEYUSEDFLAGS "TIME"                                         00214200
.***      BL1'1XXXXXXX'                                                 00214300
         AIF   ('&TIME' EQ '').ZI3A                                     00214400
&ZW                   SETC  '&ZW.1'                                     00214500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00214600
                      AGO   .ZI3C                                       00214700
.*                                                                      00214800
.ZI3A                 ANOP  ,                                           00214900
&ZW                   SETC  '&ZW.0'                                     00215000
.ZI3C                 ANOP  ,                                           00215100
.*-------------------------------------------------------------------   00215200
.***AI.L08 XKEYUSEDFLAGS "IOCTOKEN"                                     00215300
.***      BL1'X1XXXXXX'                                                 00215400
         AIF   ('&IOCTOKEN' EQ '').ZI4A                                 00215500
&ZW                   SETC  '&ZW.1'                                     00215600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00215700
                      AGO   .ZI4C                                       00215800
.*                                                                      00215900
.ZI4A                 ANOP  ,                                           00216000
&ZW                   SETC  '&ZW.0'                                     00216100
.ZI4C                 ANOP  ,                                           00216200
.*-------------------------------------------------------------------   00216300
.***AI.L08 XKEYUSEDFLAGS "STATUS"                                       00216400
.***      BL1'XX1XXXXX'                                                 00216500
         AIF   ('&STATUS' EQ '').ZI5A                                   00216600
&ZW                   SETC  '&ZW.1'                                     00216700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00216800
                      AGO   .ZI5C                                       00216900
.*                                                                      00217000
.ZI5A                 ANOP  ,                                           00217100
&ZW                   SETC  '&ZW.0'                                     00217200
.ZI5C                 ANOP  ,                                           00217300
.*-------------------------------------------------------------------   00217400
.***AI.L08 XKEYUSEDFLAGS "CDRSIZE"                                      00217500
.***      BL1'XXX1XXXX'                                                 00217600
         AIF   ('&CDRSIZE' EQ '').ZI6A                                  00217700
&ZW                   SETC  '&ZW.1'                                     00217800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00217900
                      AGO   .ZI6C                                       00218000
.*                                                                      00218100
.ZI6A                 ANOP  ,                                           00218200
&ZW                   SETC  '&ZW.0'                                     00218300
.ZI6C                 ANOP  ,                                           00218400
.*-------------------------------------------------------------------   00218500
.***AI.L08 XKEYUSEDFLAGS "IO"                                           00218600
.***      BL1'XXXX1XXX'                                                 00218700
         AIF   ('&XREAD' NE 'IO').ZI7A                                  00218800
&ZW                   SETC  '&ZW.1'                                     00218900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00219000
                      AGO   .ZI7C                                       00219100
.*                                                                      00219200
.ZI7A                 ANOP  ,                                           00219300
&ZW                   SETC  '&ZW.0'                                     00219400
.ZI7C                 ANOP  ,                                           00219500
.*-------------------------------------------------------------------   00219600
.***AI.L08 XKEYUSEDFLAGS "COND"                                         00219700
.***      BL1'XXXXX1XX'                                                 00219800
         AIF   ('&XREAD' NE 'COND').ZI8A                                00219900
&ZW                   SETC  '&ZW.1'                                     00220000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00220100
                      AGO   .ZI8C                                       00220200
.*                                                                      00220300
.ZI8A                 ANOP  ,                                           00220400
&ZW                   SETC  '&ZW.0'                                     00220500
.ZI8C                 ANOP  ,                                           00220600
.*-------------------------------------------------------------------   00220700
.***AI.L08 XKEYUSEDFLAGS "NOIO"                                         00220800
.***      BL1'XXXXXX1X'                                                 00220900
         AIF   ('&XREAD' NE 'NOIO').ZI9A                                00221000
&ZW                   SETC  '&ZW.1'                                     00221100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00221200
                      AGO   .ZI9C                                       00221300
.*                                                                      00221400
.ZI9A                 ANOP  ,                                           00221500
&ZW                   SETC  '&ZW.0'                                     00221600
.ZI9C                 ANOP  ,                                           00221700
.*-------------------------------------------------------------------   00221800
.***AI.L08 XKEYUSEDFLAGS "NODE_DESCRIPTOR"                              00221900
.***      BL1'XXXXXXX1'                                                 00222000
         AIF   ('&NODE_DESCRIPTOR' EQ '').ZI10A                         00222100
&ZW                   SETC  '&ZW.1'                                     00222200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00222300
                      AGO   .ZI10C                                      00222400
.*                                                                      00222500
.ZI10A                ANOP  ,                                           00222600
&ZW                   SETC  '&ZW.0'                                     00222700
.ZI10C                ANOP  ,                                           00222800
.*-------------------------------------------------------------------   00222900
.***AI.L11 XKEYUSEDFLAGS BL1                                            00223000
                      AIF   ('&ZCLNG' NE 'YES').ZI10E  ALL ZERO BITS    00223100
&ZOPN                 SETA  &ZOPN+1                                     00223200
&ZOPL(&ZOPN)          SETC  ' '                                         00223300
&ZOPO(&ZOPN)          SETC  'OI'                                        00223400
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00223500
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00223600
.ZI10E                ANOP  ,                                           00223700
.*-------------------------------------------------------------------   00223800
.***AI.L25  XDEVN XL2                                                   00223900
                      AIF   ('&ZXDEVN' EQ '').ZI11E                     00224000
                      AIF   ('&ZXDEVN' EQ 'OUTPUT').ZI11E               00224100
&ZCGPR                SETC  '&XDEVN'                                    00224200
.*                                                                      00224300
                      AIF   ('&XDEVN'(1,1) NE '(').ZI11B                00224400
&ZCGPR   SETC  '0('.'&XDEVN'(2,K'&XDEVN-2).')'                          00224500
                      AGO   .ZI11D                                      00224600
.ZI11B                ANOP  ,                                           00224700
.*                                                                      00224800
&ZC                   SETC  '&XDEVN'(1,1)                               00224900
                      AIF   (T'&ZC NE 'N').ZI11D                        00225000
&ZC                   SETC  '&XDEVN'                                    00225100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI11D               00225200
&ZCGPR                SETC  '=AL2(&XDEVN)'                              00225300
.*                                                                      00225400
.ZI11D                ANOP  ,                                           00225500
.*                                                                      00225600
&ZOPN                 SETA  &ZOPN+1                                     00225700
&ZOPL(&ZOPN)          SETC  ' '                                         00225800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00225900
&ZOPV(&ZOPN)          SETC  '2(2,1),&ZCGPR'                             00226000
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVN XDEVN'                          00226100
.*                                                                      00226200
.ZI11E                ANOP  ,                                           00226300
.*-------------------------------------------------------------------   00226400
.***AI.L25  XTIME CL8                                                   00226500
                      AIF   ('&ZXTIME' EQ '').ZI12E                     00226600
                      AIF   ('&ZXTIME' EQ 'OUTPUT').ZI12E               00226700
&ZCGPR                SETC  '&XTIME'                                    00226800
.*                                                                      00226900
                      AIF   ('&XTIME'(1,1) NE '(').ZI12B                00227000
&ZCGPR   SETC  '0('.'&XTIME'(2,K'&XTIME-2).')'                          00227100
                      AGO   .ZI12D                                      00227200
.ZI12B                ANOP  ,                                           00227300
.*                                                                      00227400
                      AIF   ('&TIME(1)' EQ '').ZI12I                    00227500
&ZC                   SETC  '5'                                         00227600
                      AIF   ('&XTIME' NE '&ZC').ZI12C                   00227700
.ZI12I                ANOP  ,                                           00227800
&ZCGPR                SETC  '=CL8''&XTIME'''                            00227900
.ZI12C                ANOP  ,                                           00228000
.*                                                                      00228100
.ZI12D                ANOP  ,                                           00228200
.*                                                                      00228300
&ZOPN                 SETA  &ZOPN+1                                     00228400
&ZOPL(&ZOPN)          SETC  ' '                                         00228500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00228600
&ZOPV(&ZOPN)          SETC  '4(8,1),&ZCGPR'                             00228700
&ZOPD(&ZOPN)          SETC  '++ &ZXTIME XTIME'                          00228800
.*                                                                      00228900
.ZI12E                ANOP  ,                                           00229000
.*-------------------------------------------------------------------   00229100
.***AI.L18 ADDR XIOCTOKEN A                                             00229200
         AIF   ('&XIOCTOKEN' NE 'NONE').ZI13                            00229300
&ZXIOCTOKEN           SETC  ''             RESET INPUT/OUTPUT           00229400
.ZI13                 ANOP  ,                                           00229500
.*-------------------------------------------------------------------   00229600
.***AI.L19 ADDR XIOCTOKEN A                                             00229700
                      AIF   ('&ZXIOCTOKEN' EQ '').ZI13H                 00229800
&ZCLNG                SETC  '&XIOCTOKEN'                                00229900
&ZCGPR                SETC  '14'                                        00230000
         AIF   ('&XIOCTOKEN'(1,1) EQ '(').ZI13F  IN GPR                 00230100
.*                                                                      00230200
&ZOPN                 SETA  &ZOPN+1                                     00230300
&ZOPL(&ZOPN)          SETC  ' '                                         00230400
&ZOPO(&ZOPN)          SETC  'LA'                                        00230500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00230600
&ZOPD(&ZOPN)          SETC  '++ &ZXIOCTOKEN XIOCTOKEN'                  00230700
.*                                                                      00230800
                      AGO   .ZI13G                                      00230900
.*                                                                      00231000
.ZI13F                ANOP  ,                                           00231100
&ZCGPR   SETC  '&XIOCTOKEN'(2,K'&XIOCTOKEN-2)                           00231200
.*                                                                      00231300
.ZI13G                ANOP  ,                                           00231400
.*                                                                      00231500
&ZOPN                 SETA  &ZOPN+1                                     00231600
&ZOPL(&ZOPN)          SETC  ' '                                         00231700
&ZOPO(&ZOPN)          SETC  'ST'                                        00231800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,12(,1)'                             00231900
&ZOPD(&ZOPN)          SETC  '++ &ZXIOCTOKEN XIOCTOKEN'                  00232000
.*                                                                      00232100
.ZI13H                ANOP  ,                                           00232200
.*-------------------------------------------------------------------   00232300
.***AI.L19  XCDRAREA A                                                  00232400
                      AIF   ('&ZXCDRAREA' EQ '').ZI14H                  00232500
&ZCLNG                SETC  '&XCDRAREA'                                 00232600
&ZCGPR                SETC  '14'                                        00232700
         AIF   ('&XCDRAREA'(1,1) EQ '(').ZI14F  IN GPR                  00232800
.*                                                                      00232900
&ZOPN                 SETA  &ZOPN+1                                     00233000
&ZOPL(&ZOPN)          SETC  ' '                                         00233100
&ZOPO(&ZOPN)          SETC  'LA'                                        00233200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00233300
&ZOPD(&ZOPN)          SETC  '++ &ZXCDRAREA XCDRAREA'                    00233400
.*                                                                      00233500
                      AGO   .ZI14G                                      00233600
.*                                                                      00233700
.ZI14F                ANOP  ,                                           00233800
&ZCGPR   SETC  '&XCDRAREA'(2,K'&XCDRAREA-2)                             00233900
.*                                                                      00234000
.ZI14G                ANOP  ,                                           00234100
.*                                                                      00234200
&ZOPN                 SETA  &ZOPN+1                                     00234300
&ZOPL(&ZOPN)          SETC  ' '                                         00234400
&ZOPO(&ZOPN)          SETC  'ST'                                        00234500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             00234600
&ZOPD(&ZOPN)          SETC  '++ &ZXCDRAREA XCDRAREA'                    00234700
.*                                                                      00234800
.ZI14H                ANOP  ,                                           00234900
.*-------------------------------------------------------------------   00235000
.***AI.L25  XCDRLEN F                                                   00235100
                      AIF   ('&ZXCDRLEN' EQ '').ZI15E                   00235200
                      AIF   ('&ZXCDRLEN' EQ 'OUTPUT').ZI15E             00235300
&ZCGPR                SETC  '&XCDRLEN'                                  00235400
.*                                                                      00235500
                      AIF   ('&XCDRLEN'(1,1) NE '(').ZI15B              00235600
&ZCGPR   SETC  '0('.'&XCDRLEN'(2,K'&XCDRLEN-2).')'                      00235700
                      AGO   .ZI15D                                      00235800
.ZI15B                ANOP  ,                                           00235900
.*                                                                      00236000
&ZC                   SETC  '&XCDRLEN'(1,1)                             00236100
                      AIF   (T'&ZC NE 'N').ZI15D                        00236200
&ZC                   SETC  '&XCDRLEN'                                  00236300
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI15D               00236400
&ZCGPR                SETC  '=AL4(&XCDRLEN)'                            00236500
.*                                                                      00236600
.ZI15D                ANOP  ,                                           00236700
.*                                                                      00236800
&ZOPN                 SETA  &ZOPN+1                                     00236900
&ZOPL(&ZOPN)          SETC  ' '                                         00237000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00237100
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            00237200
&ZOPD(&ZOPN)          SETC  '++ &ZXCDRLEN XCDRLEN'                      00237300
.*                                                                      00237400
.ZI15E                ANOP  ,                                           00237500
.*-------------------------------------------------------------------   00237600
.***AI.L18  XSTATUS XL1                                                 00237700
         AIF   ('&XSTATUS' NE 'NONE').ZI17                              00237800
&ZXSTATUS             SETC  ''             RESET INPUT/OUTPUT           00237900
.ZI17                 ANOP  ,                                           00238000
.*-------------------------------------------------------------------   00238100
.***AI.L25  XSTATUS XL1                                                 00238200
                      AIF   ('&ZXSTATUS' EQ '').ZI17E                   00238300
                      AIF   ('&ZXSTATUS' EQ 'OUTPUT').ZI17E             00238400
&ZCGPR                SETC  '&XSTATUS'                                  00238500
.*                                                                      00238600
                      AIF   ('&XSTATUS'(1,1) NE '(').ZI17B              00238700
&ZCGPR   SETC  '0('.'&XSTATUS'(2,K'&XSTATUS-2).')'                      00238800
                      AGO   .ZI17D                                      00238900
.ZI17B                ANOP  ,                                           00239000
.*                                                                      00239100
&ZC                   SETC  '&XSTATUS'(1,1)                             00239200
                      AIF   (T'&ZC NE 'N').ZI17D                        00239300
&ZC                   SETC  '&XSTATUS'                                  00239400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI17D               00239500
&ZCGPR                SETC  '=BL1''&XSTATUS'''                          00239600
.*                                                                      00239700
.ZI17D                ANOP  ,                                           00239800
.*                                                                      00239900
&ZOPN                 SETA  &ZOPN+1                                     00240000
&ZOPL(&ZOPN)          SETC  ' '                                         00240100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00240200
&ZOPV(&ZOPN)          SETC  '28(1,1),&ZCGPR'                            00240300
&ZOPD(&ZOPN)          SETC  '++ &ZXSTATUS XSTATUS'                      00240400
.*                                                                      00240500
.ZI17E                ANOP  ,                                           00240600
.*-------------------------------------------------------------------   00240700
.***AI.L25  XSCHSET XL1                                                 00240800
                      AIF   ('&ZXSCHSET' EQ '').ZI18E                   00240900
                      AIF   ('&ZXSCHSET' EQ 'OUTPUT').ZI18E             00241000
&ZCGPR                SETC  '&XSCHSET'                                  00241100
         AIF   ('&XSCHSET' EQ '0').ZI18E                                00241200
         AIF   ('&XSCHSET' EQ '0').ZI18E                                00241300
.*                                                                      00241400
                      AIF   ('&XSCHSET'(1,1) NE '(').ZI18B              00241500
&ZCGPR   SETC  '0('.'&XSCHSET'(2,K'&XSCHSET-2).')'                      00241600
                      AGO   .ZI18D                                      00241700
.ZI18B                ANOP  ,                                           00241800
.*                                                                      00241900
&ZC                   SETC  '&XSCHSET'(1,1)                             00242000
                      AIF   (T'&ZC NE 'N').ZI18D                        00242100
&ZC                   SETC  '&XSCHSET'                                  00242200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI18D               00242300
&ZCGPR                SETC  '=AL1(&XSCHSET)'                            00242400
.*                                                                      00242500
.ZI18D                ANOP  ,                                           00242600
.*                                                                      00242700
&ZOPN                 SETA  &ZOPN+1                                     00242800
&ZOPL(&ZOPN)          SETC  ' '                                         00242900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00243000
&ZOPV(&ZOPN)          SETC  '29(1,1),&ZCGPR'                            00243100
&ZOPD(&ZOPN)          SETC  '++ &ZXSCHSET XSCHSET'                      00243200
.*                                                                      00243300
.ZI18E                ANOP  ,                                           00243400
.*-------------------------------------------------------------------   00243500
.***AI.L25  XCHPID XL1                                                  00243600
                      AIF   ('&ZXCHPID' EQ '').ZI19E                    00243700
                      AIF   ('&ZXCHPID' EQ 'OUTPUT').ZI19E              00243800
&ZCGPR                SETC  '&XCHPID'                                   00243900
.*                                                                      00244000
                      AIF   ('&XCHPID'(1,1) NE '(').ZI19B               00244100
&ZCGPR   SETC  '0('.'&XCHPID'(2,K'&XCHPID-2).')'                        00244200
                      AGO   .ZI19D                                      00244300
.ZI19B                ANOP  ,                                           00244400
.*                                                                      00244500
&ZC                   SETC  '&XCHPID'(1,1)                              00244600
                      AIF   (T'&ZC NE 'N').ZI19D                        00244700
&ZC                   SETC  '&XCHPID'                                   00244800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI19D               00244900
&ZCGPR                SETC  '=AL1(&XCHPID)'                             00245000
.*                                                                      00245100
.ZI19D                ANOP  ,                                           00245200
.*                                                                      00245300
&ZOPN                 SETA  &ZOPN+1                                     00245400
&ZOPL(&ZOPN)          SETC  ' '                                         00245500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00245600
&ZOPV(&ZOPN)          SETC  '30(1,1),&ZCGPR'                            00245700
&ZOPD(&ZOPN)          SETC  '++ &ZXCHPID XCHPID'                        00245800
.*                                                                      00245900
.ZI19E                ANOP  ,                                           00246000
.*-------------------------------------------------------------------   00246100
.***AI.L05 XKEYUSEDFLAGS2 BL1                                           00246200
&ZW                   SETC  ''                                          00246300
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00246400
.*-------------------------------------------------------------------   00246500
.***AI.L08 XKEYUSEDFLAGS2 "SCHSET"                                      00246600
.***      BL1'1XXXXXXX'                                                 00246700
         AIF   ('&SCHSET' EQ '').ZI21A                                  00246800
&ZW                   SETC  '&ZW.1'                                     00246900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00247000
                      AGO   .ZI21C                                      00247100
.*                                                                      00247200
.ZI21A                ANOP  ,                                           00247300
&ZW                   SETC  '&ZW.0'                                     00247400
.ZI21C                ANOP  ,                                           00247500
.*-------------------------------------------------------------------   00247600
.***AI.L08 XKEYUSEDFLAGS2 "WWPN"                                        00247700
.***      BL1'X1XXXXXX'                                                 00247800
         AIF   ('&WWPN' EQ '').ZI22A                                    00247900
&ZW                   SETC  '&ZW.1000000'                               00248000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00248100
                      AGO   .ZI22C                                      00248200
.*                                                                      00248300
.ZI22A                ANOP  ,                                           00248400
&ZW                   SETC  '&ZW.0000000'                               00248500
.ZI22C                ANOP  ,                                           00248600
.*-------------------------------------------------------------------   00248700
.***AI.L11 XKEYUSEDFLAGS2 BL1                                           00248800
                      AIF   ('&ZCLNG' NE 'YES').ZI22E  ALL ZERO BITS    00248900
&ZOPN                 SETA  &ZOPN+1                                     00249000
&ZOPL(&ZOPN)          SETC  ' '                                         00249100
&ZOPO(&ZOPN)          SETC  'OI'                                        00249200
&ZOPV(&ZOPN)          SETC  '31(1),B''&ZW'''                            00249300
&ZOPD(&ZOPN)          SETC  '++ OUTPUT BL1'                             00249400
.ZI22E                ANOP  ,                                           00249500
.*-------------------------------------------------------------------   00249600
.***AI.L19  XNODE_DESCRIPTOR A                                          00249700
                      AIF   ('&ZXNODE_DESCRIPTOR' EQ '').ZI23H          00249800
&ZCLNG                SETC  '&XNODE_DESCRIPTOR'                         00249900
&ZCGPR                SETC  '14'                                        00250000
         AIF   ('&XNODE_DESCRIPTOR'(1,1) EQ '(').ZI23F  IN GPR          00250100
        AIF   ('&XNODE_DESCRIPTOR' EQ '0').ZI23H                        00250200
.*                                                                      00250300
.*                                                                      00250400
&ZOPN                 SETA  &ZOPN+1                                     00250500
&ZOPL(&ZOPN)          SETC  ' '                                         00250600
&ZOPO(&ZOPN)          SETC  'LA'                                        00250700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00250800
&ZOPD(&ZOPN)          SETC  '++ &ZXNODE_DESCRIPTOR XNODE_DESCRIPTOR'    00250900
.*                                                                      00251000
                      AGO   .ZI23G                                      00251100
.*                                                                      00251200
.ZI23F                ANOP  ,                                           00251300
&ZCGPR   SETC  '&XNODE_DESCRIPTOR'(2,K'&XNODE_DESCRIPTOR-2)             00251400
.*                                                                      00251500
.ZI23G                ANOP  ,                                           00251600
.*                                                                      00251700
&ZOPN                 SETA  &ZOPN+1                                     00251800
&ZOPL(&ZOPN)          SETC  ' '                                         00251900
&ZOPO(&ZOPN)          SETC  'ST'                                        00252000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,32(,1)'                             00252100
&ZOPD(&ZOPN)          SETC  '++ &ZXNODE_DESCRIPTOR XNODE_DESCRIPTOR'    00252200
.*                                                                      00252300
.ZI23H                ANOP  ,                                           00252400
.*-------------------------------------------------------------------   00252500
.***AI.LVER01                                                           00252600
                      AIF  (&XPLISTVER LT 2).ZI25Z                      00252700
.*-------------------------------------------------------------------   00252800
.***AI.LVER02                                                           00252900
.ZI25Z                ANOP  ,                                           00253000
.*-------------------------------------------------------------------   00253100
&ZOPN1                SETA &ZOPN                                        00253200
.*******************************************************************    00253300
.***  PROCESS IOSCDR OUTPUT PARAMETERS                                  00253400
.*******************************************************************    00253500
                      ACTR  10000                                       00253600
.*------------------------------------------------------------------    00253700
.***AO.L02 XCDRSIZE F                                                   00253800
         AIF   ('&ZXCDRSIZE' EQ 'OUTPUT').ZO16A  OUTPUT                 00253900
         AIF   ('&ZXCDRSIZE' NE 'INOUT').ZO16C  INOUT                   00254000
.ZO16A    AIF   ('&XCDRSIZE'(1,1) NE '(').ZO16B  ADDR IN GPR            00254100
&ZCGPR   SETC  '&XCDRSIZE'(2,K'&XCDRSIZE-2)                             00254200
&ZOPN                 SETA  &ZOPN+1                                     00254300
&ZOPL(&ZOPN)          SETC  ' '                                         00254400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00254500
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),24(1)'                         00254600
&ZOPD(&ZOPN)          SETC  '++ XCDRSIZE F'                             00254700
                      AGO   .ZO16C                                      00254800
.*                                                                      00254900
.ZO16B                ANOP  ,                                           00255000
&ZAWRK   SETA  K'&XCDRSIZE                                              00255100
         AIF   ('&XCDRSIZE'(&ZAWRK,1) NE ')').ZO16G                     00255200
&ZN      SETA  2                                                        00255300
.ZO16H    ANOP                                                          00255400
         AIF   (&ZN GE &ZAWRK).ZO16G                                    00255500
         AIF   ('&XCDRSIZE'(&ZN,1) NE '(').ZO16I                        00255600
&ZC      SETC  '&XCDRSIZE'(1,&ZN).'4'.','                               00255700
&ZC      SETC  '&ZC'.'&XCDRSIZE'(&ZN+1,&ZAWRK-&ZN).',24(1)'             00255800
         AGO   .ZO16J                                                   00255900
.ZO16I    ANOP                                                          00256000
&ZN      SETA  &ZN+1                                                    00256100
         AGO   .ZO16H                                                   00256200
.ZO16G    ANOP                                                          00256300
&ZC      SETC  '&XCDRSIZE.(4),24(1)'                                    00256400
.ZO16J    ANOP                                                          00256500
&ZOPN                 SETA  &ZOPN+1                                     00256600
&ZOPL(&ZOPN)          SETC  ' '                                         00256700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00256800
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00256900
&ZOPD(&ZOPN)          SETC  '++ XCDRSIZE F'                             00257000
.ZO16C                ANOP  ,                                           00257100
.*------------------------------------------------------------------    00257200
.***AO.L01 XSTATUS XL1                                                  00257300
        AIF   ('&XSTATUS' NE 'NONE').ZO17                               00257400
&ZXSTATUS             SETC  ''             RESET OUTPUT/INOUT           00257500
.ZO17                 ANOP  ,                                           00257600
.*------------------------------------------------------------------    00257700
.***AO.L02 XSTATUS XL1                                                  00257800
         AIF   ('&XSTATUS' NE 'NONE').ZO17D  CK DEF                     00257900
         AIF   ('&ZXSTATUS' NE 'OUTPUT').ZO17C  CK DEF                  00258000
.ZO17D                ANOP  ,                                           00258100
         AIF   ('&ZXSTATUS' EQ 'OUTPUT').ZO17A  OUTPUT                  00258200
         AIF   ('&ZXSTATUS' NE 'INOUT').ZO17C  INOUT                    00258300
.ZO17A    AIF   ('&XSTATUS'(1,1) NE '(').ZO17B  ADDR IN GPR             00258400
&ZCGPR   SETC  '&XSTATUS'(2,K'&XSTATUS-2)                               00258500
&ZOPN                 SETA  &ZOPN+1                                     00258600
&ZOPL(&ZOPN)          SETC  ' '                                         00258700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00258800
&ZOPV(&ZOPN)          SETC  '0(1,&ZCGPR),28(1)'                         00258900
&ZOPD(&ZOPN)          SETC  '++ XSTATUS XL1'                            00259000
                      AGO   .ZO17C                                      00259100
.*                                                                      00259200
.ZO17B                ANOP  ,                                           00259300
&ZAWRK   SETA  K'&XSTATUS                                               00259400
         AIF   ('&XSTATUS'(&ZAWRK,1) NE ')').ZO17G                      00259500
&ZN      SETA  2                                                        00259600
.ZO17H    ANOP                                                          00259700
         AIF   (&ZN GE &ZAWRK).ZO17G                                    00259800
         AIF   ('&XSTATUS'(&ZN,1) NE '(').ZO17I                         00259900
&ZC      SETC  '&XSTATUS'(1,&ZN).'1'.','                                00260000
&ZC      SETC  '&ZC'.'&XSTATUS'(&ZN+1,&ZAWRK-&ZN).',28(1)'              00260100
         AGO   .ZO17J                                                   00260200
.ZO17I    ANOP                                                          00260300
&ZN      SETA  &ZN+1                                                    00260400
         AGO   .ZO17H                                                   00260500
.ZO17G    ANOP                                                          00260600
&ZC      SETC  '&XSTATUS.(1),28(1)'                                     00260700
.ZO17J    ANOP                                                          00260800
&ZOPN                 SETA  &ZOPN+1                                     00260900
&ZOPL(&ZOPN)          SETC  ' '                                         00261000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00261100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00261200
&ZOPD(&ZOPN)          SETC  '++ XSTATUS XL1'                            00261300
.ZO17C                ANOP  ,                                           00261400
.*------------------------------------------------------------------    00261500
.***AO.LVER01                                                           00261600
                      AIF  (&XPLISTVER LT 2).ZO24Z  PLVER               00261700
.*------------------------------------------------------------------    00261800
.***AO.L02 XWWPN XL8                                                    00261900
         AIF   ('&ZXWWPN' EQ 'OUTPUT').ZO24A  OUTPUT                    00262000
         AIF   ('&ZXWWPN' NE 'INOUT').ZO24C  INOUT                      00262100
.ZO24A    AIF   ('&XWWPN'(1,1) NE '(').ZO24B  ADDR IN GPR               00262200
&ZCGPR   SETC  '&XWWPN'(2,K'&XWWPN-2)                                   00262300
&ZOPN                 SETA  &ZOPN+1                                     00262400
&ZOPL(&ZOPN)          SETC  ' '                                         00262500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00262600
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),36(1)'                         00262700
&ZOPD(&ZOPN)          SETC  '++ XWWPN XL8'                              00262800
                      AGO   .ZO24C                                      00262900
.*                                                                      00263000
.ZO24B                ANOP  ,                                           00263100
&ZAWRK   SETA  K'&XWWPN                                                 00263200
         AIF   ('&XWWPN'(&ZAWRK,1) NE ')').ZO24G                        00263300
&ZN      SETA  2                                                        00263400
.ZO24H    ANOP                                                          00263500
         AIF   (&ZN GE &ZAWRK).ZO24G                                    00263600
         AIF   ('&XWWPN'(&ZN,1) NE '(').ZO24I                           00263700
&ZC      SETC  '&XWWPN'(1,&ZN).'8'.','                                  00263800
&ZC      SETC  '&ZC'.'&XWWPN'(&ZN+1,&ZAWRK-&ZN).',36(1)'                00263900
         AGO   .ZO24J                                                   00264000
.ZO24I    ANOP                                                          00264100
&ZN      SETA  &ZN+1                                                    00264200
         AGO   .ZO24H                                                   00264300
.ZO24G    ANOP                                                          00264400
&ZC      SETC  '&XWWPN.(8),36(1)'                                       00264500
.ZO24J    ANOP                                                          00264600
&ZOPN                 SETA  &ZOPN+1                                     00264700
&ZOPL(&ZOPN)          SETC  ' '                                         00264800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00264900
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00265000
&ZOPD(&ZOPN)          SETC  '++ XWWPN XL8'                              00265100
.ZO24C                ANOP  ,                                           00265200
.*------------------------------------------------------------------    00265300
.***AO.LVER02                                                           00265400
.ZO24Z                ANOP  ,                                           00265500
.*******************************************************************    00265600
.***AO.X02  RETURN CODE PROCESSING                                      00265700
.*******************************************************************    00265800
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00265900
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00266000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00266100
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00266200
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00266300
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00266400
&ZOPN                 SETA  &ZOPN+1                                     00266500
&ZOPL(&ZOPN)          SETC  ' '                                         00266600
&ZOPO(&ZOPN)          SETC  'ST'                                        00266700
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00266800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00266900
                      AGO   .ZMRETX                                     00267000
.*                                                                      00267100
.ZMRET2               ANOP  ,                                           00267200
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00267300
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00267400
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00267500
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00267600
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00267700
&ZOPN                 SETA  &ZOPN+1                                     00267800
&ZOPL(&ZOPN)          SETC  ' '                                         00267900
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00268000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00268100
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00268200
.ZMRETX               ANOP  ,                                           00268300
.*******************************************************************    00268400
.***AO.X03  REASON CODE PROCESSING                                      00268500
.*******************************************************************    00268600
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00268700
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00268800
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00268900
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00269000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00269100
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00269200
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00269300
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00269400
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00269500
&ZOPN                 SETA  &ZOPN+1                                     00269600
&ZOPL(&ZOPN)          SETC  ' '                                         00269700
&ZOPO(&ZOPN)          SETC  'ST'                                        00269800
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00269900
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00270000
                      AGO   .ZMRSNX                                     00270100
.*                                                                      00270200
.ZMRSN2               ANOP  ,                                           00270300
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00270400
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00270500
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00270600
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00270700
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00270800
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00270900
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00271000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00271100
&ZOPN                 SETA  &ZOPN+1                                     00271200
&ZOPL(&ZOPN)          SETC  ' '                                         00271300
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00271400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00271500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00271600
.ZMRSNX               ANOP  ,                                           00271700
.*******************************************************************    00271800
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00271900
.*******************************************************************    00272000
.ZMFLX                ANOP  ,              MF=L PROCESSING              00272100
.*******************************************************************    00272200
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00272300
.*******************************************************************    00272400
                      ACTR  10000                                       00272500
.*                                                                      00272600
                      LCLA  &ZLC           COLUMN POSITION              00272700
                      LCLA  &ZOPX          LIST TABLE INDEX             00272800
                      LCLC  &ZLL           LABEL                        00272900
                      LCLC  &ZLOP          OPERATION                    00273000
                      LCLC  &ZLV           VALUE                        00273100
                      LCLC  &ZLD           DESCRIPTION                  00273200
.*                                                                      00273300
&ZOPX                 SETA  1                                           00273400
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00273500
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00273600
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00273700
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00273800
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00273900
                      AIF   (K'&ZLD LE 0).ZL5                           00274000
&ZLC                  SETA  35             COMMENT COLUMN               00274100
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00274200
&ZLC                  SETA  33             COMMMENT COLUMN              00274300
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00274400
&ZLV                  SETC  '&ZLV'.' '                                  00274500
                      AGO   .ZL3                                        00274600
.*                                                                      00274700
.ZL4                  ANOP  ,                                           00274800
&ZLV                  SETC  '&ZLV'.' '                                  00274900
.ZL5                  ANOP  ,                                           00275000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00275100
.*                                                                      00275200
&ZLL     &ZLOP &ZLV                                                     00275300
.*                                                                      00275400
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00275500
                      AGO   .ZL2           CONTINUE LOOPING             00275600
.*                                                                      00275700
.ZLX                  ANOP  ,                                           00275800
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00275900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00276000
.*********************************************************************  00276100
.*                                                                   *  00276200
.*  Branch or PC linkage                                             *  00276300
.*                                                                   *  00276400
.*********************************************************************  00276500
         AIF    ('&XLINKAGE' NE 'LINK').LNKPC1                          00276600
         LINK EP=IOSVCDRI      ++ LINK TO MODULE IOSVCDRI               00276700
         AGO   .DONE1                                                   00276800
.LNKPC1  ANOP                                                           00276900
         L     14,16(0,0)         ++ GET CVT ADDRESS                    00277000
         L     14,772(14,0)       ++ GET SFT ADDRESS                    00277100
.*********************************************************************  00277200
.*                                                                   *  00277300
.*  Get LX/EX for IOSCDR Service                                     *  00277400
.*                                                                   *  00277500
.*  Note: LX/EX is calculated by multiplying the PC number (112)     *  00277600
.*        times the length of a PC/AUTH table entry (4) and          *  00277700
.*        then subtracting 4.                                        *  00277800
.*                                                                   *  00277900
.*********************************************************************  00278000
         L     14,444(14,0)       ++ GET LX/EX FOR IOSCDR Service       00278100
         PC    0(14)              ++ PC TO IOSVCDRP                     00278200
.DONE1   ANOP                                                           00278300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00278400
.ZLINKX               ANOP  ,                                           00278500
.*******************************************************************    00278600
.***AP.X01  FORMAT GENERATED CODE                                       00278700
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00278800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00278900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00279000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00279100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00279200
                      AIF   (K'&ZLD LE 0).ZL51                          00279300
&ZLC                  SETA  35             COMMENT COLUMN               00279400
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00279500
&ZLC                  SETA  33             COMMENT COLUMN               00279600
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00279700
&ZLV                  SETC  '&ZLV'.' '                                  00279800
                      AGO   .ZL31                                       00279900
.*                                                                      00280000
.ZL41                 ANOP  ,                                           00280100
&ZLV                  SETC  '&ZLV'.' '                                  00280200
.ZL51                 ANOP  ,                                           00280300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00280400
.*                                                                      00280500
&ZLL     &ZLOP &ZLV                                                     00280600
.*                                                                      00280700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00280800
                      AGO   .ZL21          CONTINUE LOOPING             00280900
.*                                                                      00281000
.ZLX1                 ANOP  ,                                           00281100
.*******************************************************************    00281200
.***AP.X02  END OF IOSCDR MACRO                                         00281300
&ZIOSCDR              SETC  'YES'          SET IOSCDR USED              00281400
         POP   PRINT                                                    00281500
*                                            IOSCDR-2                   00281600
         SPACE 1                                                        00281700
.ZLX2                 ANOP  ,                                           00281800
         MEND                                                           00281900
**********************************************************************/ 00282000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00282100
*%IOSCDR: MACRO KEYS(DEVN,SCHSET,CHPID,CDRAREA,CDRLEN,CDRSIZE,READ,     00282200
*                 STATUS,TIME,IOCTOKEN,NODE_DESCRIPTOR,WWPN,LINKAGE,    00282300
*                 RETCODE,RSNCODE,PLISTVER,MF);                         00282400
*  ANS('?'!!MACLABEL!!' '!!'IOSCDRP '!!MACLIST!!                        00282500
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00282600
*%END IOSCDR;                                                           00282700

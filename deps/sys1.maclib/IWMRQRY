*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWMRQRY                               -02/22/21-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  WLM Workload Activity Query Service           * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 1993, 2021                         * 00001200
*                                                                     * 00001300
* STATUS= HBB77D0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      IWMRQRY is the interface reporting products should use to      * 00002100
*      obtain address space related general execution delays.         * 00002200
*      Enclave related information may optionally be requested.       * 00002300
*                                                                     * 00002400
*      The macro will complete the parameter list with caller         * 00002500
*      specified data and invoke a stacking, space switching PC       * 00002600
*      routine in the WLM address space.  Address space related data  * 00002700
*      collected will be aggregated on an address space basis, while  * 00002800
*      Enclave related data (if requested) will be aggregated by      * 00002900
*      Enclave.                                                       * 00003000
*                                                                     * 00003100
*      If a user does not know the size of the answer area required   * 00003200
*      by the service, he should code issue IWMRQRY with ANSLEN set   * 00003300
*      to zero.  The length of the answer area will be placed in      * 00003400
*      QRYLEN.                                                        * 00003500
*                                                                     * 00003600
*      The IWMRQRY macro is provided in list, execute, and standard   * 00003700
*      form.  The list form accepts no variable parameters and is     * 00003800
*      used only to reserve space for the parameter list.  The        * 00003900
*      standard form is provided for use with routines which do not   * 00004000
*      require reentrant code.  The execute form is provided for use  * 00004100
*      with the list format for reentrant routines.  The IWMRQRY      * 00004200
*      macro is provided in PL/AS and assembler formats.              * 00004300
*                                                                     * 00004400
*      The parameter list must be in the caller's primary address     * 00004500
*      space, or in a dataspace accesible by the current unit of      * 00004600
*      work's dispatchable unit access list (DUal).                   * 00004700
*                                                                     * 00004800
*01* EXTERNAL CLASSIFICATION:  PSPI                                   * 00004900
*                                                                     * 00005000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00005100
*                                                                     * 00005200
*01* ENVIRONMENT:                                                     * 00005300
*                                                                     * 00005400
*                                                                     * 00005500
*      Dispatchable unit mode: Task mode.                             * 00005600
*                                                                     * 00005700
*      Minimum authorization: Supervisor state or program key mask    * 00005800
*                        (PKM) allowing keys 0-7.                     * 00005900
*                                                                     * 00006000
*      AMODE:            31-bit.                                      * 00006100
*                                                                     * 00006200
*      ASC mode:         Primary or Access Register.  Any P,S,H.      * 00006300
*                                                                     * 00006400
*                        If in Access Register ASC mode, specify      * 00006500
*                        SYSSTATE ASCENV=AR before invoking this      * 00006600
*                        macro.                                       * 00006700
*                                                                     * 00006800
*      Interrupt status: Enabled for I/O and external interrupts.     * 00006900
*                                                                     * 00007000
*      Locks:            No locks held.                               * 00007100
*                                                                     * 00007200
*      Control parameters:     The caller of IWMRQRY must provide     * 00007300
*                        storage for an answer area mapped by         * 00007400
*                        IWMWRQAA.  This answer area may reside in    * 00007500
*                        the caller's primary address space, or in a  * 00007600
*                        dataspace accessible via the current unit of * 00007700
*                        work's dispatchable unit access list (DUal). * 00007800
*                                                                     * 00007900
*                                                                     * 00008000
*                                                                     * 00008100
*01* PROGRAMMING REQUIREMENTS:                                        * 00008200
*                                                                     * 00008300
*                                                                     * 00008400
*    1.  The macro CVT must be included to use this macro.            * 00008500
*                                                                     * 00008600
*    2.  The macro IWMYCON must be included to use this macro.        * 00008700
*                                                                     * 00008800
*    3.  The macro IWMPB must be in the library concatenation, since  * 00008900
*        it is included by IWMYCON.                                   * 00009000
*                                                                     * 00009100
*    4.  Note that the high order halfword of register 0, and the     * 00009200
*        reason code variable when specified, may be non-zero and     * 00009300
*        represents diagnostic data which is NOT part of the external * 00009400
*        interface.  The high order halfword should thus be excluded  * 00009500
*        from comparison with the reason code values described above. * 00009600
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 00009700
*        be used for this purpose.                                    * 00009800
*                                                                     * 00009900
*                                                                     * 00010000
*                                                                     * 00010100
*01* RESTRICTIONS:                                                    * 00010200
*                                                                     * 00010300
*                                                                     * 00010400
*    1.  This macro may not be used prior to the completion of WLM    * 00010500
*        address space initialization                                 * 00010600
*                                                                     * 00010700
*    2.  The caller cannot have an EUT FRR established.               * 00010800
*                                                                     * 00010900
*                                                                     * 00011000
*                                                                     * 00011100
*01* INPUT REGISTER INFORMATION:                                      * 00011200
*                                                                     * 00011300
*    Before issuing the IWMRQRY macro, the caller does not have to    * 00011400
*    place any information into any register unless using it in       * 00011500
*    register notation for a particular parameter, or using it as a   * 00011600
*    base register.                                                   * 00011700
*                                                                     * 00011800
*01* OUTPUT REGISTER INFORMATION:                                     * 00011900
*                                                                     * 00012000
*    When control returns to the caller, the GPRs contain:            * 00012100
*                                                                     * 00012200
*                                                                     * 00012300
*    REGISTER  CONTENTS                                               * 00012400
*                                                                     * 00012500
*    0         Reason code if GR15 return code is non-zero            * 00012600
*                                                                     * 00012700
*    1         Used as work registers by the system                   * 00012800
*                                                                     * 00012900
*    2-13      Unchanged                                              * 00013000
*                                                                     * 00013100
*    14        Used as a work register by the system                  * 00013200
*                                                                     * 00013300
*    15        Return code                                            * 00013400
*                                                                     * 00013500
*                                                                     * 00013600
*                                                                     * 00013700
*    When control returns to the caller, the ARs contain:             * 00013800
*                                                                     * 00013900
*                                                                     * 00014000
*    REGISTER  CONTENTS                                               * 00014100
*                                                                     * 00014200
*    0-1       Used as work registers by the system                   * 00014300
*                                                                     * 00014400
*    2-13      Unchanged                                              * 00014500
*                                                                     * 00014600
*    14-15     Used as work registers by the system                   * 00014700
*                                                                     * 00014800
*                                                                     * 00014900
*                                                                     * 00015000
*    Some callers depend on register contents remaining the same      * 00015100
*    before and after issuing a service.  If the system changes the   * 00015200
*    contents of registers on which the caller depends, the caller    * 00015300
*    must save them before issuing the service, and restore them      * 00015400
*    after the system returns control.                                * 00015500
*                                                                     * 00015600
*01* PERFORMANCE IMPLICATIONS:                                        * 00015700
*                                                                     * 00015800
*    None                                                             * 00015900
*                                                                     * 00016000
*01* SYNTAX:                                                          * 00016100
*                                                                     * 00016200
*Ýxlabel¨  IWMRQRY  Ð  INFO=ALL                                       * 00016300
*                   ¿ ,INFO=ONE                                       * 00016400
*                         ,ASID=xasid                                 * 00016500
*                   ÐÝ,ENCLAVES=NONE¨                                 * 00016600
*                   ÔÝ,ENCLAVES=ALL¨                                  * 00016700
*                   ¿Ý,ENCLAVES=ONE                                   * 00016800
*                         ,ETOKEN=xetoken¨                            * 00016900
*                     ,ANSAREA=xansarea                               * 00017000
*                     ,ANSLEN=xanslen                                 * 00017100
*                     ,QUERYLEN=xquerylen                             * 00017200
*                    Ý,RETCODE=xretcode¨                              * 00017300
*                    Ý,RSNCODE=xrsncode¨                              * 00017400
*                    Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨          * 00017500
*                   ÐÝ,MF=S¨                                          * 00017600
*                   ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                   * 00017700
*                   ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                     * 00017800
*                                                                     * 00017900
*                                                                     * 00018000
*      Where:                                                         * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*      Ýxlabel¨                                                       * 00018400
*          is an optional symbol, starting in column 1, that is the   * 00018500
*          name on the IWMRQRY macro invocation.  The name must       * 00018600
*          conform to the rules for an ordinary assembler language    * 00018700
*          symbol.                                                    * 00018800
*          DEFAULT: No name.                                          * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*      INFO=»ALL!ONEº                                                 * 00019400
*          is a required keyword input which indicates what           * 00019500
*          information the query service is to return                 * 00019600
*                                                                     * 00019700
*                                                                     * 00019800
*          INFO=ALL                                                   * 00019900
*              indicates that information for all address spaces      * 00020000
*              should be returned. The RQAE entries in the IWMWRQAA   * 00020100
*              area are returned as an array where each entry's index * 00020200
*              corresponds to the address space's ASID.               * 00020300
*                                                                     * 00020400
*          INFO=ONE                                                   * 00020500
*              indicates that address space information is requested  * 00020600
*              for a particular asid.                                 * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*              ASID=xasid                                             * 00021000
*                  is the name (RS-type), or address in register      * 00021100
*                  (2)-(12), of a required fullword input which       * 00021200
*                  contains the ASID of the address space to be       * 00021300
*                  queried.                                           * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*                                                                     * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*                                                                     * 00022000
*                                                                     * 00022100
*                                                                     * 00022200
*      ÝENCLAVES=»NONE!ALL!ONEº¨                                      * 00022300
*          is an optional keyword input which indicates whether       * 00022400
*          Enclave information is requested.                          * 00022500
*          DEFAULT: NONE                                              * 00022600
*                                                                     * 00022700
*                                                                     * 00022800
*          ÝENCLAVES=NONE¨                                            * 00022900
*              indicates that no Enclave information is requested.    * 00023000
*                                                                     * 00023100
*          ÝENCLAVES=ALL¨                                             * 00023200
*              indicates that information for all Enclaves should be  * 00023300
*              returned.                                              * 00023400
*                                                                     * 00023500
*          ÝENCLAVES=ONE                                              * 00023600
*              indicates that Enclave information is requested for a  * 00023700
*              particular Enclave.                                    * 00023800
*                                                                     * 00023900
*              This ENCLAVES=ONE keyword is only supported on OS/390  * 00024000
*              R4 or higher.                                          * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*              ETOKEN=xetoken¨                                        * 00024400
*                  is the name (RS-type), or address in register      * 00024500
*                  (2)-(12), of a required 8 character input which    * 00024600
*                  contains the Enclave token of the Enclave to be    * 00024700
*                  queried.                                           * 00024800
*                                                                     * 00024900
*                                                                     * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*                                                                     * 00025400
*                                                                     * 00025500
*                                                                     * 00025600
*      ANSAREA=xansarea                                               * 00025700
*          is the name (RS-type), or address in register (2)-(12), of * 00025800
*          a required character output that contains the address of a * 00025900
*          storage area to hold the information returned by IWMRQRY.  * 00026000
*          The answer area is defined by the IWMWRQAA macro. If the   * 00026100
*          length of the output area is insufficient, no data is      * 00026200
*          returned.                                                  * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*      ANSLEN=xanslen                                                 * 00026800
*          is the name (RS-type), or address in register (2)-(12), of * 00026900
*          a required fullword input which contains the length of the * 00027000
*          answer area.                                               * 00027100
*                                                                     * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*      QUERYLEN=xquerylen                                             * 00027600
*          is the name (RS-type), or address in register (2)-(12), of * 00027700
*          a required fullword output which contains the length of    * 00027800
*          the storage area required by the IWMRQRY service.  The     * 00027900
*          length of the area may change between invocations.         * 00028000
*                                                                     * 00028100
*                                                                     * 00028200
*                                                                     * 00028300
*                                                                     * 00028400
*      ÝRETCODE=xretcode¨                                             * 00028500
*          is the name (RS-type) of an optional fullword output       * 00028600
*          variable, or register (2)-(12) or (15), into which the     * 00028700
*          return code is to be copied from GPR 15.  If you specify   * 00028800
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00028900
*          the value will be left in GPR 15.                          * 00029000
*                                                                     * 00029100
*                                                                     * 00029200
*                                                                     * 00029300
*                                                                     * 00029400
*      ÝRSNCODE=xrsncode¨                                             * 00029500
*          is the name (RS-type) of an optional fullword output       * 00029600
*          variable into which the reason code is to be copied from   * 00029700
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00029800
*          R0 (within or without parentheses), the value will be left * 00029900
*          in GPR 0.                                                  * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00030500
*          is an optional byte input decimal value in the "0-1" range * 00030600
*          that specifies the macro version.  PLISTVER is the only    * 00030700
*          key allowed on the list form of MF and determines which    * 00030800
*          parameter list is generated.  The macro keys associated    * 00030900
*          with each supported version of the macro are listed in     * 00031000
*          MACRO USAGE NOTE 2.  Note that MAX may be specified        * 00031100
*          instead of a number, and the parameter list will be of the * 00031200
*          largest size currently supported. This size may grow from  * 00031300
*          release to release (thus possibly affecting the amount of  * 00031400
*          storage needed by your program).  If your program can      * 00031500
*          tolerate this, IBM recommends that you always specify MAX  * 00031600
*          when creating the list form parameter list as that will    * 00031700
*          ensure that the list form parameter list is always long    * 00031800
*          enough to hold whatever parameters might be specified on   * 00031900
*          the execute form.                                          * 00032000
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00032100
*          default is the lowest version which allows all of the      * 00032200
*          parameters specified on the invocation to be processed.    * 00032300
*                                                                     * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*                                                                     * 00032700
*      ÝMF=»S!L!Eº¨                                                   * 00032800
*          is an optional keyword input which specifies the macro     * 00032900
*          form.                                                      * 00033000
*          DEFAULT: S                                                 * 00033100
*                                                                     * 00033200
*                                                                     * 00033300
*          ÝMF=S¨                                                     * 00033400
*              specifies the standard form of the macro.  The "S"     * 00033500
*              form generates code to put the parameters into an      * 00033600
*              in-line parameter list and invoke the desired service. * 00033700
*              Full checking for required macro keys is done along    * 00033800
*              with supplying defaults for omitted optional           * 00033900
*              parameters.                                            * 00034000
*                                                                     * 00034100
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00034200
*              specifies the list form of the macro.  The "L" form    * 00034300
*              defines an area to be used for the parameter list.     * 00034400
*              Only the PLISTVER key may be specified on the          * 00034500
*              invocation.  All other macro parameters are flagged as * 00034600
*              errors.  If PLISTVER is not specified, the original    * 00034700
*              parameter list definition is used.                     * 00034800
*                                                                     * 00034900
*            ,xmfctrl                                                 * 00035000
*              is a required input.  It is the name of a storage area * 00035100
*              for the parameter list.                                * 00035200
*                                                                     * 00035300
*            »,xmfattr!0Dº                                            * 00035400
*              is an optional 60 character input string that varies   * 00035500
*              from 1 to 60 characters. Use it to force boundary      * 00035600
*              alignment of the parameter list. Use only 0F or 0D.    * 00035700
*              DEFAULT: 0D which forces the parameter list to a       * 00035800
*              doubleword boundary.                                   * 00035900
*                                                                     * 00036000
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00036100
*              specifies the execute form of the macro.  The "E" form * 00036200
*              generates code to put the parameters into the          * 00036300
*              parameter list specified by xmfctrl and provides full  * 00036400
*              syntax checking with default setting.                  * 00036500
*                                                                     * 00036600
*            ,xmfctrl                                                 * 00036700
*              is a required input.  It is the name (RS-type), or     * 00036800
*              address in register (1)-(12), of a storage area for    * 00036900
*              the parameter list.                                    * 00037000
*                                                                     * 00037100
*            »,COMPLETEº                                              * 00037200
*              is an optional keyword input which specifies the       * 00037300
*              degree of macro parameter syntax checking.             * 00037400
*              DEFAULT: COMPLETE                                      * 00037500
*                                                                     * 00037600
*                                                                     * 00037700
*              COMPLETE                                               * 00037800
*                  Checking for required macro keys is done and       * 00037900
*                  defaults are supplied for omitted optional         * 00038000
*                  parameters.                                        * 00038100
*                                                                     * 00038200
*                                                                     * 00038300
*                                                                     * 00038400
*                                                                     * 00038500
*                                                                     * 00038600
*                                                                     * 00038700
*                                                                     * 00038800
*01* RETURN CODES:                                                    * 00038900
*                                                                     * 00039000
*                                                                     * 00039100
*            0    Name: IwmRetCodeOk                                  * 00039200
*                                                                     * 00039300
*                 Meaning: Successful completion.                     * 00039400
*                                                                     * 00039500
*                 Action: None required.                              * 00039600
*                                                                     * 00039700
*            4    Name: IwmRetCodeWarning                             * 00039800
*                                                                     * 00039900
*                 Meaning: Successful completion, unusual conditions  * 00040000
*                 noted.                                              * 00040100
*                                                                     * 00040200
*                                                                     * 00040300
*                 HEX REASON  MEANING/ACTION                          * 00040400
*                 CODE                                                * 00040500
*                                                                     * 00040600
*                 xxxx0401    Name: IwmRsnCodeNoWLM                   * 00040700
*                                                                     * 00040800
*                             Meaning:  System does not support       * 00040900
*                             workload activity query services.  The  * 00041000
*                             query output area has not been          * 00041100
*                             modified.  This return code is set only * 00041200
*                             when the MVS release is prior to        * 00041300
*                             MVS/ESA SP5.1.0.                        * 00041400
*                                                                     * 00041500
*                             Action: None required.                  * 00041600
*                                                                     * 00041700
*                 xxxx040A    Name: IwmRsnCodeOutputAreaTooSmall      * 00041800
*                                                                     * 00041900
*                             Meaning:  The output area supplied is   * 00042000
*                             too small to receive all the available  * 00042100
*                             information.                            * 00042200
*                                                                     * 00042300
*                             Action: None required.  If necessary,   * 00042400
*                             reinvoke the service with an output     * 00042500
*                             area of sufficient size to receive all  * 00042600
*                             information.                            * 00042700
*                                                                     * 00042800
*                 xxxx042C    Name: IwmRsnCodeEtokenNoMatch           * 00042900
*                                                                     * 00043000
*                             Meaning: No Enclave information         * 00043100
*                             matching the input Enclave token was    * 00043200
*                             found.  Enclave related information is  * 00043300
*                             not returned.                           * 00043400
*                                                                     * 00043500
*                             Action:  None required.                 * 00043600
*                                                                     * 00043700
*                                                                     * 00043800
*                                                                     * 00043900
*            8    Name: IwmRetCodeInvocError                          * 00044000
*                                                                     * 00044100
*                 Meaning: Invalid invocation environment or          * 00044200
*                 parameters.                                         * 00044300
*                                                                     * 00044400
*                                                                     * 00044500
*                 HEX REASON  MEANING/ACTION                          * 00044600
*                 CODE                                                * 00044700
*                                                                     * 00044800
*                 xxxx0801    Name: IwmRsnCodeSrbMode                 * 00044900
*                                                                     * 00045000
*                             Meaning:  Caller is in SRB mode.        * 00045100
*                                                                     * 00045200
*                             Action: Avoid requesting this function  * 00045300
*                             while in SRB mode.                      * 00045400
*                                                                     * 00045500
*                 xxxx0803    Name: IwmRsnCodeDisabled                * 00045600
*                                                                     * 00045700
*                             Meaning: Caller is disabled.            * 00045800
*                                                                     * 00045900
*                             Action: Avoid requesting this function  * 00046000
*                             while disabled.                         * 00046100
*                                                                     * 00046200
*                 xxxx0804    Name: IwmRsnCodeLocked                  * 00046300
*                                                                     * 00046400
*                             Meaning: Caller is locked.              * 00046500
*                                                                     * 00046600
*                             Action: Avoid requesting this function  * 00046700
*                             while locked.                           * 00046800
*                                                                     * 00046900
*                 xxxx080B    Name: IwmRsnCodeBadPl                   * 00047000
*                                                                     * 00047100
*                             Meaning:  Error accessing parameter     * 00047200
*                             list.                                   * 00047300
*                                                                     * 00047400
*                             Action: Check for possible storage      * 00047500
*                             overlay.                                * 00047600
*                                                                     * 00047700
*                 xxxx0810    Name: IwmRsnCodeEutFrr                  * 00047800
*                                                                     * 00047900
*                             Meaning:  Caller has EUT FRR            * 00048000
*                             established.                            * 00048100
*                                                                     * 00048200
*                             Action: Avoid requesting this function  * 00048300
*                             with an EUT FRR set.                    * 00048400
*                                                                     * 00048500
*                 xxxx0812    Name: IwmRsnCodeBadAscb                 * 00048600
*                                                                     * 00048700
*                             Meaning:  The ASID value specified on   * 00048800
*                             the ASID keyword is invalid.            * 00048900
*                                                                     * 00049000
*                             Action: Check for possible storage      * 00049100
*                             overlay.                                * 00049200
*                                                                     * 00049300
*                 xxxx0828    Name: IwmRsnCodeBadVersion              * 00049400
*                                                                     * 00049500
*                             Meaning: Version number in parameter    * 00049600
*                             list is not valid or version length     * 00049700
*                             field is not valid.                     * 00049800
*                                                                     * 00049900
*                             Action: Check for possible storage      * 00050000
*                             overlay of the parameter list.          * 00050100
*                                                                     * 00050200
*                 xxxx0830    Name: IwmRsnCodeBadAlet                 * 00050300
*                                                                     * 00050400
*                             Meaning:  Caller has passed an invalid  * 00050500
*                             ALET.                                   * 00050600
*                                                                     * 00050700
*                             Action: Check for possible storage      * 00050800
*                             overlay of the parameter list or        * 00050900
*                             variable.                               * 00051000
*                                                                     * 00051100
*                                                                     * 00051200
*                                                                     * 00051300
*            C    Name: IwmRetCodeEnvError                            * 00051400
*                                                                     * 00051500
*                 Meaning: Environmental error.                       * 00051600
*                                                                     * 00051700
*                                                                     * 00051800
*                 HEX REASON  MEANING/ACTION                          * 00051900
*                 CODE                                                * 00052000
*                                                                     * 00052100
*                 xxxx0C01    Name: IwmRsnCodeNoStg                   * 00052200
*                                                                     * 00052300
*                             Meaning:  Storage is not available for  * 00052400
*                             the request.                            * 00052500
*                                                                     * 00052600
*                             Action: There is a storage shortage.    * 00052700
*                             The function may work successfully at a * 00052800
*                             later time.                             * 00052900
*                                                                     * 00053000
*                 xxxx0C0A    Name: IwmRsnCodeSuspended               * 00053100
*                                                                     * 00053200
*                             Meaning:  Data sampling is suspended as * 00053300
*                             a result of a component error.  No data * 00053400
*                             can be returned for this IWMRQRY        * 00053500
*                             invocation.                             * 00053600
*                                                                     * 00053700
*                             Action:  Reinvoke the function as it    * 00053800
*                             may be sucessful.                       * 00053900
*                                                                     * 00054000
*                 xxxx0C0B    Name: IwmRsnCodeStateChanged            * 00054100
*                                                                     * 00054200
*                             Meaning:  A state change (policy        * 00054300
*                             activation) occured while the data for  * 00054400
*                             the last sampling interval was being    * 00054500
*                             collected.  No data is returned for     * 00054600
*                             this invocation of IWMRQRY.             * 00054700
*                                                                     * 00054800
*                             Action:  The current sampling interval  * 00054900
*                             should be bypassed, future invocations  * 00055000
*                             of IWMRQRY for subsequent sampling      * 00055100
*                             intervals should begin returning data   * 00055200
*                             again.                                  * 00055300
*                                                                     * 00055400
*                                                                     * 00055500
*                                                                     * 00055600
*            10   Name: IwmRetCodeCompError                           * 00055700
*                                                                     * 00055800
*                 Meaning: Component error.                           * 00055900
*                                                                     * 00056000
*                 Action: No action required.  The function may be    * 00056100
*                 successful if invoked again.                        * 00056200
*                                                                     * 00056300
*                                                                     * 00056400
*                                                                     * 00056500
*                                                                     * 00056600
*01* REASON CODES:                                                    * 00056700
*                                                                     * 00056800
*       A unique reason code will be returned whenever the return     * 00056900
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00057000
*       under their corresponding return code.  Reason code and       * 00057100
*       return code constants are defined within IWMYCON.  Note that  * 00057200
*       the high order halfword of register 0, and the reason code    * 00057300
*       variable when specified, may be non-zero and represents       * 00057400
*       diagnostic data which is NOT part of the external interface.  * 00057500
*       The high order halfword should thus be excluded from          * 00057600
*       comparison with the reason code values described above.  The  * 00057700
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00057800
*       used for this purpose.                                        * 00057900
*                                                                     * 00058000
*01* MODULE TYPE:  ASSEM MACRO                                        * 00058100
*                                                                     * 00058200
*02*   PROCESSOR:  ASSEM                                              * 00058300
*                                                                     * 00058400
*01* COMPONENT:  SCWLM                                                * 00058500
*                                                                     * 00058600
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00058700
*                                                                     * 00058800
*01* MACRO USAGE NOTES:                                               * 00058900
*                                                                     * 00059000
*                                                                     * 00059100
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00059200
*        global macro variable.  Any value other than 'NO' will       * 00059300
*        result in the macro expansion being printed.  The default is * 00059400
*        'YES'.  The following examples illustrate how the ZPRINT     * 00059500
*        variable should be set.                                      * 00059600
*                                                                     * 00059700
*                    GBLC &ZPRINT                                     * 00059800
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00059900
*                                                                     * 00060000
*                                                                     * 00060100
*    2.  The  IWMRQRY macro supports multiple versions. The macro key * 00060200
*        list  below  contains the version level in which the key was * 00060300
*        first  introduced.  Positionals  are  identified by the word * 00060400
*        'Positional'  followed by the numeric value of its position. * 00060500
*        Nested  positionals  are  preceded  by their outer key.  The * 00060600
*        lowest value represents the original version and the highest * 00060700
*        value  represents  the  most  recent  version of the IWMRQRY * 00060800
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00060900
*        least  as high as the highest version number of all the keys * 00061000
*        being used.                                                  * 00061100
*                                                                     * 00061200
*        VERSION   KEY                                                * 00061300
*                                                                     * 00061400
*              0      ANSAREA                                         * 00061500
*                     ANSLEN                                          * 00061600
*                     ASID                                            * 00061700
*                     ENCLAVES                                        * 00061800
*                     INFO                                            * 00061900
*                     QUERYLEN                                        * 00062000
*              1      ETOKEN                                          * 00062100
*                                                                     * 00062200
*                                                                     * 00062300
*                                                                     * 00062400
*01* CHANGE ACTIVITY:                                                 * 00062500
*                                                                     * 00062600
*   Flag LineItem  FMID    Date   ID    Comment                       * 00062700
*                                                                     * 00062800
*    $L0=WLMI     HBB5510 921217 PDCR:  Workload Manager I            * 00062900
*    $P1=WLMI     HBB5510 940117 PDDA:  Change external               * 00063000
*                                         classification to PSPI      * 00063100
*    $P2=PIG5137  HBB5510 940301 PDCT:  Update descriptions for       * 00063200
*                                         ANSAREA keywords            * 00063300
*    $L1=ENCLV    HBB5520 940315 PD88BG:  Enclaves Support            * 00063400
*    $P3=PSY0500  JBB6604 970317 PDRK:  Single Enclave support        * 00063500
*    $P4=RFE      HBB77D0 210125 BKGE:  Update descriptions for       * 00063600
*                                         ANSAREA + INFO keywords and * 00063700
*                                         programming requirements    * 00063800
****** END OF SPECIFICATIONS *****************************************/ 00063900
*/********************************************************************* 00064000
         MACRO                                                          00064100
&XLABEL  IWMRQRY &INFO=,&ASID=,&ENCLAVES=,&ETOKEN=,&ANSAREA=,&ANSLEN=, *00064200
               &QUERYLEN=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=           00064300
.*                                                                      00064400
*              MACDATE -02/22/21-<1>                                    00064500
.*                                                                      00064600
.*******************************************************************    00064700
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00064800
.*******************************************************************    00064900
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00065000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00065100
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00065200
.*                                                                      00065300
              GBLC  &ZIWMRQRY   YES=MACRO USED AT LEAST ONCE            00065400
.*******************************************************************    00065500
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00065600
.*******************************************************************    00065700
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00065800
              LCLC  &ZCNDX      SYSNDX CHARACTERS                       00065900
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00066000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00066100
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00066200
              LCLA  &ZAWRK      USED AS A WORK AREA                     00066300
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00066400
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00066500
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00066600
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00066700
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00066800
              LCLC  &ZMAC_G     "G" or null                             00066900
&ZMAC_G       SETC  ''                                                  00067000
              LCLC  &ZMAC_LR                                            00067100
&ZMAC_LR      SETC  'LR'                                                00067200
              LCLC  &ZMAC_L                                             00067300
&ZMAC_L       SETC  'L'                                                 00067400
              LCLC  &ZMAC_ST                                            00067500
&ZMAC_ST      SETC  'ST'                                                00067600
              LCLC  &ZMAC_LLGT                                          00067700
&ZMAC_LLGT    SETC  'L'                                                 00067800
              LCLC  &ZMAC_LGR                                           00067900
&ZMAC_LGR     SETC  'LR'                                                00068000
              LCLC  &ZMAC_LG                                            00068100
&ZMAC_LG      SETC  'L'                                                 00068200
              LCLC  &ZMAC_STG                                           00068300
&ZMAC_STG     SETC  'ST'                                                00068400
              LCLA  &ZMACRET    MACRO RETURN CODE                       00068500
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00068600
.*                                                                      00068700
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00068800
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00068900
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00069000
              LCLC  &ZENDBASEPL                 End of base PL          00069100
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   00069200
.*******************************************************************    00069300
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00069400
.*******************************************************************    00069500
              LCLA  &ZI         INDEX FOR ARRAY                         00069600
              LCLA  &ZJ         INDEX FOR PARMS                         00069700
              LCLA  &ZK         INDEX FOR PARSE                         00069800
              LCLA  &ZLO        LOW RANGE VALUE                         00069900
              LCLA  &ZHI        HIGH RANGE VALUE                        00070000
              LCLC  &ZW         WORK AREA FOR PARM                      00070100
.********************************************************************   00070200
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00070300
.********************************************************************   00070400
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00070500
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00070600
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        00070700
              GBLC  &SYSAM64    SYSSTATE AMODE64                        00070800
.*                                                                      00070900
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00071000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00071100
              SPLEVEL  TEST                                             00071200
.ZSYS2        ANOP  ,                                                   00071300
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00071400
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00071500
              SYSSTATE TEST                                             00071600
              AGO   .ZSYS4                                              00071700
.ZSYS3        ANOP  ,                                                   00071800
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00071900
.ZSYS4        ANOP  ,                                                   00072000
              AIF   ('&SYSAM64' NE 'YES').ZSYSN64                       00072100
&ZMAC_LLGT    SETC 'LLGT'                                               00072200
&ZMAC_LGR     SETC 'LGR'                                                00072300
&ZMAC_LG      SETC 'LG'                                                 00072400
&ZMAC_STG     SETC 'STG'                                                00072500
.ZSYSN64      ANOP  ,                                                   00072600
.*******************************************************************    00072700
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00072800
.*******************************************************************    00072900
              LCLC  &XINFO      ++ VALUE                                00073000
              LCLC  &XASID      ++ NAME                                 00073100
              LCLC  &XENCLAVES  ++ VALUE                                00073200
              LCLC  &XETOKEN    ++ NAME                                 00073300
              LCLC  &XANSAREA   ++ NAME                                 00073400
              LCLC  &XANSLEN    ++ NAME                                 00073500
              LCLC  &XQUERYLEN  ++ NAME                                 00073600
              LCLC  &XRETCODE   ++ NAME                                 00073700
              LCLC  &XRSNCODE   ++ NAME                                 00073800
              LCLA  &XPLISTVER  ++ VALUE                                00073900
              LCLC  &XMF        ++ VALUE                                00074000
              LCLC  &XMFCTRL    ++ NAME                                 00074100
              LCLC  &XMFATTR    ++ VALUE                                00074200
              LCLC  &XMFSCK     ++ VALUE                                00074300
.*******************************************************************    00074400
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00074500
.*******************************************************************    00074600
              LCLC  &ZXINFO     ++ INPUT VALUE                          00074700
              LCLC  &ZXASID     ++ INPUT NAME                           00074800
              LCLC  &ZXENCLAVES                 ++ INPUT VALUE          00074900
              LCLC  &ZXETOKEN   ++ INPUT NAME                           00075000
              LCLC  &ZXANSAREA  ++ OUTPUT NAME                          00075100
              LCLC  &ZXANSLEN   ++ INPUT NAME                           00075200
              LCLC  &ZXQUERYLEN                 ++ OUTPUT NAME          00075300
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00075400
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00075500
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          00075600
              LCLC  &ZXMF       ++ INPUT VALUE                          00075700
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00075800
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00075900
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00076000
.********************************************************************   00076100
.***AC.PLV01  PROCESS PLISTVER                                      *   00076200
.********************************************************************   00076300
&XPLISTVER      SETA  0                                                 00076400
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00076500
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00076600
&XPLISTVER      SETA  1                                                 00076700
.ZPLV0          ANOP  ,                                                 00076800
.*                                                                      00076900
                AIF   ('&ETOKEN' EQ '').ZPLV1E                          00077000
                AIF   (&XPLISTVER GE 1).ZPLV1E                          00077100
&XPLISTVER      SETA  1                                                 00077200
.ZPLV1E         ANOP  ,                                                 00077300
.*                                                                      00077400
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00077500
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00077600
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00077700
.*-------------------------------------------------------------------   00077800
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00077900
&ZMS            SETC  '"PLISTVER='                                      00078000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00078100
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00078200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00078300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00078400
                AGO   .ZPVCK2                                           00078500
.ZPVCK3         ANOP  ,                                                 00078600
.*-------------------------------------------------------------------   00078700
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00078800
&ZMS            SETC  '"PLISTVER='                                      00078900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00079000
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00079100
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00079200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00079300
                AGO   .ZPVCKE                                           00079400
.ZPVCK2         ANOP  ,                                                 00079500
.*-------------------------------------------------------------------   00079600
&ZCVAL          SETC  '&PLISTVER(1)'                                    00079700
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00079800
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00079900
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00080000
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00080100
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00080200
.ZPVCK6         ANOP  ,                                                 00080300
&ZMS            SETC  '"PLISTVER='                                      00080400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00080500
&ZMS            SETC  '&ZMS THE RANGE IS "0-1"'                         00080600
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00080700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00080800
&XPLISTVER      SETA  1                                                 00080900
                AGO   .ZPVCKE                                           00081000
.*-------------------------------------------------------------------   00081100
.ZPVCK4A        ANOP  ,                                                 00081200
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00081300
&ZMS            SETC  'PLISTVER='                                       00081400
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00081500
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00081600
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00081700
                MNOTE 8,' &ZMS IS REQUIRED.'                            00081800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00081900
                AGO   .ZPVCK5                                           00082000
.ZPVCK4         ANOP  ,                                                 00082100
&XPLISTVER      SETA  &PLISTVER(1)                                      00082200
.ZPVCK5         ANOP  ,                                                 00082300
.ZPVCKE         ANOP  ,                                                 00082400
.********************************************************************   00082500
.***AG.MF01 PROCESS MF MACRO FORMS                                      00082600
.********************************************************************   00082700
              ACTR  10000                                               00082800
.*------------------------------------------------------------------    00082900
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00083000
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00083100
.*-------------------------------------------------------------------   00083200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00083300
.ZG38         ANOP  ,                                                   00083400
&ZTLC         SETC 'S'                                                  00083500
              AIF   ('&MF(1)' NE '&ZTLC').ZG39                          00083600
&XMF          SETC  'S'         SET KEYWORD                             00083700
              AIF   (N'&MF LE 1).ZG38A          CK NUM                  00083800
&ZMS          SETC  '"MF='                                              00083900
&ZMS          SETC  '&ZMS.&MF"'                                         00084000
&ZMS          SETC  '&ZMS "MF"'                                         00084100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00084200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00084300
.ZG38A        ANOP  ,                                                   00084400
.*-------------------------------------------------------------------   00084500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00084600
.ZG39         ANOP  ,                                                   00084700
&ZTLC         SETC 'L'                                                  00084800
              AIF   ('&MF(1)' NE '&ZTLC').ZG46                          00084900
&XMF          SETC  'L'         SET KEYWORD                             00085000
              AIF   (N'&MF LE 3).ZG39A          CK NUM                  00085100
&ZMS          SETC  '"MF='                                              00085200
&ZMS          SETC  '&ZMS.&MF"'                                         00085300
&ZMS          SETC  '&ZMS "MF"'                                         00085400
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00085500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00085600
.ZG39A        ANOP  ,                                                   00085700
.*-------------------------------------------------------------------   00085800
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00085900
              AIF   (N'&SYSLIST NE 0).ZG39B     POSITIONALS?            00086000
              AIF   ('&INFO' NE '').ZG39B       KEYS?                   00086100
              AIF   ('&ASID' NE '').ZG39B       KEYS?                   00086200
              AIF   ('&ENCLAVES' NE '').ZG39B   KEYS?                   00086300
              AIF   ('&ETOKEN' NE '').ZG39B     KEYS?                   00086400
              AIF   ('&ANSAREA' NE '').ZG39B    KEYS?                   00086500
              AIF   ('&ANSLEN' NE '').ZG39B     KEYS?                   00086600
              AIF   ('&QUERYLEN' NE '').ZG39B   KEYS?                   00086700
              AIF   ('&RETCODE' NE '').ZG39B    KEYS?                   00086800
              AIF   ('&RSNCODE' NE '').ZG39B    KEYS?                   00086900
              AGO    .ZG39C     INVOCATION OKAY                         00087000
.ZG39B        ANOP  ,                                                   00087100
&ZMS          SETC  'THE "L" FORM OF "MF"'                              00087200
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                00087300
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           00087400
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              00087500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00087600
.ZG39C        ANOP  ,                                                   00087700
.*-------------------------------------------------------------------   00087800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00087900
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00088000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00088100
              AIF   (N'&MF(2) GT 1).ZG41B       MULTI                   00088200
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00088300
.ZG41B        AIF   (K'&MF(2) GT 0).ZG41C                               00088400
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00088500
&ZMS          SETC  'WHEN "L" IS SPECIFIED'                             00088600
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00088700
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00088800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00088900
.ZG41C        ANOP  ,                                                   00089000
.*-------------------------------------------------------------------   00089100
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00089200
              AIF   (K'&ZXMFCTRL LE 0).ZG41P    NOT I/O                 00089300
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG41P                      00089400
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00089500
&ZMS          SETC  '"MF='                                              00089600
&ZMS          SETC  '&ZMS.&MF"'                                         00089700
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00089800
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00089900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00090000
.ZG41P        ANOP  ,                                                   00090100
.*-------------------------------------------------------------------   00090200
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00090300
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00090400
&XMFATTR      SETC  '0D'                                                00090500
              AIF   (K'&MF(3) LE 0).ZG44B       PARM                    00090600
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00090700
              AIF   (N'&MF(3) GT 1).ZG44B       MULTI                   00090800
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00090900
.ZG44B        ANOP  ,                                                   00091000
.*-------------------------------------------------------------------   00091100
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00091200
              AIF   (K'&ZXMFATTR LE 0).ZG44P    NOT I/O                 00091300
              AIF   ('&XMFATTR'(1,1) NE '(').ZG44P                      00091400
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00091500
&ZMS          SETC  '"MF='                                              00091600
&ZMS          SETC  '&ZMS.&MF"'                                         00091700
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00091800
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00091900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00092000
.ZG44P        ANOP  ,                                                   00092100
.*-------------------------------------------------------------------   00092200
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00092300
              AIF   (K'&ZXMFATTR LE 0).ZG44S    NOT I/O                 00092400
              AIF   (K'&XMFATTR LE 60).ZG44S    LNG OK                  00092500
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00092600
&ZMS          SETC  '"MF='                                              00092700
&ZMS          SETC  '&ZMS.&MF"'                                         00092800
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00092900
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00093000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00093100
.ZG44S        ANOP  ,                                                   00093200
.*-------------------------------------------------------------------   00093300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00093400
.ZG46         ANOP  ,                                                   00093500
&ZTLC         SETC 'E'                                                  00093600
              AIF   ('&MF(1)' NE '&ZTLC').ZG54                          00093700
&XMF          SETC  'E'         SET KEYWORD                             00093800
              AIF   (N'&MF LE 3).ZG46A          CK NUM                  00093900
&ZMS          SETC  '"MF='                                              00094000
&ZMS          SETC  '&ZMS.&MF"'                                         00094100
&ZMS          SETC  '&ZMS "MF"'                                         00094200
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00094300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00094400
.ZG46A        ANOP  ,                                                   00094500
.*-------------------------------------------------------------------   00094600
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00094700
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00094800
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00094900
              AIF   (N'&MF(2) GT 1).ZG48B       MULTI                   00095000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00095100
.ZG48B        AIF   (K'&MF(2) GT 0).ZG48C                               00095200
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00095300
&ZMS          SETC  'WHEN "E" IS SPECIFIED'                             00095400
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00095500
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00095600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00095700
.ZG48C        ANOP  ,                                                   00095800
.*-------------------------------------------------------------------   00095900
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00096000
              AIF   (K'&ZXMFCTRL LE 0).ZG48R    NOT I/O                 00096100
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG48R                      00096200
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00096300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG48P                        00096400
              AIF   (K'&ZCGPR GT 2).ZG48Q                               00096500
              AIF   ('&ZCGPR' EQ '0').ZG48Q                             00096600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00096700
              AIF   (T'&ZCGPR NE 'N').ZG48Q     INVALID REG NAME        00096800
.ZG48P        ANOP  ,                                                   00096900
              AIF   (T'&ZCGPR NE 'N').ZG48R     NON NUMERIC             00097000
              AIF   ('&ZCGPR' LT '1').ZG48Q                             00097100
              AIF   ('&ZCGPR' LE '12').ZG48R                            00097200
.ZG48Q        ANOP  ,                                                   00097300
&ZMS          SETC  '"MF='                                              00097400
&ZMS          SETC  '&ZMS.&MF"'                                         00097500
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00097600
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00097700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00097800
.ZG48R        ANOP  ,                                                   00097900
.*-------------------------------------------------------------------   00098000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00098100
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00098200
.ZG52A   AIF   ('&MF(3)' NE 'COMPLETE').ZG53A                           00098300
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00098400
.*-------------------------------------------------------------------   00098500
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00098600
.ZG53A        AIF   (K'&XMFSCK GT 0).ZG53C      KEYWORD                 00098700
              AIF   (K'&MF(3) LE 0).ZG53B                               00098800
&ZMS          SETC  '"MF='                                              00098900
&ZMS          SETC  '&ZMS.&MF"'                                         00099000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00099100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00099200
&ZMS          SETC  '&ZMS "COMPLETE".'                                  00099300
              MNOTE 8,' &ZMS '                                          00099400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00099500
.ZG53B        ANOP  ,                                                   00099600
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00099700
.ZG53C        ANOP  ,                                                   00099800
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00099900
.*------------------------------------------------------------------    00100000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00100100
.ZG54         ANOP  ,                                                   00100200
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00100300
              AIF   (K'&XMF GT 0).ZG54E         VALID ARG               00100400
              AIF   (T'&MF EQ 'O').ZG54D        OMITTED                 00100500
&ZASYSLNDX    SETA  0                                                   00100600
.ZG54A        ANOP  ,           POSITIONAL MACRO KEY                    00100700
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00100800
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG54C                    00100900
&ZTLC         SETC 'MF'                                                 00101000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG54A           00101100
.ZG54B        ANOP  ,                                                   00101200
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00101300
&ZMS          SETC  'THE "MF" KEY'                                      00101400
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00101500
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00101600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00101700
              AGO   .ZG54E                                              00101800
.ZG54C        ANOP  ,                                                   00101900
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00102000
&ZMS          SETC  '"MF='                                              00102100
&ZMS          SETC  '&ZMS.&MF"'                                         00102200
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00102300
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00102400
&ZMS          SETC  '&ZMS "S",'                                         00102500
&ZMS          SETC  '&ZMS "L",'                                         00102600
&ZMS          SETC  '&ZMS OR "E".'                                      00102700
              MNOTE 8,' &ZMS '                                          00102800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00102900
              AGO   .ZG54E                                              00103000
.ZG54D        ANOP  ,                                                   00103100
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00103200
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00103300
.ZG54E        ANOP  ,                                                   00103400
.********************************************************************   00103500
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00103600
.********************************************************************   00103700
              ACTR  10000                                               00103800
.*-------------------------------------------------------------------   00103900
.***AG.MF03 MF=(SLE)                                                    00104000
              AIF   ('&XMF' EQ 'L').ZGMFX                               00104100
.*------------------------------------------------------------------    00104200
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00104300
&XINFO        SETC  ''          INITIALIZE XVARIABLE                    00104400
.*-------------------------------------------------------------------   00104500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00104600
.ZG3          ANOP  ,                                                   00104700
              AIF   (K'&INFO(1) LE 0).ZG3A                              00104800
&ZTLC         SETC 'ALL'                                                00104900
              AIF   ('&INFO(1)' NE '&ZTLC').ZG4                         00105000
&XINFO        SETC  'ALL'       SET KEYWORD                             00105100
              AIF   (N'&INFO LE 1).ZG3A         CK NUM                  00105200
&ZMS          SETC  '"INFO='                                            00105300
&ZMS          SETC  '&ZMS.&INFO"'                                       00105400
&ZMS          SETC  '&ZMS "INFO"'                                       00105500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00105600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00105700
.ZG3A         ANOP  ,                                                   00105800
.*------------------------------------------------------------------    00105900
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00106000
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00106100
.ZG3A0        AIF   (K'&ASID LE 0).ZG3A1        OK                      00106200
&ZCVAL        SETC '&ZCVAL ASID'                INCORRECT KEY USED      00106300
.ZG3A1        AIF   (K'&ZCVAL LE 0).ZG3A2       OK                      00106400
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00106500
&ZMS          SETC  '"INFO'                                             00106600
&ZMS          SETC  '&ZMS.=&INFO"'                                      00106700
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00106800
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00106900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00107000
.ZG3A2        ANOP  ,                                                   00107100
.*-------------------------------------------------------------------   00107200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00107300
.ZG4          ANOP  ,                                                   00107400
&ZTLC         SETC 'ONE'                                                00107500
              AIF   ('&INFO(1)' NE '&ZTLC').ZG8                         00107600
&XINFO        SETC  'ONE'       SET KEYWORD                             00107700
              AIF   (N'&INFO LE 1).ZG4A         CK NUM                  00107800
&ZMS          SETC  '"INFO='                                            00107900
&ZMS          SETC  '&ZMS.&INFO"'                                       00108000
&ZMS          SETC  '&ZMS "INFO"'                                       00108100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00108200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00108300
.ZG4A         ANOP  ,                                                   00108400
.*----------------------------------------------------------------***   00108500
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00108600
              AIF   (N'&ASID LE 1).ZG6A         CK NUM                  00108700
&ZMS          SETC  '"ASID='                                            00108800
&ZMS          SETC  '&ZMS.&ASID"'                                       00108900
&ZMS          SETC  '&ZMS "ASID"'                                       00109000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00109100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00109200
.ZG6A         ANOP  ,                                                   00109300
.*-------------------------------------------------------------------   00109400
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00109500
&ZXASID       SETC  'INPUT'     SET IN/OUTPUT                           00109600
&XASID        SETC  '&ASID(1)'  SET XVARIABLE                           00109700
              AIF   (N'&ASID GT 1).ZG6B         MULTI                   00109800
&XASID        SETC  '&ASID'     SET XVARIABLE                           00109900
.ZG6B         AIF   (K'&ASID(1) GT 0).ZG6C                              00110000
&ZXASID       SETC  ''          RESET IN/OUTPUT                         00110100
&ZMS          SETC  ' '                                                 00110200
&ZMS          SETC  '&ZMS "ASID" KEY AND ITS'                           00110300
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00110400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00110500
.ZG6C         ANOP  ,                                                   00110600
.*-------------------------------------------------------------------   00110700
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00110800
              AIF   (K'&ZXASID LE 0).ZG6R       NOT I/O                 00110900
              AIF   ('&XASID'(1,1) NE '(').ZG6R                         00111000
&ZCGPR        SETC  '&XASID'(2,K'&XASID-2)                              00111100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                         00111200
              AIF   (K'&ZCGPR GT 2).ZG6Q                                00111300
              AIF   ('&ZCGPR' EQ '0').ZG6Q                              00111400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00111500
              AIF   (T'&ZCGPR NE 'N').ZG6Q      INVALID REG NAME        00111600
.ZG6P         ANOP  ,                                                   00111700
              AIF   (T'&ZCGPR NE 'N').ZG6R      NON NUMERIC             00111800
              AIF   ('&ZCGPR' LT '2').ZG6Q                              00111900
              AIF   ('&ZCGPR' LE '12').ZG6R                             00112000
.ZG6Q         ANOP  ,                                                   00112100
&ZMS          SETC  '"ASID='                                            00112200
&ZMS          SETC  '&ZMS.&ASID"'                                       00112300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00112400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00112500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00112600
.ZG6R         ANOP  ,                                                   00112700
.*------------------------------------------------------------------    00112800
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00112900
.ZG8          ANOP  ,                                                   00113000
&ZXINFO       SETC  'INPUT'     SET IN/OUTPUT                           00113100
              AIF   (K'&XINFO GT 0).ZG8E        VALID ARG               00113200
              AIF   (T'&INFO EQ 'O').ZG8D       OMITTED                 00113300
&ZASYSLNDX    SETA  0                                                   00113400
.ZG8A         ANOP  ,           POSITIONAL MACRO KEY                    00113500
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00113600
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG8C                     00113700
&ZTLC         SETC 'INFO'                                               00113800
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG8A            00113900
.ZG8B         ANOP  ,                                                   00114000
&ZXINFO       SETC  ''          RESET IN/OUTPUT                         00114100
&ZMS          SETC  'THE "INFO" KEY'                                    00114200
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00114300
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00114400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00114500
              AGO   .ZG8E                                               00114600
.ZG8C         ANOP  ,                                                   00114700
&ZXINFO       SETC  ''          RESET IN/OUTPUT                         00114800
&ZMS          SETC  '"INFO='                                            00114900
&ZMS          SETC  '&ZMS.&INFO"'                                       00115000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00115100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00115200
&ZMS          SETC  '&ZMS "ALL"'                                        00115300
&ZMS          SETC  '&ZMS OR "ONE".'                                    00115400
              MNOTE 8,' &ZMS '                                          00115500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00115600
              AGO   .ZG8E                                               00115700
.ZG8D         ANOP  ,                                                   00115800
&XINFO        SETC  'ALL'       SET DEFAULT KEYWORD                     00115900
.ZG8E         ANOP  ,                                                   00116000
.*------------------------------------------------------------------    00116100
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00116200
              AIF   (K'&INFO(1) GT 0).ZG8F      PARM                    00116300
&XINFO        SETC  ''          ENSURE NULL KEYWORD                     00116400
&ZXINFO       SETC  ''          RESET IN/OUTPUT                         00116500
&ZMS          SETC  'THE'                                               00116600
&ZMS          SETC  '&ZMS "INFO" KEY AND ITS'                           00116700
&ZMS          SETC  '&ZMS ARGUMENT ARE REQUIRED.'                       00116800
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00116900
&ZMS          SETC  '&ZMS "ALL"'                                        00117000
&ZMS          SETC  '&ZMS OR "ONE".'                                    00117100
              MNOTE 8,' &ZMS '                                          00117200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00117300
.ZG8F         ANOP  ,                                                   00117400
.*------------------------------------------------------------------    00117500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00117600
&XENCLAVES    SETC  ''          INITIALIZE XVARIABLE                    00117700
.*-------------------------------------------------------------------   00117800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00117900
.ZG11         ANOP  ,                                                   00118000
              AIF   (K'&ENCLAVES(1) LE 0).ZG11A                         00118100
&ZTLC         SETC 'NONE'                                               00118200
              AIF   ('&ENCLAVES(1)' NE '&ZTLC').ZG12                    00118300
&XENCLAVES    SETC  'NONE'      SET KEYWORD                             00118400
              AIF   (N'&ENCLAVES LE 1).ZG11A    CK NUM                  00118500
&ZMS          SETC  '"ENCLAVES='                                        00118600
&ZMS          SETC  '&ZMS.&ENCLAVES"'                                   00118700
&ZMS          SETC  '&ZMS "ENCLAVES"'                                   00118800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00118900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00119000
.ZG11A        ANOP  ,                                                   00119100
.*------------------------------------------------------------------    00119200
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00119300
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00119400
.ZG11A0       AIF   (K'&ETOKEN LE 0).ZG11A1     OK                      00119500
&ZCVAL        SETC '&ZCVAL ETOKEN'              INCORRECT KEY USED      00119600
.ZG11A1       AIF   (K'&ZCVAL LE 0).ZG11A2      OK                      00119700
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00119800
&ZMS          SETC  '"ENCLAVES'                                         00119900
&ZMS          SETC  '&ZMS.=&ENCLAVES"'                                  00120000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00120100
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00120200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00120300
.ZG11A2       ANOP  ,                                                   00120400
.*-------------------------------------------------------------------   00120500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00120600
.ZG12         ANOP  ,                                                   00120700
&ZTLC         SETC 'ALL'                                                00120800
              AIF   ('&ENCLAVES(1)' NE '&ZTLC').ZG13                    00120900
&XENCLAVES    SETC  'ALL'       SET KEYWORD                             00121000
              AIF   (N'&ENCLAVES LE 1).ZG12A    CK NUM                  00121100
&ZMS          SETC  '"ENCLAVES='                                        00121200
&ZMS          SETC  '&ZMS.&ENCLAVES"'                                   00121300
&ZMS          SETC  '&ZMS "ENCLAVES"'                                   00121400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00121500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00121600
.ZG12A        ANOP  ,                                                   00121700
.*------------------------------------------------------------------    00121800
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121900
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00122000
.ZG12A0       AIF   (K'&ETOKEN LE 0).ZG12A1     OK                      00122100
&ZCVAL        SETC '&ZCVAL ETOKEN'              INCORRECT KEY USED      00122200
.ZG12A1       AIF   (K'&ZCVAL LE 0).ZG12A2      OK                      00122300
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00122400
&ZMS          SETC  '"ENCLAVES'                                         00122500
&ZMS          SETC  '&ZMS.=&ENCLAVES"'                                  00122600
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00122700
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00122800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00122900
.ZG12A2       ANOP  ,                                                   00123000
.*-------------------------------------------------------------------   00123100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00123200
.ZG13         ANOP  ,                                                   00123300
&ZTLC         SETC 'ONE'                                                00123400
              AIF   ('&ENCLAVES(1)' NE '&ZTLC').ZG17                    00123500
&XENCLAVES    SETC  'ONE'       SET KEYWORD                             00123600
              AIF   (N'&ENCLAVES LE 1).ZG13A    CK NUM                  00123700
&ZMS          SETC  '"ENCLAVES='                                        00123800
&ZMS          SETC  '&ZMS.&ENCLAVES"'                                   00123900
&ZMS          SETC  '&ZMS "ENCLAVES"'                                   00124000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00124100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00124200
.ZG13A        ANOP  ,                                                   00124300
.*----------------------------------------------------------------***   00124400
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00124500
              AIF   (N'&ETOKEN LE 1).ZG15A      CK NUM                  00124600
&ZMS          SETC  '"ETOKEN='                                          00124700
&ZMS          SETC  '&ZMS.&ETOKEN"'                                     00124800
&ZMS          SETC  '&ZMS "ETOKEN"'                                     00124900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00125000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00125100
.ZG15A        ANOP  ,                                                   00125200
.*-------------------------------------------------------------------   00125300
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00125400
&ZXETOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00125500
&XETOKEN      SETC  '&ETOKEN(1)'                SET XVARIABLE           00125600
              AIF   (N'&ETOKEN GT 1).ZG15B      MULTI                   00125700
&XETOKEN      SETC  '&ETOKEN'   SET XVARIABLE                           00125800
.ZG15B        AIF   (K'&ETOKEN(1) GT 0).ZG15C                           00125900
&ZXETOKEN     SETC  ''          RESET IN/OUTPUT                         00126000
&ZMS          SETC  'WHEN "ONE" IS SPECIFIED'                           00126100
&ZMS          SETC  '&ZMS , "ETOKEN" KEY AND ITS'                       00126200
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00126300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00126400
.ZG15C        ANOP  ,                                                   00126500
.*-------------------------------------------------------------------   00126600
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00126700
              AIF   (K'&ZXETOKEN LE 0).ZG15R    NOT I/O                 00126800
              AIF   ('&XETOKEN'(1,1) NE '(').ZG15R                      00126900
&ZCGPR        SETC  '&XETOKEN'(2,K'&XETOKEN-2)                          00127000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG15P                        00127100
              AIF   (K'&ZCGPR GT 2).ZG15Q                               00127200
              AIF   ('&ZCGPR' EQ '0').ZG15Q                             00127300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00127400
              AIF   (T'&ZCGPR NE 'N').ZG15Q     INVALID REG NAME        00127500
.ZG15P        ANOP  ,                                                   00127600
              AIF   (T'&ZCGPR NE 'N').ZG15R     NON NUMERIC             00127700
              AIF   ('&ZCGPR' LT '2').ZG15Q                             00127800
              AIF   ('&ZCGPR' LE '12').ZG15R                            00127900
.ZG15Q        ANOP  ,                                                   00128000
&ZMS          SETC  '"ETOKEN='                                          00128100
&ZMS          SETC  '&ZMS.&ETOKEN"'                                     00128200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00128300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00128400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00128500
.ZG15R        ANOP  ,                                                   00128600
.*------------------------------------------------------------------    00128700
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00128800
.ZG17         ANOP  ,                                                   00128900
&ZXENCLAVES   SETC  'INPUT'     SET IN/OUTPUT                           00129000
              AIF   (K'&XENCLAVES GT 0).ZG17E   VALID ARG               00129100
              AIF   (T'&ENCLAVES EQ 'O').ZG17D  OMITTED                 00129200
&ZASYSLNDX    SETA  0                                                   00129300
.ZG17A        ANOP  ,           POSITIONAL MACRO KEY                    00129400
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00129500
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG17C                    00129600
&ZTLC         SETC 'ENCLAVES'                                           00129700
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG17A           00129800
.ZG17B        ANOP  ,                                                   00129900
&ZXENCLAVES   SETC  ''          RESET IN/OUTPUT                         00130000
&ZMS          SETC  'THE "ENCLAVES" KEY'                                00130100
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00130200
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00130300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00130400
              AGO   .ZG17E                                              00130500
.ZG17C        ANOP  ,                                                   00130600
&ZXENCLAVES   SETC  ''          RESET IN/OUTPUT                         00130700
&ZMS          SETC  '"ENCLAVES='                                        00130800
&ZMS          SETC  '&ZMS.&ENCLAVES"'                                   00130900
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00131000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00131100
&ZMS          SETC  '&ZMS "NONE",'                                      00131200
&ZMS          SETC  '&ZMS "ALL",'                                       00131300
&ZMS          SETC  '&ZMS OR "ONE".'                                    00131400
              MNOTE 8,' &ZMS '                                          00131500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00131600
              AGO   .ZG17E                                              00131700
.ZG17D        ANOP  ,                                                   00131800
&XENCLAVES    SETC  'NONE'      SET DEFAULT KEYWORD                     00131900
.ZG17E        ANOP  ,                                                   00132000
.*----------------------------------------------------------------***   00132100
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00132200
              AIF   (N'&ANSAREA LE 1).ZG19A     CK NUM                  00132300
&ZMS          SETC  '"ANSAREA='                                         00132400
&ZMS          SETC  '&ZMS.&ANSAREA"'                                    00132500
&ZMS          SETC  '&ZMS "ANSAREA"'                                    00132600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00132700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00132800
.ZG19A        ANOP  ,                                                   00132900
.*-------------------------------------------------------------------   00133000
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00133100
&ZXANSAREA    SETC  'OUTPUT'    SET IN/OUTPUT                           00133200
&XANSAREA     SETC  '&ANSAREA(1)'               SET XVARIABLE           00133300
              AIF   (N'&ANSAREA GT 1).ZG19B     MULTI                   00133400
&XANSAREA     SETC  '&ANSAREA'  SET XVARIABLE                           00133500
.ZG19B        AIF   (K'&ANSAREA(1) GT 0).ZG19C                          00133600
&ZXANSAREA    SETC  ''          RESET IN/OUTPUT                         00133700
&ZMS          SETC  ' '                                                 00133800
&ZMS          SETC  '&ZMS "ANSAREA" KEY AND ITS'                        00133900
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00134000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00134100
.ZG19C        ANOP  ,                                                   00134200
.*-------------------------------------------------------------------   00134300
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00134400
              AIF   (K'&ZXANSAREA LE 0).ZG19R   NOT I/O                 00134500
              AIF   ('&XANSAREA'(1,1) NE '(').ZG19R                     00134600
&ZCGPR        SETC  '&XANSAREA'(2,K'&XANSAREA-2)                        00134700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                        00134800
              AIF   (K'&ZCGPR GT 2).ZG19Q                               00134900
              AIF   ('&ZCGPR' EQ '0').ZG19Q                             00135000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00135100
              AIF   (T'&ZCGPR NE 'N').ZG19Q     INVALID REG NAME        00135200
.ZG19P        ANOP  ,                                                   00135300
              AIF   (T'&ZCGPR NE 'N').ZG19R     NON NUMERIC             00135400
              AIF   ('&ZCGPR' LT '2').ZG19Q                             00135500
              AIF   ('&ZCGPR' LE '12').ZG19R                            00135600
.ZG19Q        ANOP  ,                                                   00135700
&ZMS          SETC  '"ANSAREA='                                         00135800
&ZMS          SETC  '&ZMS.&ANSAREA"'                                    00135900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00136000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00136100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00136200
.ZG19R        ANOP  ,                                                   00136300
.*----------------------------------------------------------------***   00136400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00136500
              AIF   (N'&ANSLEN LE 1).ZG22A      CK NUM                  00136600
&ZMS          SETC  '"ANSLEN='                                          00136700
&ZMS          SETC  '&ZMS.&ANSLEN"'                                     00136800
&ZMS          SETC  '&ZMS "ANSLEN"'                                     00136900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00137000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00137100
.ZG22A        ANOP  ,                                                   00137200
.*-------------------------------------------------------------------   00137300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00137400
&ZXANSLEN     SETC  'INPUT'     SET IN/OUTPUT                           00137500
&XANSLEN      SETC  '&ANSLEN(1)'                SET XVARIABLE           00137600
              AIF   (N'&ANSLEN GT 1).ZG22B      MULTI                   00137700
&XANSLEN      SETC  '&ANSLEN'   SET XVARIABLE                           00137800
.ZG22B        AIF   (K'&ANSLEN(1) GT 0).ZG22C                           00137900
&ZXANSLEN     SETC  ''          RESET IN/OUTPUT                         00138000
&ZMS          SETC  ' '                                                 00138100
&ZMS          SETC  '&ZMS "ANSLEN" KEY AND ITS'                         00138200
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00138300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00138400
.ZG22C        ANOP  ,                                                   00138500
.*-------------------------------------------------------------------   00138600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00138700
              AIF   (K'&ZXANSLEN LE 0).ZG22R    NOT I/O                 00138800
              AIF   ('&XANSLEN'(1,1) NE '(').ZG22R                      00138900
&ZCGPR        SETC  '&XANSLEN'(2,K'&XANSLEN-2)                          00139000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                        00139100
              AIF   (K'&ZCGPR GT 2).ZG22Q                               00139200
              AIF   ('&ZCGPR' EQ '0').ZG22Q                             00139300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00139400
              AIF   (T'&ZCGPR NE 'N').ZG22Q     INVALID REG NAME        00139500
.ZG22P        ANOP  ,                                                   00139600
              AIF   (T'&ZCGPR NE 'N').ZG22R     NON NUMERIC             00139700
              AIF   ('&ZCGPR' LT '2').ZG22Q                             00139800
              AIF   ('&ZCGPR' LE '12').ZG22R                            00139900
.ZG22Q        ANOP  ,                                                   00140000
&ZMS          SETC  '"ANSLEN='                                          00140100
&ZMS          SETC  '&ZMS.&ANSLEN"'                                     00140200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00140300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00140400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00140500
.ZG22R        ANOP  ,                                                   00140600
.*----------------------------------------------------------------***   00140700
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00140800
              AIF   (N'&QUERYLEN LE 1).ZG25A    CK NUM                  00140900
&ZMS          SETC  '"QUERYLEN='                                        00141000
&ZMS          SETC  '&ZMS.&QUERYLEN"'                                   00141100
&ZMS          SETC  '&ZMS "QUERYLEN"'                                   00141200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00141300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00141400
.ZG25A        ANOP  ,                                                   00141500
.*-------------------------------------------------------------------   00141600
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00141700
&ZXQUERYLEN   SETC  'OUTPUT'    SET IN/OUTPUT                           00141800
&XQUERYLEN    SETC  '&QUERYLEN(1)'              SET XVARIABLE           00141900
              AIF   (N'&QUERYLEN GT 1).ZG25B    MULTI                   00142000
&XQUERYLEN    SETC  '&QUERYLEN'                 SET XVARIABLE           00142100
.ZG25B        AIF   (K'&QUERYLEN(1) GT 0).ZG25C                         00142200
&ZXQUERYLEN   SETC  ''          RESET IN/OUTPUT                         00142300
&ZMS          SETC  ' '                                                 00142400
&ZMS          SETC  '&ZMS "QUERYLEN" KEY AND ITS'                       00142500
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00142600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00142700
.ZG25C        ANOP  ,                                                   00142800
.*-------------------------------------------------------------------   00142900
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00143000
              AIF   (K'&ZXQUERYLEN LE 0).ZG25R  NOT I/O                 00143100
              AIF   ('&XQUERYLEN'(1,1) NE '(').ZG25R                    00143200
&ZCGPR        SETC  '&XQUERYLEN'(2,K'&XQUERYLEN-2)                      00143300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                        00143400
              AIF   (K'&ZCGPR GT 2).ZG25Q                               00143500
              AIF   ('&ZCGPR' EQ '0').ZG25Q                             00143600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00143700
              AIF   (T'&ZCGPR NE 'N').ZG25Q     INVALID REG NAME        00143800
.ZG25P        ANOP  ,                                                   00143900
              AIF   (T'&ZCGPR NE 'N').ZG25R     NON NUMERIC             00144000
              AIF   ('&ZCGPR' LT '2').ZG25Q                             00144100
              AIF   ('&ZCGPR' LE '12').ZG25R                            00144200
.ZG25Q        ANOP  ,                                                   00144300
&ZMS          SETC  '"QUERYLEN='                                        00144400
&ZMS          SETC  '&ZMS.&QUERYLEN"'                                   00144500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00144600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00144700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00144800
.ZG25R        ANOP  ,                                                   00144900
.*----------------------------------------------------------------***   00145000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00145100
              AIF   (N'&RETCODE LE 1).ZG28A     CK NUM                  00145200
&ZMS          SETC  '"RETCODE='                                         00145300
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00145400
&ZMS          SETC  '&ZMS "RETCODE"'                                    00145500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00145600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00145700
.ZG28A        ANOP  ,                                                   00145800
.*-------------------------------------------------------------------   00145900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00146000
              AIF   (K'&RETCODE(1) LE 0).ZG28C  NO PARM                 00146100
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              00146200
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00146300
              AIF   (N'&RETCODE GT 1).ZG28C                             00146400
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00146500
.ZG28C        ANOP  ,                                                   00146600
.*-------------------------------------------------------------------   00146700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00146800
              AIF   (K'&ZXRETCODE LE 0).ZG28R   NOT I/O                 00146900
              AIF   ('&XRETCODE'(1,1) NE '(').ZG28R                     00147000
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00147100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                        00147200
              AIF   (K'&ZCGPR GT 2).ZG28Q                               00147300
              AIF   ('&ZCGPR' EQ '0').ZG28Q                             00147400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00147500
              AIF   (T'&ZCGPR NE 'N').ZG28Q     INVALID REG NAME        00147600
.ZG28P        ANOP  ,                                                   00147700
              AIF   (T'&ZCGPR NE 'N').ZG28R     NON NUMERIC             00147800
              AIF   ('&ZCGPR' EQ '15').ZG28R                            00147900
              AIF   ('&ZCGPR' LT '2').ZG28Q                             00148000
              AIF   ('&ZCGPR' LE '12').ZG28R                            00148100
.ZG28Q        ANOP  ,                                                   00148200
&ZMS          SETC  '"RETCODE='                                         00148300
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00148400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00148500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'            00148600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00148700
.ZG28R        ANOP  ,                                                   00148800
.*----------------------------------------------------------------***   00148900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00149000
              AIF   (N'&RSNCODE LE 1).ZG31A     CK NUM                  00149100
&ZMS          SETC  '"RSNCODE='                                         00149200
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00149300
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00149400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00149500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00149600
.ZG31A        ANOP  ,                                                   00149700
.*-------------------------------------------------------------------   00149800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00149900
              AIF   (K'&RSNCODE(1) LE 0).ZG31C  NO PARM                 00150000
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00150100
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00150200
              AIF   (N'&RSNCODE GT 1).ZG31C                             00150300
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00150400
.ZG31C        ANOP  ,                                                   00150500
.*-------------------------------------------------------------------   00150600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00150700
              AIF   (K'&ZXRSNCODE LE 0).ZG31R   NOT I/O                 00150800
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG31R                     00150900
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00151000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                        00151100
              AIF   (K'&ZCGPR GT 2).ZG31Q                               00151200
              AIF   ('&ZCGPR' EQ '0').ZG31R                             00151300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00151400
              AIF   (T'&ZCGPR NE 'N').ZG31Q     INVALID REG NAME        00151500
.ZG31P        ANOP  ,                                                   00151600
              AIF   (T'&ZCGPR NE 'N').ZG31R     NON NUMERIC             00151700
              AIF   ('&ZCGPR' EQ '0').ZG31R                             00151800
              AIF   ('&ZCGPR' LT '2').ZG31Q                             00151900
              AIF   ('&ZCGPR' LE '12').ZG31R                            00152000
.ZG31Q        ANOP  ,                                                   00152100
&ZMS          SETC  '"RSNCODE='                                         00152200
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00152300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00152400
              MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'             00152500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00152600
.ZG31R        ANOP  ,                                                   00152700
.******************************************************************     00152800
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00152900
.******************************************************************     00153000
              ACTR  10000                                               00153100
.*----------------------------------------------------------------***   00153200
.***AH.P02 EXTRA POSITIONALS                                            00153300
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               00153400
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                00153500
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            00153600
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             00153700
.ZGLISTX1     ANOP  ,                                                   00153800
&ZCVAL        SETC  ''          ERROR FIELD                             00153900
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00154000
.ZGLIST2      ANOP  ,                                                   00154100
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00154200
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                00154300
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00154400
              AGO   .ZGLIST2                                            00154500
.*                                                                      00154600
.ZGLIST3      ANOP  ,                                                   00154700
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00154800
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'                           00154900
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00155000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00155100
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00155200
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00155300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00155400
.ZGLISTX      ANOP  ,                                                   00155500
&ZASYSLNDX    SETA  0                                                   00155600
.*-------------------------------------------------------------------   00155700
.***AG.MF04 MF=(SLE)                                                    00155800
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00155900
.*******************************************************************    00156000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00156100
.*******************************************************************    00156200
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00156300
.*******************************************************************    00156400
.***AE.01  START OF IWMRQRY MACRO CODE                                  00156500
.*******************************************************************    00156600
              LCLC  &M0M0001                 NAME                       00156700
&M0M0001      SETC  '&XLABEL'                SET NAME                   00156800
              AIF   (K'&XLABEL NE 0).XLAB2                              00156900
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00157000
.*                                                                      00157100
.XLAB2        ANOP  ,                                                   00157200
              AIF   ('&XMF' EQ 'L').XLAB3                               00157300
&M0M0001 DS    0H                             IWMRQRY-1                 00157400
.XLAB3        ANOP  ,                                                   00157500
.*******************************************************************    00157600
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00157700
.*******************************************************************    00157800
              PUSH  PRINT                                               00157900
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00158000
              PRINT OFF         ++ PR01                                 00158100
              AGO   .ZPRNTXX                                            00158200
.ZPRINTX      PRINT ON                                                  00158300
.ZPRNTXX      ANOP  ,                                                   00158400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00158500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00158600
.********************************************************************   00158700
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00158800
.********************************************************************   00158900
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00159000
                      LCLA  &ZOPN1         INVOCATION INDEX             00159100
                      LCLC  &ZOPL(4095)    LABEL                        00159200
                      LCLC  &ZOPO(4095)    OPERATION                    00159300
                      LCLC  &ZOPV(4095)    VALUE                        00159400
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00159500
.*                                                                      00159600
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00159700
.******************************************************************     00159800
.***AL.L10 IWMRQRY FMT=LIST MF=S!L PARAMETERS                           00159900
.******************************************************************     00160000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00160100
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00160200
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00160300
&XMFATTR              SETC  '0D'                                        00160400
.*                                                                      00160500
&ZOPN                 SETA  &ZOPN+1                                     00160600
&ZOPL(&ZOPN)          SETC  ' '                                         00160700
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00160800
&ZOPO(&ZOPN)          SETC  'B'                                         00160900
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00161000
                      AGO   .ZALVL6B                                    00161100
.ZALVL6A              ANOP                                              00161200
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00161300
&ZOPV(&ZOPN)          SETC  '4,8'                                       00161400
&ZOPN                 SETA  &ZOPN+1                                     00161500
&ZOPL(&ZOPN)          SETC  ' '                                         00161600
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00161700
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00161800
.ZALVL6B              ANOP                                              00161900
&ZOPD(&ZOPN)          SETC  '++ IWMRQRY ARG PARMS'                      00162000
.*                                                                      00162100
&ZOPN                 SETA  &ZOPN+1                                     00162200
&ZOPL(&ZOPN)          SETC  ' '                                         00162300
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00162400
&ZOPV(&ZOPN)          SETC  '1'                                         00162500
&ZOPD(&ZOPN)          SETC  ' '                                         00162600
.*                                                                      00162700
.ZLMFSL2              ANOP  ,                                           00162800
.*-------------------------------------------------------------------   00162900
.***AM.L00  IWMRQRY FMT=LIST name                                       00163000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00163100
&ZOPN                 SETA &ZOPN+1                                      00163200
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00163300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00163400
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00163500
&ZOPD(&ZOPN)          SETC '++ IWMRQRY NAME'                            00163600
.ZLMFSL2M             ANOP  ,                                           00163700
.*-------------------------------------------------------------------   00163800
.***AM.L01  IWMRQRY FMT=LIST PARAMETERS                                 00163900
&ZOPN                 SETA &ZOPN+1                                      00164000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00164100
&ZOPO(&ZOPN)          SETC 'DS'                                         00164200
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00164300
&ZOPD(&ZOPN)          SETC '++ IWMRQRY PARM LIST'                       00164400
.*-------------------------------------------------------------------   00164500
.***AM.L02 XVERSION XL1                                                 00164600
&ZOPN                 SETA &ZOPN+1                                      00164700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00164800
&ZOPO(&ZOPN)          SETC 'DS'                                         00164900
&ZOPV(&ZOPN)          SETC 'XL1'                                        00165000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00165100
.*-------------------------------------------------------------------   00165200
.***AM.L03 XRQRY_OPTIONS BL.8                                           00165300
&ZOPN                 SETA &ZOPN+1                                      00165400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRQRY_OPTIONS'                    00165500
&ZOPO(&ZOPN)          SETC 'DS'                                         00165600
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00165700
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00165800
.*                                                                      00165900
&ZOPN                 SETA  &ZOPN+1                                     00166000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XINFO_ALL'                       00166100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00166200
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00166300
&ZOPD(&ZOPN)          SETC  '++ XINFO.'                                 00166400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ALL'                          00166500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00166600
.*                                                                      00166700
&ZOPN                 SETA  &ZOPN+1                                     00166800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XINFO_ONE'                       00166900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00167000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00167100
&ZOPD(&ZOPN)          SETC  '++ XINFO.'                                 00167200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ONE'                          00167300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00167400
.*                                                                      00167500
&ZOPN                 SETA  &ZOPN+1                                     00167600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XENCLAVES_NONE'                  00167700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00167800
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00167900
&ZOPD(&ZOPN)          SETC  '++ XENCLAVES.'                             00168000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NONE'                         00168100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00168200
.*                                                                      00168300
&ZOPN                 SETA  &ZOPN+1                                     00168400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XENCLAVES_ALL'                   00168500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00168600
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00168700
&ZOPD(&ZOPN)          SETC  '++ XENCLAVES.'                             00168800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ALL'                          00168900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00169000
.*                                                                      00169100
&ZOPN                 SETA  &ZOPN+1                                     00169200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XENCLAVES_ONE'                   00169300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00169400
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00169500
&ZOPD(&ZOPN)          SETC  '++ XENCLAVES.'                             00169600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ONE'                          00169700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00169800
.*-------------------------------------------------------------------   00169900
.***AM.L09  XKEY XL1                                                    00170000
&ZOPN                 SETA &ZOPN+1                                      00170100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XKEY'                             00170200
&ZOPO(&ZOPN)          SETC 'DS'                                         00170300
&ZOPV(&ZOPN)          SETC 'XL1'                                        00170400
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00170500
.*-------------------------------------------------------------------   00170600
.***AM.L09  XRSV0003 CL1                                                00170700
&ZOPN                 SETA &ZOPN+1                                      00170800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         00170900
&ZOPO(&ZOPN)          SETC 'DS'                                         00171000
&ZOPV(&ZOPN)          SETC 'CL1'                                        00171100
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00171200
.*-------------------------------------------------------------------   00171300
.***AM.L09  XASID F                                                     00171400
&ZOPN                 SETA &ZOPN+1                                      00171500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XASID'                            00171600
&ZOPO(&ZOPN)          SETC 'DS'                                         00171700
&ZOPV(&ZOPN)          SETC 'F'                                          00171800
&ZOPD(&ZOPN)          SETC '++ &ZXASID '                                00171900
.*-------------------------------------------------------------------   00172000
.***AM.L09 ADDR XANSAREA A                                              00172100
&ZOPN                 SETA &ZOPN+1                                      00172200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA_ADDR'                    00172300
&ZOPO(&ZOPN)          SETC 'DS'                                         00172400
&ZOPV(&ZOPN)          SETC 'A'                                          00172500
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA ADDR'                         00172600
.*-------------------------------------------------------------------   00172700
.***AM.L09 ALET XANSAREA F                                              00172800
&ZOPN                 SETA &ZOPN+1                                      00172900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA_ALET'                    00173000
&ZOPO(&ZOPN)          SETC 'DS'                                         00173100
&ZOPV(&ZOPN)          SETC 'F'                                          00173200
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA ALET'                         00173300
.*-------------------------------------------------------------------   00173400
.***AM.L09  XANSLEN F                                                   00173500
&ZOPN                 SETA &ZOPN+1                                      00173600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSLEN'                          00173700
&ZOPO(&ZOPN)          SETC 'DS'                                         00173800
&ZOPV(&ZOPN)          SETC 'F'                                          00173900
&ZOPD(&ZOPN)          SETC '++ &ZXANSLEN '                              00174000
.*-------------------------------------------------------------------   00174100
.***AM.L09  XQUERYLEN F                                                 00174200
&ZOPN                 SETA &ZOPN+1                                      00174300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XQUERYLEN'                        00174400
&ZOPO(&ZOPN)          SETC 'DS'                                         00174500
&ZOPV(&ZOPN)          SETC 'F'                                          00174600
&ZOPD(&ZOPN)          SETC '++ &ZXQUERYLEN '                            00174700
.*-------------------------------------------------------------------   00174800
.***AM.MLM2 SAVED LOCATION COUNTER                                      00174900
                      AIF  (&XPLISTVER GE 1).ZL14LA                     00175000
                      AIF  ('&ZENDBASEPL' NE '').ZL14LA                 00175100
&ZENDBASEPL           SETC 'YES'                                        00175200
&ZOPN                 SETA &ZOPN+1                                      00175300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00175400
&ZOPO(&ZOPN)          SETC 'EQU'                                        00175500
&ZOPV(&ZOPN)          SETC '*'                                          00175600
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00175700
.ZL14LA               ANOP  ,                                           00175800
.*-------------------------------------------------------------------   00175900
.***AM.LVER1                                                            00176000
                      AIF  (&XPLISTVER LT 1).ZL14L                      00176100
.*-------------------------------------------------------------------   00176200
.*-------------------------------------------------------------------   00176300
.***AM.L09  XPLISTLEN XL2                                               00176400
&ZOPN                 SETA &ZOPN+1                                      00176500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00176600
&ZOPO(&ZOPN)          SETC 'DS'                                         00176700
&ZOPV(&ZOPN)          SETC 'XL2'                                        00176800
&ZOPD(&ZOPN)          SETC '++ INPUT '                                  00176900
.*-------------------------------------------------------------------   00177000
.***AM.LVER2                                                            00177100
.ZL14L                ANOP  ,                                           00177200
.*-------------------------------------------------------------------   00177300
.*-------------------------------------------------------------------   00177400
.***AM.LVER1                                                            00177500
                      AIF  (&XPLISTVER LT 1).ZL15L                      00177600
.*-------------------------------------------------------------------   00177700
.*-------------------------------------------------------------------   00177800
.***AM.L09  XRSV001E CL2                                                00177900
&ZOPN                 SETA &ZOPN+1                                      00178000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV001E'                         00178100
&ZOPO(&ZOPN)          SETC 'DS'                                         00178200
&ZOPV(&ZOPN)          SETC 'CL2'                                        00178300
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00178400
.*-------------------------------------------------------------------   00178500
.***AM.LVER2                                                            00178600
.ZL15L                ANOP  ,                                           00178700
.*-------------------------------------------------------------------   00178800
.*-------------------------------------------------------------------   00178900
.***AM.LVER1                                                            00179000
                      AIF  (&XPLISTVER LT 1).ZL16L                      00179100
.*-------------------------------------------------------------------   00179200
.*-------------------------------------------------------------------   00179300
.***AM.L09  XETOKEN CL8                                                 00179400
&ZOPN                 SETA &ZOPN+1                                      00179500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XETOKEN'                          00179600
&ZOPO(&ZOPN)          SETC 'DS'                                         00179700
&ZOPV(&ZOPN)          SETC 'CL8'                                        00179800
&ZOPD(&ZOPN)          SETC '++ &ZXETOKEN '                              00179900
.*-------------------------------------------------------------------   00180000
.***AM.LVER2                                                            00180100
.ZL16L                ANOP  ,                                           00180200
.*-------------------------------------------------------------------   00180300
.*-------------------------------------------------------------------   00180400
.***AM.L10 END OF IWMRQRY LIST PARAMETERS                               00180500
&ZOPN                 SETA &ZOPN+1                                      00180600
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00180700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00180800
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00180900
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00181000
.*                                                                      00181100
&ZOPN                 SETA &ZOPN+1                                      00181200
&ZOPL(&ZOPN)          SETC ' '                                          00181300
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00181400
&ZOPV(&ZOPN)          SETC '1'                                          00181500
&ZOPD(&ZOPN)          SETC ' '                                          00181600
.*-------------------------------------------------------------------   00181700
.***AL.L12 IWMRQRY FMT=LIST MF=S!L PARAMETERS                           00181800
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00181900
.*                                                                      00182000
&ZOPN                 SETA  &ZOPN+1                                     00182100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00182200
&ZOPO(&ZOPN)          SETC  'DC'                                        00182300
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00182400
&ZOPD(&ZOPN)          SETC  '++ IWMRQRY ARG PARMS'                      00182500
.*                                                                      00182600
.ZLMFSLX              ANOP  ,                                           00182700
.*-------------------------------------------------------------------   00182800
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00182900
&ZPLLEN               SETA 24                                           00183000
.*                                                                      00183100
                      AIF  (&XPLISTVER LT 1).ZLLEN2Z                    00183200
&ZPLLEN               SETA 36                                           00183300
.ZLLEN2Z              ANOP  ,                                           00183400
.*                                                                      00183500
.******************************************************************     00183600
.***AI.L01 IWMRQRY FMT=LIST FILL IN PARAMETER AREA                      00183700
.******************************************************************     00183800
                      ACTR  10000                                       00183900
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00184000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00184100
&ZCVAL                SETC  'LAE'          XAX MODE                     00184200
.ZIMFXA               ANOP ,                                            00184300
.*                                                                      00184400
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00184500
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00184600
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00184700
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00184800
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00184900
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00185000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00185100
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00185200
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00185300
&ZOPN                 SETA  &ZOPN+1                                     00185400
&ZOPL(&ZOPN)          SETC  ' '                                         00185500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00185600
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00185700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00185800
                      AGO   .ZIMFNX                                     00185900
.*                                                                      00186000
.ZIMFN2               ANOP ,                                            00186100
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00186200
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00186300
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00186400
&ZOPN                 SETA  &ZOPN+1                                     00186500
&ZOPL(&ZOPN)          SETC  ' '                                         00186600
&ZOPO(&ZOPN)          SETC  'LAE'                                       00186700
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00186800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00186900
                      AGO   .ZIMFNX                                     00187000
.ZIMFNX1              ANOP ,                                            00187100
&ZOPN                 SETA  &ZOPN+1                                     00187200
&ZOPL(&ZOPN)          SETC  ' '                                         00187300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00187400
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00187500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00187600
.ZIMFNX               ANOP ,                                            00187700
.********************************************************************   00187800
.***AI.L02 IWMRQRY FMT=LIST INITIALIZE PARAMETER AREA                   00187900
.********************************************************************   00188000
.***AI.L03 MF=(SLE)                                                     00188100
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00188200
.*                                                                      00188300
&ZOPN                 SETA  &ZOPN+1                                     00188400
&ZOPL(&ZOPN)          SETC  ' '                                         00188500
&ZOPO(&ZOPN)          SETC  'XC'                                        00188600
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00188700
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00188800
.ZIMFLX               ANOP  ,                                           00188900
.*-------------------------------------------------------------------   00189000
.***AI.L04A XVERSION XL1                                                00189100
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00189200
&ZOPN                 SETA  &ZOPN+1                                     00189300
&ZOPL(&ZOPN)          SETC  ' '                                         00189400
&ZOPO(&ZOPN)          SETC  'MVI'                                       00189500
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00189600
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00189700
.ZIMFVW               ANOP  ,                                           00189800
.*-------------------------------------------------------------------   00189900
.***AI.L05 XRQRY_OPTIONS BL1                                            00190000
&ZW                   SETC  ''                                          00190100
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00190200
.*-------------------------------------------------------------------   00190300
.***AI.L08 XRQRY_OPTIONS "ALL"                                          00190400
.***      BL1'1XXXXXXX'                                                 00190500
         AIF   ('&XINFO' NE 'ALL').ZI3A                                 00190600
&ZW                   SETC  '&ZW.1'                                     00190700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00190800
                      AGO   .ZI3C                                       00190900
.*                                                                      00191000
.ZI3A                 ANOP  ,                                           00191100
&ZW                   SETC  '&ZW.0'                                     00191200
.ZI3C                 ANOP  ,                                           00191300
.*-------------------------------------------------------------------   00191400
.***AI.L08 XRQRY_OPTIONS "ONE"                                          00191500
.***      BL1'X1XXXXXX'                                                 00191600
         AIF   ('&XINFO' NE 'ONE').ZI4A                                 00191700
&ZW                   SETC  '&ZW.1'                                     00191800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00191900
                      AGO   .ZI4C                                       00192000
.*                                                                      00192100
.ZI4A                 ANOP  ,                                           00192200
&ZW                   SETC  '&ZW.0'                                     00192300
.ZI4C                 ANOP  ,                                           00192400
.*-------------------------------------------------------------------   00192500
.***AI.L08 XRQRY_OPTIONS "NONE"                                         00192600
.***      BL1'XX1XXXXX'                                                 00192700
         AIF   ('&XENCLAVES' NE 'NONE').ZI5A                            00192800
&ZW                   SETC  '&ZW.1'                                     00192900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00193000
                      AGO   .ZI5C                                       00193100
.*                                                                      00193200
.ZI5A                 ANOP  ,                                           00193300
&ZW                   SETC  '&ZW.0'                                     00193400
.ZI5C                 ANOP  ,                                           00193500
.*-------------------------------------------------------------------   00193600
.***AI.L08 XRQRY_OPTIONS "ALL"                                          00193700
.***      BL1'XXX1XXXX'                                                 00193800
         AIF   ('&XENCLAVES' NE 'ALL').ZI6A                             00193900
&ZW                   SETC  '&ZW.1'                                     00194000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00194100
                      AGO   .ZI6C                                       00194200
.*                                                                      00194300
.ZI6A                 ANOP  ,                                           00194400
&ZW                   SETC  '&ZW.0'                                     00194500
.ZI6C                 ANOP  ,                                           00194600
.*-------------------------------------------------------------------   00194700
.***AI.L08 XRQRY_OPTIONS "ONE"                                          00194800
.***      BL1'XXXX1XXX'                                                 00194900
         AIF   ('&XENCLAVES' NE 'ONE').ZI7A                             00195000
&ZW                   SETC  '&ZW.1000'                                  00195100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00195200
                      AGO   .ZI7C                                       00195300
.*                                                                      00195400
.ZI7A                 ANOP  ,                                           00195500
&ZW                   SETC  '&ZW.0000'                                  00195600
.ZI7C                 ANOP  ,                                           00195700
.*-------------------------------------------------------------------   00195800
.***AI.L11 XRQRY_OPTIONS BL1                                            00195900
                      AIF   ('&ZCLNG' NE 'YES').ZI7E  ALL ZERO BITS     00196000
&ZOPN                 SETA  &ZOPN+1                                     00196100
&ZOPL(&ZOPN)          SETC  ' '                                         00196200
&ZOPO(&ZOPN)          SETC  'OI'                                        00196300
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00196400
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00196500
.ZI7E                 ANOP  ,                                           00196600
.*-------------------------------------------------------------------   00196700
.***AI.L25  XASID F                                                     00196800
                      AIF   ('&ZXASID' EQ '').ZI10E                     00196900
                      AIF   ('&ZXASID' EQ 'OUTPUT').ZI10E               00197000
&ZCGPR                SETC  '&XASID'                                    00197100
.*                                                                      00197200
                      AIF   ('&XASID'(1,1) NE '(').ZI10B                00197300
&ZCGPR   SETC  '0('.'&XASID'(2,K'&XASID-2).')'                          00197400
                      AGO   .ZI10D                                      00197500
.ZI10B                ANOP  ,                                           00197600
.*                                                                      00197700
&ZC                   SETC  '&XASID'(1,1)                               00197800
                      AIF   (T'&ZC NE 'N').ZI10D                        00197900
&ZC                   SETC  '&XASID'                                    00198000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               00198100
&ZCGPR                SETC  '=FL4''&XASID'''                            00198200
.*                                                                      00198300
.ZI10D                ANOP  ,                                           00198400
.*                                                                      00198500
&ZOPN                 SETA  &ZOPN+1                                     00198600
&ZOPL(&ZOPN)          SETC  ' '                                         00198700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00198800
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00198900
&ZOPD(&ZOPN)          SETC  '++ &ZXASID XASID'                          00199000
.*                                                                      00199100
.ZI10E                ANOP  ,                                           00199200
.*-------------------------------------------------------------------   00199300
.***AI.L19 ADDR XANSAREA A                                              00199400
                      AIF   ('&ZXANSAREA' EQ '').ZI11H                  00199500
&ZCLNG                SETC  '&XANSAREA'                                 00199600
&ZCGPR                SETC  '14'                                        00199700
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI11F  IN GPR                  00199800
.*                                                                      00199900
&ZOPN                 SETA  &ZOPN+1                                     00200000
&ZOPL(&ZOPN)          SETC  ' '                                         00200100
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00200200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00200300
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00200400
.*                                                                      00200500
                      AGO   .ZI11G                                      00200600
.*                                                                      00200700
.ZI11F                ANOP  ,                                           00200800
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             00200900
.*                                                                      00201000
.ZI11G                ANOP  ,                                           00201100
.*                                                                      00201200
&ZOPN                 SETA  &ZOPN+1                                     00201300
&ZOPL(&ZOPN)          SETC  ' '                                         00201400
&ZOPO(&ZOPN)          SETC  'ST'                                        00201500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              00201600
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00201700
.*                                                                      00201800
.ZI11H                ANOP  ,                                           00201900
.*-------------------------------------------------------------------   00202000
.***AI.L23 ALET XANSAREA F                                              00202100
         AIF   ('&ZXANSAREA' EQ '').ZI12G                               00202200
         AIF   ('&SYSASCE' EQ 'P').ZI12G   SYSSTATE PRIMARY             00202300
&ZCLNG                SETC  '&XANSAREA'                                 00202400
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI12E  IN AR                   00202500
.*                                                                      00202600
&ZCGPR                SETC  '14'                                        00202700
                      AGO   .ZI12F                                      00202800
.*                                                                      00202900
.ZI12E                ANOP  ,                                           00203000
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             00203100
.*                                                                      00203200
.ZI12F                ANOP  ,                                           00203300
.*                                                                      00203400
&ZOPN                 SETA  &ZOPN+1                                     00203500
&ZOPL(&ZOPN)          SETC  ' '                                         00203600
&ZOPO(&ZOPN)          SETC  'STAM'                                      00203700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,12(1)'                       00203800
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00203900
.*                                                                      00204000
.ZI12G                ANOP  ,                                           00204100
.*-------------------------------------------------------------------   00204200
.***AI.L25  XANSLEN F                                                   00204300
                      AIF   ('&ZXANSLEN' EQ '').ZI13E                   00204400
                      AIF   ('&ZXANSLEN' EQ 'OUTPUT').ZI13E             00204500
&ZCGPR                SETC  '&XANSLEN'                                  00204600
.*                                                                      00204700
                      AIF   ('&XANSLEN'(1,1) NE '(').ZI13B              00204800
&ZCGPR   SETC  '0('.'&XANSLEN'(2,K'&XANSLEN-2).')'                      00204900
                      AGO   .ZI13D                                      00205000
.ZI13B                ANOP  ,                                           00205100
.*                                                                      00205200
&ZC                   SETC  '&XANSLEN'(1,1)                             00205300
                      AIF   (T'&ZC NE 'N').ZI13D                        00205400
&ZC                   SETC  '&XANSLEN'                                  00205500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI13D               00205600
&ZCGPR                SETC  '=FL4''&XANSLEN'''                          00205700
.*                                                                      00205800
.ZI13D                ANOP  ,                                           00205900
.*                                                                      00206000
&ZOPN                 SETA  &ZOPN+1                                     00206100
&ZOPL(&ZOPN)          SETC  ' '                                         00206200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00206300
&ZOPV(&ZOPN)          SETC  '16(4,1),&ZCGPR'                            00206400
&ZOPD(&ZOPN)          SETC  '++ &ZXANSLEN XANSLEN'                      00206500
.*                                                                      00206600
.ZI13E                ANOP  ,                                           00206700
.*-------------------------------------------------------------------   00206800
.***AI.LVER01                                                           00206900
                      AIF  (&XPLISTVER LT 1).ZI15Z                      00207000
.*-------------------------------------------------------------------   00207100
.***AI.L04 XPLISTLEN XL2                                                00207200
&ZOPN                 SETA  &ZOPN+1                                     00207300
&ZOPL(&ZOPN)          SETC  ' '                                         00207400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00207500
&ZOPV(&ZOPN)          SETC  '24(2,1),=AL2(&ZPLLEN)'                     00207600
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00207700
.*-------------------------------------------------------------------   00207800
.***AI.LVER02                                                           00207900
.ZI15Z                ANOP  ,                                           00208000
.*-------------------------------------------------------------------   00208100
.***AI.LVER01                                                           00208200
                      AIF  (&XPLISTVER LT 1).ZI16Z                      00208300
.*-------------------------------------------------------------------   00208400
.***AI.LVER02                                                           00208500
.ZI16Z                ANOP  ,                                           00208600
.*-------------------------------------------------------------------   00208700
.***AI.LVER01                                                           00208800
                      AIF  (&XPLISTVER LT 1).ZI17Z                      00208900
.*-------------------------------------------------------------------   00209000
.***AI.L25  XETOKEN CL8                                                 00209100
                      AIF   ('&ZXETOKEN' EQ '').ZI17E                   00209200
                      AIF   ('&ZXETOKEN' EQ 'OUTPUT').ZI17E             00209300
&ZCGPR                SETC  '&XETOKEN'                                  00209400
.*                                                                      00209500
                      AIF   ('&XETOKEN'(1,1) NE '(').ZI17B              00209600
&ZCGPR   SETC  '0('.'&XETOKEN'(2,K'&XETOKEN-2).')'                      00209700
.ZI17B                ANOP  ,                                           00209800
.*                                                                      00209900
&ZOPN                 SETA  &ZOPN+1                                     00210000
&ZOPL(&ZOPN)          SETC  ' '                                         00210100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00210200
&ZOPV(&ZOPN)          SETC  '28(8,1),&ZCGPR'                            00210300
&ZOPD(&ZOPN)          SETC  '++ &ZXETOKEN XETOKEN'                      00210400
.*                                                                      00210500
.ZI17E                ANOP  ,                                           00210600
.*-------------------------------------------------------------------   00210700
.***AI.LVER02                                                           00210800
.ZI17Z                ANOP  ,                                           00210900
.*-------------------------------------------------------------------   00211000
&ZOPN1                SETA &ZOPN                                        00211100
.*******************************************************************    00211200
.***  PROCESS IWMRQRY OUTPUT PARAMETERS                                 00211300
.*******************************************************************    00211400
                      ACTR  10000                                       00211500
.*------------------------------------------------------------------    00211600
.***AO.L02 XQUERYLEN F                                                  00211700
         AIF   ('&ZXQUERYLEN' EQ 'OUTPUT').ZO14A  OUTPUT                00211800
         AIF   ('&ZXQUERYLEN' NE 'INOUT').ZO14C  INOUT                  00211900
.ZO14A    AIF   ('&XQUERYLEN'(1,1) NE '(').ZO14B  ADDR IN GPR           00212000
&ZCGPR   SETC  '&XQUERYLEN'(2,K'&XQUERYLEN-2)                           00212100
&ZOPN                 SETA  &ZOPN+1                                     00212200
&ZOPL(&ZOPN)          SETC  ' '                                         00212300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00212400
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),20(1)'                         00212500
&ZOPD(&ZOPN)          SETC  '++ XQUERYLEN F'                            00212600
                      AGO   .ZO14C                                      00212700
.*                                                                      00212800
.ZO14B                ANOP  ,                                           00212900
&ZAWRK   SETA  K'&XQUERYLEN                                             00213000
         AIF   ('&XQUERYLEN'(&ZAWRK,1) NE ')').ZO14G                    00213100
&ZN      SETA  2                                                        00213200
.ZO14H    ANOP                                                          00213300
         AIF   (&ZN GE &ZAWRK).ZO14G                                    00213400
         AIF   ('&XQUERYLEN'(&ZN,1) NE '(').ZO14I                       00213500
&ZC      SETC  '&XQUERYLEN'(1,&ZN).'4'.','                              00213600
&ZC      SETC  '&ZC'.'&XQUERYLEN'(&ZN+1,&ZAWRK-&ZN).',20(1)'            00213700
         AGO   .ZO14J                                                   00213800
.ZO14I    ANOP                                                          00213900
&ZN      SETA  &ZN+1                                                    00214000
         AGO   .ZO14H                                                   00214100
.ZO14G    ANOP                                                          00214200
&ZC      SETC  '&XQUERYLEN.(4),20(1)'                                   00214300
.ZO14J    ANOP                                                          00214400
&ZOPN                 SETA  &ZOPN+1                                     00214500
&ZOPL(&ZOPN)          SETC  ' '                                         00214600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00214700
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00214800
&ZOPD(&ZOPN)          SETC  '++ XQUERYLEN F'                            00214900
.ZO14C                ANOP  ,                                           00215000
.*******************************************************************    00215100
.***AO.X02  RETURN CODE PROCESSING                                      00215200
.*******************************************************************    00215300
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00215400
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00215500
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00215600
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00215700
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00215800
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00215900
&ZOPN                 SETA  &ZOPN+1                                     00216000
&ZOPL(&ZOPN)          SETC  ' '                                         00216100
&ZOPO(&ZOPN)          SETC  'ST'                                        00216200
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00216300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00216400
                      AGO   .ZMRETX                                     00216500
.*                                                                      00216600
.ZMRET2               ANOP  ,                                           00216700
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00216800
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00216900
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00217000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00217100
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00217200
&ZOPN                 SETA  &ZOPN+1                                     00217300
&ZOPL(&ZOPN)          SETC  ' '                                         00217400
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00217500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00217600
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00217700
.ZMRETX               ANOP  ,                                           00217800
.*******************************************************************    00217900
.***AO.X03  REASON CODE PROCESSING                                      00218000
.*******************************************************************    00218100
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00218200
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00218300
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00218400
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00218500
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00218600
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00218700
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00218800
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00218900
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00219000
&ZOPN                 SETA  &ZOPN+1                                     00219100
&ZOPL(&ZOPN)          SETC  ' '                                         00219200
&ZOPO(&ZOPN)          SETC  'ST'                                        00219300
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00219400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00219500
                      AGO   .ZMRSNX                                     00219600
.*                                                                      00219700
.ZMRSN2               ANOP  ,                                           00219800
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00219900
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00220000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00220100
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00220200
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00220300
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00220400
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00220500
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00220600
&ZOPN                 SETA  &ZOPN+1                                     00220700
&ZOPL(&ZOPN)          SETC  ' '                                         00220800
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00220900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00221000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00221100
.ZMRSNX               ANOP  ,                                           00221200
.*******************************************************************    00221300
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00221400
.*******************************************************************    00221500
.ZMFLX                ANOP  ,              MF=L PROCESSING              00221600
.*******************************************************************    00221700
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00221800
.*******************************************************************    00221900
                      ACTR  10000                                       00222000
.*                                                                      00222100
                      LCLA  &ZLC           COLUMN POSITION              00222200
                      LCLA  &ZOPX          LIST TABLE INDEX             00222300
                      LCLC  &ZLL           LABEL                        00222400
                      LCLC  &ZLOP          OPERATION                    00222500
                      LCLC  &ZLV           VALUE                        00222600
                      LCLC  &ZLD           DESCRIPTION                  00222700
.*                                                                      00222800
&ZOPX                 SETA  1                                           00222900
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00223000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00223100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00223200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00223300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00223400
                      AIF   (K'&ZLD LE 0).ZL5                           00223500
&ZLC                  SETA  35             COMMENT COLUMN               00223600
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00223700
&ZLC                  SETA  33             COMMMENT COLUMN              00223800
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00223900
&ZLV                  SETC  '&ZLV'.' '                                  00224000
                      AGO   .ZL3                                        00224100
.*                                                                      00224200
.ZL4                  ANOP  ,                                           00224300
&ZLV                  SETC  '&ZLV'.' '                                  00224400
.ZL5                  ANOP  ,                                           00224500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00224600
.*                                                                      00224700
&ZLL     &ZLOP &ZLV                                                     00224800
.*                                                                      00224900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00225000
                      AGO   .ZL2           CONTINUE LOOPING             00225100
.*                                                                      00225200
.ZLX                  ANOP  ,                                           00225300
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00225400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00225500
         L     14,16(0,0)              GET CVT ADDRESS                  00225600
.***CHECK FOR VERSION 0 @P3A                                            00225700
                      AIF  (&XPLISTVER EQ 0).VEROK                      00225800
.*-------------------------------------------------------------------   00225900
         TM    CVTOSLV2-CVT(14),X'80'  TEST FOR JBB6604 PRESENCE        00226000
         BNZ   VEROK&SYSNDX            BRANCH IF JBB6604 PRESENCE       00226100
         LA    0,IWMRSNCODEBADVERSION  SET REASON CODE = BAD VERSION    00226200
         LA    15,IWMRETCODEINVOCERROR SET ERROR RETURN CODE            00226300
         B     END&SYSNDX              BRANCH TO END LABEL              00226400
VEROK&SYSNDX DS    0H                  BRANCH LABEL FOR VERSION OK      00226500
.*-------------------------------------------------------------------   00226600
.VEROK                ANOP  ,                                           00226700
.*-------------------------------------------------------------------   00226800
         AIF   ('&SYSASCE' EQ 'P').NOAR    CHECK FOR AR MODE CALLERS    00226900
         LAE   14,0(14,0)              CLEAR AR 14                      00227000
.NOAR    ANOP                                                           00227100
         TM    CVTOSLV1-CVT(14),X'40'      TEST FOR WLM PRESENCE        00227200
         BO    WLM&SYSNDX              BRANCH WHEN WLM IS PRESENT       00227300
         LA    0,IWMRSNCODENOWLM       SET REASON CODE = NO WLM         00227400
         LA    15,IWMRETCODEWARNING    SET WARNING RETURN CODE          00227500
         B     END&SYSNDX              BRANCH TO END LABEL              00227600
WLM&SYSNDX DS    0H                    BRANCH LABEL FOR WLM PRESENT     00227700
         L     14,772(14,0)            GET SFT ADDRESS                  00227800
         L     14,380(14,0)            GET LX FOR SERVICE ROUTINE       00227900
         LA    15,15                   GET EX FOR SERVICE ROUTINE       00228000
         OR    14,15                   GET PC NUMBER                    00228100
         PC    0(14)                                                    00228200
END&SYSNDX DS    0H                    END LABEL                        00228300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00228400
.ZLINKX               ANOP  ,                                           00228500
.*******************************************************************    00228600
.***AP.X01  FORMAT GENERATED CODE                                       00228700
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00228800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00228900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00229000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00229100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00229200
                      AIF   (K'&ZLD LE 0).ZL51                          00229300
&ZLC                  SETA  35             COMMENT COLUMN               00229400
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00229500
&ZLC                  SETA  33             COMMENT COLUMN               00229600
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00229700
&ZLV                  SETC  '&ZLV'.' '                                  00229800
                      AGO   .ZL31                                       00229900
.*                                                                      00230000
.ZL41                 ANOP  ,                                           00230100
&ZLV                  SETC  '&ZLV'.' '                                  00230200
.ZL51                 ANOP  ,                                           00230300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00230400
.*                                                                      00230500
&ZLL     &ZLOP &ZLV                                                     00230600
.*                                                                      00230700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00230800
                      AGO   .ZL21          CONTINUE LOOPING             00230900
.*                                                                      00231000
.ZLX1                 ANOP  ,                                           00231100
.*******************************************************************    00231200
.***AP.X02  END OF IWMRQRY MACRO                                        00231300
&ZIWMRQRY             SETC  'YES'          SET IWMRQRY USED             00231400
         POP   PRINT                                                    00231500
*                                            IWMRQRY-1                  00231600
         SPACE 1                                                        00231700
.ZLX2                 ANOP  ,                                           00231800
         MEND                                                           00231900
**********************************************************************/ 00232000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00232100
*%IWMRQRY: MACRO KEYS(INFO,ASID,ENCLAVES,ETOKEN,ANSAREA,ANSLEN,         00232200
*                 QUERYLEN,RETCODE,RSNCODE,PLISTVER,MF);                00232300
*  ANS('?'!!MACLABEL!!' '!!'IWMRQRYP '!!MACLIST!!                       00232400
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00232500
*%END IWMRQRY;                                                          00232600

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  CTRACEWR                              -09/24/04-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Component Trace Write Macro                   * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 (C) COPYRIGHT IBM CORP. 1990, 2005                     * 00001200
*                                                                     * 00001300
* STATUS= HBB7720                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      CTRACEWR macro provides the interface to the Component Trace   * 00002100
*      Writer service routine.                                        * 00002200
*                                                                     * 00002300
*      Register Usage                                                 * 00002400
*                                                                     * 00002500
*                                                                     * 00002600
*      o   AR/GPRs 0,1,14,15 are not preserved.                       * 00002700
*                                                                     * 00002800
*      o   AR/GPRs 2-13 are preserved.                                * 00002900
*                                                                     * 00003000
*      o   Upon return GPR 15 contains a return code.                 * 00003100
*                                                                     * 00003200
*      o   Upon return GPR 0 will contain a reason code if GPR 15 is  * 00003300
*          non-zero.                                                  * 00003400
*                                                                     * 00003500
*                                                                     * 00003600
*                                                                     * 00003700
*02*   OPERATION:                                                     * 00003800
*                                                                     * 00003900
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00004000
*                                                                     * 00004100
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00004200
*                                                                     * 00004300
*                                                                     * 00004400
*he CTRACEWR macro performs syntax checking to validate the user      * 00004500
*pecified request. If an error is detected, macro phase error         * 00004600
*essages are issued and a macro phase return code of 8 is set.        * 00004700
*                                                                     * 00004800
*he parameter list is defined.                                        * 00004900
*                                                                     * 00005000
*he parameter list is initialized and the linkage code is generated   * 00005100
*o perform a non-space switch PC to the service routine for the       * 00005200
*trace external writer.                                               * 00005300
*                                                                     * 00005400
*he CTRACEWR macro cannot be invoked in an environment where it is    * 00005500
*ot possible to obtain the VSMFIX lock.                               * 00005600
*                                                                     * 00005700
*01* ENVIRONMENT:                                                     * 00005800
*                                                                     * 00005900
*                                                                     * 00006000
*      Dispatchable unit mode: Task or SRB mode.                      * 00006100
*                                                                     * 00006200
*      Minimum authorization: Supervisor state.  Zero PSW key.        * 00006300
*                                                                     * 00006400
*      AMODE:            31-bit.                                      * 00006500
*                                                                     * 00006600
*      ASC mode:         Primary or Access Register.                  * 00006700
*                                                                     * 00006800
*                        Any cross memory mode is supported.          * 00006900
*                                                                     * 00007000
*      Interrupt status: Enabled or disabled for I/O and external     * 00007100
*                        interrupts.                                  * 00007200
*                                                                     * 00007300
*01* RESTRICTIONS:                                                    * 00007400
*    The CTRACEWR macro cannot be invoked in an environment where it  * 00007500
*    is not possible to obtain the VSMFIX lock.                       * 00007600
*                                                                     * 00007700
*                                                                     * 00007800
*                                                                     * 00007900
*01* SYNTAX:                                                          * 00008000
*                                                                     * 00008100
*Ýxlabel¨  CTRACEWR     BUFFADDR=xbuffaddr                            * 00008200
*                         Ý,BUFFALET=»xbuffalet!NOBUFFALETº¨          * 00008300
*                         Ý,BUFFSTOKEN=»xbuffstoken!BY_BUFFALETº¨     * 00008400
*                      ,BUFFLEN=xbufflen                              * 00008500
*                      ,TOKEN=xtoken                                  * 00008600
*                      ,TBWCADDR=xtbwcaddr                            * 00008700
*                     Ý,TBWCALET=»xtbwcalet!NOTBWCALETº¨              * 00008800
*                     Ý,SYNCH=»NO!YESº¨                               * 00008900
*                     Ý,RC=xrc¨                                       * 00009000
*                     Ý,RSNCODE=xrsncode¨                             * 00009100
*                     Ý,COM=»xcom!NULLº¨                              * 00009200
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00009300
*                    ÐÝ,MF=S¨                                         * 00009400
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00009500
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00009600
*                                                                     * 00009700
*                                                                     * 00009800
*      Where:                                                         * 00009900
*                                                                     * 00010000
*                                                                     * 00010100
*      Ýxlabel¨                                                       * 00010200
*          is an optional symbol, starting in column 1, that is the   * 00010300
*          name on the CTRACEWR macro invocation.  The name must      * 00010400
*          conform to the rules for an ordinary assembler language    * 00010500
*          symbol.                                                    * 00010600
*          DEFAULT: No name.                                          * 00010700
*                                                                     * 00010800
*                                                                     * 00010900
*                                                                     * 00011000
*                                                                     * 00011100
*      BUFFADDR=xbuffaddr                                             * 00011200
*          is the name (RS-type), or address in register (2)-(12), of * 00011300
*          a required 4 byte input that contains the address of the   * 00011400
*          buffer to be written externally.                           * 00011500
*                                                                     * 00011600
*                                                                     * 00011700
*          ÝBUFFALET=»xbuffalet!NOBUFFALETº¨                          * 00011800
*              is the name (RS-type), or address in register          * 00011900
*              (2)-(12), of an optional 4 character input variable    * 00012000
*              that contains the ALET on the PASN access list that    * 00012100
*              identifies the address/data space where the buffer     * 00012200
*              resides.  This keyword is only appropriate when the    * 00012300
*              buffer to be written externally resides in either a    * 00012400
*              data space or an address space that is different from  * 00012500
*              the current primary address space.  NOTE: the space    * 00012600
*              identified by BUFFALET and the space identified by     * 00012700
*              TBWCALET must both be addressable from the same        * 00012800
*              address space; that is, they both must be addressable  * 00012900
*              from the HOME address space (if a HOME ALET is         * 00013000
*              specified) or from the SECONDARY address space (if a   * 00013100
*              SECONDARY ALET is specified) or from the PRIMARY       * 00013200
*              address space (if a PRIMARY ALET or data space ALET on * 00013300
*              the PASN access list or no ALET is specified, and      * 00013400
*              buffSTOKEN is not specified), or from the address      * 00013500
*              space identified by the buffSTOKEN parameter.          * 00013600
*              DEFAULT: NOBUFFALET                                    * 00013700
*                                                                     * 00013800
*                                                                     * 00013900
*                                                                     * 00014000
*                                                                     * 00014100
*          ÝBUFFSTOKEN=»xbuffstoken!BY_BUFFALETº¨                     * 00014200
*              is the name (RS-type), or address in register          * 00014300
*              (2)-(12), of an optional 8 character input variable    * 00014400
*              that contains the STOKEN for the address space that    * 00014500
*              owns the buffer which is identified by the buffaddr    * 00014600
*              and buffalet parameters.  The value is ignored if      * 00014700
*              BUFFALET specifies a value of 1 (the secondary address * 00014800
*              space) or a value of 2 (the home address space).       * 00014900
*              DEFAULT: BY_BUFFALET which indicates that the owning   * 00015000
*              space is determined by the value of the buffalet       * 00015100
*              parameter.                                             * 00015200
*                                                                     * 00015300
*                                                                     * 00015400
*                                                                     * 00015500
*                                                                     * 00015600
*                                                                     * 00015700
*                                                                     * 00015800
*      BUFFLEN=xbufflen                                               * 00015900
*          is the name (RS-type), or address in register (2)-(12), of * 00016000
*          a required fullword input variable that provides the       * 00016100
*          length (in number of bytes) of the buffer that is to be    * 00016200
*          written externally.  For better processing time, and more  * 00016300
*          efficient use of space, it is preferable to pass large     * 00016400
*          buffers to Ctrace for writing.  For this reason, it is     * 00016500
*          recommended that the buffer size be at LEAST 4K bytes.     * 00016600
*          Ctrace will split buffers that are too large to fit into a * 00016700
*          single block, so there is no upper limit on the buffer     * 00016800
*          length, aside from needing to fit into a fixed(31) field   * 00016900
*          and Ctrace being able to obtain sufficient storage to      * 00017000
*          process the request.                                       * 00017100
*                                                                     * 00017200
*                                                                     * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*      TOKEN=xtoken                                                   * 00017600
*          is the name (RS-type), or address in register (2)-(12), of * 00017700
*          a required 8 character input variable that contains the    * 00017800
*          token that was passed to the component start/stop exit     * 00017900
*          when it was requested to start tracing externally.         * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*      TBWCADDR=xtbwcaddr                                             * 00018500
*          is the name (RS-type), or address in register (2)-(12), of * 00018600
*          a required 4 byte input that contains the address of       * 00018700
*          storage that is obtained by the component and mapped by    * 00018800
*          ITTTBWC.  This storage is used to provide communication    * 00018900
*          between the component tracing routine and the CTRACE code  * 00019000
*          that is capturing the trace buffer asynchronously.  The    * 00019100
*          CTRACECS macro should be used to manipulate control        * 00019200
*          information that is mapped by ITTTBWC.                     * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*                                                                     * 00019600
*                                                                     * 00019700
*      ÝTBWCALET=»xtbwcalet!NOTBWCALETº¨                              * 00019800
*          is the name (RS-type), or address in register (2)-(12), of * 00019900
*          an optional 4 character input variable that contains the   * 00020000
*          ALET on the PASN access list that identifies the           * 00020100
*          address/data space where the control area (storage mapped  * 00020200
*          by ITTTBWC) resides.  This keyword is only appropriate     * 00020300
*          when the control area resides in either a data space or an * 00020400
*          address space that is different from the current primary   * 00020500
*          address space.  NOTE: the space identified by BUFFALET and * 00020600
*          the space identified by TBWCALET must both be addressable  * 00020700
*          from the same address space; that is, they both must be    * 00020800
*          addressable from the HOME address space (if a HOME ALET is * 00020900
*          specified) or from the SECONDARY address space (if a       * 00021000
*          SECONDARY ALET is specified) or from the PRIMARY address   * 00021100
*          space (if a PRIMARY ALET or data space ALET on the PASN    * 00021200
*          access list or no ALET is specified, and buffSTOKEN is not * 00021300
*          specified), or from the address space identified by the    * 00021400
*          buffSTOKEN parameter.                                      * 00021500
*          DEFAULT: NOTBWCALET                                        * 00021600
*                                                                     * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*                                                                     * 00022000
*      ÝSYNCH=»NO!YESº¨                                               * 00022100
*          is an optional keyword input is an optional keyword input  * 00022200
*          used to indicate whether the CTRACEWR function should be   * 00022300
*          completed asynchronously or synchronously.                 * 00022400
*          DEFAULT: NO                                                * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*          SYNCH=NO                                                   * 00022800
*              specifies that the CTRACEWR function should be         * 00022900
*              executed asynchronously.                               * 00023000
*                                                                     * 00023100
*          SYNCH=YES                                                  * 00023200
*              specifies that the CTRACEWR function should be         * 00023300
*              executed synchronously.                                * 00023400
*                                                                     * 00023500
*                                                                     * 00023600
*                                                                     * 00023700
*                                                                     * 00023800
*                                                                     * 00023900
*                                                                     * 00024000
*      ÝRC=xrc¨                                                       * 00024100
*          is the name (RS-type) of an optional fullword output       * 00024200
*          variable, or register (2)-(12), into which the return code * 00024300
*          is to be copied from GPR 15.                               * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*                                                                     * 00024700
*                                                                     * 00024800
*      ÝRSNCODE=xrsncode¨                                             * 00024900
*          is the name (RS-type) of an optional fullword output       * 00025000
*          variable, or register (2)-(12), into which the reason code * 00025100
*          is to be copied from GPR 0.                                * 00025200
*                                                                     * 00025300
*                                                                     * 00025400
*                                                                     * 00025500
*                                                                     * 00025600
*      ÝCOM=»xcom!NULLº¨                                              * 00025700
*          is an optional character input  that will appear in the    * 00025800
*          block comment before the macro invocation echo. It can be  * 00025900
*          used to comment the macro invocation.  The comment string  * 00026000
*          must be enclosed in quotes if it contains any lower case   * 00026100
*          characters.                                                * 00026200
*          DEFAULT: NULL                                              * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00026800
*          is an optional byte input decimal value in the "0-0" range * 00026900
*          that specifies the macro version.  PLISTVER is the only    * 00027000
*          key allowed on the list form of MF and determines which    * 00027100
*          parameter list is generated.  Note that MAX may be         * 00027200
*          specified instead of a number, and the parameter list will * 00027300
*          be of the largest size currently supported. This size may  * 00027400
*          grow from release to release (thus possibly affecting the  * 00027500
*          amount of storage needed by your program).  If your        * 00027600
*          program can tolerate this, IBM recommends that you always  * 00027700
*          specify MAX when creating the list form parameter list as  * 00027800
*          that will ensure that the list form parameter list is      * 00027900
*          always long enough to hold whatever parameters might be    * 00028000
*          specified on the execute form.                             * 00028100
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00028200
*          default is the lowest version which allows all of the      * 00028300
*          parameters specified on the invocation to be processed.    * 00028400
*                                                                     * 00028500
*                                                                     * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*      ÝMF=»S!L!Eº¨                                                   * 00028900
*          is an optional keyword input which specifies the macro     * 00029000
*          form.                                                      * 00029100
*          DEFAULT: S                                                 * 00029200
*                                                                     * 00029300
*                                                                     * 00029400
*          ÝMF=S¨                                                     * 00029500
*              specifies the standard form of the macro.  The "S"     * 00029600
*              form generates code to put the parameters into an      * 00029700
*              in-line parameter list and invoke the desired service. * 00029800
*              Full checking for required macro keys is done along    * 00029900
*              with supplying defaults for omitted optional           * 00030000
*              parameters.                                            * 00030100
*                                                                     * 00030200
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00030300
*              specifies the list form of the macro.  The "L" form    * 00030400
*              defines an area to be used for the parameter list.     * 00030500
*              Only the PLISTVER key may be specified on the          * 00030600
*              invocation.  All other macro parameters are flagged as * 00030700
*              errors.  If PLISTVER is not specified, the original    * 00030800
*              parameter list definition is used.                     * 00030900
*                                                                     * 00031000
*            ,xmfctrl                                                 * 00031100
*              is a required input.  It is the name of a storage area * 00031200
*              for the parameter list.                                * 00031300
*                                                                     * 00031400
*            »,xmfattr!0Dº                                            * 00031500
*              is an optional 60 character input string that varies   * 00031600
*              from 1 to 60 characters. Use it to force boundary      * 00031700
*              alignment of the parameter list. Use only 0F or 0D.    * 00031800
*              DEFAULT: 0D which forces the parameter list to a       * 00031900
*              doubleword boundary.                                   * 00032000
*                                                                     * 00032100
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00032200
*              specifies the execute form of the macro.  The "E" form * 00032300
*              generates code to put the parameters into the          * 00032400
*              parameter list specified by xmfctrl and provides full  * 00032500
*              syntax checking with default setting.                  * 00032600
*                                                                     * 00032700
*            ,xmfctrl                                                 * 00032800
*              is a required input.  It is the name (RS-type), or     * 00032900
*              address in register (1)-(12), of a storage area for    * 00033000
*              the parameter list.                                    * 00033100
*                                                                     * 00033200
*            »,COMPLETEº                                              * 00033300
*              is an optional keyword input which specifies the       * 00033400
*              degree of macro parameter syntax checking.             * 00033500
*              DEFAULT: COMPLETE                                      * 00033600
*                                                                     * 00033700
*                                                                     * 00033800
*              COMPLETE                                               * 00033900
*                  Checking for required macro keys is done and       * 00034000
*                  defaults are supplied for omitted optional         * 00034100
*                  parameters.                                        * 00034200
*                                                                     * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*                                                                     * 00034700
*                                                                     * 00034800
*                                                                     * 00034900
*01* RETURN CODES:                                                    * 00035000
*                                                                     * 00035100
*                                                                     * 00035200
*                                                                     * 00035300
*                      00   Successful - CTRACE has initiated the     * 00035400
*                           process of capturing the trace data.      * 00035500
*                                                                     * 00035600
*                      04   Unsuccessful - No data was captured since * 00035700
*                           the trace is not connected to an active   * 00035800
*                           writer.                                   * 00035900
*                                                                     * 00036000
*                      08   Unsuccessful due to environmental         * 00036100
*                           circumstances, reason code in register    * 00036200
*                           zero.                                     * 00036300
*                                                                     * 00036400
*                      12 (C) Unsuccessful due to invalid input,      * 00036500
*                           reason code in register zero.             * 00036600
*                                                                     * 00036700
*                                                                     * 00036800
*                                                                     * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*01* REASON CODES:                                                    * 00037200
*                                                                     * 00037300
*       The format for reason codes is xxxxyyxx where yy is the       * 00037400
*       hexadecimal reason code.                                      * 00037500
*                                                                     * 00037600
*                                                                     * 00037700
*       RETURN   REASON                                               * 00037800
*       CODE     CODE                                                 * 00037900
*                                                                     * 00038000
*                                                                     * 00038100
*       08       01 - Storage required to perform the CTRACE Write    * 00038200
*                operation could not be obtained.                     * 00038300
*                                                                     * 00038400
*       08       02 - Unable to schedule SRB to process this request. * 00038500
*                                                                     * 00038600
*       08       03 - The control information (TBWC) has already been * 00038700
*                reused by the component.                             * 00038800
*                                                                     * 00038900
*       12 (C)   01 - Could not process request since caller is       * 00039000
*                holding locks which require CTRACE to process.       * 00039100
*                                                                     * 00039200
*       12 (C)   02 - Invalid input token.                            * 00039300
*                                                                     * 00039400
*       12 (C)   03 - Input TBWC is invalid (not in real storage or   * 00039500
*                sequence number is the same as the previous write    * 00039600
*                request).                                            * 00039700
*                                                                     * 00039800
*                                                                     * 00039900
*                                                                     * 00040000
*01* ABEND CODES:                                                     * 00040100
*                                                                     * 00040200
*                                                                     * 00040300
*       00D       Component Trace service request failed.             * 00040400
*                                                                     * 00040500
*                                                                     * 00040600
*                                                                     * 00040700
*01* ABEND REASON CODES:                                              * 00040800
*                                                                     * 00040900
*       The format for reason codes is xxyyyyxx where yyyy is the     * 00041000
*       reason code.  The reason codes are in hexadecimal.            * 00041100
*                                                                     * 00041200
*                                                                     * 00041300
*       ABEND    REASON                                               * 00041400
*       CODE     CODE                                                 * 00041500
*                                                                     * 00041600
*                                                                     * 00041700
*       00D      0101 - Incompatible level of the CTRACEWR parameter  * 00041800
*                list used with the service routine.                  * 00041900
*                                                                     * 00042000
*       00D      0102 - Non zero values in the reserved fields or     * 00042100
*                fields unused for the requested service in the       * 00042200
*                CTRACEWR parameter list.                             * 00042300
*                                                                     * 00042400
*                                                                     * 00042500
*                                                                     * 00042600
*01* MODULE TYPE:  ASSEM MACRO                                        * 00042700
*                                                                     * 00042800
*02*   PROCESSOR:  ASSEM                                              * 00042900
*                                                                     * 00043000
*01* COMPONENT:  SCTRC                                                * 00043100
*                                                                     * 00043200
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00043300
*                                                                     * 00043400
*01* MACRO USAGE NOTES:                                               * 00043500
*                                                                     * 00043600
*                                                                     * 00043700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00043800
*        global macro variable.  Any value other than 'NO' will       * 00043900
*        result in the macro expansion being printed.  The default is * 00044000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00044100
*        variable should be set.                                      * 00044200
*                                                                     * 00044300
*                    GBLC &ZPRINT                                     * 00044400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00044500
*                                                                     * 00044600
*                                                                     * 00044700
*    2.  All   keys   currently   contained  in  the  CTRACEWR  macro * 00044800
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00044900
*        value of 0 or MAX.                                           * 00045000
*                                                                     * 00045100
*        None                                                         * 00045200
*                                                                     * 00045300
*                                                                     * 00045400
*                                                                     * 00045500
*01* CHANGE ACTIVITY:                                                 * 00045600
*                                                                     * 00045700
*   Flag LineItem  FMID    Date   ID    Comment                       * 00045800
*                                                                     * 00045900
*    $L0=CTWTR    HBB4420 071290 PD34G1:  Ctrace writer support.      * 00046000
*    $P1=PH31404  HBB4420 091790 PD34G1:  Fix copyright.              * 00046100
*    $L1=IOSCT    HBB6603 032996 PDXM:  Add SYNCH keyword.            * 00046200
*    $P2=PYN1087  HBB7708 051503 PDE1:  Recompile.                    * 00046300
*    $P3=ME00645  HBB7720 070104 PDXB:  buffSTOKEN                    * 00046400
****** END OF SPECIFICATIONS *****************************************/ 00046500
*/********************************************************************* 00046600
         MACRO                                                          00046700
&XLABEL  CTRACEWR &BUFFADDR=,&BUFFALET=,&BUFFSTOKEN=,&BUFFLEN=,&TOKEN=,*00046800
               &TBWCADDR=,&TBWCALET=,&SYNCH=,&RC=,&RSNCODE=,&COM=,     *00046900
               &PLISTVER=,&MF=                                          00047000
.*                                                                      00047100
*                MACDATE -09/24/04-<0>                                  00047200
.*                                                                      00047300
.*******************************************************************    00047400
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00047500
.*******************************************************************    00047600
                GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                 00047700
                GBLC  &ZTEST      YES=TEST NO=NO TEST                   00047800
                GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX           00047900
.*                                                                      00048000
                GBLC  &ZCTRACEWR  YES=MACRO USED AT LEAST ONCE          00048100
.*******************************************************************    00048200
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00048300
.*******************************************************************    00048400
                LCLC  &ZMS        ERROR MESSAGE WORK AREA               00048500
                LCLC  &ZCNDX      SYSNDX CHARACTERS                     00048600
                LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED            00048700
                LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR           00048800
                LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE           00048900
                LCLA  &ZAWRK      USED AS A WORK AREA                   00049000
                LCLA  &ZASIZ      USED FOR SIZE OF VALUE                00049100
                LCLA  &ZN         NUMERIC WORK VARIABLE                 00049200
                LCLC  &ZC         CHARACTER WORK VARIABLE               00049300
                LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE           00049400
                LCLA  &ZTLA       VALUE TOO LONG VARIABLE               00049500
                LCLC  &ZMAC_G     "G" or null                           00049600
&ZMAC_G         SETC  ''                                                00049700
                LCLC  &ZMAC_LR                                          00049800
&ZMAC_LR        SETC  'LR'                                              00049900
                LCLC  &ZMAC_L                                           00050000
&ZMAC_L         SETC  'L'                                               00050100
                LCLC  &ZMAC_ST                                          00050200
&ZMAC_ST        SETC  'ST'                                              00050300
                LCLA  &ZMACRET    MACRO RETURN CODE                     00050400
&ZMACRET        SETA  0           ASSUME NO ERRORS                      00050500
.*                                                                      00050600
                LCLC  &ZCSYSLIST(255)           NONXKEY, POS ARRAY      00050700
                LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()            00050800
                LCLA  &ZPLLEN     PARAMETER LIST LENGTH                 00050900
                LCLC  &ZENDBASEPL               End of base PL          00051000
                LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                 00051100
.*******************************************************************    00051200
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00051300
.*******************************************************************    00051400
                LCLA  &ZI         INDEX FOR ARRAY                       00051500
                LCLA  &ZJ         INDEX FOR PARMS                       00051600
                LCLA  &ZK         INDEX FOR PARSE                       00051700
                LCLA  &ZLO        LOW RANGE VALUE                       00051800
                LCLA  &ZHI        HIGH RANGE VALUE                      00051900
                LCLC  &ZW         WORK AREA FOR PARM                    00052000
.********************************************************************   00052100
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00052200
.********************************************************************   00052300
                GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL               00052400
                GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE        00052500
                GBLA  &SYSALVL    SYSSTATE ARCHLVL                      00052600
                GBLC  &SYSAM64    SYSSTATE AMODE64                      00052700
.*                                                                      00052800
                AIF   (K'&SYSASCE GT 0).ZSYS4   SYS STATE DEFINED       00052900
                AIF   (K'&SYSSPLV GT 0).ZSYS2   SP LEVEL DEFINED        00053000
                SPLEVEL  TEST                                           00053100
.ZSYS2          ANOP  ,                                                 00053200
                AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1             00053300
                AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1             00053400
                SYSSTATE TEST                                           00053500
                AGO   .ZSYS4                                            00053600
.ZSYS3          ANOP  ,                                                 00053700
&SYSASCE        SETC  'P'         ASSUME SYSSTATE PRIMARY               00053800
.ZSYS4          ANOP  ,                                                 00053900
.*******************************************************************    00054000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00054100
.*******************************************************************    00054200
                LCLC  &XBUFFADDR  ++ NAME                               00054300
                LCLC  &XBUFFALET  ++ NAME                               00054400
                LCLC  &XBUFFSTOKEN              ++ NAME                 00054500
                LCLC  &XBUFFLEN   ++ NAME                               00054600
                LCLC  &XTOKEN     ++ NAME                               00054700
                LCLC  &XTBWCADDR  ++ NAME                               00054800
                LCLC  &XTBWCALET  ++ NAME                               00054900
                LCLC  &XSYNCH     ++ VALUE                              00055000
                LCLC  &XRC        ++ NAME                               00055100
                LCLC  &XRSNCODE   ++ NAME                               00055200
                LCLC  &XCOM       ++ VALUE                              00055300
                LCLA  &XPLISTVER  ++ VALUE                              00055400
                LCLC  &XMF        ++ VALUE                              00055500
                LCLC  &XMFCTRL    ++ NAME                               00055600
                LCLC  &XMFATTR    ++ VALUE                              00055700
                LCLC  &XMFSCK     ++ VALUE                              00055800
.*******************************************************************    00055900
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00056000
.*******************************************************************    00056100
                LCLC  &ZXBUFFADDR               ++ INPUT NAME           00056200
                LCLC  &ZXBUFFALET               ++ INPUT NAME           00056300
                LCLC  &ZXBUFFSTOKEN             ++ INPUT NAME           00056400
                LCLC  &ZXBUFFLEN  ++ INPUT NAME                         00056500
                LCLC  &ZXTOKEN    ++ INPUT NAME                         00056600
                LCLC  &ZXTBWCADDR               ++ INPUT NAME           00056700
                LCLC  &ZXTBWCALET               ++ INPUT NAME           00056800
                LCLC  &ZXSYNCH    ++ INPUT VALUE                        00056900
                LCLC  &ZXRC       ++ OUTPUT NAME                        00057000
                LCLC  &ZXRSNCODE  ++ OUTPUT NAME                        00057100
                LCLC  &ZXCOM      ++ INPUT VALUE                        00057200
                LCLC  &ZXPLISTVER               ++ INPUT VALUE          00057300
                LCLC  &ZXMF       ++ INPUT VALUE                        00057400
                LCLC  &ZXMFCTRL   ++ INPUT NAME                         00057500
                LCLC  &ZXMFATTR   ++ INPUT VALUE                        00057600
                LCLC  &ZXMFSCK    ++ INPUT VALUE                        00057700
.********************************************************************   00057800
.***AC.PLV01  PROCESS PLISTVER                                      *   00057900
.********************************************************************   00058000
&XPLISTVER      SETA  0                                                 00058100
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00058200
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00058300
&XPLISTVER      SETA  0                                                 00058400
.ZPLV0          ANOP  ,                                                 00058500
.*                                                                      00058600
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00058700
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00058800
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00058900
.*-------------------------------------------------------------------   00059000
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00059100
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00059200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00059300
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00059400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00059500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00059600
                AGO   .ZPVCK2                                           00059700
.ZPVCK3         ANOP  ,                                                 00059800
.*-------------------------------------------------------------------   00059900
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00060000
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00060100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00060200
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00060300
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00060400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00060500
                AGO   .ZPVCKE                                           00060600
.ZPVCK2         ANOP  ,                                                 00060700
.*-------------------------------------------------------------------   00060800
&ZCVAL          SETC  '&PLISTVER(1)'                                    00060900
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00061000
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00061100
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00061200
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00061300
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00061400
.ZPVCK6         ANOP  ,                                                 00061500
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00061600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00061700
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00061800
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00061900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00062000
&XPLISTVER      SETA  0                                                 00062100
                AGO   .ZPVCKE                                           00062200
.*-------------------------------------------------------------------   00062300
.ZPVCK4A        ANOP  ,                                                 00062400
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00062500
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00062600
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00062700
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00062800
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00062900
                MNOTE 8,' &ZMS IS REQUIRED.'                            00063000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00063100
                AGO   .ZPVCK5                                           00063200
.ZPVCK4         ANOP  ,                                                 00063300
&XPLISTVER      SETA  &PLISTVER(1)                                      00063400
.ZPVCK5         ANOP  ,                                                 00063500
.ZPVCKE         ANOP  ,                                                 00063600
.********************************************************************   00063700
.***AG.MF01 PROCESS MF MACRO FORMS                                      00063800
.********************************************************************   00063900
                ACTR  10000                                             00064000
.*------------------------------------------------------------------    00064100
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00064200
&XMF            SETC  ''          INITIALIZE XVARIABLE                  00064300
.*-------------------------------------------------------------------   00064400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00064500
.ZG41           ANOP  ,                                                 00064600
&ZTLC           SETC 'S'                                                00064700
                AIF   ('&MF(1)' NE '&ZTLC').ZG42                        00064800
&XMF            SETC  'S'         SET KEYWORD                           00064900
                AIF   (N'&MF LE 1).ZG41A        CK NUM                  00065000
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00065100
&ZMS            SETC  '&ZMS.&MF"'                                       00065200
&ZMS            SETC  '&ZMS "MF"'                                       00065300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00065400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00065500
.ZG41A          ANOP  ,                                                 00065600
.*-------------------------------------------------------------------   00065700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00065800
.ZG42           ANOP  ,                                                 00065900
&ZTLC           SETC 'L'                                                00066000
                AIF   ('&MF(1)' NE '&ZTLC').ZG49                        00066100
&XMF            SETC  'L'         SET KEYWORD                           00066200
                AIF   (N'&MF LE 3).ZG42A        CK NUM                  00066300
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00066400
&ZMS            SETC  '&ZMS.&MF"'                                       00066500
&ZMS            SETC  '&ZMS "MF"'                                       00066600
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00066700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00066800
.ZG42A          ANOP  ,                                                 00066900
.*-------------------------------------------------------------------   00067000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00067100
                AIF   (N'&SYSLIST NE 0).ZG42B   POSITIONALS?            00067200
                AIF   ('&BUFFADDR' NE '').ZG42B  KEYS?                  00067300
                AIF   ('&BUFFALET' NE '').ZG42B  KEYS?                  00067400
                AIF   ('&BUFFSTOKEN' NE '').ZG42B  KEYS?                00067500
                AIF   ('&BUFFLEN' NE '').ZG42B  KEYS?                   00067600
                AIF   ('&TOKEN' NE '').ZG42B    KEYS?                   00067700
                AIF   ('&TBWCADDR' NE '').ZG42B  KEYS?                  00067800
                AIF   ('&TBWCALET' NE '').ZG42B  KEYS?                  00067900
                AIF   ('&SYNCH' NE '').ZG42B    KEYS?                   00068000
                AIF   ('&RC' NE '').ZG42B       KEYS?                   00068100
                AIF   ('&RSNCODE' NE '').ZG42B  KEYS?                   00068200
                AIF   ('&COM' NE '').ZG42B      KEYS?                   00068300
                AGO    .ZG42C     INVOCATION OKAY                       00068400
.ZG42B          ANOP  ,                                                 00068500
&ZMS            SETC  'THE "L" FORM OF "MF"'    *MFLA* MNOTE            00068600
&ZMS            SETC  '&ZMS CAN ONLY HAVE'                              00068700
&ZMS            SETC  '&ZMS THE "PLISTVER" KEY'                         00068800
                MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'            00068900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00069000
.ZG42C          ANOP  ,                                                 00069100
.*-------------------------------------------------------------------   00069200
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00069300
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00069400
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00069500
                AIF   (N'&MF(2) GT 1).ZG44B     MULTI PARMS             00069600
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00069700
.ZG44B          AIF   (K'&MF(2) GT 0).ZG44C                             00069800
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00069900
&ZMS            SETC  'WHEN "L" IS SPECIFIED'   *KRQDA*                 00070000
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00070100
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00070200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00070300
.ZG44C          ANOP  ,                                                 00070400
.*-------------------------------------------------------------------   00070500
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00070600
                AIF   (K'&ZXMFCTRL LE 0).ZG44P  NOT I/O                 00070700
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG44P                    00070800
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00070900
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00071000
&ZMS            SETC  '&ZMS.&MF"'                                       00071100
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00071200
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                 00071300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00071400
.ZG44P          ANOP  ,                                                 00071500
.*-------------------------------------------------------------------   00071600
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00071700
&ZXMFATTR       SETC  'INPUT'     SET IN/OUTPUT                         00071800
&XMFATTR        SETC  '0D'                                              00071900
                AIF   (K'&MF(3) LE 0).ZG47B     PARM                    00072000
&XMFATTR        SETC  '&MF(3,1)'  SET XVARIABLE                         00072100
                AIF   (N'&MF(3) GT 1).ZG47B     MULTI PARMS             00072200
&XMFATTR        SETC  '&MF(3)'    SET XVARIABLE                         00072300
.ZG47B          ANOP  ,                                                 00072400
.*-------------------------------------------------------------------   00072500
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00072600
                AIF   (K'&ZXMFATTR LE 0).ZG47P  NOT I/O                 00072700
                AIF   ('&XMFATTR'(1,1) NE '(').ZG47P                    00072800
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00072900
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00073000
&ZMS            SETC  '&ZMS.&MF"'                                       00073100
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00073200
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                 00073300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00073400
.ZG47P          ANOP  ,                                                 00073500
.*-------------------------------------------------------------------   00073600
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00073700
                AIF   (K'&ZXMFATTR LE 0).ZG47S  NOT I/O                 00073800
                AIF   (K'&XMFATTR LE 60).ZG47S  LNG OK                  00073900
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00074000
&ZMS            SETC  '"MF='      *KLNGA* MNOTE                         00074100
&ZMS            SETC  '&ZMS.&MF"'                                       00074200
&ZMS            SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'             00074300
                MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                00074400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00074500
.ZG47S          ANOP  ,                                                 00074600
.*-------------------------------------------------------------------   00074700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00074800
.ZG49           ANOP  ,                                                 00074900
&ZTLC           SETC 'E'                                                00075000
                AIF   ('&MF(1)' NE '&ZTLC').ZG57                        00075100
&XMF            SETC  'E'         SET KEYWORD                           00075200
                AIF   (N'&MF LE 3).ZG49A        CK NUM                  00075300
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00075400
&ZMS            SETC  '&ZMS.&MF"'                                       00075500
&ZMS            SETC  '&ZMS "MF"'                                       00075600
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00075700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00075800
.ZG49A          ANOP  ,                                                 00075900
.*-------------------------------------------------------------------   00076000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00076100
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00076200
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00076300
                AIF   (N'&MF(2) GT 1).ZG51B     MULTI PARMS             00076400
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00076500
.ZG51B          AIF   (K'&MF(2) GT 0).ZG51C                             00076600
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00076700
&ZMS            SETC  'WHEN "E" IS SPECIFIED'   *KRQDA*                 00076800
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00076900
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00077000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00077100
.ZG51C          ANOP  ,                                                 00077200
.*-------------------------------------------------------------------   00077300
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00077400
                AIF   (K'&ZXMFCTRL LE 0).ZG51R  NOT I/O                 00077500
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG51R                    00077600
&ZCGPR          SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                        00077700
                AIF   ('&ZCGPR'(1,1) NE '0').ZG51P                      00077800
                AIF   (K'&ZCGPR GT 2).ZG51Q                             00077900
                AIF   ('&ZCGPR' EQ '0').ZG51Q                           00078000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00078100
                AIF   (T'&ZCGPR NE 'N').ZG51Q   INVALID REG NAME        00078200
.ZG51P          ANOP  ,                                                 00078300
                AIF   (T'&ZCGPR NE 'N').ZG51R   NON NUMERIC             00078400
                AIF   ('&ZCGPR' LT '1').ZG51Q                           00078500
                AIF   ('&ZCGPR' LE '12').ZG51R                          00078600
.ZG51Q          ANOP  ,                                                 00078700
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00078800
&ZMS            SETC  '&ZMS.&MF"'                                       00078900
&ZMS            SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'         00079000
                MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                  00079100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00079200
.ZG51R          ANOP  ,                                                 00079300
.*-------------------------------------------------------------------   00079400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00079500
&XMFSCK         SETC  ''          INITIALIZE XVARIABLE                  00079600
.ZG55A   AIF   ('&MF(3)' NE 'COMPLETE').ZG56A                           00079700
&XMFSCK         SETC  'COMPLETE'  SET KEYWORD                           00079800
.*-------------------------------------------------------------------   00079900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00080000
.ZG56A          AIF   (K'&XMFSCK GT 0).ZG56C    KEYWORD                 00080100
                AIF   (K'&MF(3) LE 0).ZG56B                             00080200
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00080300
&ZMS            SETC  '&ZMS.&MF"'                                       00080400
&ZMS            SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '         00080500
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00080600
&ZMS            SETC  '&ZMS "COMPLETE".'                                00080700
                MNOTE 8,' &ZMS '                                        00080800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00080900
.ZG56B          ANOP  ,                                                 00081000
&XMFSCK         SETC  'COMPLETE'  SET DEFAULT KEYWORD                   00081100
.ZG56C          ANOP  ,                                                 00081200
&ZXMFSCK        SETC  'INPUT'     SET IN/OUTPUT                         00081300
.*------------------------------------------------------------------    00081400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00081500
.ZG57           ANOP  ,                                                 00081600
&ZXMF           SETC  'INPUT'     SET IN/OUTPUT                         00081700
                AIF   (K'&XMF GT 0).ZG57E       VALID ARG               00081800
                AIF   (T'&MF EQ 'O').ZG57D      OMITTED                 00081900
&ZASYSLNDX      SETA  0                                                 00082000
.ZG57A          ANOP  ,           POSITIONAL MACRO KEY                  00082100
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00082200
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG57C                  00082300
&ZTLC           SETC 'MF'                                               00082400
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG57A         00082500
.ZG57B          ANOP  ,                                                 00082600
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00082700
&ZMS            SETC  'THE "MF" KEY'            *KOPTA* MNOTE           00082800
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00082900
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00083000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00083100
                AGO   .ZG57E                                            00083200
.ZG57C          ANOP  ,                                                 00083300
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00083400
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00083500
&ZMS            SETC  '&ZMS.&MF"'                                       00083600
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00083700
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00083800
&ZMS            SETC  '&ZMS "S",'                                       00083900
&ZMS            SETC  '&ZMS "L",'                                       00084000
&ZMS            SETC  '&ZMS OR "E".'                                    00084100
                MNOTE 8,' &ZMS '                                        00084200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00084300
                AGO   .ZG57E                                            00084400
.ZG57D          ANOP  ,                                                 00084500
&XMF            SETC  'S'         SET DEFAULT KEYWORD                   00084600
&XMFSCK         SETC  'COMPLETE'  COMPLETE CHECKING                     00084700
.ZG57E          ANOP  ,                                                 00084800
.********************************************************************   00084900
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00085000
.********************************************************************   00085100
                ACTR  10000                                             00085200
.*-------------------------------------------------------------------   00085300
.***AG.MF03 MF=(SLE)                                                    00085400
                AIF   ('&XMF' EQ 'L').ZGMFX                             00085500
.*----------------------------------------------------------------***   00085600
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00085700
                AIF   (N'&BUFFADDR LE 1).ZG2A   CK NUM                  00085800
&ZMS            SETC  '"BUFFADDR='              *KPOSA* MNOTE           00085900
&ZMS            SETC  '&ZMS.&BUFFADDR"'                                 00086000
&ZMS            SETC  '&ZMS "BUFFADDR"'                                 00086100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00086200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00086300
.ZG2A           ANOP  ,                                                 00086400
.*-------------------------------------------------------------------   00086500
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00086600
&ZXBUFFADDR     SETC  'INPUT'     SET IN/OUTPUT                         00086700
&XBUFFADDR      SETC  '&BUFFADDR(1)'            SET XVARIABLE           00086800
                AIF   (N'&BUFFADDR GT 1).ZG2B   MULTI PARMS             00086900
&XBUFFADDR      SETC  '&BUFFADDR'               SET XVARIABLE           00087000
.ZG2B           AIF   (K'&BUFFADDR(1) GT 0).ZG2C                        00087100
&ZXBUFFADDR     SETC  ''          RESET IN/OUTPUT                       00087200
&ZMS            SETC  ' '         *KRQDA*                               00087300
&ZMS            SETC  '&ZMS "BUFFADDR" KEY AND ITS'                     00087400
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00087500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00087600
.ZG2C           ANOP  ,                                                 00087700
.*-------------------------------------------------------------------   00087800
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00087900
                AIF   (K'&ZXBUFFADDR LE 0).ZG2R  NOT I/O                00088000
                AIF   ('&XBUFFADDR'(1,1) NE '(').ZG2R                   00088100
&ZCGPR          SETC  '&XBUFFADDR'(2,K'&XBUFFADDR-2)                    00088200
                AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                       00088300
                AIF   (K'&ZCGPR GT 2).ZG2Q                              00088400
                AIF   ('&ZCGPR' EQ '0').ZG2Q                            00088500
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00088600
                AIF   (T'&ZCGPR NE 'N').ZG2Q    INVALID REG NAME        00088700
.ZG2P           ANOP  ,                                                 00088800
                AIF   (T'&ZCGPR NE 'N').ZG2R    NON NUMERIC             00088900
                AIF   ('&ZCGPR' LT '2').ZG2Q                            00089000
                AIF   ('&ZCGPR' LE '12').ZG2R                           00089100
.ZG2Q           ANOP  ,                                                 00089200
&ZMS            SETC  '"BUFFADDR='              *KGPRA* MNOTE           00089300
&ZMS            SETC  '&ZMS.&BUFFADDR"'                                 00089400
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00089500
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00089600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00089700
.ZG2R           ANOP  ,                                                 00089800
.*----------------------------------------------------------------***   00089900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00090000
                AIF   (N'&BUFFALET LE 1).ZG4A   CK NUM                  00090100
&ZMS            SETC  '"BUFFALET='              *KPOSA* MNOTE           00090200
&ZMS            SETC  '&ZMS.&BUFFALET"'                                 00090300
&ZMS            SETC  '&ZMS "BUFFALET"'                                 00090400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00090500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00090600
.ZG4A           ANOP  ,                                                 00090700
.*-------------------------------------------------------------------   00090800
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         00090900
&XBUFFALET      SETC  'NOBUFFALET'              SET DEFAULT             00091000
                AIF   (K'&BUFFALET(1) LE 0).ZG4C  PARM                  00091100
&XBUFFALET      SETC  '&BUFFALET(1)'            SET XVARIABLE           00091200
                AIF   (N'&BUFFALET GT 1).ZG4B   MULTI PARMS             00091300
&XBUFFALET      SETC  '&BUFFALET'               SET XVARIABLE           00091400
.ZG4B           AIF   (K'&BUFFADDR(1) GT 0).ZG4C  KEY                   00091500
&ZMS            SETC  '"BUFFALET'               *KDEPA* MNOTE           00091600
&ZMS            SETC  '&ZMS.=&BUFFALET"'                                00091700
&ZMS            SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                   00091800
&ZMS            SETC  '&ZMS '                                           00091900
&ZMS            SETC  '&ZMS "BUFFADDR"'                                 00092000
                MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                      00092100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00092200
.ZG4C           ANOP  ,                                                 00092300
&ZXBUFFALET     SETC  'INPUT'     SET IN/OUTPUT                         00092400
.*-------------------------------------------------------------------   00092500
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00092600
                AIF   (K'&ZXBUFFALET LE 0).ZG4R  NOT I/O                00092700
         AIF   ('&XBUFFALET' EQ 'NOBUFFALET').ZG4R                      00092800
                AIF   ('&XBUFFALET'(1,1) NE '(').ZG4R                   00092900
&ZCGPR          SETC  '&XBUFFALET'(2,K'&XBUFFALET-2)                    00093000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                       00093100
                AIF   (K'&ZCGPR GT 2).ZG4Q                              00093200
                AIF   ('&ZCGPR' EQ '0').ZG4Q                            00093300
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00093400
                AIF   (T'&ZCGPR NE 'N').ZG4Q    INVALID REG NAME        00093500
.ZG4P           ANOP  ,                                                 00093600
                AIF   (T'&ZCGPR NE 'N').ZG4R    NON NUMERIC             00093700
                AIF   ('&ZCGPR' LT '2').ZG4Q                            00093800
                AIF   ('&ZCGPR' LE '12').ZG4R                           00093900
.ZG4Q           ANOP  ,                                                 00094000
&ZMS            SETC  '"BUFFALET='              *KGPRA* MNOTE           00094100
&ZMS            SETC  '&ZMS.&BUFFALET"'                                 00094200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00094300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00094400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00094500
.ZG4R           ANOP  ,                                                 00094600
.*----------------------------------------------------------------***   00094700
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00094800
                AIF   (N'&BUFFSTOKEN LE 1).ZG7A  CK NUM                 00094900
&ZMS            SETC  '"BUFFSTOKEN='            *KPOSA* MNOTE           00095000
&ZMS            SETC  '&ZMS.&BUFFSTOKEN"'                               00095100
&ZMS            SETC  '&ZMS "BUFFSTOKEN"'                               00095200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00095300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00095400
.ZG7A           ANOP  ,                                                 00095500
.*-------------------------------------------------------------------   00095600
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         00095700
&XBUFFSTOKEN    SETC  'BY_BUFFALET'             SET DEFAULT             00095800
                AIF   (K'&BUFFSTOKEN(1) LE 0).ZG7C  PARM                00095900
&XBUFFSTOKEN    SETC  '&BUFFSTOKEN(1)'          SET XVARIABLE           00096000
                AIF   (N'&BUFFSTOKEN GT 1).ZG7B  MULTI PARMS            00096100
&XBUFFSTOKEN    SETC  '&BUFFSTOKEN'             SET XVARIABLE           00096200
.ZG7B           AIF   (K'&BUFFADDR(1) GT 0).ZG7C  KEY                   00096300
&ZMS            SETC  '"BUFFSTOKEN'             *KDEPA* MNOTE           00096400
&ZMS            SETC  '&ZMS.=&BUFFSTOKEN"'                              00096500
&ZMS            SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                   00096600
&ZMS            SETC  '&ZMS '                                           00096700
&ZMS            SETC  '&ZMS "BUFFADDR"'                                 00096800
                MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                      00096900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00097000
.ZG7C           ANOP  ,                                                 00097100
&ZXBUFFSTOKEN   SETC  'INPUT'     SET IN/OUTPUT                         00097200
.*-------------------------------------------------------------------   00097300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00097400
                AIF   (K'&ZXBUFFSTOKEN LE 0).ZG7R  NOT I/O              00097500
         AIF   ('&XBUFFSTOKEN' EQ 'BY_BUFFALET').ZG7R                   00097600
                AIF   ('&XBUFFSTOKEN'(1,1) NE '(').ZG7R                 00097700
&ZCGPR          SETC  '&XBUFFSTOKEN'(2,K'&XBUFFSTOKEN-2)                00097800
                AIF   ('&ZCGPR'(1,1) NE '0').ZG7P                       00097900
                AIF   (K'&ZCGPR GT 2).ZG7Q                              00098000
                AIF   ('&ZCGPR' EQ '0').ZG7Q                            00098100
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00098200
                AIF   (T'&ZCGPR NE 'N').ZG7Q    INVALID REG NAME        00098300
.ZG7P           ANOP  ,                                                 00098400
                AIF   (T'&ZCGPR NE 'N').ZG7R    NON NUMERIC             00098500
                AIF   ('&ZCGPR' LT '2').ZG7Q                            00098600
                AIF   ('&ZCGPR' LE '12').ZG7R                           00098700
.ZG7Q           ANOP  ,                                                 00098800
&ZMS            SETC  '"BUFFSTOKEN='            *KGPRA* MNOTE           00098900
&ZMS            SETC  '&ZMS.&BUFFSTOKEN"'                               00099000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00099100
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00099200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00099300
.ZG7R           ANOP  ,                                                 00099400
.*----------------------------------------------------------------***   00099500
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00099600
                AIF   (N'&BUFFLEN LE 1).ZG11A   CK NUM                  00099700
&ZMS            SETC  '"BUFFLEN='               *KPOSA* MNOTE           00099800
&ZMS            SETC  '&ZMS.&BUFFLEN"'                                  00099900
&ZMS            SETC  '&ZMS "BUFFLEN"'                                  00100000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00100100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00100200
.ZG11A          ANOP  ,                                                 00100300
.*-------------------------------------------------------------------   00100400
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00100500
&ZXBUFFLEN      SETC  'INPUT'     SET IN/OUTPUT                         00100600
&XBUFFLEN       SETC  '&BUFFLEN(1)'             SET XVARIABLE           00100700
                AIF   (N'&BUFFLEN GT 1).ZG11B   MULTI PARMS             00100800
&XBUFFLEN       SETC  '&BUFFLEN'  SET XVARIABLE                         00100900
.ZG11B          AIF   (K'&BUFFLEN(1) GT 0).ZG11C                        00101000
&ZXBUFFLEN      SETC  ''          RESET IN/OUTPUT                       00101100
&ZMS            SETC  ' '         *KRQDA*                               00101200
&ZMS            SETC  '&ZMS "BUFFLEN" KEY AND ITS'                      00101300
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00101400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00101500
.ZG11C          ANOP  ,                                                 00101600
.*-------------------------------------------------------------------   00101700
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00101800
                AIF   (K'&ZXBUFFLEN LE 0).ZG11R  NOT I/O                00101900
                AIF   ('&XBUFFLEN'(1,1) NE '(').ZG11R                   00102000
&ZCGPR          SETC  '&XBUFFLEN'(2,K'&XBUFFLEN-2)                      00102100
                AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                      00102200
                AIF   (K'&ZCGPR GT 2).ZG11Q                             00102300
                AIF   ('&ZCGPR' EQ '0').ZG11Q                           00102400
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00102500
                AIF   (T'&ZCGPR NE 'N').ZG11Q   INVALID REG NAME        00102600
.ZG11P          ANOP  ,                                                 00102700
                AIF   (T'&ZCGPR NE 'N').ZG11R   NON NUMERIC             00102800
                AIF   ('&ZCGPR' LT '2').ZG11Q                           00102900
                AIF   ('&ZCGPR' LE '12').ZG11R                          00103000
.ZG11Q          ANOP  ,                                                 00103100
&ZMS            SETC  '"BUFFLEN='               *KGPRA* MNOTE           00103200
&ZMS            SETC  '&ZMS.&BUFFLEN"'                                  00103300
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00103400
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00103500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00103600
.ZG11R          ANOP  ,                                                 00103700
.*----------------------------------------------------------------***   00103800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00103900
                AIF   (N'&TOKEN LE 1).ZG14A     CK NUM                  00104000
&ZMS            SETC  '"TOKEN='   *KPOSA* MNOTE                         00104100
&ZMS            SETC  '&ZMS.&TOKEN"'                                    00104200
&ZMS            SETC  '&ZMS "TOKEN"'                                    00104300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00104400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00104500
.ZG14A          ANOP  ,                                                 00104600
.*-------------------------------------------------------------------   00104700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00104800
&ZXTOKEN        SETC  'INPUT'     SET IN/OUTPUT                         00104900
&XTOKEN         SETC  '&TOKEN(1)'               SET XVARIABLE           00105000
                AIF   (N'&TOKEN GT 1).ZG14B     MULTI PARMS             00105100
&XTOKEN         SETC  '&TOKEN'    SET XVARIABLE                         00105200
.ZG14B          AIF   (K'&TOKEN(1) GT 0).ZG14C                          00105300
&ZXTOKEN        SETC  ''          RESET IN/OUTPUT                       00105400
&ZMS            SETC  ' '         *KRQDA*                               00105500
&ZMS            SETC  '&ZMS "TOKEN" KEY AND ITS'                        00105600
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00105700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00105800
.ZG14C          ANOP  ,                                                 00105900
.*-------------------------------------------------------------------   00106000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00106100
                AIF   (K'&ZXTOKEN LE 0).ZG14R   NOT I/O                 00106200
                AIF   ('&XTOKEN'(1,1) NE '(').ZG14R                     00106300
&ZCGPR          SETC  '&XTOKEN'(2,K'&XTOKEN-2)                          00106400
                AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                      00106500
                AIF   (K'&ZCGPR GT 2).ZG14Q                             00106600
                AIF   ('&ZCGPR' EQ '0').ZG14Q                           00106700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00106800
                AIF   (T'&ZCGPR NE 'N').ZG14Q   INVALID REG NAME        00106900
.ZG14P          ANOP  ,                                                 00107000
                AIF   (T'&ZCGPR NE 'N').ZG14R   NON NUMERIC             00107100
                AIF   ('&ZCGPR' LT '2').ZG14Q                           00107200
                AIF   ('&ZCGPR' LE '12').ZG14R                          00107300
.ZG14Q          ANOP  ,                                                 00107400
&ZMS            SETC  '"TOKEN='   *KGPRA* MNOTE                         00107500
&ZMS            SETC  '&ZMS.&TOKEN"'                                    00107600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00107700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00107800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00107900
.ZG14R          ANOP  ,                                                 00108000
.*----------------------------------------------------------------***   00108100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00108200
                AIF   (N'&TBWCADDR LE 1).ZG17A  CK NUM                  00108300
&ZMS            SETC  '"TBWCADDR='              *KPOSA* MNOTE           00108400
&ZMS            SETC  '&ZMS.&TBWCADDR"'                                 00108500
&ZMS            SETC  '&ZMS "TBWCADDR"'                                 00108600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00108700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00108800
.ZG17A          ANOP  ,                                                 00108900
.*-------------------------------------------------------------------   00109000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00109100
&ZXTBWCADDR     SETC  'INPUT'     SET IN/OUTPUT                         00109200
&XTBWCADDR      SETC  '&TBWCADDR(1)'            SET XVARIABLE           00109300
                AIF   (N'&TBWCADDR GT 1).ZG17B  MULTI PARMS             00109400
&XTBWCADDR      SETC  '&TBWCADDR'               SET XVARIABLE           00109500
.ZG17B          AIF   (K'&TBWCADDR(1) GT 0).ZG17C                       00109600
&ZXTBWCADDR     SETC  ''          RESET IN/OUTPUT                       00109700
&ZMS            SETC  ' '         *KRQDA*                               00109800
&ZMS            SETC  '&ZMS "TBWCADDR" KEY AND ITS'                     00109900
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00110000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00110100
.ZG17C          ANOP  ,                                                 00110200
.*-------------------------------------------------------------------   00110300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00110400
                AIF   (K'&ZXTBWCADDR LE 0).ZG17R  NOT I/O               00110500
                AIF   ('&XTBWCADDR'(1,1) NE '(').ZG17R                  00110600
&ZCGPR          SETC  '&XTBWCADDR'(2,K'&XTBWCADDR-2)                    00110700
                AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                      00110800
                AIF   (K'&ZCGPR GT 2).ZG17Q                             00110900
                AIF   ('&ZCGPR' EQ '0').ZG17Q                           00111000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00111100
                AIF   (T'&ZCGPR NE 'N').ZG17Q   INVALID REG NAME        00111200
.ZG17P          ANOP  ,                                                 00111300
                AIF   (T'&ZCGPR NE 'N').ZG17R   NON NUMERIC             00111400
                AIF   ('&ZCGPR' LT '2').ZG17Q                           00111500
                AIF   ('&ZCGPR' LE '12').ZG17R                          00111600
.ZG17Q          ANOP  ,                                                 00111700
&ZMS            SETC  '"TBWCADDR='              *KGPRA* MNOTE           00111800
&ZMS            SETC  '&ZMS.&TBWCADDR"'                                 00111900
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00112000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00112100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00112200
.ZG17R          ANOP  ,                                                 00112300
.*----------------------------------------------------------------***   00112400
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00112500
                AIF   (N'&TBWCALET LE 1).ZG20A  CK NUM                  00112600
&ZMS            SETC  '"TBWCALET='              *KPOSA* MNOTE           00112700
&ZMS            SETC  '&ZMS.&TBWCALET"'                                 00112800
&ZMS            SETC  '&ZMS "TBWCALET"'                                 00112900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00113000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00113100
.ZG20A          ANOP  ,                                                 00113200
.*-------------------------------------------------------------------   00113300
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00113400
&ZXTBWCALET     SETC  'INPUT'     SET IN/OUTPUT                         00113500
&XTBWCALET      SETC  'NOTBWCALET'                                      00113600
                AIF   (K'&TBWCALET(1) LE 0).ZG20B  PARM                 00113700
&XTBWCALET      SETC  '&TBWCALET(1)'            SET XVARIABLE           00113800
                AIF   (N'&TBWCALET GT 1).ZG20B  MULTI PARMS             00113900
&XTBWCALET      SETC  '&TBWCALET'               SET XVARIABLE           00114000
.ZG20B          ANOP  ,                                                 00114100
.*-------------------------------------------------------------------   00114200
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00114300
                AIF   (K'&ZXTBWCALET LE 0).ZG20R  NOT I/O               00114400
         AIF   ('&XTBWCALET' EQ 'NOTBWCALET').ZG20R                     00114500
                AIF   ('&XTBWCALET'(1,1) NE '(').ZG20R                  00114600
&ZCGPR          SETC  '&XTBWCALET'(2,K'&XTBWCALET-2)                    00114700
                AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                      00114800
                AIF   (K'&ZCGPR GT 2).ZG20Q                             00114900
                AIF   ('&ZCGPR' EQ '0').ZG20Q                           00115000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00115100
                AIF   (T'&ZCGPR NE 'N').ZG20Q   INVALID REG NAME        00115200
.ZG20P          ANOP  ,                                                 00115300
                AIF   (T'&ZCGPR NE 'N').ZG20R   NON NUMERIC             00115400
                AIF   ('&ZCGPR' LT '2').ZG20Q                           00115500
                AIF   ('&ZCGPR' LE '12').ZG20R                          00115600
.ZG20Q          ANOP  ,                                                 00115700
&ZMS            SETC  '"TBWCALET='              *KGPRA* MNOTE           00115800
&ZMS            SETC  '&ZMS.&TBWCALET"'                                 00115900
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00116000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00116100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00116200
.ZG20R          ANOP  ,                                                 00116300
.*----------------------------------------------------------------***   00116400
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00116500
                AIF   (N'&SYNCH LE 1).ZG23A     CK NUM                  00116600
&ZMS            SETC  '"SYNCH='   *KPOSA* MNOTE                         00116700
&ZMS            SETC  '&ZMS.&SYNCH"'                                    00116800
&ZMS            SETC  '&ZMS "SYNCH"'                                    00116900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00117000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00117100
.ZG23A          ANOP  ,                                                 00117200
.*-------------------------------------------------------------------   00117300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00117400
&XSYNCH         SETC  ''          INITIALIZE XVARIABLE                  00117500
.ZG24A   AIF   ('&SYNCH(1)' NE 'NO').ZG25A                              00117600
&XSYNCH         SETC  'NO'        SET KEYWORD                           00117700
.*-------------------------------------------------------------------   00117800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00117900
.ZG25A   AIF   ('&SYNCH(1)' NE 'YES').ZG26A                             00118000
&XSYNCH         SETC  'YES'       SET KEYWORD                           00118100
.*-------------------------------------------------------------------   00118200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00118300
.ZG26A          AIF   (K'&XSYNCH GT 0).ZG26C    KEYWORD                 00118400
                AIF   (K'&SYNCH(1) LE 0).ZG26B                          00118500
&ZMS            SETC  '"SYNCH='   *KUKWA* MNOTE                         00118600
&ZMS            SETC  '&ZMS.&SYNCH"'                                    00118700
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00118800
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00118900
&ZMS            SETC  '&ZMS "NO"'                                       00119000
&ZMS            SETC  '&ZMS OR "YES".'                                  00119100
                MNOTE 8,' &ZMS '                                        00119200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00119300
.ZG26B          ANOP  ,                                                 00119400
&XSYNCH         SETC  'NO'        SET DEFAULT KEYWORD                   00119500
.ZG26C          ANOP  ,                                                 00119600
&ZXSYNCH        SETC  'INPUT'     SET IN/OUTPUT                         00119700
.*----------------------------------------------------------------***   00119800
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00119900
                AIF   (N'&RC LE 1).ZG28A        CK NUM                  00120000
&ZMS            SETC  '"RC='      *KPOSA* MNOTE                         00120100
&ZMS            SETC  '&ZMS.&RC"'                                       00120200
&ZMS            SETC  '&ZMS "RC"'                                       00120300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00120400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00120500
.ZG28A          ANOP  ,                                                 00120600
.*-------------------------------------------------------------------   00120700
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00120800
                AIF   (K'&RC(1) LE 0).ZG28C     NO PARM                 00120900
&ZXRC           SETC  'OUTPUT'    SET OUTPUT                            00121000
&XRC            SETC  '&RC(1)'    SET XVARIABLE                         00121100
                AIF   (N'&RC GT 1).ZG28C                                00121200
&XRC            SETC  '&RC'       SET XVARIABLE                         00121300
.ZG28C          ANOP  ,                                                 00121400
.*-------------------------------------------------------------------   00121500
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00121600
                AIF   (K'&ZXRC LE 0).ZG28R      NOT I/O                 00121700
                AIF   ('&XRC'(1,1) NE '(').ZG28R                        00121800
&ZCGPR          SETC  '&XRC'(2,K'&XRC-2)                                00121900
                AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                      00122000
                AIF   (K'&ZCGPR GT 2).ZG28Q                             00122100
                AIF   ('&ZCGPR' EQ '0').ZG28Q                           00122200
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00122300
                AIF   (T'&ZCGPR NE 'N').ZG28Q   INVALID REG NAME        00122400
.ZG28P          ANOP  ,                                                 00122500
                AIF   (T'&ZCGPR NE 'N').ZG28R   NON NUMERIC             00122600
                AIF   ('&ZCGPR' LT '2').ZG28Q                           00122700
                AIF   ('&ZCGPR' LE '12').ZG28R                          00122800
.ZG28Q          ANOP  ,                                                 00122900
&ZMS            SETC  '"RC='      *KGPRA* MNOTE                         00123000
&ZMS            SETC  '&ZMS.&RC"'                                       00123100
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00123200
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00123300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00123400
.ZG28R          ANOP  ,                                                 00123500
.*----------------------------------------------------------------***   00123600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00123700
                AIF   (N'&RSNCODE LE 1).ZG31A   CK NUM                  00123800
&ZMS            SETC  '"RSNCODE='               *KPOSA* MNOTE           00123900
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00124000
&ZMS            SETC  '&ZMS "RSNCODE"'                                  00124100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00124200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00124300
.ZG31A          ANOP  ,                                                 00124400
.*-------------------------------------------------------------------   00124500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00124600
                AIF   (K'&RSNCODE(1) LE 0).ZG31C  NO PARM               00124700
&ZXRSNCODE      SETC  'OUTPUT'    SET OUTPUT                            00124800
&XRSNCODE       SETC  '&RSNCODE(1)'             SET XVARIABLE           00124900
                AIF   (N'&RSNCODE GT 1).ZG31C                           00125000
&XRSNCODE       SETC  '&RSNCODE'  SET XVARIABLE                         00125100
.ZG31C          ANOP  ,                                                 00125200
.*-------------------------------------------------------------------   00125300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00125400
                AIF   (K'&ZXRSNCODE LE 0).ZG31R  NOT I/O                00125500
                AIF   ('&XRSNCODE'(1,1) NE '(').ZG31R                   00125600
&ZCGPR          SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                      00125700
                AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                      00125800
                AIF   (K'&ZCGPR GT 2).ZG31Q                             00125900
                AIF   ('&ZCGPR' EQ '0').ZG31Q                           00126000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00126100
                AIF   (T'&ZCGPR NE 'N').ZG31Q   INVALID REG NAME        00126200
.ZG31P          ANOP  ,                                                 00126300
                AIF   (T'&ZCGPR NE 'N').ZG31R   NON NUMERIC             00126400
                AIF   ('&ZCGPR' LT '2').ZG31Q                           00126500
                AIF   ('&ZCGPR' LE '12').ZG31R                          00126600
.ZG31Q          ANOP  ,                                                 00126700
&ZMS            SETC  '"RSNCODE='               *KGPRA* MNOTE           00126800
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00126900
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00127000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00127100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00127200
.ZG31R          ANOP  ,                                                 00127300
.*----------------------------------------------------------------***   00127400
.***AG.KXVAR05 VALUE, OPT INPUT, KEYS -XVARIABLE KEY                    00127500
                AIF   (N'&COM LE 1).ZG34A       CK NUM                  00127600
&ZMS            SETC  '"COM='     *KPOSA* MNOTE                         00127700
&ZMS            SETC  '&ZMS.&COM"'                                      00127800
&ZMS            SETC  '&ZMS "COM"'                                      00127900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00128000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00128100
.ZG34A          ANOP  ,                                                 00128200
.*-------------------------------------------------------------------   00128300
.***AG.KXVAR13 VALUE, OPT INPUT, KEYS -XVARIABLE                        00128400
&ZXCOM          SETC  'INPUT'     SET IN/OUTPUT                         00128500
&XCOM           SETC  'NULL'                                            00128600
                AIF   (K'&COM(1) LE 0).ZG34B    PARM                    00128700
&XCOM           SETC  '&COM(1)'   SET XVARIABLE                         00128800
                AIF   (N'&COM GT 1).ZG34B       MULTI PARMS             00128900
&XCOM           SETC  '&COM'      SET XVARIABLE                         00129000
.ZG34B          ANOP  ,                                                 00129100
.*-------------------------------------------------------------------   00129200
.***AG.KCK01 VALUE, OPT INPUT, KEYS -GPR NOT ALLOWED                    00129300
                AIF   (K'&ZXCOM LE 0).ZG34P     NOT I/O                 00129400
                AIF   ('&XCOM' EQ 'NULL').ZG34P                         00129500
                AIF   ('&XCOM'(1,1) NE '(').ZG34P                       00129600
&ZXCOM          SETC  ''          RESET IN/OUTPUT                       00129700
&ZMS            SETC  '"COM='     *KGPRA* MNOTE                         00129800
&ZMS            SETC  '&ZMS.&COM"'                                      00129900
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00130000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00130100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00130200
.ZG34P          ANOP  ,                                                 00130300
.*-------------------------------------------------------------------   00130400
.***AG.KCK03 VALUE, OPT INPUT, KEYS -CHARACTER LENGTH                   00130500
                AIF   (K'&ZXCOM LE 0).ZG34S     NOT I/O                 00130600
                AIF   ('&XCOM' EQ 'NULL').ZG34S                         00130700
                AIF   (K'&XCOM LE 256).ZG34S    LNG OK                  00130800
&ZXCOM          SETC  ''          RESET IN/OUTPUT                       00130900
&ZMS            SETC  '"COM='     *KLNGA* MNOTE                         00131000
&ZMS            SETC  '&ZMS.&COM"'                                      00131100
&ZMS            SETC  '&ZMS ARGUMENT 1 EXCEEDS THE MAXIMUM'             00131200
                MNOTE 8,' &ZMS LENGTH OF 256 CHARACTERS.'               00131300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00131400
.ZG34S          ANOP  ,                                                 00131500
.******************************************************************     00131600
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00131700
.******************************************************************     00131800
                ACTR  10000                                             00131900
.*----------------------------------------------------------------***   00132000
.***AH.P02 EXTRA POSITIONALS                                            00132100
                AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS              00132200
                AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL              00132300
                AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL          00132400
                AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL           00132500
.ZGLISTX1       ANOP  ,                                                 00132600
&ZCVAL          SETC  ''          ERROR FIELD                           00132700
&ZAWRK          SETA  0           POSITIONAL NUMBER                     00132800
.ZGLIST2        ANOP  ,                                                 00132900
&ZAWRK          SETA  &ZAWRK+1    NEXT POSITIONAL                       00133000
                AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE              00133100
&ZCVAL          SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                   00133200
                AGO   .ZGLIST2                                          00133300
.*                                                                      00133400
.ZGLIST3        ANOP  ,                                                 00133500
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)     STRIP COMMA             00133600
&ZMS            SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE          00133700
&ZMS            SETC  '&ZMS "&ZCVAL"'                                   00133800
&ZMS            SETC  '&ZMS CANNOT BE USED.'                            00133900
&ZMS            SETC  '&ZMS NO POSITIONAL ARGUMENTS'                    00134000
                MNOTE 8,' &ZMS ARE ALLOWED.'                            00134100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00134200
.ZGLISTX        ANOP  ,                                                 00134300
&ZASYSLNDX      SETA  0                                                 00134400
.*-------------------------------------------------------------------   00134500
.***AG.MF04 MF=(SLE)                                                    00134600
.ZGMFX          ANOP  ,           END OF FULL SYNTAX CHECK              00134700
.*******************************************************************    00134800
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00134900
.*******************************************************************    00135000
                AIF   (&ZMACRET NE 0).ZLX2      ERROR DETECTED          00135100
.*******************************************************************    00135200
.***AE.01  START OF CTRACEWR MACRO CODE                                 00135300
.*******************************************************************    00135400
                LCLC  &M0M0001                 NAME                     00135500
&M0M0001        SETC  '&XLABEL'                SET NAME                 00135600
                AIF   (K'&XLABEL NE 0).XLAB2                            00135700
&M0M0001        SETC  'M00M&SYSNDX'            DEFAULT NAME             00135800
.*                                                                      00135900
.XLAB2          ANOP  ,                                                 00136000
                AIF   ('&XMF' EQ 'L').XLAB3                             00136100
&M0M0001 DS    0H                             CTRACEWR-0                00136200
.XLAB3          ANOP  ,                                                 00136300
.*******************************************************************    00136400
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00136500
.*******************************************************************    00136600
              PUSH  PRINT                                               00136700
                AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON        00136800
                PRINT OFF         ++ PR01                               00136900
                AGO   .ZPRNTXX                                          00137000
.ZPRINTX        PRINT ON                                                00137100
.ZPRNTXX        ANOP  ,                                                 00137200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00137300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00137400
.********************************************************************   00137500
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00137600
.********************************************************************   00137700
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00137800
                      LCLA  &ZOPN1         INVOCATION INDEX             00137900
                      LCLC  &ZOPL(4095)    LABEL                        00138000
                      LCLC  &ZOPO(4095)    OPERATION                    00138100
                      LCLC  &ZOPV(4095)    VALUE                        00138200
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00138300
.*                                                                      00138400
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00138500
.******************************************************************     00138600
.***AL.L10 CTRACEWR FMT=LIST MF=S!L PARAMETERS                          00138700
.******************************************************************     00138800
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00138900
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00139000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00139100
&XMFATTR              SETC  '0D'                                        00139200
.*                                                                      00139300
&ZOPN                 SETA  &ZOPN+1                                     00139400
&ZOPL(&ZOPN)          SETC  ' '                                         00139500
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00139600
&ZOPO(&ZOPN)          SETC  'B'                                         00139700
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00139800
                      AGO   .ZALVL6B                                    00139900
.ZALVL6A              ANOP                                              00140000
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00140100
&ZOPV(&ZOPN)          SETC  '4,8'                                       00140200
&ZOPN                 SETA  &ZOPN+1                                     00140300
&ZOPL(&ZOPN)          SETC  ' '                                         00140400
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00140500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00140600
.ZALVL6B              ANOP                                              00140700
&ZOPD(&ZOPN)          SETC  '++ CTRACEWR ARG PARMS'                     00140800
.*                                                                      00140900
&ZOPN                 SETA  &ZOPN+1                                     00141000
&ZOPL(&ZOPN)          SETC  ' '                                         00141100
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00141200
&ZOPV(&ZOPN)          SETC  '1'                                         00141300
&ZOPD(&ZOPN)          SETC  ' '                                         00141400
.*                                                                      00141500
.ZLMFSL2              ANOP  ,                                           00141600
.*-------------------------------------------------------------------   00141700
.***AM.L00  CTRACEWR FMT=LIST name                                      00141800
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00141900
&ZOPN                 SETA &ZOPN+1                                      00142000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00142100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00142200
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00142300
&ZOPD(&ZOPN)          SETC '++ CTRACEWR NAME'                           00142400
.ZLMFSL2M             ANOP  ,                                           00142500
.*-------------------------------------------------------------------   00142600
.***AM.L01  CTRACEWR FMT=LIST PARAMETERS                                00142700
&ZOPN                 SETA &ZOPN+1                                      00142800
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00142900
&ZOPO(&ZOPN)          SETC 'DS'                                         00143000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00143100
&ZOPD(&ZOPN)          SETC '++ CTRACEWR PARM LIST'                      00143200
.*-------------------------------------------------------------------   00143300
.***AM.L02 XVERSION XL1                                                 00143400
&ZOPN                 SETA &ZOPN+1                                      00143500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00143600
&ZOPO(&ZOPN)          SETC 'DS'                                         00143700
&ZOPV(&ZOPN)          SETC 'XL1'                                        00143800
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00143900
.*-------------------------------------------------------------------   00144000
.***AM.L03 XFLAGS BL.8                                                  00144100
&ZOPN                 SETA &ZOPN+1                                      00144200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00144300
&ZOPO(&ZOPN)          SETC 'DS'                                         00144400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00144500
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00144600
.*                                                                      00144700
&ZOPN                 SETA  &ZOPN+1                                     00144800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSYNCH_YES'                      00144900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00145000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00145100
&ZOPD(&ZOPN)          SETC  '++ XSYNCH.'                                00145200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00145300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00145400
.*                                                                      00145500
&ZOPN                 SETA  &ZOPN+1                                     00145600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_BUFFSTOKEN'              00145700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00145800
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00145900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00146000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).BUFFSTOKEN'                   00146100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00146200
.*-------------------------------------------------------------------   00146300
.***AM.L09  XRSV0000 CL2                                                00146400
&ZOPN                 SETA &ZOPN+1                                      00146500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0000'                         00146600
&ZOPO(&ZOPN)          SETC 'DS'                                         00146700
&ZOPV(&ZOPN)          SETC 'CL2'                                        00146800
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0000'                      00146900
.*-------------------------------------------------------------------   00147000
.***AM.L09  XBUFFADDR A                                                 00147100
&ZOPN                 SETA &ZOPN+1                                      00147200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFADDR'                        00147300
&ZOPO(&ZOPN)          SETC 'DS'                                         00147400
&ZOPV(&ZOPN)          SETC 'A'                                          00147500
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFADDR  XBUFFADDR'                  00147600
.*-------------------------------------------------------------------   00147700
.***AM.L09  XBUFFALET CL4                                               00147800
&ZOPN                 SETA &ZOPN+1                                      00147900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFALET'                        00148000
&ZOPO(&ZOPN)          SETC 'DS'                                         00148100
&ZOPV(&ZOPN)          SETC 'CL4'                                        00148200
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFALET  XBUFFALET'                  00148300
.*-------------------------------------------------------------------   00148400
.***AM.L09  XBUFFLEN F                                                  00148500
&ZOPN                 SETA &ZOPN+1                                      00148600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFLEN'                         00148700
&ZOPO(&ZOPN)          SETC 'DS'                                         00148800
&ZOPV(&ZOPN)          SETC 'F'                                          00148900
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFLEN  XBUFFLEN'                    00149000
.*-------------------------------------------------------------------   00149100
.***AM.L09  XTOKEN CL8                                                  00149200
&ZOPN                 SETA &ZOPN+1                                      00149300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTOKEN'                           00149400
&ZOPO(&ZOPN)          SETC 'DS'                                         00149500
&ZOPV(&ZOPN)          SETC 'CL8'                                        00149600
&ZOPD(&ZOPN)          SETC '++ &ZXTOKEN  XTOKEN'                        00149700
.*-------------------------------------------------------------------   00149800
.***AM.L09  XTBWCADDR A                                                 00149900
&ZOPN                 SETA &ZOPN+1                                      00150000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTBWCADDR'                        00150100
&ZOPO(&ZOPN)          SETC 'DS'                                         00150200
&ZOPV(&ZOPN)          SETC 'A'                                          00150300
&ZOPD(&ZOPN)          SETC '++ &ZXTBWCADDR  XTBWCADDR'                  00150400
.*-------------------------------------------------------------------   00150500
.***AM.L09  XTBWCALET CL4                                               00150600
&ZOPN                 SETA &ZOPN+1                                      00150700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTBWCALET'                        00150800
&ZOPO(&ZOPN)          SETC 'DS'                                         00150900
&ZOPV(&ZOPN)          SETC 'CL4'                                        00151000
&ZOPD(&ZOPN)          SETC '++ &ZXTBWCALET  XTBWCALET'                  00151100
.*-------------------------------------------------------------------   00151200
.***AM.L09  XBUFFSTOKEN CL8                                             00151300
&ZOPN                 SETA &ZOPN+1                                      00151400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFSTOKEN'                      00151500
&ZOPO(&ZOPN)          SETC 'DS'                                         00151600
&ZOPV(&ZOPN)          SETC 'CL8'                                        00151700
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFSTOKEN  XBUFFSTOKEN'              00151800
.*-------------------------------------------------------------------   00151900
.***AM.L10 END OF CTRACEWR LIST PARAMETERS                              00152000
&ZOPN                 SETA &ZOPN+1                                      00152100
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00152200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00152300
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00152400
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00152500
.*                                                                      00152600
&ZOPN                 SETA &ZOPN+1                                      00152700
&ZOPL(&ZOPN)          SETC ' '                                          00152800
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00152900
&ZOPV(&ZOPN)          SETC '1'                                          00153000
&ZOPD(&ZOPN)          SETC ' '                                          00153100
.*-------------------------------------------------------------------   00153200
.***AL.L12 CTRACEWR FMT=LIST MF=S!L PARAMETERS                          00153300
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00153400
.*                                                                      00153500
&ZOPN                 SETA  &ZOPN+1                                     00153600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00153700
&ZOPO(&ZOPN)          SETC  'DC'                                        00153800
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00153900
&ZOPD(&ZOPN)          SETC  '++ CTRACEWR ARG PARMS'                     00154000
.*                                                                      00154100
.ZLMFSLX              ANOP  ,                                           00154200
.*-------------------------------------------------------------------   00154300
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00154400
&ZPLLEN               SETA 40                                           00154500
.*                                                                      00154600
.******************************************************************     00154700
.***AI.L01 CTRACEWR FMT=LIST FILL IN PARAMETER AREA                     00154800
.******************************************************************     00154900
                      ACTR  10000                                       00155000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00155100
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00155200
&ZCVAL                SETC  'LAE'          XAX MODE                     00155300
.ZIMFXA               ANOP ,                                            00155400
.*                                                                      00155500
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00155600
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00155700
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00155800
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00155900
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00156000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00156100
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00156200
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00156300
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00156400
&ZOPN                 SETA  &ZOPN+1                                     00156500
&ZOPL(&ZOPN)          SETC  ' '                                         00156600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00156700
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00156800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00156900
                      AGO   .ZIMFNX                                     00157000
.*                                                                      00157100
.ZIMFN2               ANOP ,                                            00157200
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00157300
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00157400
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00157500
&ZOPN                 SETA  &ZOPN+1                                     00157600
&ZOPL(&ZOPN)          SETC  ' '                                         00157700
&ZOPO(&ZOPN)          SETC  'LAE'                                       00157800
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00157900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00158000
                      AGO   .ZIMFNX                                     00158100
.ZIMFNX1              ANOP ,                                            00158200
&ZOPN                 SETA  &ZOPN+1                                     00158300
&ZOPL(&ZOPN)          SETC  ' '                                         00158400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00158500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00158600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00158700
.ZIMFNX               ANOP ,                                            00158800
.********************************************************************   00158900
.***AI.L02 CTRACEWR FMT=LIST INITIALIZE PARAMETER AREA                  00159000
.********************************************************************   00159100
.***AI.L03 MF=(SLE)                                                     00159200
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00159300
.*                                                                      00159400
&ZOPN                 SETA  &ZOPN+1                                     00159500
&ZOPL(&ZOPN)          SETC  ' '                                         00159600
&ZOPO(&ZOPN)          SETC  'XC'                                        00159700
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00159800
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00159900
.ZIMFLX               ANOP  ,                                           00160000
.*-------------------------------------------------------------------   00160100
.***AI.L05 XFLAGS BL1                                                   00160200
&ZW                   SETC  ''                                          00160300
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00160400
.*-------------------------------------------------------------------   00160500
.***AI.L08 XFLAGS "YES"                                                 00160600
.***      BL1'1XXXXXXX'                                                 00160700
         AIF   ('&XSYNCH' NE 'YES').ZI3A                                00160800
&ZW                   SETC  '&ZW.1'                                     00160900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00161000
                      AGO   .ZI3C                                       00161100
.*                                                                      00161200
.ZI3A                 ANOP  ,                                           00161300
&ZW                   SETC  '&ZW.0'                                     00161400
.ZI3C                 ANOP  ,                                           00161500
.*-------------------------------------------------------------------   00161600
.***AI.L08 XFLAGS "BUFFSTOKEN"                                          00161700
.***      BL1'X1XXXXXX'                                                 00161800
         AIF   ('&BUFFSTOKEN' EQ '').ZI4A                               00161900
&ZW                   SETC  '&ZW.1000000'                               00162000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00162100
                      AGO   .ZI4C                                       00162200
.*                                                                      00162300
.ZI4A                 ANOP  ,                                           00162400
&ZW                   SETC  '&ZW.0000000'                               00162500
.ZI4C                 ANOP  ,                                           00162600
.*-------------------------------------------------------------------   00162700
.***AI.L11 XFLAGS BL1                                                   00162800
                      AIF   ('&ZCLNG' NE 'YES').ZI4E  ALL ZERO BITS     00162900
&ZOPN                 SETA  &ZOPN+1                                     00163000
&ZOPL(&ZOPN)          SETC  ' '                                         00163100
&ZOPO(&ZOPN)          SETC  'OI'                                        00163200
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00163300
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00163400
.ZI4E                 ANOP  ,                                           00163500
.*-------------------------------------------------------------------   00163600
.***AI.L25  XBUFFADDR AL4                                               00163700
                      AIF   ('&ZXBUFFADDR' EQ '').ZI6E                  00163800
                      AIF   ('&ZXBUFFADDR' EQ 'OUTPUT').ZI6E            00163900
&ZCGPR                SETC  '&XBUFFADDR'                                00164000
.*                                                                      00164100
                      AIF   ('&XBUFFADDR'(1,1) NE '(').ZI6B             00164200
&ZCGPR   SETC  '0('.'&XBUFFADDR'(2,K'&XBUFFADDR-2).')'                  00164300
                      AGO   .ZI6D                                       00164400
.ZI6B                 ANOP  ,                                           00164500
.*                                                                      00164600
&ZC                   SETC  '&XBUFFADDR'(1,1)                           00164700
                      AIF   (T'&ZC NE 'N').ZI6D                         00164800
&ZC                   SETC  '&XBUFFADDR'                                00164900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI6D                00165000
&ZCGPR                SETC  '=AL4(&XBUFFADDR)'                          00165100
.*                                                                      00165200
.ZI6D                 ANOP  ,                                           00165300
.*                                                                      00165400
&ZOPN                 SETA  &ZOPN+1                                     00165500
&ZOPL(&ZOPN)          SETC  ' '                                         00165600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00165700
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00165800
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFADDR XBUFFADDR'                  00165900
.*                                                                      00166000
.ZI6E                 ANOP  ,                                           00166100
.*-------------------------------------------------------------------   00166200
.***AI.L18  XBUFFALET CL4                                               00166300
         AIF   ('&XBUFFALET' NE 'NOBUFFALET').ZI7                       00166400
&ZXBUFFALET           SETC  ''             RESET INPUT/OUTPUT           00166500
.ZI7                  ANOP  ,                                           00166600
.*-------------------------------------------------------------------   00166700
.***AI.L25  XBUFFALET CL4                                               00166800
                      AIF   ('&ZXBUFFALET' EQ '').ZI7E                  00166900
                      AIF   ('&ZXBUFFALET' EQ 'OUTPUT').ZI7E            00167000
&ZCGPR                SETC  '&XBUFFALET'                                00167100
.*                                                                      00167200
                      AIF   ('&XBUFFALET'(1,1) NE '(').ZI7B             00167300
&ZCGPR   SETC  '0('.'&XBUFFALET'(2,K'&XBUFFALET-2).')'                  00167400
.ZI7B                 ANOP  ,                                           00167500
.*                                                                      00167600
&ZOPN                 SETA  &ZOPN+1                                     00167700
&ZOPL(&ZOPN)          SETC  ' '                                         00167800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00167900
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             00168000
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFALET XBUFFALET'                  00168100
.*                                                                      00168200
.ZI7E                 ANOP  ,                                           00168300
.*-------------------------------------------------------------------   00168400
.***AI.L25  XBUFFLEN F                                                  00168500
                      AIF   ('&ZXBUFFLEN' EQ '').ZI8E                   00168600
                      AIF   ('&ZXBUFFLEN' EQ 'OUTPUT').ZI8E             00168700
&ZCGPR                SETC  '&XBUFFLEN'                                 00168800
.*                                                                      00168900
                      AIF   ('&XBUFFLEN'(1,1) NE '(').ZI8B              00169000
&ZCGPR   SETC  '0('.'&XBUFFLEN'(2,K'&XBUFFLEN-2).')'                    00169100
                      AGO   .ZI8D                                       00169200
.ZI8B                 ANOP  ,                                           00169300
.*                                                                      00169400
&ZC                   SETC  '&XBUFFLEN'(1,1)                            00169500
                      AIF   (T'&ZC NE 'N').ZI8D                         00169600
&ZC                   SETC  '&XBUFFLEN'                                 00169700
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI8D                00169800
&ZCGPR                SETC  '=FL4''&XBUFFLEN'''                         00169900
.*                                                                      00170000
.ZI8D                 ANOP  ,                                           00170100
.*                                                                      00170200
&ZOPN                 SETA  &ZOPN+1                                     00170300
&ZOPL(&ZOPN)          SETC  ' '                                         00170400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00170500
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00170600
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFLEN XBUFFLEN'                    00170700
.*                                                                      00170800
.ZI8E                 ANOP  ,                                           00170900
.*-------------------------------------------------------------------   00171000
.***AI.L25  XTOKEN CL8                                                  00171100
                      AIF   ('&ZXTOKEN' EQ '').ZI9E                     00171200
                      AIF   ('&ZXTOKEN' EQ 'OUTPUT').ZI9E               00171300
&ZCGPR                SETC  '&XTOKEN'                                   00171400
.*                                                                      00171500
                      AIF   ('&XTOKEN'(1,1) NE '(').ZI9B                00171600
&ZCGPR   SETC  '0('.'&XTOKEN'(2,K'&XTOKEN-2).')'                        00171700
.ZI9B                 ANOP  ,                                           00171800
.*                                                                      00171900
&ZOPN                 SETA  &ZOPN+1                                     00172000
&ZOPL(&ZOPN)          SETC  ' '                                         00172100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00172200
&ZOPV(&ZOPN)          SETC  '16(8,1),&ZCGPR'                            00172300
&ZOPD(&ZOPN)          SETC  '++ &ZXTOKEN XTOKEN'                        00172400
.*                                                                      00172500
.ZI9E                 ANOP  ,                                           00172600
.*-------------------------------------------------------------------   00172700
.***AI.L25  XTBWCADDR AL4                                               00172800
                      AIF   ('&ZXTBWCADDR' EQ '').ZI10E                 00172900
                      AIF   ('&ZXTBWCADDR' EQ 'OUTPUT').ZI10E           00173000
&ZCGPR                SETC  '&XTBWCADDR'                                00173100
.*                                                                      00173200
                      AIF   ('&XTBWCADDR'(1,1) NE '(').ZI10B            00173300
&ZCGPR   SETC  '0('.'&XTBWCADDR'(2,K'&XTBWCADDR-2).')'                  00173400
                      AGO   .ZI10D                                      00173500
.ZI10B                ANOP  ,                                           00173600
.*                                                                      00173700
&ZC                   SETC  '&XTBWCADDR'(1,1)                           00173800
                      AIF   (T'&ZC NE 'N').ZI10D                        00173900
&ZC                   SETC  '&XTBWCADDR'                                00174000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               00174100
&ZCGPR                SETC  '=AL4(&XTBWCADDR)'                          00174200
.*                                                                      00174300
.ZI10D                ANOP  ,                                           00174400
.*                                                                      00174500
&ZOPN                 SETA  &ZOPN+1                                     00174600
&ZOPL(&ZOPN)          SETC  ' '                                         00174700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00174800
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            00174900
&ZOPD(&ZOPN)          SETC  '++ &ZXTBWCADDR XTBWCADDR'                  00175000
.*                                                                      00175100
.ZI10E                ANOP  ,                                           00175200
.*-------------------------------------------------------------------   00175300
.***AI.L18  XTBWCALET CL4                                               00175400
         AIF   ('&XTBWCALET' NE 'NOTBWCALET').ZI11                      00175500
&ZXTBWCALET           SETC  ''             RESET INPUT/OUTPUT           00175600
.ZI11                 ANOP  ,                                           00175700
.*-------------------------------------------------------------------   00175800
.***AI.L25  XTBWCALET CL4                                               00175900
                      AIF   ('&ZXTBWCALET' EQ '').ZI11E                 00176000
                      AIF   ('&ZXTBWCALET' EQ 'OUTPUT').ZI11E           00176100
&ZCGPR                SETC  '&XTBWCALET'                                00176200
.*                                                                      00176300
                      AIF   ('&XTBWCALET'(1,1) NE '(').ZI11B            00176400
&ZCGPR   SETC  '0('.'&XTBWCALET'(2,K'&XTBWCALET-2).')'                  00176500
.ZI11B                ANOP  ,                                           00176600
.*                                                                      00176700
&ZOPN                 SETA  &ZOPN+1                                     00176800
&ZOPL(&ZOPN)          SETC  ' '                                         00176900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00177000
&ZOPV(&ZOPN)          SETC  '28(4,1),&ZCGPR'                            00177100
&ZOPD(&ZOPN)          SETC  '++ &ZXTBWCALET XTBWCALET'                  00177200
.*                                                                      00177300
.ZI11E                ANOP  ,                                           00177400
.*-------------------------------------------------------------------   00177500
.***AI.L18  XBUFFSTOKEN CL8                                             00177600
         AIF   ('&XBUFFSTOKEN' NE 'BY_BUFFALET').ZI12                   00177700
&ZXBUFFSTOKEN         SETC  ''             RESET INPUT/OUTPUT           00177800
.ZI12                 ANOP  ,                                           00177900
.*-------------------------------------------------------------------   00178000
.***AI.L25  XBUFFSTOKEN CL8                                             00178100
                      AIF   ('&ZXBUFFSTOKEN' EQ '').ZI12E               00178200
                      AIF   ('&ZXBUFFSTOKEN' EQ 'OUTPUT').ZI12E         00178300
&ZCGPR                SETC  '&XBUFFSTOKEN'                              00178400
.*                                                                      00178500
                      AIF   ('&XBUFFSTOKEN'(1,1) NE '(').ZI12B          00178600
&ZCGPR   SETC  '0('.'&XBUFFSTOKEN'(2,K'&XBUFFSTOKEN-2).')'              00178700
.ZI12B                ANOP  ,                                           00178800
.*                                                                      00178900
&ZOPN                 SETA  &ZOPN+1                                     00179000
&ZOPL(&ZOPN)          SETC  ' '                                         00179100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00179200
&ZOPV(&ZOPN)          SETC  '32(8,1),&ZCGPR'                            00179300
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFSTOKEN XBUFFSTOKEN'              00179400
.*                                                                      00179500
.ZI12E                ANOP  ,                                           00179600
.*-------------------------------------------------------------------   00179700
&ZOPN1                SETA &ZOPN                                        00179800
.*******************************************************************    00179900
.***  PROCESS CTRACEWR OUTPUT PARAMETERS                                00180000
.*******************************************************************    00180100
                      ACTR  10000                                       00180200
.*******************************************************************    00180300
.***AO.X02  RETURN CODE PROCESSING                                      00180400
.*******************************************************************    00180500
                      AIF   (N'&RC LE 0).ZMRETX                         00180600
                      AIF   ('&XRC'(1,1) EQ '(').ZMRET2                 00180700
                      AIF   ('&XRC' EQ 'GPR15').ZMRETX                  00180800
                      AIF   ('&XRC' EQ 'REG15').ZMRETX                  00180900
                      AIF   ('&XRC' EQ 'R15').ZMRETX                    00181000
                      AIF   ('&XRC' EQ '15').ZMRETX                     00181100
&ZOPN                 SETA  &ZOPN+1                                     00181200
&ZOPL(&ZOPN)          SETC  ' '                                         00181300
&ZOPO(&ZOPN)          SETC  'ST'                                        00181400
&ZOPV(&ZOPN)          SETC  '15,&XRC'                                   00181500
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00181600
                      AGO   .ZMRETX                                     00181700
.*                                                                      00181800
.ZMRET2               ANOP  ,                                           00181900
&ZCGPR                SETC  '&XRC'(2,K'&XRC-2)                          00182000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00182100
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00182200
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00182300
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00182400
&ZOPN                 SETA  &ZOPN+1                                     00182500
&ZOPL(&ZOPN)          SETC  ' '                                         00182600
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00182700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00182800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00182900
.ZMRETX               ANOP  ,                                           00183000
.*******************************************************************    00183100
.***AO.X03  REASON CODE PROCESSING                                      00183200
.*******************************************************************    00183300
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00183400
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00183500
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00183600
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00183700
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00183800
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00183900
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00184000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00184100
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00184200
&ZOPN                 SETA  &ZOPN+1                                     00184300
&ZOPL(&ZOPN)          SETC  ' '                                         00184400
&ZOPO(&ZOPN)          SETC  'ST'                                        00184500
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00184600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00184700
                      AGO   .ZMRSNX                                     00184800
.*                                                                      00184900
.ZMRSN2               ANOP  ,                                           00185000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00185100
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00185200
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00185300
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00185400
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00185500
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00185600
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00185700
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00185800
&ZOPN                 SETA  &ZOPN+1                                     00185900
&ZOPL(&ZOPN)          SETC  ' '                                         00186000
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00186100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00186200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00186300
.ZMRSNX               ANOP  ,                                           00186400
.*******************************************************************    00186500
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00186600
.*******************************************************************    00186700
.ZMFLX                ANOP  ,              MF=L PROCESSING              00186800
.*******************************************************************    00186900
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00187000
.*******************************************************************    00187100
                      ACTR  10000                                       00187200
.*                                                                      00187300
                      LCLA  &ZLC           COLUMN POSITION              00187400
                      LCLA  &ZOPX          LIST TABLE INDEX             00187500
                      LCLC  &ZLL           LABEL                        00187600
                      LCLC  &ZLOP          OPERATION                    00187700
                      LCLC  &ZLV           VALUE                        00187800
                      LCLC  &ZLD           DESCRIPTION                  00187900
.*                                                                      00188000
&ZOPX                 SETA  1                                           00188100
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00188200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00188300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00188400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00188500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00188600
                      AIF   (K'&ZLD LE 0).ZL5                           00188700
&ZLC                  SETA  35             COMMENT COLUMN               00188800
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00188900
&ZLC                  SETA  33             COMMMENT COLUMN              00189000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00189100
&ZLV                  SETC  '&ZLV'.' '                                  00189200
                      AGO   .ZL3                                        00189300
.*                                                                      00189400
.ZL4                  ANOP  ,                                           00189500
&ZLV                  SETC  '&ZLV'.' '                                  00189600
.ZL5                  ANOP  ,                                           00189700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00189800
.*                                                                      00189900
&ZLL     &ZLOP &ZLV                                                     00190000
.*                                                                      00190100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00190200
                      AGO   .ZL2           CONTINUE LOOPING             00190300
.*                                                                      00190400
.ZLX                  ANOP  ,                                           00190500
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00190600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00190700
         L    14,16(0,0)            GET CVT ADDRESS                     00190800
         L    14,772(14,0)          GET SFT ADDRESS                     00190900
         L    14,296(14,0)          GET LX/EX (PC NUMBER)               00191000
         PC   0(14)                 PC TO CTRACE WRITER SERVICE         00191100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00191200
.ZLINKX               ANOP  ,                                           00191300
.*******************************************************************    00191400
.***AP.X01  FORMAT GENERATED CODE                                       00191500
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00191600
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00191700
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00191800
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00191900
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00192000
                      AIF   (K'&ZLD LE 0).ZL51                          00192100
&ZLC                  SETA  35             COMMENT COLUMN               00192200
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00192300
&ZLC                  SETA  33             COMMENT COLUMN               00192400
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00192500
&ZLV                  SETC  '&ZLV'.' '                                  00192600
                      AGO   .ZL31                                       00192700
.*                                                                      00192800
.ZL41                 ANOP  ,                                           00192900
&ZLV                  SETC  '&ZLV'.' '                                  00193000
.ZL51                 ANOP  ,                                           00193100
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00193200
.*                                                                      00193300
&ZLL     &ZLOP &ZLV                                                     00193400
.*                                                                      00193500
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00193600
                      AGO   .ZL21          CONTINUE LOOPING             00193700
.*                                                                      00193800
.ZLX1                 ANOP  ,                                           00193900
.*******************************************************************    00194000
.***AP.X02  END OF CTRACEWR MACRO                                       00194100
&ZCTRACEWR            SETC  'YES'          SET CTRACEWR USED            00194200
         POP   PRINT                                                    00194300
*                                            CTRACEWR-0                 00194400
         SPACE 1                                                        00194500
.ZLX2                 ANOP  ,                                           00194600
         MEND                                                           00194700
**********************************************************************/ 00194800
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00194900
*%CTRACEWR: MACRO KEYS(BUFFADDR,BUFFALET,BUFFSTOKEN,BUFFLEN,TOKEN,      00195000
*                 TBWCADDR,TBWCALET,SYNCH,RC,RSNCODE,COM,PLISTVER,MF);  00195100
*  ANS('?'!!MACLABEL!!' '!!'CTRACEWP '!!MACLIST!!                       00195200
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00195300
*%END CTRACEWR;                                                         00195400

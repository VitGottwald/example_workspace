*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IOSCHPD                               -02/24/15-<4> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  IOS CHPID Description Service                 * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 1997, 2015                         * 00001200
*                                                                     * 00001300
* STATUS= HBB77A0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The IOSCHPD macro returns information for a specific channel   * 00002100
*      path id (CHPID) or channel path type (CHP_Type).               * 00002200
*                                                                     * 00002300
*                                                                     * 00002400
*                                                                     * 00002500
*01* EXTERNAL CLASSIFICATION:                                         * 00002600
*                                                                     * 00002700
*02* GUPI: BASE                                                       * 00002800
*                                                                     * 00002900
*02* NONE: FIELDS                                                     * 00003000
*          UTILITYSTRINGS                                             * 00003100
*                                                                     * 00003200
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003300
*                                                                     * 00003400
*01* ENVIRONMENT:                                                     * 00003500
*                                                                     * 00003600
*                                                                     * 00003700
*                        LINKAGE=SYSTEM callers must meet the         * 00003800
*                        following criteria:                          * 00003900
*                                                                     * 00004000
*      Dispatchable unit mode: Task or SRB mode.                      * 00004100
*                                                                     * 00004200
*      Minimum authorization: Problem or Supervisor state.  Any PSW   * 00004300
*                        key.                                         * 00004400
*                                                                     * 00004500
*      AMODE:            24- or 31-bit.                               * 00004600
*                                                                     * 00004700
*      ASC mode:         Primary or Access Register.                  * 00004800
*                                                                     * 00004900
*      Interrupt status: Enabled or disabled for I/O and external     * 00005000
*                        interrupts.                                  * 00005100
*                                                                     * 00005200
*      Locks:            No locks held.                               * 00005300
*                                                                     * 00005400
*                                                                     * 00005500
*                                                                     * 00005600
*01* PROGRAMMING REQUIREMENTS:                                        * 00005700
*                                                                     * 00005800
*    None                                                             * 00005900
*                                                                     * 00006000
*01* RESTRICTIONS:                                                    * 00006100
*                                                                     * 00006200
*    The parameter list must be in the caller's primary address space * 00006300
*    or be addressable via the dispatchable unit access list.         * 00006400
*                                                                     * 00006500
*    The LINKAGE=BRANCH option is limited to callers which meet the   * 00006600
*    following criteria:                                              * 00006700
*                                                                     * 00006800
*                                                                     * 00006900
*    o   supervisor state and key 0                                   * 00007000
*                                                                     * 00007100
*    o   31 bit addressing mode                                       * 00007200
*                                                                     * 00007300
*    o   primary ASC mode                                             * 00007400
*                                                                     * 00007500
*    o   the parameter list and any storage areas pointed to by the   * 00007600
*        parameter list reside in fixed or DREF storage               * 00007700
*                                                                     * 00007800
*                                                                     * 00007900
*                                                                     * 00008000
*    The UTILITYSTRINGS option is limited to callers which are        * 00008100
*    running in supervisor state and key 0-7.                         * 00008200
*                                                                     * 00008300
*01* PERFORMANCE IMPLICATIONS:                                        * 00008400
*                                                                     * 00008500
*    None.                                                            * 00008600
*                                                                     * 00008700
*01* MACRO USAGE NOTES:                                               * 00008800
*                                                                     * 00008900
*                                                                     * 00009000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00009100
*        global macro variable.  Any value other than 'NO' will       * 00009200
*        result in the macro expansion being printed.  The default is * 00009300
*        'YES'.  The following examples illustrate how the ZPRINT     * 00009400
*        variable should be set.                                      * 00009500
*                                                                     * 00009600
*                    GBLC &ZPRINT                                     * 00009700
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00009800
*                                                                     * 00009900
*                                                                     * 00010000
*    2.  The  IOSCHPD macro supports multiple versions. The macro key * 00010100
*        list  below  contains the version level in which the key was * 00010200
*        first  introduced.  Positionals  are  identified by the word * 00010300
*        'Positional'  followed by the numeric value of its position. * 00010400
*        Nested  positionals  are  preceded  by their outer key.  The * 00010500
*        lowest value represents the original version and the highest * 00010600
*        value  represents  the  most  recent  version of the IOSCHPD * 00010700
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00010800
*        least  as high as the highest version number of all the keys * 00010900
*        being used.                                                  * 00011000
*                                                                     * 00011100
*        VERSION   KEY                                                * 00011200
*                                                                     * 00011300
*                                                                     * 00011400
*                                                                     * 00011500
*                                                                     * 00011600
*01* INPUT REGISTER INFORMATION:                                      * 00011700
*                                                                     * 00011800
*    Before  issuing  the  IOSCHPD macro, the caller does not have to * 00011900
*    place  any  information  into  any  register  unless using it in * 00012000
*    register  notation  for a particular parameter, or using it as a * 00012100
*    base register                                                    * 00012200
*                                                                     * 00012300
*01* OUTPUT REGISTER INFORMATION:                                     * 00012400
*                                                                     * 00012500
*    The  contents  of  registers  14  through  1  are altered during * 00012600
*    processing.                                                      * 00012700
*                                                                     * 00012800
*    When control returns to the caller, the GPRs contain:            * 00012900
*                                                                     * 00013000
*                                                                     * 00013100
*    REGISTER  CONTENTS                                               * 00013200
*                                                                     * 00013300
*    0         Reason Code                                            * 00013400
*                                                                     * 00013500
*    1         Unpredictable (Used as a work register by the system)  * 00013600
*                                                                     * 00013700
*    2-13      Unchanged                                              * 00013800
*                                                                     * 00013900
*    14        Unpredictable (Used as a work register by the system)  * 00014000
*                                                                     * 00014100
*    15        Return Code                                            * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*    When control returns to the caller, the ARs contain:             * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*    REGISTER  CONTENTS                                               * 00014900
*                                                                     * 00015000
*    0-1       Unpredictable (Used as work registers by the system)   * 00015100
*                                                                     * 00015200
*    2-13      Unchanged                                              * 00015300
*                                                                     * 00015400
*    14-15     Unpredictable (Used as work registers by the system)   * 00015500
*                                                                     * 00015600
*                                                                     * 00015700
*                                                                     * 00015800
*01* SYNTAX:                                                          * 00015900
*                                                                     * 00016000
*Ýxlabel¨  IOSCHPD  Ð  CHPID=xchpid                                   * 00016100
*                   ¿ ,CHP_TYPE=xchp_type                             * 00016200
*                        Ý,CHP_PARM=»xchp_parm!0º¨                    * 00016300
*                   Ð ,ACRONYM=Ýxacronym¨                             * 00016400
*                   Ô ,DESC=Ýxdesc¨                                   * 00016500
*                   Ô ,ATTR=Ýxattr¨                                   * 00016600
*                   Ô ,WWPN=Ýxwwpn¨                                   * 00016700
*                   Ô ,ND=Ýxnd¨                                       * 00016800
*                   ¿ ,UTILITYSTRINGS=Ýxutilitystrings¨               * 00016900
*                    Ý,LINKAGE=»SYSTEM!BRANCHº¨                       * 00017000
*                    Ý,RETCODE=xretcode¨                              * 00017100
*                    Ý,RSNCODE=xrsncode¨                              * 00017200
*                    Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨          * 00017300
*                   ÐÝ,MF=S¨                                          * 00017400
*                   ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                   * 00017500
*                   ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                     * 00017600
*                                                                     * 00017700
*                                                                     * 00017800
*      Where:                                                         * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*      Ýxlabel¨                                                       * 00018200
*          is an optional symbol, starting in column 1, that is the   * 00018300
*          name on the IOSCHPD macro invocation.  The name must       * 00018400
*          conform to the rules for an ordinary assembler language    * 00018500
*          symbol.                                                    * 00018600
*          DEFAULT: No name.                                          * 00018700
*                                                                     * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*      The following is a set of mutually exclusive keys.  This set   * 00019200
*      is required; only one key must be specified.                   * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*      CHPID=xchpid                                                   * 00019600
*          belongs to a set of mutually exclusive keys. It is the     * 00019700
*          name (RS-type), or address in register (2)-(12), of a      * 00019800
*          halfword input which specifies the CHPID number for which  * 00019900
*          to retrieve the acronym and/or description.  This is a     * 00020000
*          binary value that must be in the range of x'0000' to       * 00020100
*          x'00FF'.                                                   * 00020200
*                                                                     * 00020300
*      CHP_TYPE=xchp_type                                             * 00020400
*          belongs to a set of mutually exclusive keys. It is the     * 00020500
*          name (RS-type), or address in register (2)-(12), of a byte * 00020600
*          input which specifies the channel path type for which to   * 00020700
*          retrieve the acronym and/or description.  The channel path * 00020800
*          type can be obtained by invoking the ?UCBINFO PATHINFO     * 00020900
*          macro and mapping the results with the IOSDPATH mapping    * 00021000
*          macro.  (The interface type is in the field called         * 00021100
*          PathIntType).                                              * 00021200
*                                                                     * 00021300
*                                                                     * 00021400
*          ÝCHP_PARM=»xchp_parm!0º¨                                   * 00021500
*              is the name (RS-type), or address in register          * 00021600
*              (2)-(12), of an optional byte input which specifies    * 00021700
*              the Channel Path Parameter. If managed option is       * 00021800
*              specified with this keyword and if the CHP Type is     * 00021900
*              managed, the description and acronym returned will     * 00022000
*              indicate that the CHP Type is managed. 1 corresponds   * 00022100
*              to the managed option and 0 corresponds to the non     * 00022200
*              managed option.                                        * 00022300
*                                                                     * 00022400
*              NOTE:  If no CHP_PARM is specified, information        * 00022500
*              returned for default non managed option                * 00022600
*              DEFAULT: 0.                                            * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*                                                                     * 00023000
*                                                                     * 00023100
*                                                                     * 00023200
*      End of a set of mutually exclusive required keys.              * 00023300
*                                                                     * 00023400
*                                                                     * 00023500
*                                                                     * 00023600
*      The following is a group of keys.  At least one must be        * 00023700
*      specified.                                                     * 00023800
*                                                                     * 00023900
*                                                                     * 00024000
*      ACRONYM=Ýxacronym¨                                             * 00024100
*          is the name (RS-type), or address in register (2)-(12), of * 00024200
*          a 5 character output area which is to receive the acronym. * 00024300
*                                                                     * 00024400
*      DESC=Ýxdesc¨                                                   * 00024500
*          is the name (RS-type), or address in register (2)-(12), of * 00024600
*          a 32 character output area which is to receive the         * 00024700
*          description.                                               * 00024800
*                                                                     * 00024900
*      ATTR=Ýxattr¨                                                   * 00025000
*          is the name (RS-type), or address in register (2)-(12), of * 00025100
*          a 32 character output area which is to receive the CHPID   * 00025200
*          attributes.  ATTR can only be specified with CHPID.        * 00025300
*                                                                     * 00025400
*      WWPN=Ýxwwpn¨                                                   * 00025500
*          is the name (RS-type), or address in register (2)-(12), of * 00025600
*          a 64 bit output area which is to receive the Worldwide     * 00025700
*          Port Name (WWPN) for the CHPID.  If the WWPN is not        * 00025800
*          available, zeroes will be returned.  WWPN can only be      * 00025900
*          specified with CHPID.                                      * 00026000
*                                                                     * 00026100
*      ND=Ýxnd¨                                                       * 00026200
*          is the name (RS-type), or address in register (2)-(12), of * 00026300
*          a 32 character output area which is to receive the Node    * 00026400
*          descriptor for the CHPID.  If the Node Descriptor is not   * 00026500
*          available, zeroes will be returned.  ND can only be        * 00026600
*          specified with CHPID.                                      * 00026700
*                                                                     * 00026800
*      UTILITYSTRINGS=Ýxutilitystrings¨                               * 00026900
*          is the name (RS-type), or address in register (2)-(12), of * 00027000
*          a 64 character output area into which IOSCHPD is to return * 00027100
*          up to four 16 byte utility strings that were defined for   * 00027200
*          CHPID.  If no utility strings were defined for the CHPID,  * 00027300
*          the area is set to zeroes.  If fewer than four utility     * 00027400
*          strings were defined for the CHPID, the string positions   * 00027500
*          that were not defined are set to zeroes.  UTILITYSTRINGS   * 00027600
*          can only be specified with CHPID.                          * 00027700
*                                                                     * 00027800
*                                                                     * 00027900
*                                                                     * 00028000
*      End of group of keys.                                          * 00028100
*                                                                     * 00028200
*                                                                     * 00028300
*                                                                     * 00028400
*      ÝLINKAGE=»SYSTEM!BRANCHº¨                                      * 00028500
*          is an optional keyword input that indicates whether a      * 00028600
*          branch-entry linkage should be generated or a Program Call * 00028700
*          should be issued for the routine invocation.               * 00028800
*          DEFAULT: SYSTEM                                            * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*          LINKAGE=SYSTEM                                             * 00029200
*              requests Program Call invocation.                      * 00029300
*                                                                     * 00029400
*          LINKAGE=BRANCH                                             * 00029500
*              requests branch-entry invocation.  The LINKAGE=BRANCH  * 00029600
*              option is intended for performance-sensitive invokers  * 00029700
*              or programs which require this function during NIP     * 00029800
*              before a PC can be issued.  See RESTRICTIONS for the   * 00029900
*              restrictions on branch-entry invocation.               * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*                                                                     * 00030600
*      ÝRETCODE=xretcode¨                                             * 00030700
*          is the name (RS-type) of an optional fullword output       * 00030800
*          variable, or register (2)-(12) or (15), into which the     * 00030900
*          return code is to be copied from GPR 15.  If you specify   * 00031000
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00031100
*          the value will be left in GPR 15.                          * 00031200
*                                                                     * 00031300
*                                                                     * 00031400
*                                                                     * 00031500
*                                                                     * 00031600
*      ÝRSNCODE=xrsncode¨                                             * 00031700
*          is the name (RS-type) of an optional fullword output       * 00031800
*          variable into which the reason code is to be copied from   * 00031900
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00032000
*          R0 (within or without parentheses), the value will be left * 00032100
*          in GPR 0.                                                  * 00032200
*                                                                     * 00032300
*                                                                     * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00032700
*          is an optional byte input decimal value in the "1-4" range * 00032800
*          that specifies the macro version.  PLISTVER is the only    * 00032900
*          key allowed on the list form of MF and determines which    * 00033000
*          parameter list is generated.  The macro keys associated    * 00033100
*          with each supported version of the macro are listed in     * 00033200
*          MACRO USAGE NOTE 2.  Note that MAX may be specified        * 00033300
*          instead of a number, and the parameter list will be of the * 00033400
*          largest size currently supported. This size may grow from  * 00033500
*          release to release (thus possibly affecting the amount of  * 00033600
*          storage needed by your program).  If your program can      * 00033700
*          tolerate this, IBM recommends that you always specify MAX  * 00033800
*          when creating the list form parameter list as that will    * 00033900
*          ensure that the list form parameter list is always long    * 00034000
*          enough to hold whatever parameters might be specified on   * 00034100
*          the execute form.                                          * 00034200
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00034300
*          default is the lowest version which allows all of the      * 00034400
*          parameters specified on the invocation to be processed.    * 00034500
*                                                                     * 00034600
*                                                                     * 00034700
*                                                                     * 00034800
*                                                                     * 00034900
*      ÝMF=»S!L!Eº¨                                                   * 00035000
*          is an optional keyword input which specifies the macro     * 00035100
*          form.                                                      * 00035200
*          DEFAULT: S                                                 * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*          ÝMF=S¨                                                     * 00035600
*              specifies the standard form of the macro.  The "S"     * 00035700
*              form generates code to put the parameters into an      * 00035800
*              in-line parameter list and invoke the desired service. * 00035900
*              Full checking for required macro keys is done along    * 00036000
*              with supplying defaults for omitted optional           * 00036100
*              parameters.                                            * 00036200
*                                                                     * 00036300
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00036400
*              specifies the list form of the macro.  The "L" form    * 00036500
*              defines an area to be used for the parameter list.     * 00036600
*              Only the PLISTVER key may be specified on the          * 00036700
*              invocation.  All other macro parameters are flagged as * 00036800
*              errors.  If PLISTVER is not specified, the original    * 00036900
*              parameter list definition is used.                     * 00037000
*                                                                     * 00037100
*            ,xmfctrl                                                 * 00037200
*              is a required input.  It is the name of a storage area * 00037300
*              for the parameter list.                                * 00037400
*                                                                     * 00037500
*            »,xmfattr!0Dº                                            * 00037600
*              is an optional 60 character input string that varies   * 00037700
*              from 1 to 60 characters. Use it to force boundary      * 00037800
*              alignment of the parameter list. Use only 0F or 0D.    * 00037900
*              DEFAULT: 0D which forces the parameter list to a       * 00038000
*              doubleword boundary.                                   * 00038100
*                                                                     * 00038200
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00038300
*              specifies the execute form of the macro.  The "E" form * 00038400
*              generates code to put the parameters into the          * 00038500
*              parameter list specified by xmfctrl and provides full  * 00038600
*              syntax checking with default setting.                  * 00038700
*                                                                     * 00038800
*            ,xmfctrl                                                 * 00038900
*              is a required input.  It is the name (RS-type), or     * 00039000
*              address in register (1)-(12), of a storage area for    * 00039100
*              the parameter list.                                    * 00039200
*                                                                     * 00039300
*            »,COMPLETEº                                              * 00039400
*              is an optional keyword input which specifies the       * 00039500
*              degree of macro parameter syntax checking.             * 00039600
*              DEFAULT: COMPLETE                                      * 00039700
*                                                                     * 00039800
*                                                                     * 00039900
*              COMPLETE                                               * 00040000
*                  Checking for required macro keys is done and       * 00040100
*                  defaults are supplied for omitted optional         * 00040200
*                  parameters.                                        * 00040300
*                                                                     * 00040400
*                                                                     * 00040500
*                                                                     * 00040600
*                                                                     * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*                                                                     * 00041000
*01* RETURN CODES:                                                    * 00041100
*                                                                     * 00041200
*                                                                     * 00041300
*                                                                     * 00041400
*                 X'00'     The requested information has been        * 00041500
*                           returned.                                 * 00041600
*                                                                     * 00041700
*                 X'04'     The requested information has not been    * 00041800
*                           returned.  Unless indicated differently   * 00041900
*                           below, all of the output areas for the    * 00042000
*                           information to be returned have been set  * 00042100
*                           to zeroes.                                * 00042200
*                                                                     * 00042300
*                           Reason Codes                              * 00042400
*                                                                     * 00042500
*                                                                     * 00042600
*                           X'00'     The system could not determine  * 00042700
*                                     the CHP type from the input     * 00042800
*                                     CHPID.                          * 00042900
*                                                                     * 00043000
*                           X'01'     The input CHPID is not          * 00043100
*                                     configured.                     * 00043200
*                                                                     * 00043300
*                           X'02'     The CHP type obtained from the  * 00043400
*                                     input CHPID is not valid.       * 00043500
*                                                                     * 00043600
*                           X'03'     The input CHP type is invalid.  * 00043700
*                                                                     * 00043800
*                           X'04'     The input CHP_PARM is invalid.  * 00043900
*                                                                     * 00044000
*                           X'05'     The managed option(1) was       * 00044100
*                                     specified with CHP_PARM.        * 00044200
*                                     However, the CHP_Type is not    * 00044300
*                                     managed. The default acronym    * 00044400
*                                     and/or description is returned. * 00044500
*                                                                     * 00044600
*                           X'06'     The system was unable to obtain * 00044700
*                                     the requested information from  * 00044800
*                                     the channel subsystem for this  * 00044900
*                                     CHPID.                          * 00045000
*                                                                     * 00045100
*                           X'07'     The input CHPID value is        * 00045200
*                                     invalid (must be in the range   * 00045300
*                                     of X'0000' to x'00FF').         * 00045400
*                                                                     * 00045500
*                                                                     * 00045600
*                                                                     * 00045700
*                 X'08'     Error in caller's parameters.             * 00045800
*                                                                     * 00045900
*                           Reason codes                              * 00046000
*                                                                     * 00046100
*                                                                     * 00046200
*                           X'01'     The caller specified an invalid * 00046300
*                                     ALET.                           * 00046400
*                                                                     * 00046500
*                           X'02'     An error occurred in accessing  * 00046600
*                                     the caller's parameter list.    * 00046700
*                                                                     * 00046800
*                           X'03'     A keyword that is not allowed   * 00046900
*                                     to be specified with CHP_TYPE   * 00047000
*                                     was specified.  This keyword is * 00047100
*                                     only allowed when CHPID is      * 00047200
*                                     specified.  For example, ATTR   * 00047300
*                                     may only be specified when      * 00047400
*                                     CHPID is specified.             * 00047500
*                                                                     * 00047600
*                           X'04'     A caller who was not in         * 00047700
*                                     supervisor state and key 0-7    * 00047800
*                                     specified a restricted keyword  * 00047900
*                                     (e.g., UTILITYSTRINGS).         * 00048000
*                                                                     * 00048100
*                           X'05'     An error occurred referencing   * 00048200
*                                     the user-supplied work area for * 00048300
*                                     the UtilityStrings information. * 00048400
*                                                                     * 00048500
*                                                                     * 00048600
*                                                                     * 00048700
*                 X'C'      Recovery was entered.                     * 00048800
*                                                                     * 00048900
*                 X'20'     Recovery was entered.                     * 00049000
*                                                                     * 00049100
*                                                                     * 00049200
*                                                                     * 00049300
*                                                                     * 00049400
*                                                                     * 00049500
*01* REASON CODES:                                                    * 00049600
*                                                                     * 00049700
*       See return codes section.                                     * 00049800
*                                                                     * 00049900
*01* MODULE TYPE:  ASSEM MACRO                                        * 00050000
*                                                                     * 00050100
*02*   PROCESSOR:  ASSEM                                              * 00050200
*                                                                     * 00050300
*01* COMPONENT:  SC1C3                                                * 00050400
*                                                                     * 00050500
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00050600
*                                                                     * 00050700
*01* CHANGE ACTIVITY:                                                 * 00050800
*                                                                     * 00050900
*   Flag LineItem  FMID    Date   ID    Comment                       * 00051000
*                                                                     * 00051100
*    $L0=HERC     HBB6605 970423 PDHC:  Hercules support              * 00051200
*    $L1=DYCHM    HBB7703 991022 PDUU:  Dynamic CHPID Management      * 00051300
*                                         Support                     * 00051400
*    $L2=DYCHM    JBB7713 000818 PDED:  Dynamic CHPID Management      * 00051500
*                                         Support                     * 00051600
*    $L3=SMI-S    HBB7770 090630 PDHC:  SMI-S Support : Add WWPN      * 00051700
*    $L4=PORTDEC  HBB7790 110731 PDMD:  Switch Port Decommissioning:  * 00051800
*                                         Changes flagged as OA38303  * 00051900
*    $L5=PCIEIOS  HBB7790 121212 PDDR:  Added function to return the  * 00052000
*                                         utility strings for a       * 00052100
*                                         CHPID.                      * 00052200
*    $P1=PUX0381  HBB6605 970819 PDHC:  Remove Hercules support - no  * 00052300
*                                         code change                 * 00052400
*    $P2=OA42231  HBB77A0 150216 PDDR:  Indicate that the CHPID       * 00052500
*                                         parameter is a binary value * 00052600
*                                         in the range of x'0000' to  * 00052700
*                                         X'00FF'.  Added return      * 00052800
*                                         code=4, reason code=7 if    * 00052900
*                                         the CHPID value is invalid. * 00053000
*    $01=OW33706  HBB6603 980630 PDLE:  No code changes. Reship to    * 00053100
*                                         complete OW33706            * 00053200
*    $02=OW37043  HBB6603 990730 MXN:  Correct function code set when * 00053300
*                                         invoking IOSCHPD from       * 00053400
*                                         assembler program.          * 00053500
*    $03=OW54840  HBB6608 020615 PDUU:  Roll back ATTR output keyword * 00053600
*                                         support from JBB7713 back   * 00053700
*                                         to HBB6608.  No code        * 00053800
*                                         changes at JBB7713 and      * 00053900
*                                         above.                      * 00054000
*    $A8=OA38303  HBB7770 120831 PDMD:  Switch Port Decommissioning:  * 00054100
*                                         Add ND                      * 00054200
****** END OF SPECIFICATIONS *****************************************/ 00054300
*/********************************************************************* 00054400
         MACRO                                                          00054500
&XLABEL  IOSCHPD &CHPID=,&CHP_TYPE=,&CHP_PARM=,&ACRONYM=,&DESC=,&ATTR=,*00054600
               &WWPN=,&ND=,&UTILITYSTRINGS=,&LINKAGE=,&RETCODE=,       *00054700
               &RSNCODE=,&PLISTVER=,&MF=                                00054800
.*                                                                      00054900
*                    MACDATE -02/24/15-<4>                              00055000
.*                                                                      00055100
.*******************************************************************    00055200
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00055300
.*******************************************************************    00055400
                    GBLC  &ZPRINT     YES=PRINT NO=NO PRINT             00055500
                    GBLC  &ZTEST      YES=TEST NO=NO TEST               00055600
                    GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX       00055700
.*                                                                      00055800
                    GBLC  &ZIOSCHPD   YES=MACRO USED AT LEAST ONCE      00055900
.*******************************************************************    00056000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00056100
.*******************************************************************    00056200
                    LCLC  &ZMS        ERROR MESSAGE WORK AREA           00056300
                    LCLC  &ZCNDX      SYSNDX CHARACTERS                 00056400
                    LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED        00056500
                    LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR       00056600
                    LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE       00056700
                    LCLA  &ZAWRK      USED AS A WORK AREA               00056800
                    LCLA  &ZASIZ      USED FOR SIZE OF VALUE            00056900
                    LCLA  &ZN         NUMERIC WORK VARIABLE             00057000
                    LCLC  &ZC         CHARACTER WORK VARIABLE           00057100
                    LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE       00057200
                    LCLA  &ZTLA       VALUE TOO LONG VARIABLE           00057300
                    LCLC  &ZMAC_G     "G" or null                       00057400
&ZMAC_G             SETC  ''                                            00057500
                    LCLC  &ZMAC_LR                                      00057600
&ZMAC_LR            SETC  'LR'                                          00057700
                    LCLC  &ZMAC_L                                       00057800
&ZMAC_L             SETC  'L'                                           00057900
                    LCLC  &ZMAC_ST                                      00058000
&ZMAC_ST            SETC  'ST'                                          00058100
                    LCLC  &ZMAC_LLGT                                    00058200
&ZMAC_LLGT          SETC  'L'                                           00058300
                    LCLC  &ZMAC_LGR                                     00058400
&ZMAC_LGR           SETC  'LR'                                          00058500
                    LCLC  &ZMAC_LG                                      00058600
&ZMAC_LG            SETC  'L'                                           00058700
                    LCLC  &ZMAC_STG                                     00058800
&ZMAC_STG           SETC  'ST'                                          00058900
                    LCLA  &ZMACRET    MACRO RETURN CODE                 00059000
&ZMACRET            SETA  0           ASSUME NO ERRORS                  00059100
.*                                                                      00059200
                    LCLC  &ZCSYSLIST(255)       NONXKEY, POS ARRAY      00059300
                    LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()        00059400
                    LCLA  &ZPLLEN     PARAMETER LIST LENGTH             00059500
                    LCLC  &ZENDBASEPL           End of base PL          00059600
                    LCLA  &ZPLWORKA   PARAMETER LIST LENGTH             00059700
.*******************************************************************    00059800
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00059900
.*******************************************************************    00060000
                    LCLA  &ZI         INDEX FOR ARRAY                   00060100
                    LCLA  &ZJ         INDEX FOR PARMS                   00060200
                    LCLA  &ZK         INDEX FOR PARSE                   00060300
                    LCLA  &ZLO        LOW RANGE VALUE                   00060400
                    LCLA  &ZHI        HIGH RANGE VALUE                  00060500
                    LCLC  &ZW         WORK AREA FOR PARM                00060600
.********************************************************************   00060700
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00060800
.********************************************************************   00060900
                    GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL           00061000
                    GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE    00061100
                    GBLA  &SYSALVL    SYSSTATE ARCHLVL                  00061200
                    GBLC  &SYSAM64    SYSSTATE AMODE64                  00061300
.*                                                                      00061400
                    AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED    00061500
                    AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED     00061600
                    SPLEVEL  TEST                                       00061700
.ZSYS2              ANOP  ,                                             00061800
                    AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1         00061900
                    AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1         00062000
                    SYSSTATE TEST                                       00062100
                    AGO   .ZSYS4                                        00062200
.ZSYS3              ANOP  ,                                             00062300
&SYSASCE            SETC  'P'         ASSUME SYSSTATE PRIMARY           00062400
.ZSYS4              ANOP  ,                                             00062500
                    AIF   ('&SYSAM64' NE 'YES').ZSYSN64                 00062600
&ZMAC_LLGT          SETC 'LLGT'                                         00062700
&ZMAC_LGR           SETC 'LGR'                                          00062800
&ZMAC_LG            SETC 'LG'                                           00062900
&ZMAC_STG           SETC 'STG'                                          00063000
.ZSYSN64            ANOP  ,                                             00063100
.*******************************************************************    00063200
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00063300
.*******************************************************************    00063400
                    LCLC  &XCHPIDVAR1           ++ NAME                 00063500
                    LCLC  &XCHPID     ++ NAME                           00063600
                    LCLC  &XCHP_TYPE  ++ NAME                           00063700
                    LCLC  &XCHP_PARM  ++ NAME                           00063800
                    LCLC  &XACRONYM   ++ NAME                           00063900
                    LCLC  &XDESC      ++ NAME                           00064000
                    LCLC  &XATTR      ++ NAME                           00064100
                    LCLC  &XWWPN      ++ NAME                           00064200
                    LCLC  &XND        ++ NAME                           00064300
                    LCLC  &XUTILITYSTRINGS      ++ NAME                 00064400
                    LCLC  &XLINKAGE   ++ VALUE                          00064500
                    LCLC  &XRETCODE   ++ NAME                           00064600
                    LCLC  &XRSNCODE   ++ NAME                           00064700
                    LCLA  &XPLISTVER  ++ VALUE                          00064800
                    LCLC  &XMF        ++ VALUE                          00064900
                    LCLC  &XMFCTRL    ++ NAME                           00065000
                    LCLC  &XMFATTR    ++ VALUE                          00065100
                    LCLC  &XMFSCK     ++ VALUE                          00065200
.*******************************************************************    00065300
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00065400
.*******************************************************************    00065500
                    LCLC  &ZXCHPIDVAR1          ++ INPUT NAME           00065600
                    LCLC  &ZXCHPID    ++ INPUT NAME                     00065700
                    LCLC  &ZXCHP_TYPE           ++ INPUT NAME           00065800
                    LCLC  &ZXCHP_PARM           ++ INPUT NAME           00065900
                    LCLC  &ZXACRONYM  ++ OUTPUT NAME                    00066000
                    LCLC  &ZXDESC     ++ OUTPUT NAME                    00066100
                    LCLC  &ZXATTR     ++ OUTPUT NAME                    00066200
                    LCLC  &ZXWWPN     ++ OUTPUT NAME                    00066300
                    LCLC  &ZXND       ++ OUTPUT NAME                    00066400
                    LCLC  &ZXUTILITYSTRINGS     ++ OUTPUT NAME          00066500
                    LCLC  &ZXLINKAGE  ++ INPUT VALUE                    00066600
                    LCLC  &ZXRETCODE  ++ OUTPUT NAME                    00066700
                    LCLC  &ZXRSNCODE  ++ OUTPUT NAME                    00066800
                    LCLC  &ZXPLISTVER           ++ INPUT VALUE          00066900
                    LCLC  &ZXMF       ++ INPUT VALUE                    00067000
                    LCLC  &ZXMFCTRL   ++ INPUT NAME                     00067100
                    LCLC  &ZXMFATTR   ++ INPUT VALUE                    00067200
                    LCLC  &ZXMFSCK    ++ INPUT VALUE                    00067300
.********************************************************************   00067400
.***AC.PLV01  PROCESS PLISTVER                                      *   00067500
.********************************************************************   00067600
&XPLISTVER      SETA  1                                                 00067700
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00067800
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00067900
&XPLISTVER      SETA  4                                                 00068000
.ZPLV0          ANOP  ,                                                 00068100
.*                                                                      00068200
                AIF   ('&ATTR' EQ '').ZPLV1E                            00068300
                AIF   (&XPLISTVER GE 2).ZPLV1E                          00068400
&XPLISTVER      SETA  2                                                 00068500
.ZPLV1E         ANOP  ,                                                 00068600
.*                                                                      00068700
                AIF   ('&WWPN' EQ '').ZPLV2E                            00068800
                AIF   (&XPLISTVER GE 2).ZPLV2E                          00068900
&XPLISTVER      SETA  2                                                 00069000
.ZPLV2E         ANOP  ,                                                 00069100
.*                                                                      00069200
                AIF   ('&ND' EQ '').ZPLV3E                              00069300
                AIF   (&XPLISTVER GE 3).ZPLV3E                          00069400
&XPLISTVER      SETA  3                                                 00069500
.ZPLV3E         ANOP  ,                                                 00069600
.*                                                                      00069700
                AIF   ('&UTILITYSTRINGS' EQ '').ZPLV4E                  00069800
                AIF   (&XPLISTVER GE 4).ZPLV4E                          00069900
&XPLISTVER      SETA  4                                                 00070000
.ZPLV4E         ANOP  ,                                                 00070100
.*                                                                      00070200
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00070300
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00070400
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00070500
.*-------------------------------------------------------------------   00070600
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00070700
&ZMS            SETC  '"PLISTVER='                                      00070800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00070900
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00071000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00071100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00071200
                AGO   .ZPVCK2                                           00071300
.ZPVCK3         ANOP  ,                                                 00071400
.*-------------------------------------------------------------------   00071500
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00071600
&ZMS            SETC  '"PLISTVER='                                      00071700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00071800
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00071900
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00072000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00072100
                AGO   .ZPVCKE                                           00072200
.ZPVCK2         ANOP  ,                                                 00072300
.*-------------------------------------------------------------------   00072400
&ZCVAL          SETC  '&PLISTVER(1)'                                    00072500
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00072600
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00072700
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00072800
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00072900
                AIF   (&ZN LE 4).ZPVCK4A   NOT HIGH                     00073000
.ZPVCK6         ANOP  ,                                                 00073100
&ZMS            SETC  '"PLISTVER='                                      00073200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00073300
&ZMS            SETC  '&ZMS THE RANGE IS "1-4"'                         00073400
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00073500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00073600
&XPLISTVER      SETA  4                                                 00073700
                AGO   .ZPVCKE                                           00073800
.*-------------------------------------------------------------------   00073900
.ZPVCK4A        ANOP  ,                                                 00074000
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00074100
&ZMS            SETC  'PLISTVER='                                       00074200
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00074300
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00074400
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00074500
                MNOTE 8,' &ZMS IS REQUIRED.'                            00074600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00074700
                AGO   .ZPVCK5                                           00074800
.ZPVCK4         ANOP  ,                                                 00074900
&XPLISTVER      SETA  &PLISTVER(1)                                      00075000
.ZPVCK5         ANOP  ,                                                 00075100
.ZPVCKE         ANOP  ,                                                 00075200
.********************************************************************   00075300
.***AG.MF01 PROCESS MF MACRO FORMS                                      00075400
.********************************************************************   00075500
                    ACTR  10000                                         00075600
.*------------------------------------------------------------------    00075700
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00075800
&XMF                SETC  ''          INITIALIZE XVARIABLE              00075900
.*-------------------------------------------------------------------   00076000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00076100
.ZG32               ANOP  ,                                             00076200
&ZTLC               SETC 'S'                                            00076300
                    AIF   ('&MF(1)' NE '&ZTLC').ZG33                    00076400
&XMF                SETC  'S'         SET KEYWORD                       00076500
                    AIF   (N'&MF LE 1).ZG32A    CK NUM                  00076600
&ZMS                SETC  '"MF='                                        00076700
&ZMS                SETC  '&ZMS.&MF"'                                   00076800
&ZMS                SETC  '&ZMS "MF"'                                   00076900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00077000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00077100
.ZG32A              ANOP  ,                                             00077200
.*-------------------------------------------------------------------   00077300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00077400
.ZG33               ANOP  ,                                             00077500
&ZTLC               SETC 'L'                                            00077600
                    AIF   ('&MF(1)' NE '&ZTLC').ZG40                    00077700
&XMF                SETC  'L'         SET KEYWORD                       00077800
                    AIF   (N'&MF LE 3).ZG33A    CK NUM                  00077900
&ZMS                SETC  '"MF='                                        00078000
&ZMS                SETC  '&ZMS.&MF"'                                   00078100
&ZMS                SETC  '&ZMS "MF"'                                   00078200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'          00078300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00078400
.ZG33A              ANOP  ,                                             00078500
.*-------------------------------------------------------------------   00078600
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00078700
                    AIF   (N'&SYSLIST NE 0).ZG33B  POSITIONALS?         00078800
                    AIF   ('&CHPID' NE '').ZG33B  KEYS?                 00078900
                    AIF   ('&CHP_TYPE' NE '').ZG33B  KEYS?              00079000
                    AIF   ('&CHP_PARM' NE '').ZG33B  KEYS?              00079100
                    AIF   ('&ACRONYM' NE '').ZG33B  KEYS?               00079200
                    AIF   ('&DESC' NE '').ZG33B  KEYS?                  00079300
                    AIF   ('&ATTR' NE '').ZG33B  KEYS?                  00079400
                    AIF   ('&WWPN' NE '').ZG33B  KEYS?                  00079500
                    AIF   ('&ND' NE '').ZG33B   KEYS?                   00079600
                    AIF   ('&UTILITYSTRINGS' NE '').ZG33B  KEYS?        00079700
                    AIF   ('&LINKAGE' NE '').ZG33B  KEYS?               00079800
                    AIF   ('&RETCODE' NE '').ZG33B  KEYS?               00079900
                    AIF   ('&RSNCODE' NE '').ZG33B  KEYS?               00080000
                    AGO    .ZG33C     INVOCATION OKAY                   00080100
.ZG33B              ANOP  ,                                             00080200
&ZMS                SETC  'THE "L" FORM OF "MF"'                        00080300
&ZMS                SETC  '&ZMS CAN ONLY HAVE'                          00080400
&ZMS                SETC  '&ZMS THE "PLISTVER" KEY'                     00080500
                    MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'        00080600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00080700
.ZG33C              ANOP  ,                                             00080800
.*-------------------------------------------------------------------   00080900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00081000
&ZXMFCTRL           SETC  'INPUT'     SET IN/OUTPUT                     00081100
&XMFCTRL            SETC  '&MF(2,1)'  SET XVARIABLE                     00081200
                    AIF   (N'&MF(2) GT 1).ZG35B  MULTI                  00081300
&XMFCTRL            SETC  '&MF(2)'    SET XVARIABLE                     00081400
.ZG35B              AIF   (K'&MF(2) GT 0).ZG35C                         00081500
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00081600
&ZMS                SETC  'WHEN "L" IS SPECIFIED'                       00081700
&ZMS                SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'           00081800
                    MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                  00081900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00082000
.ZG35C              ANOP  ,                                             00082100
.*-------------------------------------------------------------------   00082200
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00082300
                    AIF   (K'&ZXMFCTRL LE 0).ZG35P  NOT I/O             00082400
                    AIF   ('&XMFCTRL'(1,1) NE '(').ZG35P                00082500
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00082600
&ZMS                SETC  '"MF='                                        00082700
&ZMS                SETC  '&ZMS.&MF"'                                   00082800
&ZMS                SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'     00082900
                    MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'             00083000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00083100
.ZG35P              ANOP  ,                                             00083200
.*-------------------------------------------------------------------   00083300
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00083400
&ZXMFATTR           SETC  'INPUT'     SET IN/OUTPUT                     00083500
&XMFATTR            SETC  '0D'                                          00083600
                    AIF   (K'&MF(3) LE 0).ZG38B  PARM                   00083700
&XMFATTR            SETC  '&MF(3,1)'  SET XVARIABLE                     00083800
                    AIF   (N'&MF(3) GT 1).ZG38B  MULTI                  00083900
&XMFATTR            SETC  '&MF(3)'    SET XVARIABLE                     00084000
.ZG38B              ANOP  ,                                             00084100
.*-------------------------------------------------------------------   00084200
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00084300
                    AIF   (K'&ZXMFATTR LE 0).ZG38P  NOT I/O             00084400
                    AIF   ('&XMFATTR'(1,1) NE '(').ZG38P                00084500
&ZXMFATTR           SETC  ''          RESET IN/OUTPUT                   00084600
&ZMS                SETC  '"MF='                                        00084700
&ZMS                SETC  '&ZMS.&MF"'                                   00084800
&ZMS                SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'     00084900
                    MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'             00085000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00085100
.ZG38P              ANOP  ,                                             00085200
.*-------------------------------------------------------------------   00085300
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00085400
                    AIF   (K'&ZXMFATTR LE 0).ZG38S  NOT I/O             00085500
                    AIF   (K'&XMFATTR LE 60).ZG38S  LNG OK              00085600
&ZXMFATTR           SETC  ''          RESET IN/OUTPUT                   00085700
&ZMS                SETC  '"MF='                                        00085800
&ZMS                SETC  '&ZMS.&MF"'                                   00085900
&ZMS                SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'         00086000
                    MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'            00086100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00086200
.ZG38S              ANOP  ,                                             00086300
.*-------------------------------------------------------------------   00086400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00086500
.ZG40               ANOP  ,                                             00086600
&ZTLC               SETC 'E'                                            00086700
                    AIF   ('&MF(1)' NE '&ZTLC').ZG48                    00086800
&XMF                SETC  'E'         SET KEYWORD                       00086900
                    AIF   (N'&MF LE 3).ZG40A    CK NUM                  00087000
&ZMS                SETC  '"MF='                                        00087100
&ZMS                SETC  '&ZMS.&MF"'                                   00087200
&ZMS                SETC  '&ZMS "MF"'                                   00087300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'          00087400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00087500
.ZG40A              ANOP  ,                                             00087600
.*-------------------------------------------------------------------   00087700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00087800
&ZXMFCTRL           SETC  'INPUT'     SET IN/OUTPUT                     00087900
&XMFCTRL            SETC  '&MF(2,1)'  SET XVARIABLE                     00088000
                    AIF   (N'&MF(2) GT 1).ZG42B  MULTI                  00088100
&XMFCTRL            SETC  '&MF(2)'    SET XVARIABLE                     00088200
.ZG42B              AIF   (K'&MF(2) GT 0).ZG42C                         00088300
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00088400
&ZMS                SETC  'WHEN "E" IS SPECIFIED'                       00088500
&ZMS                SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'           00088600
                    MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                  00088700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00088800
.ZG42C              ANOP  ,                                             00088900
.*-------------------------------------------------------------------   00089000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00089100
                    AIF   (K'&ZXMFCTRL LE 0).ZG42R  NOT I/O             00089200
                    AIF   ('&XMFCTRL'(1,1) NE '(').ZG42R                00089300
&ZCGPR              SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                    00089400
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG42P                  00089500
                    AIF   (K'&ZCGPR GT 2).ZG42Q                         00089600
                    AIF   ('&ZCGPR' EQ '0').ZG42Q                       00089700
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00089800
                    AIF   (T'&ZCGPR NE 'N').ZG42Q  INVALID REG NAME     00089900
.ZG42P              ANOP  ,                                             00090000
                    AIF   (T'&ZCGPR NE 'N').ZG42R  NON NUMERIC          00090100
                    AIF   ('&ZCGPR' LT '1').ZG42Q                       00090200
                    AIF   ('&ZCGPR' LE '12').ZG42R                      00090300
.ZG42Q              ANOP  ,                                             00090400
&ZMS                SETC  '"MF='                                        00090500
&ZMS                SETC  '&ZMS.&MF"'                                   00090600
&ZMS                SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'     00090700
                    MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'              00090800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00090900
.ZG42R              ANOP  ,                                             00091000
.*-------------------------------------------------------------------   00091100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00091200
&XMFSCK             SETC  ''          INITIALIZE XVARIABLE              00091300
.ZG46A   AIF   ('&MF(3)' NE 'COMPLETE').ZG47A                           00091400
&XMFSCK             SETC  'COMPLETE'  SET KEYWORD                       00091500
.*-------------------------------------------------------------------   00091600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00091700
.ZG47A              AIF   (K'&XMFSCK GT 0).ZG47C  KEYWORD               00091800
                    AIF   (K'&MF(3) LE 0).ZG47B                         00091900
&ZMS                SETC  '"MF='                                        00092000
&ZMS                SETC  '&ZMS.&MF"'                                   00092100
&ZMS                SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '     00092200
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00092300
&ZMS                SETC  '&ZMS "COMPLETE".'                            00092400
                    MNOTE 8,' &ZMS '                                    00092500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00092600
.ZG47B              ANOP  ,                                             00092700
&XMFSCK             SETC  'COMPLETE'  SET DEFAULT KEYWORD               00092800
.ZG47C              ANOP  ,                                             00092900
&ZXMFSCK            SETC  'INPUT'     SET IN/OUTPUT                     00093000
.*------------------------------------------------------------------    00093100
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00093200
.ZG48               ANOP  ,                                             00093300
&ZXMF               SETC  'INPUT'     SET IN/OUTPUT                     00093400
                    AIF   (K'&XMF GT 0).ZG48E   VALID ARG               00093500
                    AIF   (T'&MF EQ 'O').ZG48D  OMITTED                 00093600
&ZASYSLNDX          SETA  0                                             00093700
.ZG48A              ANOP  ,           POSITIONAL MACRO KEY              00093800
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00093900
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG48C              00094000
&ZTLC               SETC 'MF'                                           00094100
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG48A     00094200
.ZG48B              ANOP  ,                                             00094300
&ZXMF               SETC  ''          RESET IN/OUTPUT                   00094400
&ZMS                SETC  'THE "MF" KEY'                                00094500
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00094600
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00094700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00094800
                    AGO   .ZG48E                                        00094900
.ZG48C              ANOP  ,                                             00095000
&ZXMF               SETC  ''          RESET IN/OUTPUT                   00095100
&ZMS                SETC  '"MF='                                        00095200
&ZMS                SETC  '&ZMS.&MF"'                                   00095300
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00095400
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00095500
&ZMS                SETC  '&ZMS "S",'                                   00095600
&ZMS                SETC  '&ZMS "L",'                                   00095700
&ZMS                SETC  '&ZMS OR "E".'                                00095800
                    MNOTE 8,' &ZMS '                                    00095900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00096000
                    AGO   .ZG48E                                        00096100
.ZG48D              ANOP  ,                                             00096200
&XMF                SETC  'S'         SET DEFAULT KEYWORD               00096300
&XMFSCK             SETC  'COMPLETE'  COMPLETE CHECKING                 00096400
.ZG48E              ANOP  ,                                             00096500
.********************************************************************   00096600
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00096700
.********************************************************************   00096800
                    ACTR  10000                                         00096900
.*-------------------------------------------------------------------   00097000
.***AG.MF03 MF=(SLE)                                                    00097100
                    AIF   ('&XMF' EQ 'L').ZGMFX                         00097200
.*----------------------------------------------------------------***   00097300
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00097400
&XCHPIDVAR1         SETC  ''          INITIALIZE XVARIABLE              00097500
                    AIF   (K'&CHPID LE 0).ZG2C                          00097600
&ZXCHPIDVAR1        SETC  'INPUT'     SET IN/OUTPUT                     00097700
&XCHPIDVAR1         SETC  'CHPID'     SET XVARIABLE                     00097800
&ZXCHPID            SETC  'INPUT'     SET IN/OUTPUT                     00097900
&XCHPID             SETC  '&CHPID(1)'           SET XVARIABLE PARM      00098000
                    AIF   (N'&CHPID GT 1).ZG2A                          00098100
&XCHPID             SETC  '&CHPID'    SET XVARIABLE PARM                00098200
.ZG2A               AIF   (N'&CHPID LE 1).ZG2B  CK NUM                  00098300
&ZMS                SETC  '"CHPID='                                     00098400
&ZMS                SETC  '&ZMS.&CHPID"'                                00098500
&ZMS                SETC  '&ZMS "CHPID"'                                00098600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00098700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00098800
.ZG2B               AIF   (K'&XCHPID GT 0).ZG2C  ONE PARM               00098900
&ZXCHPIDVAR1        SETC  ''          RESET IN/OUTPUT                   00099000
&ZXCHPID            SETC  ''          RESET IN/OUTPUT                   00099100
&ZMS                SETC  ' '                                           00099200
&ZMS                SETC  '&ZMS "CHPID" KEY AND ITS'                    00099300
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00099400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00099500
.ZG2C               ANOP  ,                                             00099600
.*----------------------------------------------------------------***   00099700
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00099800
                    AIF   (K'&CHP_TYPE LE 0).ZG3D  NO ME KEY            00099900
                    AIF   (N'&CHP_TYPE LE 1).ZG3A  CK NUM               00100000
&ZMS                SETC  '"CHP_TYPE='                                  00100100
&ZMS                SETC  '&ZMS.&CHP_TYPE"'                             00100200
&ZMS                SETC  '&ZMS "CHP_TYPE"'                             00100300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00100400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00100500
.ZG3A               AIF   (K'&XCHPIDVAR1 LE 0).ZG3B                     00100600
&ZMS                SETC  '"CHP_TYPE'                                   00100700
&ZMS                SETC  '&ZMS.=&CHP_TYPE"'                            00100800
&ZMS                SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'         00100900
&ZMS                SETC  '&ZMS "&XCHPIDVAR1"'                          00101000
                    MNOTE 8,' &ZMS KEY.'                                00101100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00101200
                    AGO   .ZG3D                                         00101300
.*                                                                      00101400
.ZG3B               ANOP  ,                                             00101500
&ZXCHPIDVAR1        SETC  'INPUT'     SET IN/OUTPUT                     00101600
&XCHPIDVAR1         SETC  'CHP_TYPE'  SET XVARIABLE                     00101700
&ZXCHP_TYPE         SETC  'INPUT'     SET IN/OUTPUT                     00101800
&XCHP_TYPE          SETC  '&CHP_TYPE(1)'        SET XVARIABLE PARM      00101900
                    AIF   (N'&CHP_TYPE GT 1).ZG3C                       00102000
&XCHP_TYPE          SETC  '&CHP_TYPE'           SET XVARIABLE PARM      00102100
.ZG3C               AIF   (K'&XCHP_TYPE GT 0).ZG3D  ONE PARM            00102200
&ZXCHPIDVAR1        SETC  ''          RESET IN/OUTPUT                   00102300
&ZXCHP_TYPE         SETC  ''          RESET IN/OUTPUT                   00102400
&ZMS                SETC  ' '                                           00102500
&ZMS                SETC  '&ZMS "CHP_TYPE" KEY AND ITS'                 00102600
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00102700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00102800
.ZG3D               ANOP  ,                                             00102900
.*------------------------------------------------------------------    00103000
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00103100
                    AIF   (K'&XCHPIDVAR1 GT 0).ZG7B                     00103200
&ZXCHPIDVAR1        SETC  ''          RESET IN/OUTPUT                   00103300
&ZXCHPID            SETC  ''          RESET IN/OUTPUT                   00103400
&XCHPIDVAR1         SETC  ''          ENSURE NULL                       00103500
&XCHPID             SETC  ''          ENSURE NULL                       00103600
&ZMS                SETC  'ONE OF THE FOLLOWING'                        00103700
&ZMS                SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'           00103800
&ZMS                SETC  '&ZMS REQUIRED:'                              00103900
&ZMS                SETC  '&ZMS "CHPID"'        VALID ME KEY            00104000
&ZMS                SETC  '&ZMS OR "CHP_TYPE".'  VALID ME KEY           00104100
                    MNOTE 8,' &ZMS '                                    00104200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00104300
.ZG7B               ANOP  ,                                             00104400
.*-------------------------------------------------------------------   00104500
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00104600
.ZG2ZY  AIF    ('&XCHPIDVAR1' NE 'CHPID').ZG3ZY                         00104700
.*-------------------------------------------------------------------   00104800
.***AG.KMEKY14 NAME, RQD INPUT, ME KEYS -DISALLOWED KEYS                00104900
&ZCVAL              SETC ''           ERROR KEY FIELD                   00105000
.ZG2I0              AIF   (K'&CHP_PARM LE 0).ZG2I1                      00105100
&ZCVAL              SETC '&ZCVAL CHP_PARM'      DISALLOWED KEY          00105200
.ZG2I1              AIF   (K'&ZCVAL LE 0).ZG2J  KEY                     00105300
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00105400
&ZMS                SETC  '"CHPID'                                      00105500
&ZMS                SETC  '&ZMS.=&CHPID"'                               00105600
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00105700
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00105800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00105900
.ZG2J               ANOP  ,                                             00106000
.*-------------------------------------------------------------------   00106100
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00106200
                    AIF   (K'&ZXCHPID LE 0).ZG2R  NOT I/O               00106300
                    AIF   ('&XCHPID'(1,1) NE '(').ZG2R                  00106400
&ZCGPR              SETC  '&XCHPID'(2,K'&XCHPID-2)                      00106500
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                   00106600
                    AIF   (K'&ZCGPR GT 2).ZG2Q                          00106700
                    AIF   ('&ZCGPR' EQ '0').ZG2Q                        00106800
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00106900
                    AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME      00107000
.ZG2P               ANOP  ,                                             00107100
                    AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC           00107200
                    AIF   ('&ZCGPR' LT '2').ZG2Q                        00107300
                    AIF   ('&ZCGPR' LE '12').ZG2R                       00107400
.ZG2Q               ANOP  ,                                             00107500
&ZMS                SETC  '"CHPID='                                     00107600
&ZMS                SETC  '&ZMS.&CHPID"'                                00107700
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00107800
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00107900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00108000
.ZG2R               ANOP  ,                                             00108100
.*-------------------------------------------------------------------   00108200
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00108300
.ZG3ZY  AIF    ('&XCHPIDVAR1' NE 'CHP_TYPE').ZG7ZY                      00108400
.*-------------------------------------------------------------------   00108500
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00108600
                    AIF   (K'&ZXCHP_TYPE LE 0).ZG3R  NOT I/O            00108700
                    AIF   ('&XCHP_TYPE'(1,1) NE '(').ZG3R               00108800
&ZCGPR              SETC  '&XCHP_TYPE'(2,K'&XCHP_TYPE-2)                00108900
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG3P                   00109000
                    AIF   (K'&ZCGPR GT 2).ZG3Q                          00109100
                    AIF   ('&ZCGPR' EQ '0').ZG3Q                        00109200
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00109300
                    AIF   (T'&ZCGPR NE 'N').ZG3Q  INVALID REG NAME      00109400
.ZG3P               ANOP  ,                                             00109500
                    AIF   (T'&ZCGPR NE 'N').ZG3R  NON NUMERIC           00109600
                    AIF   ('&ZCGPR' LT '2').ZG3Q                        00109700
                    AIF   ('&ZCGPR' LE '12').ZG3R                       00109800
.ZG3Q               ANOP  ,                                             00109900
&ZMS                SETC  '"CHP_TYPE='                                  00110000
&ZMS                SETC  '&ZMS.&CHP_TYPE"'                             00110100
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00110200
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00110300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00110400
.ZG3R               ANOP  ,                                             00110500
.*----------------------------------------------------------------***   00110600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00110700
                    AIF   (N'&CHP_PARM LE 1).ZG5A  CK NUM               00110800
&ZMS                SETC  '"CHP_PARM='                                  00110900
&ZMS                SETC  '&ZMS.&CHP_PARM"'                             00111000
&ZMS                SETC  '&ZMS "CHP_PARM"'                             00111100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00111200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00111300
.ZG5A               ANOP  ,                                             00111400
.*-------------------------------------------------------------------   00111500
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00111600
&ZXCHP_PARM         SETC  'INPUT'     SET IN/OUTPUT                     00111700
&XCHP_PARM          SETC  '0'                                           00111800
                    AIF   (K'&CHP_PARM(1) LE 0).ZG5B  PARM              00111900
&XCHP_PARM          SETC  '&CHP_PARM(1)'        SET XVARIABLE           00112000
                    AIF   (N'&CHP_PARM GT 1).ZG5B  MULTI                00112100
&XCHP_PARM          SETC  '&CHP_PARM'           SET XVARIABLE           00112200
.ZG5B               ANOP  ,                                             00112300
.*-------------------------------------------------------------------   00112400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00112500
                    AIF   (K'&ZXCHP_PARM LE 0).ZG5R  NOT I/O            00112600
                    AIF   ('&XCHP_PARM'(1,1) NE '(').ZG5R               00112700
&ZCGPR              SETC  '&XCHP_PARM'(2,K'&XCHP_PARM-2)                00112800
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                   00112900
                    AIF   (K'&ZCGPR GT 2).ZG5Q                          00113000
                    AIF   ('&ZCGPR' EQ '0').ZG5Q                        00113100
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00113200
                    AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME      00113300
.ZG5P               ANOP  ,                                             00113400
                    AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC           00113500
                    AIF   ('&ZCGPR' LT '2').ZG5Q                        00113600
                    AIF   ('&ZCGPR' LE '12').ZG5R                       00113700
.ZG5Q               ANOP  ,                                             00113800
&ZMS                SETC  '"CHP_PARM='                                  00113900
&ZMS                SETC  '&ZMS.&CHP_PARM"'                             00114000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00114100
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00114200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00114300
.ZG5R               ANOP  ,                                             00114400
.*-------------------------------------------------------------------   00114500
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00114600
.ZG7ZY              ANOP ,            END MUTUALLY EXCLUSIVE KEYS       00114700
.*-------------------------------------------------------------------   00114800
.***AG.KCK02 NAME,  OUTPUT, ME GROUP -GPR OUT OF RANGE                  00114900
                    AIF   (K'&ZXCHP_PARM LE 0).ZG8R  NOT I/O            00115000
                    AIF   ('&XCHP_PARM'(1,1) NE '(').ZG8R               00115100
&ZCGPR              SETC  '&XCHP_PARM'(2,K'&XCHP_PARM-2)                00115200
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                   00115300
                    AIF   (K'&ZCGPR GT 2).ZG8Q                          00115400
                    AIF   ('&ZCGPR' EQ '0').ZG8Q                        00115500
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00115600
                    AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME      00115700
.ZG8P               ANOP  ,                                             00115800
                    AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC           00115900
                    AIF   ('&ZCGPR' LT '2').ZG8Q                        00116000
                    AIF   ('&ZCGPR' LE '12').ZG8R                       00116100
.ZG8Q               ANOP  ,                                             00116200
&ZMS                SETC  '"CHP_PARM='                                  00116300
&ZMS                SETC  '&ZMS.&CHP_PARM"'                             00116400
&ZMS                SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'     00116500
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00116600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00116700
.ZG8R               ANOP  ,                                             00116800
.*----------------------------------------------------------------***   00116900
.***AG.KMGRP05 NAME,  OUTPUT, ME GROUP -XVARIABLE KEY                   00117000
                    AIF   (N'&ACRONYM LE 1).ZG9A  CK NUM                00117100
&ZMS                SETC  '"ACRONYM='                                   00117200
&ZMS                SETC  '&ZMS.&ACRONYM"'                              00117300
&ZMS                SETC  '&ZMS "ACRONYM"'                              00117400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00117500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00117600
.ZG9A               ANOP  ,                                             00117700
.*-------------------------------------------------------------------   00117800
.***AG.KMGRP06 NAME,  OUTPUT, ME GROUP -XVARIABLE                       00117900
&ZXACRONYM          SETC  'OUTPUT'    SET IN/OUTPUT                     00118000
&XACRONYM           SETC  '&ACRONYM(1)'         SET XVARIABLE           00118100
                    AIF   (N'&ACRONYM GT 1).ZG9B                        00118200
&XACRONYM           SETC  '&ACRONYM'  SET XVARIABLE                     00118300
.ZG9B               AIF   (K'&ACRONYM(1) GT 0).ZG9C                     00118400
&ZXACRONYM          SETC  ''          RESET IN/OUTPUT                   00118500
.ZG9C               ANOP  ,                                             00118600
.*-------------------------------------------------------------------   00118700
.***AG.KCK02 NAME,  OUTPUT, ME GROUP -GPR OUT OF RANGE                  00118800
                    AIF   (K'&ZXACRONYM LE 0).ZG9R  NOT I/O             00118900
                    AIF   ('&XACRONYM'(1,1) NE '(').ZG9R                00119000
&ZCGPR              SETC  '&XACRONYM'(2,K'&XACRONYM-2)                  00119100
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG9P                   00119200
                    AIF   (K'&ZCGPR GT 2).ZG9Q                          00119300
                    AIF   ('&ZCGPR' EQ '0').ZG9Q                        00119400
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00119500
                    AIF   (T'&ZCGPR NE 'N').ZG9Q  INVALID REG NAME      00119600
.ZG9P               ANOP  ,                                             00119700
                    AIF   (T'&ZCGPR NE 'N').ZG9R  NON NUMERIC           00119800
                    AIF   ('&ZCGPR' LT '2').ZG9Q                        00119900
                    AIF   ('&ZCGPR' LE '12').ZG9R                       00120000
.ZG9Q               ANOP  ,                                             00120100
&ZMS                SETC  '"ACRONYM='                                   00120200
&ZMS                SETC  '&ZMS.&ACRONYM"'                              00120300
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00120400
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00120500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00120600
.ZG9R               ANOP  ,                                             00120700
.*----------------------------------------------------------------***   00120800
.***AG.KMGRP05 NAME,  OUTPUT, ME GROUP -XVARIABLE KEY                   00120900
                    AIF   (N'&DESC LE 1).ZG10A  CK NUM                  00121000
&ZMS                SETC  '"DESC='                                      00121100
&ZMS                SETC  '&ZMS.&DESC"'                                 00121200
&ZMS                SETC  '&ZMS "DESC"'                                 00121300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00121400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00121500
.ZG10A              ANOP  ,                                             00121600
.*-------------------------------------------------------------------   00121700
.***AG.KMGRP06 NAME,  OUTPUT, ME GROUP -XVARIABLE                       00121800
&ZXDESC             SETC  'OUTPUT'    SET IN/OUTPUT                     00121900
&XDESC              SETC  '&DESC(1)'  SET XVARIABLE                     00122000
                    AIF   (N'&DESC GT 1).ZG10B                          00122100
&XDESC              SETC  '&DESC'     SET XVARIABLE                     00122200
.ZG10B              AIF   (K'&DESC(1) GT 0).ZG10C                       00122300
&ZXDESC             SETC  ''          RESET IN/OUTPUT                   00122400
.ZG10C              ANOP  ,                                             00122500
.*-------------------------------------------------------------------   00122600
.***AG.KCK02 NAME,  OUTPUT, ME GROUP -GPR OUT OF RANGE                  00122700
                    AIF   (K'&ZXDESC LE 0).ZG10R  NOT I/O               00122800
                    AIF   ('&XDESC'(1,1) NE '(').ZG10R                  00122900
&ZCGPR              SETC  '&XDESC'(2,K'&XDESC-2)                        00123000
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                  00123100
                    AIF   (K'&ZCGPR GT 2).ZG10Q                         00123200
                    AIF   ('&ZCGPR' EQ '0').ZG10Q                       00123300
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00123400
                    AIF   (T'&ZCGPR NE 'N').ZG10Q  INVALID REG NAME     00123500
.ZG10P              ANOP  ,                                             00123600
                    AIF   (T'&ZCGPR NE 'N').ZG10R  NON NUMERIC          00123700
                    AIF   ('&ZCGPR' LT '2').ZG10Q                       00123800
                    AIF   ('&ZCGPR' LE '12').ZG10R                      00123900
.ZG10Q              ANOP  ,                                             00124000
&ZMS                SETC  '"DESC='                                      00124100
&ZMS                SETC  '&ZMS.&DESC"'                                 00124200
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00124300
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00124400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00124500
.ZG10R              ANOP  ,                                             00124600
.*----------------------------------------------------------------***   00124700
.***AG.KMGRP05 NAME,  OUTPUT, ME GROUP -XVARIABLE KEY                   00124800
                    AIF   (N'&ATTR LE 1).ZG11A  CK NUM                  00124900
&ZMS                SETC  '"ATTR='                                      00125000
&ZMS                SETC  '&ZMS.&ATTR"'                                 00125100
&ZMS                SETC  '&ZMS "ATTR"'                                 00125200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00125300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00125400
.ZG11A              ANOP  ,                                             00125500
.*-------------------------------------------------------------------   00125600
.***AG.KMGRP06 NAME,  OUTPUT, ME GROUP -XVARIABLE                       00125700
&ZXATTR             SETC  'OUTPUT'    SET IN/OUTPUT                     00125800
&XATTR              SETC  '&ATTR(1)'  SET XVARIABLE                     00125900
                    AIF   (N'&ATTR GT 1).ZG11B                          00126000
&XATTR              SETC  '&ATTR'     SET XVARIABLE                     00126100
.ZG11B              AIF   (K'&ATTR(1) GT 0).ZG11C                       00126200
&ZXATTR             SETC  ''          RESET IN/OUTPUT                   00126300
.ZG11C              ANOP  ,                                             00126400
.*-------------------------------------------------------------------   00126500
.***AG.KCK02 NAME,  OUTPUT, ME GROUP -GPR OUT OF RANGE                  00126600
                    AIF   (K'&ZXATTR LE 0).ZG11R  NOT I/O               00126700
                    AIF   ('&XATTR'(1,1) NE '(').ZG11R                  00126800
&ZCGPR              SETC  '&XATTR'(2,K'&XATTR-2)                        00126900
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                  00127000
                    AIF   (K'&ZCGPR GT 2).ZG11Q                         00127100
                    AIF   ('&ZCGPR' EQ '0').ZG11Q                       00127200
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00127300
                    AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME     00127400
.ZG11P              ANOP  ,                                             00127500
                    AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC          00127600
                    AIF   ('&ZCGPR' LT '2').ZG11Q                       00127700
                    AIF   ('&ZCGPR' LE '12').ZG11R                      00127800
.ZG11Q              ANOP  ,                                             00127900
&ZMS                SETC  '"ATTR='                                      00128000
&ZMS                SETC  '&ZMS.&ATTR"'                                 00128100
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00128200
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00128300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00128400
.ZG11R              ANOP  ,                                             00128500
.*----------------------------------------------------------------***   00128600
.***AG.KMGRP05 NAME,  OUTPUT, ME GROUP -XVARIABLE KEY                   00128700
                    AIF   (N'&WWPN LE 1).ZG12A  CK NUM                  00128800
&ZMS                SETC  '"WWPN='                                      00128900
&ZMS                SETC  '&ZMS.&WWPN"'                                 00129000
&ZMS                SETC  '&ZMS "WWPN"'                                 00129100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00129200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00129300
.ZG12A              ANOP  ,                                             00129400
.*-------------------------------------------------------------------   00129500
.***AG.KMGRP06 NAME,  OUTPUT, ME GROUP -XVARIABLE                       00129600
&ZXWWPN             SETC  'OUTPUT'    SET IN/OUTPUT                     00129700
&XWWPN              SETC  '&WWPN(1)'  SET XVARIABLE                     00129800
                    AIF   (N'&WWPN GT 1).ZG12B                          00129900
&XWWPN              SETC  '&WWPN'     SET XVARIABLE                     00130000
.ZG12B              AIF   (K'&WWPN(1) GT 0).ZG12C                       00130100
&ZXWWPN             SETC  ''          RESET IN/OUTPUT                   00130200
.ZG12C              ANOP  ,                                             00130300
.*-------------------------------------------------------------------   00130400
.***AG.KCK02 NAME,  OUTPUT, ME GROUP -GPR OUT OF RANGE                  00130500
                    AIF   (K'&ZXWWPN LE 0).ZG12R  NOT I/O               00130600
                    AIF   ('&XWWPN'(1,1) NE '(').ZG12R                  00130700
&ZCGPR              SETC  '&XWWPN'(2,K'&XWWPN-2)                        00130800
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG12P                  00130900
                    AIF   (K'&ZCGPR GT 2).ZG12Q                         00131000
                    AIF   ('&ZCGPR' EQ '0').ZG12Q                       00131100
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00131200
                    AIF   (T'&ZCGPR NE 'N').ZG12Q  INVALID REG NAME     00131300
.ZG12P              ANOP  ,                                             00131400
                    AIF   (T'&ZCGPR NE 'N').ZG12R  NON NUMERIC          00131500
                    AIF   ('&ZCGPR' LT '2').ZG12Q                       00131600
                    AIF   ('&ZCGPR' LE '12').ZG12R                      00131700
.ZG12Q              ANOP  ,                                             00131800
&ZMS                SETC  '"WWPN='                                      00131900
&ZMS                SETC  '&ZMS.&WWPN"'                                 00132000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00132100
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00132200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00132300
.ZG12R              ANOP  ,                                             00132400
.*----------------------------------------------------------------***   00132500
.***AG.KMGRP05 NAME,  OUTPUT, ME GROUP -XVARIABLE KEY                   00132600
                    AIF   (N'&ND LE 1).ZG13A    CK NUM                  00132700
&ZMS                SETC  '"ND='                                        00132800
&ZMS                SETC  '&ZMS.&ND"'                                   00132900
&ZMS                SETC  '&ZMS "ND"'                                   00133000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00133100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00133200
.ZG13A              ANOP  ,                                             00133300
.*-------------------------------------------------------------------   00133400
.***AG.KMGRP06 NAME,  OUTPUT, ME GROUP -XVARIABLE                       00133500
&ZXND               SETC  'OUTPUT'    SET IN/OUTPUT                     00133600
&XND                SETC  '&ND(1)'    SET XVARIABLE                     00133700
                    AIF   (N'&ND GT 1).ZG13B                            00133800
&XND                SETC  '&ND'       SET XVARIABLE                     00133900
.ZG13B              AIF   (K'&ND(1) GT 0).ZG13C                         00134000
&ZXND               SETC  ''          RESET IN/OUTPUT                   00134100
.ZG13C              ANOP  ,                                             00134200
.*-------------------------------------------------------------------   00134300
.***AG.KCK02 NAME,  OUTPUT, ME GROUP -GPR OUT OF RANGE                  00134400
                    AIF   (K'&ZXND LE 0).ZG13R  NOT I/O                 00134500
                    AIF   ('&XND'(1,1) NE '(').ZG13R                    00134600
&ZCGPR              SETC  '&XND'(2,K'&XND-2)                            00134700
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG13P                  00134800
                    AIF   (K'&ZCGPR GT 2).ZG13Q                         00134900
                    AIF   ('&ZCGPR' EQ '0').ZG13Q                       00135000
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00135100
                    AIF   (T'&ZCGPR NE 'N').ZG13Q  INVALID REG NAME     00135200
.ZG13P              ANOP  ,                                             00135300
                    AIF   (T'&ZCGPR NE 'N').ZG13R  NON NUMERIC          00135400
                    AIF   ('&ZCGPR' LT '2').ZG13Q                       00135500
                    AIF   ('&ZCGPR' LE '12').ZG13R                      00135600
.ZG13Q              ANOP  ,                                             00135700
&ZMS                SETC  '"ND='                                        00135800
&ZMS                SETC  '&ZMS.&ND"'                                   00135900
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00136000
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00136100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00136200
.ZG13R              ANOP  ,                                             00136300
.*----------------------------------------------------------------***   00136400
.***AG.KMGRP05 NAME,  OUTPUT, ME GROUP -XVARIABLE KEY                   00136500
                    AIF   (N'&UTILITYSTRINGS LE 1).ZG14A  CK NUM        00136600
&ZMS                SETC  '"UTILITYSTRINGS='                            00136700
&ZMS                SETC  '&ZMS.&UTILITYSTRINGS"'                       00136800
&ZMS                SETC  '&ZMS "UTILITYSTRINGS"'                       00136900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00137000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00137100
.ZG14A              ANOP  ,                                             00137200
.*-------------------------------------------------------------------   00137300
.***AG.KMGRP06 NAME,  OUTPUT, ME GROUP -XVARIABLE                       00137400
&ZXUTILITYSTRINGS   SETC  'OUTPUT'    SET IN/OUTPUT                     00137500
&XUTILITYSTRINGS    SETC  '&UTILITYSTRINGS(1)'  SET XVARIABLE           00137600
                    AIF   (N'&UTILITYSTRINGS GT 1).ZG14B                00137700
&XUTILITYSTRINGS    SETC  '&UTILITYSTRINGS'     SET XVARIABLE           00137800
.ZG14B              AIF   (K'&UTILITYSTRINGS(1) GT 0).ZG14C             00137900
&ZXUTILITYSTRINGS   SETC  ''          RESET IN/OUTPUT                   00138000
.ZG14C              ANOP  ,                                             00138100
.*-------------------------------------------------------------------   00138200
.***AG.KCK02 NAME,  OUTPUT, ME GROUP -GPR OUT OF RANGE                  00138300
                    AIF   (K'&ZXUTILITYSTRINGS LE 0).ZG14R  NOT I/O     00138400
                    AIF   ('&XUTILITYSTRINGS'(1,1) NE '(').ZG14R        00138500
&ZCGPR              SETC  '&XUTILITYSTRINGS'(2,K'&XUTILITYSTRINGS-2)    00138600
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                  00138700
                    AIF   (K'&ZCGPR GT 2).ZG14Q                         00138800
                    AIF   ('&ZCGPR' EQ '0').ZG14Q                       00138900
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00139000
                    AIF   (T'&ZCGPR NE 'N').ZG14Q  INVALID REG NAME     00139100
.ZG14P              ANOP  ,                                             00139200
                    AIF   (T'&ZCGPR NE 'N').ZG14R  NON NUMERIC          00139300
                    AIF   ('&ZCGPR' LT '2').ZG14Q                       00139400
                    AIF   ('&ZCGPR' LE '12').ZG14R                      00139500
.ZG14Q              ANOP  ,                                             00139600
&ZMS                SETC  '"UTILITYSTRINGS='                            00139700
&ZMS                SETC  '&ZMS.&UTILITYSTRINGS"'                       00139800
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00139900
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00140000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00140100
.ZG14R              ANOP  ,                                             00140200
.*-------------------------------------------------------------------   00140300
.***AG.KMGRP11 NAME,  OUTPUT, ME GROUP -AT LEAST ONE SPECIFIED          00140400
&ZCVAL              SETC ''           ERROR KEY FIELD                   00140500
                    AIF   (K'&XACRONYM GT 0).ZG15J                      00140600
&ZCVAL              SETC '&ZCVAL,ACRONYM'       NOT USED KEY            00140700
                    AIF   (K'&XDESC GT 0).ZG15J                         00140800
&ZCVAL              SETC '&ZCVAL,DESC'          NOT USED KEY            00140900
                    AIF   (K'&XATTR GT 0).ZG15J                         00141000
&ZCVAL              SETC '&ZCVAL,ATTR'          NOT USED KEY            00141100
                    AIF   (K'&XWWPN GT 0).ZG15J                         00141200
&ZCVAL              SETC '&ZCVAL,WWPN'          NOT USED KEY            00141300
                    AIF   (K'&XND GT 0).ZG15J                           00141400
&ZCVAL              SETC '&ZCVAL,ND'  NOT USED KEY                      00141500
                    AIF   (K'&XUTILITYSTRINGS GT 0).ZG15J               00141600
&ZCVAL              SETC '&ZCVAL,UTILITYSTRINGS'  NOT USED KEY          00141700
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00141800
&ZMS                SETC  'ONE OR MORE OF THE'                          00141900
&ZMS                SETC  '&ZMS FOLLOWING KEY(S) IS REQUIRED: '         00142000
&ZMS                SETC  '&ZMS "ACRONYM",'                             00142100
&ZMS                SETC  '&ZMS " DESC",'                               00142200
&ZMS                SETC  '&ZMS " ATTR",'                               00142300
&ZMS                SETC  '&ZMS " WWPN",'                               00142400
&ZMS                SETC  '&ZMS " ND",'                                 00142500
                    MNOTE 8,' &ZMS " UTILITYSTRINGS".'                  00142600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00142700
.ZG15J              ANOP  ,                                             00142800
.ZG15K              ANOP  ,                                             00142900
.*-------------------------------------------------------------------   00143000
.***AG.KCK02 NAME,  OUTPUT, ME GROUP -GPR OUT OF RANGE                  00143100
                    AIF   (K'&ZXUTILITYSTRINGS LE 0).ZG15R  NOT I/O     00143200
                    AIF   ('&XUTILITYSTRINGS'(1,1) NE '(').ZG15R        00143300
&ZCGPR              SETC  '&XUTILITYSTRINGS'(2,K'&XUTILITYSTRINGS-2)    00143400
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG15P                  00143500
                    AIF   (K'&ZCGPR GT 2).ZG15Q                         00143600
                    AIF   ('&ZCGPR' EQ '0').ZG15Q                       00143700
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00143800
                    AIF   (T'&ZCGPR NE 'N').ZG15Q  INVALID REG NAME     00143900
.ZG15P              ANOP  ,                                             00144000
                    AIF   (T'&ZCGPR NE 'N').ZG15R  NON NUMERIC          00144100
                    AIF   ('&ZCGPR' LT '2').ZG15Q                       00144200
                    AIF   ('&ZCGPR' LE '12').ZG15R                      00144300
.ZG15Q              ANOP  ,                                             00144400
&ZMS                SETC  '"UTILITYSTRINGS='                            00144500
&ZMS                SETC  '&ZMS.&UTILITYSTRINGS"'                       00144600
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00144700
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00144800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00144900
.ZG15R              ANOP  ,                                             00145000
.*----------------------------------------------------------------***   00145100
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00145200
                    AIF   (N'&LINKAGE LE 1).ZG17A  CK NUM               00145300
&ZMS                SETC  '"LINKAGE='                                   00145400
&ZMS                SETC  '&ZMS.&LINKAGE"'                              00145500
&ZMS                SETC  '&ZMS "LINKAGE"'                              00145600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00145700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00145800
.ZG17A              ANOP  ,                                             00145900
.*-------------------------------------------------------------------   00146000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00146100
&XLINKAGE           SETC  ''          INITIALIZE XVARIABLE              00146200
.ZG18A   AIF   ('&LINKAGE(1)' NE 'SYSTEM').ZG19A                        00146300
&XLINKAGE           SETC  'SYSTEM'    SET KEYWORD                       00146400
.*-------------------------------------------------------------------   00146500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00146600
.ZG19A   AIF   ('&LINKAGE(1)' NE 'BRANCH').ZG20A                        00146700
&XLINKAGE           SETC  'BRANCH'    SET KEYWORD                       00146800
.*-------------------------------------------------------------------   00146900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00147000
.ZG20A              AIF   (K'&XLINKAGE GT 0).ZG20C  KEYWORD             00147100
                    AIF   (K'&LINKAGE(1) LE 0).ZG20B                    00147200
&ZMS                SETC  '"LINKAGE='                                   00147300
&ZMS                SETC  '&ZMS.&LINKAGE"'                              00147400
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00147500
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00147600
&ZMS                SETC  '&ZMS "SYSTEM"'                               00147700
&ZMS                SETC  '&ZMS OR "BRANCH".'                           00147800
                    MNOTE 8,' &ZMS '                                    00147900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00148000
.ZG20B              ANOP  ,                                             00148100
&XLINKAGE           SETC  'SYSTEM'    SET DEFAULT KEYWORD               00148200
.ZG20C              ANOP  ,                                             00148300
&ZXLINKAGE          SETC  'INPUT'     SET IN/OUTPUT                     00148400
.*----------------------------------------------------------------***   00148500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00148600
                    AIF   (N'&RETCODE LE 1).ZG22A  CK NUM               00148700
&ZMS                SETC  '"RETCODE='                                   00148800
&ZMS                SETC  '&ZMS.&RETCODE"'                              00148900
&ZMS                SETC  '&ZMS "RETCODE"'                              00149000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00149100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00149200
.ZG22A              ANOP  ,                                             00149300
.*-------------------------------------------------------------------   00149400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00149500
                    AIF   (K'&RETCODE(1) LE 0).ZG22C  NO PARM           00149600
&ZXRETCODE          SETC  'OUTPUT'    SET OUTPUT                        00149700
&XRETCODE           SETC  '&RETCODE(1)'         SET XVARIABLE           00149800
                    AIF   (N'&RETCODE GT 1).ZG22C                       00149900
&XRETCODE           SETC  '&RETCODE'  SET XVARIABLE                     00150000
.ZG22C              ANOP  ,                                             00150100
.*-------------------------------------------------------------------   00150200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00150300
                    AIF   (K'&ZXRETCODE LE 0).ZG22R  NOT I/O            00150400
                    AIF   ('&XRETCODE'(1,1) NE '(').ZG22R               00150500
&ZCGPR              SETC  '&XRETCODE'(2,K'&XRETCODE-2)                  00150600
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                  00150700
                    AIF   (K'&ZCGPR GT 2).ZG22Q                         00150800
                    AIF   ('&ZCGPR' EQ '0').ZG22Q                       00150900
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00151000
                    AIF   (T'&ZCGPR NE 'N').ZG22Q  INVALID REG NAME     00151100
.ZG22P              ANOP  ,                                             00151200
                    AIF   (T'&ZCGPR NE 'N').ZG22R  NON NUMERIC          00151300
                    AIF   ('&ZCGPR' EQ '15').ZG22R                      00151400
                    AIF   ('&ZCGPR' LT '2').ZG22Q                       00151500
                    AIF   ('&ZCGPR' LE '12').ZG22R                      00151600
.ZG22Q              ANOP  ,                                             00151700
&ZMS                SETC  '"RETCODE='                                   00151800
&ZMS                SETC  '&ZMS.&RETCODE"'                              00151900
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00152000
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'      00152100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00152200
.ZG22R              ANOP  ,                                             00152300
.*----------------------------------------------------------------***   00152400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00152500
                    AIF   (N'&RSNCODE LE 1).ZG25A  CK NUM               00152600
&ZMS                SETC  '"RSNCODE='                                   00152700
&ZMS                SETC  '&ZMS.&RSNCODE"'                              00152800
&ZMS                SETC  '&ZMS "RSNCODE"'                              00152900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00153000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00153100
.ZG25A              ANOP  ,                                             00153200
.*-------------------------------------------------------------------   00153300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00153400
                    AIF   (K'&RSNCODE(1) LE 0).ZG25C  NO PARM           00153500
&ZXRSNCODE          SETC  'OUTPUT'    SET OUTPUT                        00153600
&XRSNCODE           SETC  '&RSNCODE(1)'         SET XVARIABLE           00153700
                    AIF   (N'&RSNCODE GT 1).ZG25C                       00153800
&XRSNCODE           SETC  '&RSNCODE'  SET XVARIABLE                     00153900
.ZG25C              ANOP  ,                                             00154000
.*-------------------------------------------------------------------   00154100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00154200
                    AIF   (K'&ZXRSNCODE LE 0).ZG25R  NOT I/O            00154300
                    AIF   ('&XRSNCODE'(1,1) NE '(').ZG25R               00154400
&ZCGPR              SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                  00154500
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                  00154600
                    AIF   (K'&ZCGPR GT 2).ZG25Q                         00154700
                    AIF   ('&ZCGPR' EQ '0').ZG25R                       00154800
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00154900
                    AIF   (T'&ZCGPR NE 'N').ZG25Q  INVALID REG NAME     00155000
.ZG25P              ANOP  ,                                             00155100
                    AIF   (T'&ZCGPR NE 'N').ZG25R  NON NUMERIC          00155200
                    AIF   ('&ZCGPR' EQ '0').ZG25R                       00155300
                    AIF   ('&ZCGPR' LT '2').ZG25Q                       00155400
                    AIF   ('&ZCGPR' LE '12').ZG25R                      00155500
.ZG25Q              ANOP  ,                                             00155600
&ZMS                SETC  '"RSNCODE='                                   00155700
&ZMS                SETC  '&ZMS.&RSNCODE"'                              00155800
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00155900
                    MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'       00156000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00156100
.ZG25R              ANOP  ,                                             00156200
.******************************************************************     00156300
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00156400
.******************************************************************     00156500
                    ACTR  10000                                         00156600
.*----------------------------------------------------------------***   00156700
.***AH.P02 EXTRA POSITIONALS                                            00156800
                    AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS          00156900
                    AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL          00157000
                    AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL      00157100
                    AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL       00157200
.ZGLISTX1           ANOP  ,                                             00157300
&ZCVAL              SETC  ''          ERROR FIELD                       00157400
&ZAWRK              SETA  0           POSITIONAL NUMBER                 00157500
.ZGLIST2            ANOP  ,                                             00157600
&ZAWRK              SETA  &ZAWRK+1    NEXT POSITIONAL                   00157700
                    AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE          00157800
&ZCVAL              SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA               00157900
                    AGO   .ZGLIST2                                      00158000
.*                                                                      00158100
.ZGLIST3            ANOP  ,                                             00158200
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA            00158300
&ZMS                SETC  'POSITIONAL ARGUMENT(S),'                     00158400
&ZMS                SETC  '&ZMS "&ZCVAL"'                               00158500
&ZMS                SETC  '&ZMS CANNOT BE USED.'                        00158600
&ZMS                SETC  '&ZMS NO POSITIONAL ARGUMENTS'                00158700
                    MNOTE 8,' &ZMS ARE ALLOWED.'                        00158800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00158900
.ZGLISTX            ANOP  ,                                             00159000
&ZASYSLNDX          SETA  0                                             00159100
.*-------------------------------------------------------------------   00159200
.***AG.MF04 MF=(SLE)                                                    00159300
.ZGMFX              ANOP  ,           END OF FULL SYNTAX CHECK          00159400
.*******************************************************************    00159500
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00159600
.*******************************************************************    00159700
                    AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED          00159800
.*******************************************************************    00159900
.***AE.01  START OF IOSCHPD MACRO CODE                                  00160000
.*******************************************************************    00160100
                    LCLC  &M0M0001                 NAME                 00160200
&M0M0001            SETC  '&XLABEL'                SET NAME             00160300
                    AIF   (K'&XLABEL NE 0).XLAB2                        00160400
&M0M0001            SETC  'M00M&SYSNDX'            DEFAULT NAME         00160500
.*                                                                      00160600
.XLAB2              ANOP  ,                                             00160700
                    AIF   ('&XMF' EQ 'L').XLAB3                         00160800
&M0M0001 DS    0H                             IOSCHPD-4                 00160900
.XLAB3              ANOP  ,                                             00161000
.*******************************************************************    00161100
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00161200
.*******************************************************************    00161300
              PUSH  PRINT                                               00161400
                    AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON    00161500
                    PRINT OFF         ++ PR01                           00161600
                    AGO   .ZPRNTXX                                      00161700
.ZPRINTX            PRINT ON                                            00161800
.ZPRNTXX            ANOP  ,                                             00161900
.********************************************************************   00162000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00162100
.********************************************************************   00162200
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00162300
                      LCLA  &ZOPN1         INVOCATION INDEX             00162400
                      LCLC  &ZOPL(4095)    LABEL                        00162500
                      LCLC  &ZOPO(4095)    OPERATION                    00162600
                      LCLC  &ZOPV(4095)    VALUE                        00162700
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00162800
.*                                                                      00162900
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00163000
.******************************************************************     00163100
.***AL.L10 IOSCHPD FMT=LIST MF=S!L PARAMETERS                           00163200
.******************************************************************     00163300
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00163400
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00163500
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00163600
&XMFATTR              SETC  '0D'                                        00163700
.*                                                                      00163800
&ZOPN                 SETA  &ZOPN+1                                     00163900
&ZOPL(&ZOPN)          SETC  ' '                                         00164000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00164100
&ZOPO(&ZOPN)          SETC  'B'                                         00164200
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00164300
                      AGO   .ZALVL6B                                    00164400
.ZALVL6A              ANOP                                              00164500
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00164600
&ZOPV(&ZOPN)          SETC  '4,8'                                       00164700
&ZOPN                 SETA  &ZOPN+1                                     00164800
&ZOPL(&ZOPN)          SETC  ' '                                         00164900
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00165000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00165100
.ZALVL6B              ANOP                                              00165200
&ZOPD(&ZOPN)          SETC  '++ IOSCHPD ARG PARMS'                      00165300
.*                                                                      00165400
&ZOPN                 SETA  &ZOPN+1                                     00165500
&ZOPL(&ZOPN)          SETC  ' '                                         00165600
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00165700
&ZOPV(&ZOPN)          SETC  '1'                                         00165800
&ZOPD(&ZOPN)          SETC  ' '                                         00165900
.*                                                                      00166000
.ZLMFSL2              ANOP  ,                                           00166100
.*-------------------------------------------------------------------   00166200
.***AM.L00  IOSCHPD FMT=LIST name                                       00166300
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00166400
&ZOPN                 SETA &ZOPN+1                                      00166500
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00166600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00166700
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00166800
&ZOPD(&ZOPN)          SETC '++ IOSCHPD NAME'                            00166900
.ZLMFSL2M             ANOP  ,                                           00167000
.*-------------------------------------------------------------------   00167100
.***AM.L01  IOSCHPD FMT=LIST PARAMETERS                                 00167200
&ZOPN                 SETA &ZOPN+1                                      00167300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00167400
&ZOPO(&ZOPN)          SETC 'DS'                                         00167500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00167600
&ZOPD(&ZOPN)          SETC '++ IOSCHPD PARM LIST'                       00167700
.*-------------------------------------------------------------------   00167800
.***AM.L02 XVERSION XL1                                                 00167900
&ZOPN                 SETA &ZOPN+1                                      00168000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00168100
&ZOPO(&ZOPN)          SETC 'DS'                                         00168200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00168300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00168400
.*-------------------------------------------------------------------   00168500
.***AM.L03 XFLAGS BL.8                                                  00168600
&ZOPN                 SETA &ZOPN+1                                      00168700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00168800
&ZOPO(&ZOPN)          SETC 'DS'                                         00168900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00169000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00169100
.*                                                                      00169200
&ZOPN                 SETA  &ZOPN+1                                     00169300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CHPID'                   00169400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00169500
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00169600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00169700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CHPID'                        00169800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00169900
.*                                                                      00170000
&ZOPN                 SETA  &ZOPN+1                                     00170100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CHP_TYPE'                00170200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00170300
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00170400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00170500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CHP_TYPE'                     00170600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00170700
.*                                                                      00170800
&ZOPN                 SETA  &ZOPN+1                                     00170900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_ACRONYM'                 00171000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00171100
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00171200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00171300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ACRONYM'                      00171400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00171500
.*                                                                      00171600
&ZOPN                 SETA  &ZOPN+1                                     00171700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_DESC'                    00171800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00171900
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00172000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00172100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DESC'                         00172200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00172300
.*                                                                      00172400
&ZOPN                 SETA  &ZOPN+1                                     00172500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CHP_PARM'                00172600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00172700
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00172800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00172900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CHP_PARM'                     00173000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00173100
.*                                                                      00173200
&ZOPN                 SETA  &ZOPN+1                                     00173300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_ATTR'                    00173400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00173500
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00173600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00173700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ATTR'                         00173800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00173900
.*                                                                      00174000
&ZOPN                 SETA  &ZOPN+1                                     00174100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_WWPN'                    00174200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00174300
&ZOPV(&ZOPN)          SETC  'B''00000010'''                             00174400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00174500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).WWPN'                         00174600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00174700
.*                                                                      00174800
&ZOPN                 SETA  &ZOPN+1                                     00174900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_ND'                      00175000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00175100
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00175200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00175300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ND'                           00175400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00175500
.*-------------------------------------------------------------------   00175600
.***AM.L03 XFLAG2 BL.8                                                  00175700
&ZOPN                 SETA &ZOPN+1                                      00175800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAG2'                           00175900
&ZOPO(&ZOPN)          SETC 'DS'                                         00176000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00176100
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00176200
.*                                                                      00176300
&ZOPN                 SETA  &ZOPN+1                                     00176400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_UTILITYSTRINGS'          00176500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00176600
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00176700
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00176800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UTILITYSTRINGS'               00176900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00177000
.*-------------------------------------------------------------------   00177100
.***AM.L09  XRESERVED1 CL3                                              00177200
&ZOPN                 SETA &ZOPN+1                                      00177300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       00177400
&ZOPO(&ZOPN)          SETC 'DS'                                         00177500
&ZOPV(&ZOPN)          SETC 'CL3'                                        00177600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00177700
.*-------------------------------------------------------------------   00177800
.***AM.L09  XCHPID XL2                                                  00177900
&ZOPN                 SETA &ZOPN+1                                      00178000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCHPID'                           00178100
&ZOPO(&ZOPN)          SETC 'DS'                                         00178200
&ZOPV(&ZOPN)          SETC 'XL2'                                        00178300
&ZOPD(&ZOPN)          SETC '++ &ZXCHPID '                               00178400
.*-------------------------------------------------------------------   00178500
.***AM.L09  XCHP_TYPE XL1                                               00178600
&ZOPN                 SETA &ZOPN+1                                      00178700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCHP_TYPE'                        00178800
&ZOPO(&ZOPN)          SETC 'DS'                                         00178900
&ZOPV(&ZOPN)          SETC 'XL1'                                        00179000
&ZOPD(&ZOPN)          SETC '++ &ZXCHP_TYPE '                            00179100
.*-------------------------------------------------------------------   00179200
.***AM.L09  XACRONYM CL5                                                00179300
&ZOPN                 SETA &ZOPN+1                                      00179400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XACRONYM'                         00179500
&ZOPO(&ZOPN)          SETC 'DS'                                         00179600
&ZOPV(&ZOPN)          SETC 'CL5'                                        00179700
&ZOPD(&ZOPN)          SETC '++ &ZXACRONYM '                             00179800
.*-------------------------------------------------------------------   00179900
.***AM.L09  XDESC CL32                                                  00180000
&ZOPN                 SETA &ZOPN+1                                      00180100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDESC'                            00180200
&ZOPO(&ZOPN)          SETC 'DS'                                         00180300
&ZOPV(&ZOPN)          SETC 'CL32'                                       00180400
&ZOPD(&ZOPN)          SETC '++ &ZXDESC '                                00180500
.*-------------------------------------------------------------------   00180600
.***AM.L09  XCHP_PARM XL1                                               00180700
&ZOPN                 SETA &ZOPN+1                                      00180800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCHP_PARM'                        00180900
&ZOPO(&ZOPN)          SETC 'DS'                                         00181000
&ZOPV(&ZOPN)          SETC 'XL1'                                        00181100
&ZOPD(&ZOPN)          SETC '++ &ZXCHP_PARM '                            00181200
.*-------------------------------------------------------------------   00181300
.***AM.L09  XRESERVED2 CL5                                              00181400
&ZOPN                 SETA &ZOPN+1                                      00181500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED2'                       00181600
&ZOPO(&ZOPN)          SETC 'DS'                                         00181700
&ZOPV(&ZOPN)          SETC 'CL5'                                        00181800
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00181900
.*-------------------------------------------------------------------   00182000
.***AM.L09  XWWPN BL.64                                                 00182100
&ZOPN                 SETA &ZOPN+1                                      00182200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XWWPN'                            00182300
&ZOPO(&ZOPN)          SETC 'DS'                                         00182400
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00182500
&ZOPD(&ZOPN)          SETC '++ &ZXWWPN '                                00182600
.*-------------------------------------------------------------------   00182700
.***AM.MLM2 SAVED LOCATION COUNTER                                      00182800
                      AIF  (&XPLISTVER GE 2).ZL20LA                     00182900
                      AIF  ('&ZENDBASEPL' NE '').ZL20LA                 00183000
&ZENDBASEPL           SETC 'YES'                                        00183100
&ZOPN                 SETA &ZOPN+1                                      00183200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00183300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00183400
&ZOPV(&ZOPN)          SETC '*'                                          00183500
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00183600
.ZL20LA               ANOP  ,                                           00183700
.*-------------------------------------------------------------------   00183800
.***AM.LVER1                                                            00183900
                      AIF  (&XPLISTVER LT 2).ZL20L                      00184000
.*-------------------------------------------------------------------   00184100
.*-------------------------------------------------------------------   00184200
.***AM.L09  XATTR CL32                                                  00184300
&ZOPN                 SETA &ZOPN+1                                      00184400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XATTR'                            00184500
&ZOPO(&ZOPN)          SETC 'DS'                                         00184600
&ZOPV(&ZOPN)          SETC 'CL32'                                       00184700
&ZOPD(&ZOPN)          SETC '++ &ZXATTR '                                00184800
.*-------------------------------------------------------------------   00184900
.***AM.LVER2                                                            00185000
.ZL20L                ANOP  ,                                           00185100
.*-------------------------------------------------------------------   00185200
.*-------------------------------------------------------------------   00185300
.***AM.MLM2 SAVED LOCATION COUNTER                                      00185400
                      AIF  (&XPLISTVER GE 3).ZL21LA                     00185500
                      AIF  ('&ZENDBASEPL' NE '').ZL21LA                 00185600
&ZENDBASEPL           SETC 'YES'                                        00185700
&ZOPN                 SETA &ZOPN+1                                      00185800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00185900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00186000
&ZOPV(&ZOPN)          SETC '*'                                          00186100
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00186200
.ZL21LA               ANOP  ,                                           00186300
.*-------------------------------------------------------------------   00186400
.***AM.LVER1                                                            00186500
                      AIF  (&XPLISTVER LT 3).ZL21L                      00186600
.*-------------------------------------------------------------------   00186700
.*-------------------------------------------------------------------   00186800
.***AM.L09  XND CL32                                                    00186900
&ZOPN                 SETA &ZOPN+1                                      00187000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XND'                              00187100
&ZOPO(&ZOPN)          SETC 'DS'                                         00187200
&ZOPV(&ZOPN)          SETC 'CL32'                                       00187300
&ZOPD(&ZOPN)          SETC '++ &ZXND '                                  00187400
.*-------------------------------------------------------------------   00187500
.***AM.LVER2                                                            00187600
.ZL21L                ANOP  ,                                           00187700
.*-------------------------------------------------------------------   00187800
.*-------------------------------------------------------------------   00187900
.***AM.MLM2 SAVED LOCATION COUNTER                                      00188000
                      AIF  (&XPLISTVER GE 4).ZL22LA                     00188100
                      AIF  ('&ZENDBASEPL' NE '').ZL22LA                 00188200
&ZENDBASEPL           SETC 'YES'                                        00188300
&ZOPN                 SETA &ZOPN+1                                      00188400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00188500
&ZOPO(&ZOPN)          SETC 'EQU'                                        00188600
&ZOPV(&ZOPN)          SETC '*'                                          00188700
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00188800
.ZL22LA               ANOP  ,                                           00188900
.*-------------------------------------------------------------------   00189000
.***AM.LVER1                                                            00189100
                      AIF  (&XPLISTVER LT 4).ZL22L                      00189200
.*-------------------------------------------------------------------   00189300
.*-------------------------------------------------------------------   00189400
.***AM.L09 ADDR XUTILITYSTRINGS A                                       00189500
&ZOPN                 SETA &ZOPN+1                                      00189600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUTILITYSTRINGS_ADDR'             00189700
&ZOPO(&ZOPN)          SETC 'DS'                                         00189800
&ZOPV(&ZOPN)          SETC 'A'                                          00189900
&ZOPD(&ZOPN)          SETC '++ &ZXUTILITYSTRINGS ADDR'                  00190000
.*-------------------------------------------------------------------   00190100
.***AM.LVER2                                                            00190200
.ZL22L                ANOP  ,                                           00190300
.*-------------------------------------------------------------------   00190400
.*-------------------------------------------------------------------   00190500
.***AM.LVER1                                                            00190600
                      AIF  (&XPLISTVER LT 4).ZL23L                      00190700
.*-------------------------------------------------------------------   00190800
.*-------------------------------------------------------------------   00190900
.***AM.L09 ALET XUTILITYSTRINGS F                                       00191000
&ZOPN                 SETA &ZOPN+1                                      00191100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUTILITYSTRINGS_ALET'             00191200
&ZOPO(&ZOPN)          SETC 'DS'                                         00191300
&ZOPV(&ZOPN)          SETC 'F'                                          00191400
&ZOPD(&ZOPN)          SETC '++ &ZXUTILITYSTRINGS ALET'                  00191500
.*-------------------------------------------------------------------   00191600
.***AM.LVER2                                                            00191700
.ZL23L                ANOP  ,                                           00191800
.*-------------------------------------------------------------------   00191900
.*-------------------------------------------------------------------   00192000
.***AM.LVER1                                                            00192100
                      AIF  (&XPLISTVER LT 4).ZL24L                      00192200
.*-------------------------------------------------------------------   00192300
.*-------------------------------------------------------------------   00192400
.***AM.L09  XRESERVED3 CL24                                             00192500
&ZOPN                 SETA &ZOPN+1                                      00192600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED3'                       00192700
&ZOPO(&ZOPN)          SETC 'DS'                                         00192800
&ZOPV(&ZOPN)          SETC 'CL24'                                       00192900
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00193000
.*-------------------------------------------------------------------   00193100
.***AM.LVER2                                                            00193200
.ZL24L                ANOP  ,                                           00193300
.*-------------------------------------------------------------------   00193400
.*-------------------------------------------------------------------   00193500
.***AM.L10 END OF IOSCHPD LIST PARAMETERS                               00193600
&ZOPN                 SETA &ZOPN+1                                      00193700
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00193800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00193900
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00194000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00194100
.*                                                                      00194200
&ZOPN                 SETA &ZOPN+1                                      00194300
&ZOPL(&ZOPN)          SETC ' '                                          00194400
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00194500
&ZOPV(&ZOPN)          SETC '1'                                          00194600
&ZOPD(&ZOPN)          SETC ' '                                          00194700
.*-------------------------------------------------------------------   00194800
.***AL.L12 IOSCHPD FMT=LIST MF=S!L PARAMETERS                           00194900
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00195000
.*                                                                      00195100
&ZOPN                 SETA  &ZOPN+1                                     00195200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00195300
&ZOPO(&ZOPN)          SETC  'DC'                                        00195400
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00195500
&ZOPD(&ZOPN)          SETC  '++ IOSCHPD ARG PARMS'                      00195600
.*                                                                      00195700
.ZLMFSLX              ANOP  ,                                           00195800
.*-------------------------------------------------------------------   00195900
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00196000
&ZPLLEN               SETA 60                                           00196100
.*                                                                      00196200
                      AIF  (&XPLISTVER LT 2).ZLLEN2Z                    00196300
&ZPLLEN               SETA 92                                           00196400
.ZLLEN2Z              ANOP  ,                                           00196500
.*                                                                      00196600
                      AIF  (&XPLISTVER LT 3).ZLLEN3Z                    00196700
&ZPLLEN               SETA 124                                          00196800
.ZLLEN3Z              ANOP  ,                                           00196900
.*                                                                      00197000
                      AIF  (&XPLISTVER LT 4).ZLLEN4Z                    00197100
&ZPLLEN               SETA 156                                          00197200
.ZLLEN4Z              ANOP  ,                                           00197300
.*                                                                      00197400
.******************************************************************     00197500
.***AI.L01 IOSCHPD FMT=LIST FILL IN PARAMETER AREA                      00197600
.******************************************************************     00197700
                      ACTR  10000                                       00197800
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00197900
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00198000
&ZCVAL                SETC  'LAE'          XAX MODE                     00198100
.ZIMFXA               ANOP ,                                            00198200
.*                                                                      00198300
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00198400
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00198500
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00198600
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00198700
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00198800
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00198900
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00199000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00199100
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00199200
&ZOPN                 SETA  &ZOPN+1                                     00199300
&ZOPL(&ZOPN)          SETC  ' '                                         00199400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00199500
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00199600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00199700
                      AGO   .ZIMFNX                                     00199800
.*                                                                      00199900
.ZIMFN2               ANOP ,                                            00200000
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00200100
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00200200
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00200300
&ZOPN                 SETA  &ZOPN+1                                     00200400
&ZOPL(&ZOPN)          SETC  ' '                                         00200500
&ZOPO(&ZOPN)          SETC  'LAE'                                       00200600
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00200700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00200800
                      AGO   .ZIMFNX                                     00200900
.ZIMFNX1              ANOP ,                                            00201000
&ZOPN                 SETA  &ZOPN+1                                     00201100
&ZOPL(&ZOPN)          SETC  ' '                                         00201200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00201300
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00201400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00201500
.ZIMFNX               ANOP ,                                            00201600
.********************************************************************   00201700
.***AI.L02 IOSCHPD FMT=LIST INITIALIZE PARAMETER AREA                   00201800
.********************************************************************   00201900
.***AI.L03 MF=(SLE)                                                     00202000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00202100
.*                                                                      00202200
&ZOPN                 SETA  &ZOPN+1                                     00202300
&ZOPL(&ZOPN)          SETC  ' '                                         00202400
&ZOPO(&ZOPN)          SETC  'XC'                                        00202500
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00202600
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00202700
.ZIMFLX               ANOP  ,                                           00202800
.*-------------------------------------------------------------------   00202900
.***AI.L04A XVERSION XL1                                                00203000
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00203100
&ZOPN                 SETA  &ZOPN+1                                     00203200
&ZOPL(&ZOPN)          SETC  ' '                                         00203300
&ZOPO(&ZOPN)          SETC  'MVI'                                       00203400
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00203500
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00203600
.ZIMFVW               ANOP  ,                                           00203700
.*-------------------------------------------------------------------   00203800
.***AI.L05 XFLAGS BL1                                                   00203900
&ZW                   SETC  ''                                          00204000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00204100
.*-------------------------------------------------------------------   00204200
.***AI.L08 XFLAGS "CHPID"                                               00204300
.***      BL1'1XXXXXXX'                                                 00204400
         AIF   ('&CHPID' EQ '').ZI3A                                    00204500
&ZW                   SETC  '&ZW.1'                                     00204600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00204700
                      AGO   .ZI3C                                       00204800
.*                                                                      00204900
.ZI3A                 ANOP  ,                                           00205000
&ZW                   SETC  '&ZW.0'                                     00205100
.ZI3C                 ANOP  ,                                           00205200
.*-------------------------------------------------------------------   00205300
.***AI.L08 XFLAGS "CHP_TYPE"                                            00205400
.***      BL1'X1XXXXXX'                                                 00205500
         AIF   ('&CHP_TYPE' EQ '').ZI4A                                 00205600
&ZW                   SETC  '&ZW.1'                                     00205700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00205800
                      AGO   .ZI4C                                       00205900
.*                                                                      00206000
.ZI4A                 ANOP  ,                                           00206100
&ZW                   SETC  '&ZW.0'                                     00206200
.ZI4C                 ANOP  ,                                           00206300
.*-------------------------------------------------------------------   00206400
.***AI.L08 XFLAGS "ACRONYM"                                             00206500
.***      BL1'XX1XXXXX'                                                 00206600
         AIF   ('&ACRONYM' EQ '').ZI5A                                  00206700
&ZW                   SETC  '&ZW.1'                                     00206800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00206900
                      AGO   .ZI5C                                       00207000
.*                                                                      00207100
.ZI5A                 ANOP  ,                                           00207200
&ZW                   SETC  '&ZW.0'                                     00207300
.ZI5C                 ANOP  ,                                           00207400
.*-------------------------------------------------------------------   00207500
.***AI.L08 XFLAGS "DESC"                                                00207600
.***      BL1'XXX1XXXX'                                                 00207700
         AIF   ('&DESC' EQ '').ZI6A                                     00207800
&ZW                   SETC  '&ZW.1'                                     00207900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00208000
                      AGO   .ZI6C                                       00208100
.*                                                                      00208200
.ZI6A                 ANOP  ,                                           00208300
&ZW                   SETC  '&ZW.0'                                     00208400
.ZI6C                 ANOP  ,                                           00208500
.*-------------------------------------------------------------------   00208600
.***AI.L08 XFLAGS "CHP_PARM"                                            00208700
.***      BL1'XXXX1XXX'                                                 00208800
         AIF   ('&CHP_PARM' EQ '').ZI7A                                 00208900
&ZW                   SETC  '&ZW.1'                                     00209000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00209100
                      AGO   .ZI7C                                       00209200
.*                                                                      00209300
.ZI7A                 ANOP  ,                                           00209400
&ZW                   SETC  '&ZW.0'                                     00209500
.ZI7C                 ANOP  ,                                           00209600
.*-------------------------------------------------------------------   00209700
.***AI.L08 XFLAGS "ATTR"                                                00209800
.***      BL1'XXXXX1XX'                                                 00209900
         AIF   ('&ATTR' EQ '').ZI8A                                     00210000
&ZW                   SETC  '&ZW.1'                                     00210100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00210200
                      AGO   .ZI8C                                       00210300
.*                                                                      00210400
.ZI8A                 ANOP  ,                                           00210500
&ZW                   SETC  '&ZW.0'                                     00210600
.ZI8C                 ANOP  ,                                           00210700
.*-------------------------------------------------------------------   00210800
.***AI.L08 XFLAGS "WWPN"                                                00210900
.***      BL1'XXXXXX1X'                                                 00211000
         AIF   ('&WWPN' EQ '').ZI9A                                     00211100
&ZW                   SETC  '&ZW.1'                                     00211200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00211300
                      AGO   .ZI9C                                       00211400
.*                                                                      00211500
.ZI9A                 ANOP  ,                                           00211600
&ZW                   SETC  '&ZW.0'                                     00211700
.ZI9C                 ANOP  ,                                           00211800
.*-------------------------------------------------------------------   00211900
.***AI.L08 XFLAGS "ND"                                                  00212000
.***      BL1'XXXXXXX1'                                                 00212100
         AIF   ('&ND' EQ '').ZI10A                                      00212200
&ZW                   SETC  '&ZW.1'                                     00212300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00212400
                      AGO   .ZI10C                                      00212500
.*                                                                      00212600
.ZI10A                ANOP  ,                                           00212700
&ZW                   SETC  '&ZW.0'                                     00212800
.ZI10C                ANOP  ,                                           00212900
.*-------------------------------------------------------------------   00213000
.***AI.L11 XFLAGS BL1                                                   00213100
                      AIF   ('&ZCLNG' NE 'YES').ZI10E  ALL ZERO BITS    00213200
&ZOPN                 SETA  &ZOPN+1                                     00213300
&ZOPL(&ZOPN)          SETC  ' '                                         00213400
&ZOPO(&ZOPN)          SETC  'OI'                                        00213500
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00213600
&ZOPD(&ZOPN)          SETC  '++ OUTPUT BL1'                             00213700
.ZI10E                ANOP  ,                                           00213800
.*-------------------------------------------------------------------   00213900
.***AI.L05 XFLAG2 BL1                                                   00214000
&ZW                   SETC  ''                                          00214100
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00214200
.*-------------------------------------------------------------------   00214300
.***AI.L08 XFLAG2 "UTILITYSTRINGS"                                      00214400
.***      BL1'1XXXXXXX'                                                 00214500
         AIF   ('&UTILITYSTRINGS' EQ '').ZI12A                          00214600
&ZW                   SETC  '&ZW.10000000'                              00214700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00214800
                      AGO   .ZI12C                                      00214900
.*                                                                      00215000
.ZI12A                ANOP  ,                                           00215100
&ZW                   SETC  '&ZW.00000000'                              00215200
.ZI12C                ANOP  ,                                           00215300
.*-------------------------------------------------------------------   00215400
.***AI.L11 XFLAG2 BL1                                                   00215500
                      AIF   ('&ZCLNG' NE 'YES').ZI12E  ALL ZERO BITS    00215600
&ZOPN                 SETA  &ZOPN+1                                     00215700
&ZOPL(&ZOPN)          SETC  ' '                                         00215800
&ZOPO(&ZOPN)          SETC  'OI'                                        00215900
&ZOPV(&ZOPN)          SETC  '2(1),B''&ZW'''                             00216000
&ZOPD(&ZOPN)          SETC  '++ OUTPUT BL1'                             00216100
.ZI12E                ANOP  ,                                           00216200
.*-------------------------------------------------------------------   00216300
.***AI.L25  XCHPID XL2                                                  00216400
                      AIF   ('&ZXCHPID' EQ '').ZI14E                    00216500
                      AIF   ('&ZXCHPID' EQ 'OUTPUT').ZI14E              00216600
&ZCGPR                SETC  '&XCHPID'                                   00216700
.*                                                                      00216800
                      AIF   ('&XCHPID'(1,1) NE '(').ZI14B               00216900
&ZCGPR   SETC  '0('.'&XCHPID'(2,K'&XCHPID-2).')'                        00217000
.ZI14B                ANOP  ,                                           00217100
.*                                                                      00217200
&ZC                   SETC  '&XCHPID'(1,1)                              00217300
                      AIF   (T'&ZC NE 'N').ZI14D                        00217400
&ZC                   SETC  '&XCHPID'                                   00217500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI14D               00217600
&ZCGPR                SETC  '=AL2(&XCHPID)'                             00217700
.*                                                                      00217800
.ZI14D                ANOP  ,                                           00217900
.*                                                                      00218000
&ZOPN                 SETA  &ZOPN+1                                     00218100
&ZOPL(&ZOPN)          SETC  ' '                                         00218200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00218300
&ZOPV(&ZOPN)          SETC  '6(2,1),&ZCGPR'                             00218400
&ZOPD(&ZOPN)          SETC  '++ &ZXCHPID XCHPID'                        00218500
.*                                                                      00218600
.ZI14E                ANOP  ,                                           00218700
.*-------------------------------------------------------------------   00218800
.***AI.L25  XCHP_TYPE XL1                                               00218900
                      AIF   ('&ZXCHP_TYPE' EQ '').ZI15E                 00219000
                      AIF   ('&ZXCHP_TYPE' EQ 'OUTPUT').ZI15E           00219100
&ZCGPR                SETC  '&XCHP_TYPE'                                00219200
.*                                                                      00219300
                      AIF   ('&XCHP_TYPE'(1,1) NE '(').ZI15B            00219400
&ZCGPR   SETC  '0('.'&XCHP_TYPE'(2,K'&XCHP_TYPE-2).')'                  00219500
                      AGO   .ZI15D                                      00219600
.ZI15B                ANOP  ,                                           00219700
.*                                                                      00219800
&ZC                   SETC  '&XCHP_TYPE'(1,1)                           00219900
                      AIF   (T'&ZC NE 'N').ZI15D                        00220000
&ZC                   SETC  '&XCHP_TYPE'                                00220100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI15D               00220200
&ZCGPR                SETC  '=AL1(&XCHP_TYPE)'                          00220300
.*                                                                      00220400
.ZI15D                ANOP  ,                                           00220500
.*                                                                      00220600
&ZOPN                 SETA  &ZOPN+1                                     00220700
&ZOPL(&ZOPN)          SETC  ' '                                         00220800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00220900
&ZOPV(&ZOPN)          SETC  '8(1,1),&ZCGPR'                             00221000
&ZOPD(&ZOPN)          SETC  '++ &ZXCHP_TYPE XCHP_TYPE'                  00221100
.*                                                                      00221200
.ZI15E                ANOP  ,                                           00221300
.*-------------------------------------------------------------------   00221400
.***AI.L25  XCHP_PARM XL1                                               00221500
                      AIF   ('&ZXCHP_PARM' EQ '').ZI18E                 00221600
                      AIF   ('&ZXCHP_PARM' EQ 'OUTPUT').ZI18E           00221700
&ZCGPR                SETC  '&XCHP_PARM'                                00221800
         AIF   ('&XCHP_PARM' EQ '0').ZI18E                              00221900
         AIF   ('&XCHP_PARM' EQ '0').ZI18E                              00222000
.*                                                                      00222100
                      AIF   ('&XCHP_PARM'(1,1) NE '(').ZI18B            00222200
&ZCGPR   SETC  '0('.'&XCHP_PARM'(2,K'&XCHP_PARM-2).')'                  00222300
                      AGO   .ZI18D                                      00222400
.ZI18B                ANOP  ,                                           00222500
.*                                                                      00222600
&ZC                   SETC  '&XCHP_PARM'(1,1)                           00222700
                      AIF   (T'&ZC NE 'N').ZI18D                        00222800
&ZC                   SETC  '&XCHP_PARM'                                00222900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI18D               00223000
&ZCGPR                SETC  '=AL1(&XCHP_PARM)'                          00223100
.*                                                                      00223200
.ZI18D                ANOP  ,                                           00223300
.*                                                                      00223400
&ZOPN                 SETA  &ZOPN+1                                     00223500
&ZOPL(&ZOPN)          SETC  ' '                                         00223600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00223700
&ZOPV(&ZOPN)          SETC  '46(1,1),&ZCGPR'                            00223800
&ZOPD(&ZOPN)          SETC  '++ &ZXCHP_PARM XCHP_PARM'                  00223900
.*                                                                      00224000
.ZI18E                ANOP  ,                                           00224100
.*-------------------------------------------------------------------   00224200
.***AI.LVER01                                                           00224300
                      AIF  (&XPLISTVER LT 4).ZI23Z                      00224400
.*-------------------------------------------------------------------   00224500
.***AI.L19 ADDR XUTILITYSTRINGS A                                       00224600
                      AIF   ('&ZXUTILITYSTRINGS' EQ '').ZI23H           00224700
&ZCLNG                SETC  '&XUTILITYSTRINGS'                          00224800
&ZCGPR                SETC  '14'                                        00224900
         AIF   ('&XUTILITYSTRINGS'(1,1) EQ '(').ZI23F  IN GPR           00225000
.*                                                                      00225100
&ZOPN                 SETA  &ZOPN+1                                     00225200
&ZOPL(&ZOPN)          SETC  ' '                                         00225300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00225400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00225500
&ZOPD(&ZOPN)          SETC  '++ &ZXUTILITYSTRINGS XUTILITYSTRINGS'      00225600
.*                                                                      00225700
                      AGO   .ZI23G                                      00225800
.*                                                                      00225900
.ZI23F                ANOP  ,                                           00226000
&ZCGPR   SETC  '&XUTILITYSTRINGS'(2,K'&XUTILITYSTRINGS-2)               00226100
.*                                                                      00226200
.ZI23G                ANOP  ,                                           00226300
.*                                                                      00226400
&ZOPN                 SETA  &ZOPN+1                                     00226500
&ZOPL(&ZOPN)          SETC  ' '                                         00226600
&ZOPO(&ZOPN)          SETC  'ST'                                        00226700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,124(,1)'                            00226800
&ZOPD(&ZOPN)          SETC  '++ &ZXUTILITYSTRINGS XUTILITYSTRINGS'      00226900
.*                                                                      00227000
.ZI23H                ANOP  ,                                           00227100
.*-------------------------------------------------------------------   00227200
.***AI.LVER02                                                           00227300
.ZI23Z                ANOP  ,                                           00227400
.*-------------------------------------------------------------------   00227500
.***AI.LVER01                                                           00227600
                      AIF  (&XPLISTVER LT 4).ZI24Z                      00227700
.*-------------------------------------------------------------------   00227800
.***AI.L23 ALET XUTILITYSTRINGS F                                       00227900
         AIF   ('&ZXUTILITYSTRINGS' EQ '').ZI24G                        00228000
         AIF   ('&SYSASCE' EQ 'P').ZI24G   SYSSTATE PRIMARY             00228100
&ZCLNG                SETC  '&XUTILITYSTRINGS'                          00228200
         AIF   ('&XUTILITYSTRINGS'(1,1) EQ '(').ZI24E  IN AR            00228300
.*                                                                      00228400
&ZCGPR                SETC  '14'                                        00228500
                      AGO   .ZI24F                                      00228600
.*                                                                      00228700
.ZI24E                ANOP  ,                                           00228800
&ZCGPR   SETC  '&XUTILITYSTRINGS'(2,K'&XUTILITYSTRINGS-2)               00228900
.*                                                                      00229000
.ZI24F                ANOP  ,                                           00229100
.*                                                                      00229200
&ZOPN                 SETA  &ZOPN+1                                     00229300
&ZOPL(&ZOPN)          SETC  ' '                                         00229400
&ZOPO(&ZOPN)          SETC  'STAM'                                      00229500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,128(1)'                      00229600
&ZOPD(&ZOPN)          SETC  '++ &ZXUTILITYSTRINGS XUTILITYSTRINGS'      00229700
.*                                                                      00229800
.ZI24G                ANOP  ,                                           00229900
.*-------------------------------------------------------------------   00230000
.***AI.LVER02                                                           00230100
.ZI24Z                ANOP  ,                                           00230200
.*-------------------------------------------------------------------   00230300
.***AI.LVER01                                                           00230400
                      AIF  (&XPLISTVER LT 4).ZI25Z                      00230500
.*-------------------------------------------------------------------   00230600
.***AI.LVER02                                                           00230700
.ZI25Z                ANOP  ,                                           00230800
.*-------------------------------------------------------------------   00230900
&ZOPN1                SETA &ZOPN                                        00231000
.*******************************************************************    00231100
.***  PROCESS IOSCHPD OUTPUT PARAMETERS                                 00231200
.*******************************************************************    00231300
                      ACTR  10000                                       00231400
.*------------------------------------------------------------------    00231500
.***AO.L02 XACRONYM CL5                                                 00231600
         AIF   ('&ZXACRONYM' EQ 'OUTPUT').ZO16A  OUTPUT                 00231700
         AIF   ('&ZXACRONYM' NE 'INOUT').ZO16C  INOUT                   00231800
.ZO16A    AIF   ('&XACRONYM'(1,1) NE '(').ZO16B  ADDR IN GPR            00231900
&ZCGPR   SETC  '&XACRONYM'(2,K'&XACRONYM-2)                             00232000
&ZOPN                 SETA  &ZOPN+1                                     00232100
&ZOPL(&ZOPN)          SETC  ' '                                         00232200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00232300
&ZOPV(&ZOPN)          SETC  '0(5,&ZCGPR),9(1)'                          00232400
&ZOPD(&ZOPN)          SETC  '++ XACRONYM CL5'                           00232500
                      AGO   .ZO16C                                      00232600
.*                                                                      00232700
.ZO16B                ANOP  ,                                           00232800
&ZAWRK   SETA  K'&XACRONYM                                              00232900
         AIF   ('&XACRONYM'(&ZAWRK,1) NE ')').ZO16G                     00233000
&ZN      SETA  2                                                        00233100
.ZO16H    ANOP                                                          00233200
         AIF   (&ZN GE &ZAWRK).ZO16G                                    00233300
         AIF   ('&XACRONYM'(&ZN,1) NE '(').ZO16I                        00233400
&ZC      SETC  '&XACRONYM'(1,&ZN).'5'.','                               00233500
&ZC      SETC  '&ZC'.'&XACRONYM'(&ZN+1,&ZAWRK-&ZN).',9(1)'              00233600
         AGO   .ZO16J                                                   00233700
.ZO16I    ANOP                                                          00233800
&ZN      SETA  &ZN+1                                                    00233900
         AGO   .ZO16H                                                   00234000
.ZO16G    ANOP                                                          00234100
&ZC      SETC  '&XACRONYM.(5),9(1)'                                     00234200
.ZO16J    ANOP                                                          00234300
&ZOPN                 SETA  &ZOPN+1                                     00234400
&ZOPL(&ZOPN)          SETC  ' '                                         00234500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00234600
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00234700
&ZOPD(&ZOPN)          SETC  '++ XACRONYM CL5'                           00234800
.ZO16C                ANOP  ,                                           00234900
.*------------------------------------------------------------------    00235000
.***AO.L02 XDESC CL32                                                   00235100
         AIF   ('&ZXDESC' EQ 'OUTPUT').ZO17A  OUTPUT                    00235200
         AIF   ('&ZXDESC' NE 'INOUT').ZO17C  INOUT                      00235300
.ZO17A    AIF   ('&XDESC'(1,1) NE '(').ZO17B  ADDR IN GPR               00235400
&ZCGPR   SETC  '&XDESC'(2,K'&XDESC-2)                                   00235500
&ZOPN                 SETA  &ZOPN+1                                     00235600
&ZOPL(&ZOPN)          SETC  ' '                                         00235700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00235800
&ZOPV(&ZOPN)          SETC  '0(32,&ZCGPR),14(1)'                        00235900
&ZOPD(&ZOPN)          SETC  '++ XDESC CL32'                             00236000
                      AGO   .ZO17C                                      00236100
.*                                                                      00236200
.ZO17B                ANOP  ,                                           00236300
&ZAWRK   SETA  K'&XDESC                                                 00236400
         AIF   ('&XDESC'(&ZAWRK,1) NE ')').ZO17G                        00236500
&ZN      SETA  2                                                        00236600
.ZO17H    ANOP                                                          00236700
         AIF   (&ZN GE &ZAWRK).ZO17G                                    00236800
         AIF   ('&XDESC'(&ZN,1) NE '(').ZO17I                           00236900
&ZC      SETC  '&XDESC'(1,&ZN).'32'.','                                 00237000
&ZC      SETC  '&ZC'.'&XDESC'(&ZN+1,&ZAWRK-&ZN).',14(1)'                00237100
         AGO   .ZO17J                                                   00237200
.ZO17I    ANOP                                                          00237300
&ZN      SETA  &ZN+1                                                    00237400
         AGO   .ZO17H                                                   00237500
.ZO17G    ANOP                                                          00237600
&ZC      SETC  '&XDESC.(32),14(1)'                                      00237700
.ZO17J    ANOP                                                          00237800
&ZOPN                 SETA  &ZOPN+1                                     00237900
&ZOPL(&ZOPN)          SETC  ' '                                         00238000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00238100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00238200
&ZOPD(&ZOPN)          SETC  '++ XDESC CL32'                             00238300
.ZO17C                ANOP  ,                                           00238400
.*------------------------------------------------------------------    00238500
.***AO.L02 XWWPN XL8                                                    00238600
         AIF   ('&ZXWWPN' EQ 'OUTPUT').ZO20A  OUTPUT                    00238700
         AIF   ('&ZXWWPN' NE 'INOUT').ZO20C  INOUT                      00238800
.ZO20A    AIF   ('&XWWPN'(1,1) NE '(').ZO20B  ADDR IN GPR               00238900
&ZCGPR   SETC  '&XWWPN'(2,K'&XWWPN-2)                                   00239000
&ZOPN                 SETA  &ZOPN+1                                     00239100
&ZOPL(&ZOPN)          SETC  ' '                                         00239200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00239300
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),52(1)'                         00239400
&ZOPD(&ZOPN)          SETC  '++ XWWPN XL8'                              00239500
                      AGO   .ZO20C                                      00239600
.*                                                                      00239700
.ZO20B                ANOP  ,                                           00239800
&ZAWRK   SETA  K'&XWWPN                                                 00239900
         AIF   ('&XWWPN'(&ZAWRK,1) NE ')').ZO20G                        00240000
&ZN      SETA  2                                                        00240100
.ZO20H    ANOP                                                          00240200
         AIF   (&ZN GE &ZAWRK).ZO20G                                    00240300
         AIF   ('&XWWPN'(&ZN,1) NE '(').ZO20I                           00240400
&ZC      SETC  '&XWWPN'(1,&ZN).'8'.','                                  00240500
&ZC      SETC  '&ZC'.'&XWWPN'(&ZN+1,&ZAWRK-&ZN).',52(1)'                00240600
         AGO   .ZO20J                                                   00240700
.ZO20I    ANOP                                                          00240800
&ZN      SETA  &ZN+1                                                    00240900
         AGO   .ZO20H                                                   00241000
.ZO20G    ANOP                                                          00241100
&ZC      SETC  '&XWWPN.(8),52(1)'                                       00241200
.ZO20J    ANOP                                                          00241300
&ZOPN                 SETA  &ZOPN+1                                     00241400
&ZOPL(&ZOPN)          SETC  ' '                                         00241500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00241600
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00241700
&ZOPD(&ZOPN)          SETC  '++ XWWPN XL8'                              00241800
.ZO20C                ANOP  ,                                           00241900
.*------------------------------------------------------------------    00242000
.***AO.LVER01                                                           00242100
                      AIF  (&XPLISTVER LT 2).ZO21Z  PLVER               00242200
.*------------------------------------------------------------------    00242300
.***AO.L02 XATTR CL32                                                   00242400
         AIF   ('&ZXATTR' EQ 'OUTPUT').ZO21A  OUTPUT                    00242500
         AIF   ('&ZXATTR' NE 'INOUT').ZO21C  INOUT                      00242600
.ZO21A    AIF   ('&XATTR'(1,1) NE '(').ZO21B  ADDR IN GPR               00242700
&ZCGPR   SETC  '&XATTR'(2,K'&XATTR-2)                                   00242800
&ZOPN                 SETA  &ZOPN+1                                     00242900
&ZOPL(&ZOPN)          SETC  ' '                                         00243000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00243100
&ZOPV(&ZOPN)          SETC  '0(32,&ZCGPR),60(1)'                        00243200
&ZOPD(&ZOPN)          SETC  '++ XATTR CL32'                             00243300
                      AGO   .ZO21C                                      00243400
.*                                                                      00243500
.ZO21B                ANOP  ,                                           00243600
&ZAWRK   SETA  K'&XATTR                                                 00243700
         AIF   ('&XATTR'(&ZAWRK,1) NE ')').ZO21G                        00243800
&ZN      SETA  2                                                        00243900
.ZO21H    ANOP                                                          00244000
         AIF   (&ZN GE &ZAWRK).ZO21G                                    00244100
         AIF   ('&XATTR'(&ZN,1) NE '(').ZO21I                           00244200
&ZC      SETC  '&XATTR'(1,&ZN).'32'.','                                 00244300
&ZC      SETC  '&ZC'.'&XATTR'(&ZN+1,&ZAWRK-&ZN).',60(1)'                00244400
         AGO   .ZO21J                                                   00244500
.ZO21I    ANOP                                                          00244600
&ZN      SETA  &ZN+1                                                    00244700
         AGO   .ZO21H                                                   00244800
.ZO21G    ANOP                                                          00244900
&ZC      SETC  '&XATTR.(32),60(1)'                                      00245000
.ZO21J    ANOP                                                          00245100
&ZOPN                 SETA  &ZOPN+1                                     00245200
&ZOPL(&ZOPN)          SETC  ' '                                         00245300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00245400
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00245500
&ZOPD(&ZOPN)          SETC  '++ XATTR CL32'                             00245600
.ZO21C                ANOP  ,                                           00245700
.*------------------------------------------------------------------    00245800
.***AO.LVER02                                                           00245900
.ZO21Z                ANOP  ,                                           00246000
.*------------------------------------------------------------------    00246100
.***AO.LVER01                                                           00246200
                      AIF  (&XPLISTVER LT 3).ZO22Z  PLVER               00246300
.*------------------------------------------------------------------    00246400
.***AO.L02 XND CL32                                                     00246500
         AIF   ('&ZXND' EQ 'OUTPUT').ZO22A  OUTPUT                      00246600
         AIF   ('&ZXND' NE 'INOUT').ZO22C  INOUT                        00246700
.ZO22A    AIF   ('&XND'(1,1) NE '(').ZO22B  ADDR IN GPR                 00246800
&ZCGPR   SETC  '&XND'(2,K'&XND-2)                                       00246900
&ZOPN                 SETA  &ZOPN+1                                     00247000
&ZOPL(&ZOPN)          SETC  ' '                                         00247100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00247200
&ZOPV(&ZOPN)          SETC  '0(32,&ZCGPR),92(1)'                        00247300
&ZOPD(&ZOPN)          SETC  '++ XND CL32'                               00247400
                      AGO   .ZO22C                                      00247500
.*                                                                      00247600
.ZO22B                ANOP  ,                                           00247700
&ZAWRK   SETA  K'&XND                                                   00247800
         AIF   ('&XND'(&ZAWRK,1) NE ')').ZO22G                          00247900
&ZN      SETA  2                                                        00248000
.ZO22H    ANOP                                                          00248100
         AIF   (&ZN GE &ZAWRK).ZO22G                                    00248200
         AIF   ('&XND'(&ZN,1) NE '(').ZO22I                             00248300
&ZC      SETC  '&XND'(1,&ZN).'32'.','                                   00248400
&ZC      SETC  '&ZC'.'&XND'(&ZN+1,&ZAWRK-&ZN).',92(1)'                  00248500
         AGO   .ZO22J                                                   00248600
.ZO22I    ANOP                                                          00248700
&ZN      SETA  &ZN+1                                                    00248800
         AGO   .ZO22H                                                   00248900
.ZO22G    ANOP                                                          00249000
&ZC      SETC  '&XND.(32),92(1)'                                        00249100
.ZO22J    ANOP                                                          00249200
&ZOPN                 SETA  &ZOPN+1                                     00249300
&ZOPL(&ZOPN)          SETC  ' '                                         00249400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00249500
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00249600
&ZOPD(&ZOPN)          SETC  '++ XND CL32'                               00249700
.ZO22C                ANOP  ,                                           00249800
.*------------------------------------------------------------------    00249900
.***AO.LVER02                                                           00250000
.ZO22Z                ANOP  ,                                           00250100
.*******************************************************************    00250200
.***AO.X02  RETURN CODE PROCESSING                                      00250300
.*******************************************************************    00250400
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00250500
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00250600
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00250700
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00250800
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00250900
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00251000
&ZOPN                 SETA  &ZOPN+1                                     00251100
&ZOPL(&ZOPN)          SETC  ' '                                         00251200
&ZOPO(&ZOPN)          SETC  'ST'                                        00251300
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00251400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00251500
                      AGO   .ZMRETX                                     00251600
.*                                                                      00251700
.ZMRET2               ANOP  ,                                           00251800
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00251900
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00252000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00252100
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00252200
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00252300
&ZOPN                 SETA  &ZOPN+1                                     00252400
&ZOPL(&ZOPN)          SETC  ' '                                         00252500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00252600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00252700
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00252800
.ZMRETX               ANOP  ,                                           00252900
.*******************************************************************    00253000
.***AO.X03  REASON CODE PROCESSING                                      00253100
.*******************************************************************    00253200
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00253300
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00253400
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00253500
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00253600
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00253700
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00253800
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00253900
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00254000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00254100
&ZOPN                 SETA  &ZOPN+1                                     00254200
&ZOPL(&ZOPN)          SETC  ' '                                         00254300
&ZOPO(&ZOPN)          SETC  'ST'                                        00254400
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00254500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00254600
                      AGO   .ZMRSNX                                     00254700
.*                                                                      00254800
.ZMRSN2               ANOP  ,                                           00254900
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00255000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00255100
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00255200
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00255300
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00255400
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00255500
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00255600
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00255700
&ZOPN                 SETA  &ZOPN+1                                     00255800
&ZOPL(&ZOPN)          SETC  ' '                                         00255900
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00256000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00256100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00256200
.ZMRSNX               ANOP  ,                                           00256300
.*******************************************************************    00256400
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00256500
.*******************************************************************    00256600
.ZMFLX                ANOP  ,              MF=L PROCESSING              00256700
.*******************************************************************    00256800
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00256900
.*******************************************************************    00257000
                      ACTR  10000                                       00257100
.*                                                                      00257200
                      LCLA  &ZLC           COLUMN POSITION              00257300
                      LCLA  &ZOPX          LIST TABLE INDEX             00257400
                      LCLC  &ZLL           LABEL                        00257500
                      LCLC  &ZLOP          OPERATION                    00257600
                      LCLC  &ZLV           VALUE                        00257700
                      LCLC  &ZLD           DESCRIPTION                  00257800
.*                                                                      00257900
&ZOPX                 SETA  1                                           00258000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00258100
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00258200
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00258300
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00258400
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00258500
                      AIF   (K'&ZLD LE 0).ZL5                           00258600
&ZLC                  SETA  35             COMMENT COLUMN               00258700
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00258800
&ZLC                  SETA  33             COMMMENT COLUMN              00258900
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00259000
&ZLV                  SETC  '&ZLV'.' '                                  00259100
                      AGO   .ZL3                                        00259200
.*                                                                      00259300
.ZL4                  ANOP  ,                                           00259400
&ZLV                  SETC  '&ZLV'.' '                                  00259500
.ZL5                  ANOP  ,                                           00259600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00259700
.*                                                                      00259800
&ZLL     &ZLOP &ZLV                                                     00259900
.*                                                                      00260000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00260100
                      AGO   .ZL2           CONTINUE LOOPING             00260200
.*                                                                      00260300
.ZLX                  ANOP  ,                                           00260400
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00260500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00260600
.*-----------BAL invocation code-------------                           00260700
.LNKFC3  LA    0,10               ++ SET IOSCHPD FUNCTION CODE          00260800
         AIF    ('&XLINKAGE' NE 'BRANCH').LNKPC1                        00260900
.*********************************************************************  00261000
.*                                                                   *  00261100
.*  Get addressability to CVT                                        *  00261200
.*                                                                   *  00261300
.*********************************************************************  00261400
         L     15,16(0,0)                                               00261500
.*********************************************************************  00261600
.*                                                                   *  00261700
.*  Get addressability to IOCOM                                      *  00261800
.*                                                                   *  00261900
.*********************************************************************  00262000
         L     15,124(15,0)                                             00262100
.*********************************************************************  00262200
.*                                                                   *  00262300
.*  Get addressability to IOVT                                       *  00262400
.*                                                                   *  00262500
.*********************************************************************  00262600
         L     15,208(15,0)                                             00262700
         L     15,12(15,0)        ++ SET ADDR OF UCB SERVICES           00262800
         BALR  14,15              ++ BRANCH TO UCB SERVICES             00262900
         AGO   .DONE1                                                   00263000
.LNKPC1  ANOP                                                           00263100
         L     14,16(0,0)         ++ GET CVT ADDRESS                    00263200
         L     14,772(14,0)       ++ GET SFT ADDRESS                    00263300
.*********************************************************************  00263400
.*                                                                   *  00263500
.*  Get LX/EX for UCB Services and then PC to UCB services           *  00263600
.*                                                                   *  00263700
.*  Note: LX/EX is calculated by multiplying the PC number (79)      *  00263800
.*        times the length of a PC/AUTH table entry (4) and          *  00263900
.*        then subtracting 4.                                        *  00264000
.*                                                                   *  00264100
.*********************************************************************  00264200
         L     14,312(14,0)       ++ GET LX/EX FOR UCB SERVICES         00264300
         PC    0(14)              ++ PC TO UCB SERVICES                 00264400
.DONE1   ANOP                                                           00264500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00264600
.ZLINKX               ANOP  ,                                           00264700
.*******************************************************************    00264800
.***AP.X01  FORMAT GENERATED CODE                                       00264900
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00265000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00265100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00265200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00265300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00265400
                      AIF   (K'&ZLD LE 0).ZL51                          00265500
&ZLC                  SETA  35             COMMENT COLUMN               00265600
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00265700
&ZLC                  SETA  33             COMMENT COLUMN               00265800
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00265900
&ZLV                  SETC  '&ZLV'.' '                                  00266000
                      AGO   .ZL31                                       00266100
.*                                                                      00266200
.ZL41                 ANOP  ,                                           00266300
&ZLV                  SETC  '&ZLV'.' '                                  00266400
.ZL51                 ANOP  ,                                           00266500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00266600
.*                                                                      00266700
&ZLL     &ZLOP &ZLV                                                     00266800
.*                                                                      00266900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00267000
                      AGO   .ZL21          CONTINUE LOOPING             00267100
.*                                                                      00267200
.ZLX1                 ANOP  ,                                           00267300
.*******************************************************************    00267400
.***AP.X02  END OF IOSCHPD MACRO                                        00267500
&ZIOSCHPD             SETC  'YES'          SET IOSCHPD USED             00267600
         POP   PRINT                                                    00267700
*                                            IOSCHPD-4                  00267800
         SPACE 1                                                        00267900
.ZLX2                 ANOP  ,                                           00268000
         MEND                                                           00268100
**********************************************************************/ 00268200
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00268300
*%IOSCHPD: MACRO KEYS(CHPID,CHP_TYPE,CHP_PARM,ACRONYM,DESC,ATTR,WWPN,   00268400
*                 ND,UTILITYSTRINGS,LINKAGE,RETCODE,RSNCODE,PLISTVER,   00268500
*                 MF);                                                  00268600
*  ANS('?'!!MACLABEL!!' '!!'IOSCHPDP '!!MACLIST!!                       00268700
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00268800
*%END IOSCHPD;                                                          00268900

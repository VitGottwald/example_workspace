*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWMMNTFY                              -01/29/13-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Notify of work execution completion           * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 1993, 2013                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7790                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The primary purpose of this service is to notify MVS that the  * 00002100
*      execution phase for a work request associated with a           * 00002200
*      monitoring environment has just completed.  This may represent * 00002300
*      the entire work request OR merely a subset of it. An           * 00002400
*      indication is also given as to whether the monitoring          * 00002500
*      environment should be disassociated from the work request or   * 00002600
*      not.  When DISASSOCIATE(YES) is specified, this service will   * 00002700
*      render the information associated with the monitoring          * 00002800
*      environment unpredictable.  To associate a work request with   * 00002900
*      the monitoring environment following use of DISASSOCIATE(YES), * 00003000
*      first use Initialize Mode(Reset) or Relate/Transfer.           * 00003100
*                                                                     * 00003200
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00003300
*                                                                     * 00003400
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003500
*                                                                     * 00003600
*01* ENVIRONMENT:                                                     * 00003700
*                                                                     * 00003800
*                                                                     * 00003900
*      Dispatchable unit mode: Task or SRB mode.                      * 00004000
*                                                                     * 00004100
*      Minimum authorization: Supervisor state.  PSW key must either  * 00004200
*                        be 0 or match the value supplied on IWM4CON  * 00004300
*                        when a connect token is passed.  PSW key     * 00004400
*                        must either be 0 or match the value supplied * 00004500
*                        on IWM4MCRE.  PSW key must be 0-7. See       * 00004600
*                        restrictions below.                          * 00004700
*                                                                     * 00004800
*      AMODE:            31-bit.                                      * 00004900
*                                                                     * 00005000
*      ASC mode:         Primary.                                     * 00005100
*                                                                     * 00005200
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00005300
*                                                                     * 00005400
*      Interrupt status: Enabled for I/O and external interrupts.     * 00005500
*                                                                     * 00005600
*      Locks:            LOCAL lock held.                             * 00005700
*                                                                     * 00005800
*      Control parameters: Control parameters must be in the primary  * 00005900
*                        address space.                               * 00006000
*                                                                     * 00006100
*                                                                     * 00006200
*                                                                     * 00006300
*01* PROGRAMMING REQUIREMENTS:                                        * 00006400
*                                                                     * 00006500
*                                                                     * 00006600
*    1.  The macro CVT must be included to use this macro.            * 00006700
*                                                                     * 00006800
*    2.  The macro IWMYCON must be included to use this macro.        * 00006900
*                                                                     * 00007000
*    3.  The macro IWMPB must be in the library concatenation, since  * 00007100
*        it is included by IWMYCON.                                   * 00007200
*                                                                     * 00007300
*    4.  Note that the high order halfword of register 0, and the     * 00007400
*        reason code variable when specified, may be non-zero and     * 00007500
*        represents diagnostic data which is NOT part of the external * 00007600
*        interface.  The high order halfword should thus be excluded  * 00007700
*        from comparison with the reason code values described above. * 00007800
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 00007900
*        be used for this purpose.                                    * 00008000
*                                                                     * 00008100
*                                                                     * 00008200
*                                                                     * 00008300
*01* RESTRICTIONS:                                                    * 00008400
*                                                                     * 00008500
*                                                                     * 00008600
*    1.  This macro may not be used prior to the completion of WLM    * 00008700
*        address space initialization                                 * 00008800
*                                                                     * 00008900
*    2.  This macro may only be used on MVS/ESA (version 3 or         * 00009000
*        higher), NOT versions 1 or 2 of MVS.                         * 00009100
*                                                                     * 00009200
*    3.  Caller is responsible for error recovery                     * 00009300
*                                                                     * 00009400
*    4.  Though the caller is required to be enabled, this is not     * 00009500
*        checked.  Violation of this restriction may cause disabled   * 00009600
*        program checks which would be the responsibility of the      * 00009700
*        caller's recovery to handle.                                 * 00009800
*                                                                     * 00009900
*    5.  The monitoring environment must contain the information      * 00010000
*        saved by IWM4MINI, not IWMMRELA                              * 00010100
*                                                                     * 00010200
*    6.  The current PSW key must be 0 or match the key specified on  * 00010300
*        IWM4MCRE provided the latter is a system key (0-7).          * 00010400
*                                                                     * 00010500
*    7.  This serve can not be used for Report-Only Monitoring        * 00010600
*        Environments                                                 * 00010700
*                                                                     * 00010800
*    8.  If the key specified on IWM4MCRE was a user key (8-F), then  * 00010900
*                                                                     * 00011000
*                                                                     * 00011100
*        o   PSW key must be 0                                        * 00011200
*                                                                     * 00011300
*        o   current primary must match the primary at the time that  * 00011400
*            IWM4MCRE was invoked.  Calling from a subspace is not    * 00011500
*            supported.                                               * 00011600
*                                                                     * 00011700
*                                                                     * 00011800
*                                                                     * 00011900
*    9.  If a connect token is passed to IWMMNTFY, then               * 00012000
*                                                                     * 00012100
*                                                                     * 00012200
*        o   The connect token must be enabled for using the WLM Work * 00012300
*            Management services (specifying WORK_MANAGER=YES on      * 00012400
*            IWM4CON).                                                * 00012500
*                                                                     * 00012600
*        o   If the key specified on IWM4CON was a user key (8-F),    * 00012700
*            then                                                     * 00012800
*                                                                     * 00012900
*                                                                     * 00013000
*            -   PSW key must be 0                                    * 00013100
*                                                                     * 00013200
*            -   current primary must match the primary at the time   * 00013300
*                that IWM4CON was invoked.  Calling from a subspace   * 00013400
*                is not supported.                                    * 00013500
*                                                                     * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*                                                                     * 00013900
*                                                                     * 00014000
*    10. The caller must serialize to prevent any delay monitoring    * 00014100
*        services from being invoked concurrently for the environment * 00014200
*        represented by the monitoring token                          * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*                                                                     * 00014600
*01* INPUT REGISTER INFORMATION:                                      * 00014700
*                                                                     * 00014800
*    Before issuing the IWMMNTFY macro, the caller must ensure that   * 00014900
*    the following general purpose registers (GPRs) contain the       * 00015000
*    specified information:                                           * 00015100
*                                                                     * 00015200
*                                                                     * 00015300
*    REGISTER  CONTENTS                                               * 00015400
*                                                                     * 00015500
*    13        The address of a 72-byte standard save area in the     * 00015600
*              primary address space                                  * 00015700
*                                                                     * 00015800
*                                                                     * 00015900
*                                                                     * 00016000
*    Before issuing the IWMMNTFY macro, the caller does not have to   * 00016100
*    place any information into any AR unless using it in register    * 00016200
*    notation for a particular parameter, or using it as a base       * 00016300
*    register.                                                        * 00016400
*                                                                     * 00016500
*01* OUTPUT REGISTER INFORMATION:                                     * 00016600
*                                                                     * 00016700
*    When control returns to the caller, the GPRs contain:            * 00016800
*                                                                     * 00016900
*                                                                     * 00017000
*    REGISTER  CONTENTS                                               * 00017100
*                                                                     * 00017200
*    0-1       Used as work registers by the system                   * 00017300
*                                                                     * 00017400
*    2-13      Unchanged                                              * 00017500
*                                                                     * 00017600
*    14-15     Used as work registers by the system.                  * 00017700
*                                                                     * 00017800
*                                                                     * 00017900
*                                                                     * 00018000
*    When control returns to the caller, the ARs contain:             * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*    REGISTER  CONTENTS                                               * 00018400
*                                                                     * 00018500
*    0-1       Used as work registers by the system                   * 00018600
*                                                                     * 00018700
*    2-13      Unchanged                                              * 00018800
*                                                                     * 00018900
*    14-15     Used as work registers by the system.                  * 00019000
*                                                                     * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*    Some callers depend on register contents remaining the same      * 00019400
*    before and after issuing a service.  If the system changes the   * 00019500
*    contents of registers on which the caller depends, the caller    * 00019600
*    must save them before issuing the service, and restore them      * 00019700
*    after the system returns control.                                * 00019800
*                                                                     * 00019900
*01* PERFORMANCE IMPLICATIONS:                                        * 00020000
*                                                                     * 00020100
*    None                                                             * 00020200
*                                                                     * 00020300
*01* SYNTAX:                                                          * 00020400
*                                                                     * 00020500
*Ýxlabel¨  IWMMNTFY  ÐÝ TRAXFRPT=NO¨                                  * 00020600
*                    ¿Ý,TRAXFRPT=YES                                  * 00020700
*                          ,SYSEVPL=xsysevpl¨                         * 00020800
*                      ,MONTKN=xmontkn                                * 00020900
*                    Ð ,COMPLETION=YES                                * 00021000
*                    ¿ ,COMPLETION=NO                                 * 00021100
*                    Ð ,DISASSOCIATE=YES                              * 00021200
*                    !    Ý,WORKREQ_STA                               * 00021300
*                    !                  =»xworkreq_sta!IWMEWLMARMSTAT * 00021400
*                    !                  USNONEº¨                      * 00021500
*                    ¿ ,DISASSOCIATE=NO                               * 00021600
*                     Ý,CONNTKN=»xconntkn!NO_CONNTKNº¨                * 00021700
*                     Ý,ENDTIME=»xendtime!CURRENTº¨                   * 00021800
*                     Ý,RETCODE=xretcode¨                             * 00021900
*                     Ý,RSNCODE=xrsncode¨                             * 00022000
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00022100
*                    ÐÝ,MF=S¨                                         * 00022200
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00022300
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00022400
*                                                                     * 00022500
*                                                                     * 00022600
*      Where:                                                         * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*      Ýxlabel¨                                                       * 00023000
*          is an optional symbol, starting in column 1, that is the   * 00023100
*          name on the IWMMNTFY macro invocation.  The name must      * 00023200
*          conform to the rules for an ordinary assembler language    * 00023300
*          symbol.                                                    * 00023400
*          DEFAULT: No name.                                          * 00023500
*                                                                     * 00023600
*                                                                     * 00023700
*                                                                     * 00023800
*                                                                     * 00023900
*      ÝTRAXFRPT=»NO!YESº¨                                            * 00024000
*          is an optional keyword input which indicated (prior to     * 00024100
*          z/OS R3) whether a SYSEVENT TRAXFRPT should be issued when * 00024200
*          the system was in compatibility mode. This has become      * 00024300
*          irrelevant, but for compatibility reasons, TRAXFRPT can    * 00024400
*          still be set but has no effect.                            * 00024500
*          DEFAULT: NO                                                * 00024600
*                                                                     * 00024700
*                                                                     * 00024800
*          ÝTRAXFRPT=NO¨                                              * 00024900
*                                                                     * 00025000
*              indicates that no SYSEVENT TRAXFRPT should be issued.  * 00025100
*                                                                     * 00025200
*          ÝTRAXFRPT=YES                                              * 00025300
*                                                                     * 00025400
*              indicates (prior to z/OS R3) whether a SYSEVENT        * 00025500
*              TRAXFRPT should be issued when the system was in       * 00025600
*              compatibility mode. This has become irrelevant, but    * 00025700
*              for compatibility reasons, TRAXFRPT=YES can still be   * 00025800
*              set but has no effect.                                 * 00025900
*                                                                     * 00026000
*                                                                     * 00026100
*              SYSEVPL=xsysevpl¨                                      * 00026200
*                  is the name (RS-type), or address in register      * 00026300
*                  (2)-(12), of a required 40 character input which   * 00026400
*                  is the fully initialized SYSEVENT parameter list,  * 00026500
*                  as mapped by IHATRBPL.                             * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*                                                                     * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*      MONTKN=xmontkn                                                 * 00027500
*          is the name (RS-type), or address in register (2)-(12), of * 00027600
*          a required 32 bit input which contains the delay           * 00027700
*          monitoring token                                           * 00027800
*                                                                     * 00027900
*                                                                     * 00028000
*                                                                     * 00028100
*                                                                     * 00028200
*      COMPLETION=»YES!NOº                                            * 00028300
*          is a required keyword input which indicates whether the    * 00028400
*          (or possibly one of several) major execution phase(s)      * 00028500
*          is(are) now complete.                                      * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*          COMPLETION=YES                                             * 00028900
*              indicates that execution for an entire phase of        * 00029000
*              processing has now completed.  Typically Iwmmntfy      * 00029100
*              Completion(Yes) would be issued as a result of the     * 00029200
*              completion of the transaction program for the work     * 00029300
*              request. When a work request is comprised of several   * 00029400
*              (typically cascaded) transaction programs, each would  * 00029500
*              correspond to an invocation of Iwmmntfy                * 00029600
*              Completion(Yes).                                       * 00029700
*                                                                     * 00029800
*              The execution time, as given by the difference between * 00029900
*              the Iwmmntfy ENDTIME value and the Execution start     * 00030000
*              time (established via IWM4MINI), will be added to the  * 00030100
*              running total execution time for the service class.    * 00030200
*              There may still be "output" processing left to perform * 00030300
*              for the work request, which time would be accounted    * 00030400
*              for via Iwmrpt.  There may also be operations          * 00030500
*              corresponding to hardening of the database data        * 00030600
*              outside the scope of Notify.                           * 00030700
*                                                                     * 00030800
*          COMPLETION=NO                                              * 00030900
*              indicates that this invocation of Notify does not      * 00031000
*              correspond to the completion of an entire execution    * 00031100
*              segment. Instead this invocation of Notify corresponds * 00031200
*              to the portion of the work request represented by the  * 00031300
*              monitoring environment.  For example, use              * 00031400
*              Completion(No) when this portion of processing behaves * 00031500
*              like a subroutine in the execution phase, which is     * 00031600
*              therefore a subset of the execution time passed in     * 00031700
*              another Notify.                                        * 00031800
*                                                                     * 00031900
*              The execution time, as given by the difference between * 00032000
*              the Iwmmntfy ENDTIME value and the Execution start     * 00032100
*              time (established via IWM4MINI), will be treated       * 00032200
*              separately from that passed for Completion(Yes), since * 00032300
*              otherwise there would be double-counting.              * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*                                                                     * 00032700
*                                                                     * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*      DISASSOCIATE=»YES!NOº                                          * 00033100
*          is a required keyword input which indicates whether the    * 00033200
*          work request should be disassociated from the monitoring   * 00033300
*          environment or not.                                        * 00033400
*                                                                     * 00033500
*                                                                     * 00033600
*          DISASSOCIATE=YES                                           * 00033700
*              indicates that the work request should be              * 00033800
*              disassociated from the monitoring environment.         * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*              ÝWORKREQ_STA=»xworkreq_sta!IWMEWLMARMSTATUSNONEº¨      * 00034200
*                  is the name (RS-type), or address in register      * 00034300
*                  (2)-(12), of an optional fullword input which      * 00034400
*                  contains the completion status code of the work    * 00034500
*                  request.  Available completion status codes        * 00034600
*                  (defined in macro IWMYCON) are:                    * 00034700
*                  * IwmEwlmArmStatusGood(0),                         * 00034800
*                  * IwmEwlmArmStatusAborted(1),                      * 00034900
*                  * IwmEwlmArmStatusFailed(2) or                     * 00035000
*                  * IwmEwlmArmStatusUnknown(3)                       * 00035100
*                  The codes above correspond to status codes in the  * 00035200
*                  OpenGroup ARM 4.0 Standard (for the meaning of the * 00035300
*                  status codes see the ARM 4.0 Standard at           * 00035400
*                  http://www.opengroup.org/management/arm).          * 00035500
*                                                                     * 00035600
*                  DEFAULT: IWMEWLMARMSTATUSNONE                      * 00035700
*                  indicates that the COMPLETION parameter value and  * 00035800
*                  internal information in the Monitoring Environment * 00035900
*                  will be examined to determine the status of the    * 00036000
*                  work request. If COMPLETION=YES is specified and   * 00036100
*                  no abnormal event was recorded for the monitoring  * 00036200
*                  environment via the IWMMABNL service, the          * 00036300
*                  completion status IwmEwlmArmStatusGood will be     * 00036400
*                  reported to EWLM. If an abnormal event was         * 00036500
*                  reported via IWMMABNL or COMPLETION=NO was         * 00036600
*                  specified, the completion status                   * 00036700
*                  IwmEwlmArmStatusFailed will be reported to EWLM.   * 00036800
*                                                                     * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*          DISASSOCIATE=NO                                            * 00037200
*              indicates that the work request should not be          * 00037300
*              disassociated from the monitoring environment.         * 00037400
*                                                                     * 00037500
*                                                                     * 00037600
*                                                                     * 00037700
*                                                                     * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*      ÝCONNTKN=»xconntkn!NO_CONNTKNº¨                                * 00038100
*          is the name (RS-type), or address in register (2)-(12), of * 00038200
*          an optional 32 bit input which is returned by IWM4CON.     * 00038300
*          DEFAULT: NO_CONNTKN indicates that no connect token is     * 00038400
*          passed.                                                    * 00038500
*                                                                     * 00038600
*                                                                     * 00038700
*                                                                     * 00038800
*                                                                     * 00038900
*      ÝENDTIME=»xendtime!CURRENTº¨                                   * 00039000
*          is the name (RS-type), or address in register (2)-(12), of * 00039100
*          an optional 64 bit input which specifies the ending        * 00039200
*          execution time for the transaction in STCK format.         * 00039300
*          DEFAULT: CURRENT indicates that the current time should be * 00039400
*          used.                                                      * 00039500
*                                                                     * 00039600
*                                                                     * 00039700
*                                                                     * 00039800
*                                                                     * 00039900
*      ÝRETCODE=xretcode¨                                             * 00040000
*          is the name (RS-type) of an optional fullword output       * 00040100
*          variable, or register (2)-(12) or (15), into which the     * 00040200
*          return code is to be copied from GPR 15.  If you specify   * 00040300
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00040400
*          the value will be left in GPR 15.                          * 00040500
*                                                                     * 00040600
*                                                                     * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*      ÝRSNCODE=xrsncode¨                                             * 00041000
*          is the name (RS-type) of an optional fullword output       * 00041100
*          variable into which the reason code is to be copied from   * 00041200
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00041300
*          R0 (within or without parentheses), the value will be left * 00041400
*          in GPR 0.                                                  * 00041500
*                                                                     * 00041600
*                                                                     * 00041700
*                                                                     * 00041800
*                                                                     * 00041900
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00042000
*          is an optional byte input decimal value in the "0-1" range * 00042100
*          that specifies the macro version.  PLISTVER is the only    * 00042200
*          key allowed on the list form of MF and determines which    * 00042300
*          parameter list is generated.  The macro keys associated    * 00042400
*          with each supported version of the macro are listed in     * 00042500
*          MACRO USAGE NOTE 2.  Note that MAX may be specified        * 00042600
*          instead of a number, and the parameter list will be of the * 00042700
*          largest size currently supported. This size may grow from  * 00042800
*          release to release (thus possibly affecting the amount of  * 00042900
*          storage needed by your program).  If your program can      * 00043000
*          tolerate this, IBM recommends that you always specify MAX  * 00043100
*          when creating the list form parameter list as that will    * 00043200
*          ensure that the list form parameter list is always long    * 00043300
*          enough to hold whatever parameters might be specified on   * 00043400
*          the execute form.                                          * 00043500
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00043600
*          default is the lowest version which allows all of the      * 00043700
*          parameters specified on the invocation to be processed.    * 00043800
*                                                                     * 00043900
*                                                                     * 00044000
*                                                                     * 00044100
*                                                                     * 00044200
*      ÝMF=»S!L!Eº¨                                                   * 00044300
*          is an optional keyword input which specifies the macro     * 00044400
*          form.                                                      * 00044500
*          DEFAULT: S                                                 * 00044600
*                                                                     * 00044700
*                                                                     * 00044800
*          ÝMF=S¨                                                     * 00044900
*              specifies the standard form of the macro.  The "S"     * 00045000
*              form generates code to put the parameters into an      * 00045100
*              in-line parameter list and invoke the desired service. * 00045200
*              Full checking for required macro keys is done along    * 00045300
*              with supplying defaults for omitted optional           * 00045400
*              parameters.                                            * 00045500
*                                                                     * 00045600
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00045700
*              specifies the list form of the macro.  The "L" form    * 00045800
*              defines an area to be used for the parameter list.     * 00045900
*              Only the PLISTVER key may be specified on the          * 00046000
*              invocation.  All other macro parameters are flagged as * 00046100
*              errors.  If PLISTVER is not specified, the original    * 00046200
*              parameter list definition is used.                     * 00046300
*                                                                     * 00046400
*            ,xmfctrl                                                 * 00046500
*              is a required input.  It is the name of a storage area * 00046600
*              for the parameter list.                                * 00046700
*                                                                     * 00046800
*            »,xmfattr!0Dº                                            * 00046900
*              is an optional 60 character input string that varies   * 00047000
*              from 1 to 60 characters. Use it to force boundary      * 00047100
*              alignment of the parameter list. Use only 0F or 0D.    * 00047200
*              DEFAULT: 0D which forces the parameter list to a       * 00047300
*              doubleword boundary.                                   * 00047400
*                                                                     * 00047500
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00047600
*              specifies the execute form of the macro.  The "E" form * 00047700
*              generates code to put the parameters into the          * 00047800
*              parameter list specified by xmfctrl and provides full  * 00047900
*              syntax checking with default setting.                  * 00048000
*                                                                     * 00048100
*            ,xmfctrl                                                 * 00048200
*              is a required input.  It is the name (RS-type), or     * 00048300
*              address in register (1)-(12), of a storage area for    * 00048400
*              the parameter list.                                    * 00048500
*                                                                     * 00048600
*            »,COMPLETEº                                              * 00048700
*              is an optional keyword input which specifies the       * 00048800
*              degree of macro parameter syntax checking.             * 00048900
*              DEFAULT: COMPLETE                                      * 00049000
*                                                                     * 00049100
*                                                                     * 00049200
*              COMPLETE                                               * 00049300
*                  Checking for required macro keys is done and       * 00049400
*                  defaults are supplied for omitted optional         * 00049500
*                  parameters.                                        * 00049600
*                                                                     * 00049700
*                                                                     * 00049800
*                                                                     * 00049900
*                                                                     * 00050000
*                                                                     * 00050100
*                                                                     * 00050200
*                                                                     * 00050300
*01* ABEND CODES:  None.                                              * 00050400
*                                                                     * 00050500
*01* RETURN CODES:                                                    * 00050600
*                                                                     * 00050700
*                                                                     * 00050800
*            0    Name: IwmRetCodeOk                                  * 00050900
*                                                                     * 00051000
*                 Meaning: Successful completion.                     * 00051100
*                                                                     * 00051200
*                 Action: None required.                              * 00051300
*                                                                     * 00051400
*            4    Name: IwmRetCodeWarning                             * 00051500
*                                                                     * 00051600
*                 Meaning: Successful completion, unusual conditions  * 00051700
*                 noted.                                              * 00051800
*                                                                     * 00051900
*                                                                     * 00052000
*                 HEX REASON  MEANING/ACTION                          * 00052100
*                 CODE                                                * 00052200
*                                                                     * 00052300
*                 xxxx0401    Name: IwmRsnCodeNoWLM                   * 00052400
*                                                                     * 00052500
*                             Meaning:  System does not support delay * 00052600
*                             monitoring services.  This return code  * 00052700
*                             is only set when the MVS release is     * 00052800
*                             prior to MVS/ESA SP5.1.0.               * 00052900
*                                                                     * 00053000
*                             Action: None required.                  * 00053100
*                                                                     * 00053200
*                 xxxx0404    Name: IwmRsnCodeCompatNoSyseventRqd     * 00053300
*                                                                     * 00053400
*                             Meaning: Reserved                       * 00053500
*                                                                     * 00053600
*                 xxxx0405    Name: IwmRsnCodeGoalNoMonEnv            * 00053700
*                                                                     * 00053800
*                             Meaning:  System is in goal mode but    * 00053900
*                             the input monitoring token indicates no * 00054000
*                             monitoring environment was established, * 00054100
*                             hence MVS did not receive the           * 00054200
*                             information.                            * 00054300
*                                                                     * 00054400
*                             Action: None required.                  * 00054500
*                                                                     * 00054600
*                                                                     * 00054700
*                                                                     * 00054800
*            8    Name: IwmRetCodeInvocError                          * 00054900
*                                                                     * 00055000
*                 Meaning: Invalid invocation environment or          * 00055100
*                 parameters.                                         * 00055200
*                                                                     * 00055300
*                                                                     * 00055400
*                 HEX REASON  MEANING/ACTION                          * 00055500
*                 CODE                                                * 00055600
*                                                                     * 00055700
*                 xxxx080C    Name: IwmRsnCodeMonEnvLacksData         * 00055800
*                                                                     * 00055900
*                             Meaning:  Input monitoring environment  * 00056000
*                             does not contain the necessary          * 00056100
*                             information.                            * 00056200
*                                                                     * 00056300
*                             Action: Ensure that the monitoring      * 00056400
*                             environment was established with the    * 00056500
*                             necessary information.                  * 00056600
*                                                                     * 00056700
*                 xxxx080F    Name: IwmRsnCodeNoUserKeyNtfy           * 00056800
*                                                                     * 00056900
*                             Meaning:  User key routine not allowed  * 00057000
*                             to issue Notify.                        * 00057100
*                                                                     * 00057200
*                             Action: Avoid requesting this function  * 00057300
*                             in user key.                            * 00057400
*                                                                     * 00057500
*                 xxxx0820    Name: IwmRsnCodeBadMonEnv               * 00057600
*                                                                     * 00057700
*                             Meaning:  Input monitoring environment  * 00057800
*                             does not pass short form validity       * 00057900
*                             checking.                               * 00058000
*                                                                     * 00058100
*                             Action: Check for possible storage      * 00058200
*                             overlay.                                * 00058300
*                                                                     * 00058400
*                 xxxx0821    Name: IwmRsnCodeBadConn                 * 00058500
*                                                                     * 00058600
*                             Meaning:  Input connect token does not  * 00058700
*                             pass validity checking.                 * 00058800
*                                                                     * 00058900
*                             Action: Check for possible storage      * 00059000
*                             overlay.                                * 00059100
*                                                                     * 00059200
*                 xxxx082D    Name: IwmRsnCodeExStTimeGTEndTime       * 00059300
*                                                                     * 00059400
*                             Meaning:  Input execution start time    * 00059500
*                             later than end time.                    * 00059600
*                                                                     * 00059700
*                             Action: Check for possible storage      * 00059800
*                             overlay of the parameter list or        * 00059900
*                             variable.                               * 00060000
*                                                                     * 00060100
*                 xxxx0840    Name: IwmRsnCodeServiceNotEnabled       * 00060200
*                                                                     * 00060300
*                             Meaning:  Caller's space connection is  * 00060400
*                             not enabled for this service.           * 00060500
*                                                                     * 00060600
*                             Action: Avoid requesting this function  * 00060700
*                             under the input connection.  IWM4CON    * 00060800
*                             options must be specified previously to * 00060900
*                             enable this service.                    * 00061000
*                                                                     * 00061100
*                 xxxx087E    Name: IwmRsnCodeRoMonEnv                * 00061200
*                                                                     * 00061300
*                             Meaning:  Input monitoring environment  * 00061400
*                             is Report-Only.                         * 00061500
*                                                                     * 00061600
*                             Action: Avoid requesting this function  * 00061700
*                             for Report-Only PBs.                    * 00061800
*                                                                     * 00061900
*                 xxxx0895    Name: IwmRsnCodeEWLMServNotEnabled      * 00062000
*                                                                     * 00062100
*                             Meaning: Service is not enabled because * 00062200
*                             monitoring environment can not be       * 00062300
*                             associated with EWLM work requests.     * 00062400
*                                                                     * 00062500
*                             Action: Specify the parameter           * 00062600
*                             WORKREQ_STA only when the monitoring    * 00062700
*                             environment is created with IWMMCREA    * 00062800
*                             EWLM=YES or the address space is        * 00062900
*                             connected with IWMCONN EWLM=YES and the * 00063000
*                             connect token is passed to IWMMCREA     * 00063100
*                             when creating the monitoring            * 00063200
*                             environment.                            * 00063300
*                                                                     * 00063400
*                 xxxx0897    Name: IwmRsnCodeTranStatusInvalid       * 00063500
*                                                                     * 00063600
*                             Meaning: Passed work request completion * 00063700
*                             status is not valid.                    * 00063800
*                                                                     * 00063900
*                             Action: Check the EWLM ARM interface    * 00064000
*                             specification for valid completion      * 00064100
*                             status values.                          * 00064200
*                                                                     * 00064300
*                                                                     * 00064400
*                                                                     * 00064500
*            C    Name: IwmRetCodeEnvError                            * 00064600
*                                                                     * 00064700
*                 Meaning: Environmental error.                       * 00064800
*                                                                     * 00064900
*                                                                     * 00065000
*                 HEX REASON  MEANING/ACTION                          * 00065100
*                 CODE                                                * 00065200
*                                                                     * 00065300
*                 xxxx0C02    Name: IwmRsnCodeReportingSusp           * 00065400
*                                                                     * 00065500
*                             Meaning: Reserved SYSEVENT TRAXFRPT     * 00065600
*                             invoked, but reporting is temporarily   * 00065700
*                             suspended for one of the following      * 00065800
*                             reasons:                                * 00065900
*                                                                     * 00066000
*                                                                     * 00066100
*                             o   RMF workload activity reporting is  * 00066200
*                                 not active                          * 00066300
*                                                                     * 00066400
*                             o   There is no installation control    * 00066500
*                                 specification (IEAICSxx parmlib     * 00066600
*                                 member with RPGN specified for some * 00066700
*                                 subsystem other than TSO) in        * 00066800
*                                 effect. No data reported but a      * 00066900
*                                 later reissue could be successful.  * 00067000
*                                                                     * 00067100
*                                                                     * 00067200
*                                                                     * 00067300
*                             Action: Invoke the function when the    * 00067400
*                             conditions are alleviated.              * 00067500
*                                                                     * 00067600
*                 xxxx0C03    Name: IwmRsnCodeSyseventNoWorkElt       * 00067700
*                                                                     * 00067800
*                             Meaning:  SYSEVENT TRAXFRPT invoked,    * 00067900
*                             but no work element was available to    * 00068000
*                             save the input information.             * 00068100
*                                                                     * 00068200
*                             Action: Invoke the function when the    * 00068300
*                             conditions are alleviated.  This        * 00068400
*                             condition may be due to a common        * 00068500
*                             storage shortage condition.             * 00068600
*                                                                     * 00068700
*                 xxxx0C04    Name: IwmRsnCodeNtfyNoWorkElt           * 00068800
*                                                                     * 00068900
*                             Meaning:  Notify routine invoked, but   * 00069000
*                             no work element was available to save   * 00069100
*                             the input information.                  * 00069200
*                                                                     * 00069300
*                             Action: Invoke the function when the    * 00069400
*                             conditions are alleviated.  This        * 00069500
*                             condition may be due to a common        * 00069600
*                             storage shortage condition.             * 00069700
*                                                                     * 00069800
*                 xxxx0C06    Name: IwmRsnCodeNoEndTime               * 00069900
*                                                                     * 00070000
*                             Meaning:  No end time was supplied to   * 00070100
*                             the service and STCK gave a non-zero    * 00070200
*                             condition code.                         * 00070300
*                                                                     * 00070400
*                             Action: No action required.             * 00070500
*                                                                     * 00070600
*                                                                     * 00070700
*                                                                     * 00070800
*                                                                     * 00070900
*                                                                     * 00071000
*                                                                     * 00071100
*01* REASON CODES:                                                    * 00071200
*                                                                     * 00071300
*       A unique reason code will be returned whenever the return     * 00071400
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00071500
*       under their corresponding return code.  Reason code and       * 00071600
*       return code constants are defined within IWMYCON.  Note that  * 00071700
*       the high order halfword of register 0, and the reason code    * 00071800
*       variable when specified, may be non-zero and represents       * 00071900
*       diagnostic data which is NOT part of the external interface.  * 00072000
*       The high order halfword should thus be excluded from          * 00072100
*       comparison with the reason code values described above.  The  * 00072200
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00072300
*       used for this purpose.                                        * 00072400
*                                                                     * 00072500
*01* MODULE TYPE:  ASSEM MACRO                                        * 00072600
*                                                                     * 00072700
*02*   PROCESSOR:  ASSEM                                              * 00072800
*                                                                     * 00072900
*01* COMPONENT:  SCWLM                                                * 00073000
*                                                                     * 00073100
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00073200
*                                                                     * 00073300
*01* EXAMPLES:                                                        * 00073400
*                                                                     * 00073500
*01* MACRO USAGE NOTES:                                               * 00073600
*                                                                     * 00073700
*                                                                     * 00073800
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00073900
*        global macro variable.  Any value other than 'NO' will       * 00074000
*        result in the macro expansion being printed.  The default is * 00074100
*        'YES'.  The following examples illustrate how the ZPRINT     * 00074200
*        variable should be set.                                      * 00074300
*                                                                     * 00074400
*                    GBLC &ZPRINT                                     * 00074500
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00074600
*                                                                     * 00074700
*                                                                     * 00074800
*    2.  The IWMMNTFY macro supports multiple versions. The macro key * 00074900
*        list  below  contains the version level in which the key was * 00075000
*        first  introduced.  Positionals  are  identified by the word * 00075100
*        'Positional'  followed by the numeric value of its position. * 00075200
*        Nested  positionals  are  preceded  by their outer key.  The * 00075300
*        lowest value represents the original version and the highest * 00075400
*        value  represents  the  most  recent version of the IWMMNTFY * 00075500
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00075600
*        least  as high as the highest version number of all the keys * 00075700
*        being used.                                                  * 00075800
*                                                                     * 00075900
*        VERSION   KEY                                                * 00076000
*                                                                     * 00076100
*              0      COMPLETION                                      * 00076200
*                     CONNTKN                                         * 00076300
*                     DISASSOCIATE                                    * 00076400
*                     ENDTIME                                         * 00076500
*                     MONTKN                                          * 00076600
*                     SYSEVPL                                         * 00076700
*                     TRAXFRPT                                        * 00076800
*              1      WORKREQ_STA                                     * 00076900
*                                                                     * 00077000
*                                                                     * 00077100
*                                                                     * 00077200
*01* CHANGE ACTIVITY:                                                 * 00077300
*                                                                     * 00077400
*   Flag LineItem  FMID    Date   ID    Comment                       * 00077500
*                                                                     * 00077600
*    $L0=WLMI     HBB5510 920309 PD16:  Workload Manager I            * 00077700
*    $L1=WLMP     HBB6603 950313 PDRK:  Added new reason code -       * 00077800
*                                         IwmRsnCodeServiceNotEnabled * 00077900
*    $L2=WLMPPBS  HBB7707 011030 3241PB:  Peter Baeuerle              * 00078000
*                                         For Report-Only Monitor     * 00078100
*                                         Environment:  New reason    * 00078200
*                                         code IwmRsnCodeRoMonEnv     * 00078300
*    $L3=PYN0364  HBB7708 020813 3241JK:  Juergen Kuhn                * 00078400
*                                         Parameter TRAXFRPT will not * 00078500
*                                         be required anymore         * 00078600
*    $P1=ME01176  HBB7720 040924 3241DW:  Doc changes only.  Service  * 00078700
*                                         names changed to reflect    * 00078800
*                                         the 64bit name.             * 00078900
*    $P2=WLMPERS  HBB7730 041202 3241SW:  EWLM CICS/IMS support       * 00079000
*    $P3=BLDCHKE  HBB7730 050919 3241BH:  No code change. ToolReq     * 00079100
*                                         5983 -                      * 00079200
*                                         B390.HBB7730.DRIVER5A.OC    * 00079300
*                                         OCHKE fixes.                * 00079400
*    $P4=ME04796  HBB7730 051019 3241MB:  WORKREQ_STA default value   * 00079500
*                                         will be set to              * 00079600
*                                         IwmEwlmArmStatusNone (-1),  * 00079700
*                                         if no parameter is passed.  * 00079800
*                                         The address of WORKREQ_STA  * 00079900
*                                         will be passed on the       * 00080000
*                                         parameter list.             * 00080100
*    $L4=LPBABV   HBB7790 111020 3241AH:  IWM4MNTF created. Please do * 00080200
*                                         not change this macro any   * 00080300
*                                         longer.                     * 00080400
****** END OF SPECIFICATIONS *****************************************/ 00080500
*/********************************************************************* 00080600
         MACRO                                                          00080700
&XLABEL  IWMMNTFY &TRAXFRPT=,&SYSEVPL=,&MONTKN=,&COMPLETION=,          *00080800
               &DISASSOCIATE=,&WORKREQ_STA=,&CONNTKN=,&ENDTIME=,       *00080900
               &RETCODE=,&RSNCODE=,&PLISTVER=,&MF=                      00081000
.*                                                                      00081100
*                  MACDATE -01/29/13-<1>                                00081200
.*                                                                      00081300
.*******************************************************************    00081400
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00081500
.*******************************************************************    00081600
                  GBLC  &ZPRINT     YES=PRINT NO=NO PRINT               00081700
                  GBLC  &ZTEST      YES=TEST NO=NO TEST                 00081800
                  GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX         00081900
.*                                                                      00082000
                  GBLC  &ZIWMMNTFY  YES=MACRO USED AT LEAST ONCE        00082100
.*******************************************************************    00082200
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00082300
.*******************************************************************    00082400
                  LCLC  &ZMS        ERROR MESSAGE WORK AREA             00082500
                  LCLC  &ZCNDX      SYSNDX CHARACTERS                   00082600
                  LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED          00082700
                  LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR         00082800
                  LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE         00082900
                  LCLA  &ZAWRK      USED AS A WORK AREA                 00083000
                  LCLA  &ZASIZ      USED FOR SIZE OF VALUE              00083100
                  LCLA  &ZN         NUMERIC WORK VARIABLE               00083200
                  LCLC  &ZC         CHARACTER WORK VARIABLE             00083300
                  LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE         00083400
                  LCLA  &ZTLA       VALUE TOO LONG VARIABLE             00083500
                  LCLC  &ZMAC_G     "G" or null                         00083600
&ZMAC_G           SETC  ''                                              00083700
                  LCLC  &ZMAC_LR                                        00083800
&ZMAC_LR          SETC  'LR'                                            00083900
                  LCLC  &ZMAC_L                                         00084000
&ZMAC_L           SETC  'L'                                             00084100
                  LCLC  &ZMAC_ST                                        00084200
&ZMAC_ST          SETC  'ST'                                            00084300
                  LCLC  &ZMAC_LLGT                                      00084400
&ZMAC_LLGT        SETC  'L'                                             00084500
                  LCLC  &ZMAC_LGR                                       00084600
&ZMAC_LGR         SETC  'LR'                                            00084700
                  LCLC  &ZMAC_LG                                        00084800
&ZMAC_LG          SETC  'L'                                             00084900
                  LCLC  &ZMAC_STG                                       00085000
&ZMAC_STG         SETC  'ST'                                            00085100
                  LCLA  &ZMACRET    MACRO RETURN CODE                   00085200
&ZMACRET          SETA  0           ASSUME NO ERRORS                    00085300
.*                                                                      00085400
                  LCLC  &ZCSYSLIST(255)         NONXKEY, POS ARRAY      00085500
                  LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()          00085600
                  LCLA  &ZPLLEN     PARAMETER LIST LENGTH               00085700
                  LCLC  &ZENDBASEPL             End of base PL          00085800
                  LCLA  &ZPLWORKA   PARAMETER LIST LENGTH               00085900
.*******************************************************************    00086000
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00086100
.*******************************************************************    00086200
                  LCLA  &ZI         INDEX FOR ARRAY                     00086300
                  LCLA  &ZJ         INDEX FOR PARMS                     00086400
                  LCLA  &ZK         INDEX FOR PARSE                     00086500
                  LCLA  &ZLO        LOW RANGE VALUE                     00086600
                  LCLA  &ZHI        HIGH RANGE VALUE                    00086700
                  LCLC  &ZW         WORK AREA FOR PARM                  00086800
.********************************************************************   00086900
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00087000
.********************************************************************   00087100
                  GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL             00087200
                  GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE      00087300
                  GBLA  &SYSALVL    SYSSTATE ARCHLVL                    00087400
                  GBLC  &SYSAM64    SYSSTATE AMODE64                    00087500
.*                                                                      00087600
                  AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED      00087700
                  AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED       00087800
                  SPLEVEL  TEST                                         00087900
.ZSYS2            ANOP  ,                                               00088000
                  AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1           00088100
                  AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1           00088200
                  SYSSTATE TEST                                         00088300
                  AGO   .ZSYS4                                          00088400
.ZSYS3            ANOP  ,                                               00088500
&SYSASCE          SETC  'P'         ASSUME SYSSTATE PRIMARY             00088600
.ZSYS4            ANOP  ,                                               00088700
                  AIF   ('&SYSAM64' NE 'YES').ZSYSN64                   00088800
&ZMAC_LLGT        SETC 'LLGT'                                           00088900
&ZMAC_LGR         SETC 'LGR'                                            00089000
&ZMAC_LG          SETC 'LG'                                             00089100
&ZMAC_STG         SETC 'STG'                                            00089200
.ZSYSN64          ANOP  ,                                               00089300
.*******************************************************************    00089400
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00089500
.*******************************************************************    00089600
                  LCLC  &XTRAXFRPT  ++ VALUE                            00089700
                  LCLC  &XSYSEVPL   ++ NAME                             00089800
                  LCLC  &XMONTKN    ++ NAME                             00089900
                  LCLC  &XCOMPLETION            ++ VALUE                00090000
                  LCLC  &XDISASSOCIATE          ++ VALUE                00090100
                  LCLC  &XWORKREQ_STA           ++ NAME                 00090200
                  LCLC  &XCONNTKN   ++ NAME                             00090300
                  LCLC  &XENDTIME   ++ NAME                             00090400
                  LCLC  &XRETCODE   ++ NAME                             00090500
                  LCLC  &XRSNCODE   ++ NAME                             00090600
                  LCLA  &XPLISTVER  ++ VALUE                            00090700
                  LCLC  &XMF        ++ VALUE                            00090800
                  LCLC  &XMFCTRL    ++ NAME                             00090900
                  LCLC  &XMFATTR    ++ VALUE                            00091000
                  LCLC  &XMFSCK     ++ VALUE                            00091100
.*******************************************************************    00091200
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00091300
.*******************************************************************    00091400
                  LCLC  &ZXTRAXFRPT             ++ INPUT VALUE          00091500
                  LCLC  &ZXSYSEVPL  ++ INPUT NAME                       00091600
                  LCLC  &ZXMONTKN   ++ INPUT NAME                       00091700
                  LCLC  &ZXCOMPLETION           ++ INPUT VALUE          00091800
                  LCLC  &ZXDISASSOCIATE         ++ INPUT VALUE          00091900
                  LCLC  &ZXWORKREQ_STA          ++ INPUT NAME           00092000
                  LCLC  &ZXCONNTKN  ++ INPUT NAME                       00092100
                  LCLC  &ZXENDTIME  ++ INPUT NAME                       00092200
                  LCLC  &ZXRETCODE  ++ OUTPUT NAME                      00092300
                  LCLC  &ZXRSNCODE  ++ OUTPUT NAME                      00092400
                  LCLC  &ZXPLISTVER             ++ INPUT VALUE          00092500
                  LCLC  &ZXMF       ++ INPUT VALUE                      00092600
                  LCLC  &ZXMFCTRL   ++ INPUT NAME                       00092700
                  LCLC  &ZXMFATTR   ++ INPUT VALUE                      00092800
                  LCLC  &ZXMFSCK    ++ INPUT VALUE                      00092900
.********************************************************************   00093000
.***AC.PLV01  PROCESS PLISTVER                                      *   00093100
.********************************************************************   00093200
&XPLISTVER      SETA  0                                                 00093300
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00093400
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00093500
&XPLISTVER      SETA  1                                                 00093600
.ZPLV0          ANOP  ,                                                 00093700
.*                                                                      00093800
                AIF   ('&WORKREQ_STA' EQ '').ZPLV1E                     00093900
                AIF   (&XPLISTVER GE 1).ZPLV1E                          00094000
&XPLISTVER      SETA  1                                                 00094100
.ZPLV1E         ANOP  ,                                                 00094200
.*                                                                      00094300
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00094400
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00094500
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00094600
.*-------------------------------------------------------------------   00094700
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00094800
&ZMS            SETC  '"PLISTVER='                                      00094900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00095000
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00095100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00095200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00095300
                AGO   .ZPVCK2                                           00095400
.ZPVCK3         ANOP  ,                                                 00095500
.*-------------------------------------------------------------------   00095600
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00095700
&ZMS            SETC  '"PLISTVER='                                      00095800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00095900
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00096000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00096100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00096200
                AGO   .ZPVCKE                                           00096300
.ZPVCK2         ANOP  ,                                                 00096400
.*-------------------------------------------------------------------   00096500
&ZCVAL          SETC  '&PLISTVER(1)'                                    00096600
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00096700
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00096800
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00096900
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00097000
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00097100
.ZPVCK6         ANOP  ,                                                 00097200
&ZMS            SETC  '"PLISTVER='                                      00097300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00097400
&ZMS            SETC  '&ZMS THE RANGE IS "0-1"'                         00097500
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00097600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00097700
&XPLISTVER      SETA  1                                                 00097800
                AGO   .ZPVCKE                                           00097900
.*-------------------------------------------------------------------   00098000
.ZPVCK4A        ANOP  ,                                                 00098100
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00098200
&ZMS            SETC  'PLISTVER='                                       00098300
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00098400
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00098500
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00098600
                MNOTE 8,' &ZMS IS REQUIRED.'                            00098700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00098800
                AGO   .ZPVCK5                                           00098900
.ZPVCK4         ANOP  ,                                                 00099000
&XPLISTVER      SETA  &PLISTVER(1)                                      00099100
.ZPVCK5         ANOP  ,                                                 00099200
.ZPVCKE         ANOP  ,                                                 00099300
.********************************************************************   00099400
.***AG.MF01 PROCESS MF MACRO FORMS                                      00099500
.********************************************************************   00099600
                  ACTR  10000                                           00099700
.*------------------------------------------------------------------    00099800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00099900
&XMF              SETC  ''          INITIALIZE XVARIABLE                00100000
.*-------------------------------------------------------------------   00100100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00100200
.ZG42             ANOP  ,                                               00100300
&ZTLC             SETC 'S'                                              00100400
                  AIF   ('&MF(1)' NE '&ZTLC').ZG43                      00100500
&XMF              SETC  'S'         SET KEYWORD                         00100600
                  AIF   (N'&MF LE 1).ZG42A      CK NUM                  00100700
&ZMS              SETC  '"MF='                                          00100800
&ZMS              SETC  '&ZMS.&MF"'                                     00100900
&ZMS              SETC  '&ZMS "MF"'                                     00101000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00101100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00101200
.ZG42A            ANOP  ,                                               00101300
.*-------------------------------------------------------------------   00101400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00101500
.ZG43             ANOP  ,                                               00101600
&ZTLC             SETC 'L'                                              00101700
                  AIF   ('&MF(1)' NE '&ZTLC').ZG50                      00101800
&XMF              SETC  'L'         SET KEYWORD                         00101900
                  AIF   (N'&MF LE 3).ZG43A      CK NUM                  00102000
&ZMS              SETC  '"MF='                                          00102100
&ZMS              SETC  '&ZMS.&MF"'                                     00102200
&ZMS              SETC  '&ZMS "MF"'                                     00102300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00102400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00102500
.ZG43A            ANOP  ,                                               00102600
.*-------------------------------------------------------------------   00102700
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00102800
                  AIF   (N'&SYSLIST NE 0).ZG43B  POSITIONALS?           00102900
                  AIF   ('&TRAXFRPT' NE '').ZG43B  KEYS?                00103000
                  AIF   ('&SYSEVPL' NE '').ZG43B  KEYS?                 00103100
                  AIF   ('&MONTKN' NE '').ZG43B  KEYS?                  00103200
                  AIF   ('&COMPLETION' NE '').ZG43B  KEYS?              00103300
                  AIF   ('&DISASSOCIATE' NE '').ZG43B  KEYS?            00103400
                  AIF   ('&WORKREQ_STA' NE '').ZG43B  KEYS?             00103500
                  AIF   ('&CONNTKN' NE '').ZG43B  KEYS?                 00103600
                  AIF   ('&ENDTIME' NE '').ZG43B  KEYS?                 00103700
                  AIF   ('&RETCODE' NE '').ZG43B  KEYS?                 00103800
                  AIF   ('&RSNCODE' NE '').ZG43B  KEYS?                 00103900
                  AGO    .ZG43C     INVOCATION OKAY                     00104000
.ZG43B            ANOP  ,                                               00104100
&ZMS              SETC  'THE "L" FORM OF "MF"'                          00104200
&ZMS              SETC  '&ZMS CAN ONLY HAVE'                            00104300
&ZMS              SETC  '&ZMS THE "PLISTVER" KEY'                       00104400
                  MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'          00104500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00104600
.ZG43C            ANOP  ,                                               00104700
.*-------------------------------------------------------------------   00104800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00104900
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00105000
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00105100
                  AIF   (N'&MF(2) GT 1).ZG45B   MULTI PARMS             00105200
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00105300
.ZG45B            AIF   (K'&MF(2) GT 0).ZG45C                           00105400
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00105500
&ZMS              SETC  'WHEN "L" IS SPECIFIED'                         00105600
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00105700
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00105800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00105900
.ZG45C            ANOP  ,                                               00106000
.*-------------------------------------------------------------------   00106100
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00106200
                  AIF   (K'&ZXMFCTRL LE 0).ZG45P  NOT I/O               00106300
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG45P                  00106400
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00106500
&ZMS              SETC  '"MF='                                          00106600
&ZMS              SETC  '&ZMS.&MF"'                                     00106700
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00106800
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'               00106900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00107000
.ZG45P            ANOP  ,                                               00107100
.*-------------------------------------------------------------------   00107200
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00107300
&ZXMFATTR         SETC  'INPUT'     SET IN/OUTPUT                       00107400
&XMFATTR          SETC  '0D'                                            00107500
                  AIF   (K'&MF(3) LE 0).ZG48B   PARM                    00107600
&XMFATTR          SETC  '&MF(3,1)'  SET XVARIABLE                       00107700
                  AIF   (N'&MF(3) GT 1).ZG48B   MULTI                   00107800
&XMFATTR          SETC  '&MF(3)'    SET XVARIABLE                       00107900
.ZG48B            ANOP  ,                                               00108000
.*-------------------------------------------------------------------   00108100
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00108200
                  AIF   (K'&ZXMFATTR LE 0).ZG48P  NOT I/O               00108300
                  AIF   ('&XMFATTR'(1,1) NE '(').ZG48P                  00108400
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00108500
&ZMS              SETC  '"MF='                                          00108600
&ZMS              SETC  '&ZMS.&MF"'                                     00108700
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00108800
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'               00108900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00109000
.ZG48P            ANOP  ,                                               00109100
.*-------------------------------------------------------------------   00109200
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00109300
                  AIF   (K'&ZXMFATTR LE 0).ZG48S  NOT I/O               00109400
                  AIF   (K'&XMFATTR LE 60).ZG48S  LNG OK                00109500
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00109600
&ZMS              SETC  '"MF='                                          00109700
&ZMS              SETC  '&ZMS.&MF"'                                     00109800
&ZMS              SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'           00109900
                  MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'              00110000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00110100
.ZG48S            ANOP  ,                                               00110200
.*-------------------------------------------------------------------   00110300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00110400
.ZG50             ANOP  ,                                               00110500
&ZTLC             SETC 'E'                                              00110600
                  AIF   ('&MF(1)' NE '&ZTLC').ZG58                      00110700
&XMF              SETC  'E'         SET KEYWORD                         00110800
                  AIF   (N'&MF LE 3).ZG50A      CK NUM                  00110900
&ZMS              SETC  '"MF='                                          00111000
&ZMS              SETC  '&ZMS.&MF"'                                     00111100
&ZMS              SETC  '&ZMS "MF"'                                     00111200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00111300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00111400
.ZG50A            ANOP  ,                                               00111500
.*-------------------------------------------------------------------   00111600
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00111700
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00111800
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00111900
                  AIF   (N'&MF(2) GT 1).ZG52B   MULTI PARMS             00112000
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00112100
.ZG52B            AIF   (K'&MF(2) GT 0).ZG52C                           00112200
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00112300
&ZMS              SETC  'WHEN "E" IS SPECIFIED'                         00112400
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00112500
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00112600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00112700
.ZG52C            ANOP  ,                                               00112800
.*-------------------------------------------------------------------   00112900
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00113000
                  AIF   (K'&ZXMFCTRL LE 0).ZG52R  NOT I/O               00113100
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG52R                  00113200
&ZCGPR            SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                      00113300
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG52P                    00113400
                  AIF   (K'&ZCGPR GT 2).ZG52Q                           00113500
                  AIF   ('&ZCGPR' EQ '0').ZG52Q                         00113600
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00113700
                  AIF   (T'&ZCGPR NE 'N').ZG52Q  INVALID REG NAME       00113800
.ZG52P            ANOP  ,                                               00113900
                  AIF   (T'&ZCGPR NE 'N').ZG52R  NON NUMERIC            00114000
                  AIF   ('&ZCGPR' LT '1').ZG52Q                         00114100
                  AIF   ('&ZCGPR' LE '12').ZG52R                        00114200
.ZG52Q            ANOP  ,                                               00114300
&ZMS              SETC  '"MF='                                          00114400
&ZMS              SETC  '&ZMS.&MF"'                                     00114500
&ZMS              SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'       00114600
                  MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                00114700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00114800
.ZG52R            ANOP  ,                                               00114900
.*-------------------------------------------------------------------   00115000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00115100
&XMFSCK           SETC  ''          INITIALIZE XVARIABLE                00115200
.ZG56A   AIF   ('&MF(3)' NE 'COMPLETE').ZG57A                           00115300
&XMFSCK           SETC  'COMPLETE'  SET KEYWORD                         00115400
.*-------------------------------------------------------------------   00115500
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00115600
.ZG57A            AIF   (K'&XMFSCK GT 0).ZG57C  KEYWORD                 00115700
                  AIF   (K'&MF(3) LE 0).ZG57B                           00115800
&ZMS              SETC  '"MF='                                          00115900
&ZMS              SETC  '&ZMS.&MF"'                                     00116000
&ZMS              SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '       00116100
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00116200
&ZMS              SETC  '&ZMS "COMPLETE".'                              00116300
                  MNOTE 8,' &ZMS '                                      00116400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00116500
.ZG57B            ANOP  ,                                               00116600
&XMFSCK           SETC  'COMPLETE'  SET DEFAULT KEYWORD                 00116700
.ZG57C            ANOP  ,                                               00116800
&ZXMFSCK          SETC  'INPUT'     SET IN/OUTPUT                       00116900
.*------------------------------------------------------------------    00117000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00117100
.ZG58             ANOP  ,                                               00117200
&ZXMF             SETC  'INPUT'     SET IN/OUTPUT                       00117300
                  AIF   (K'&XMF GT 0).ZG58E     VALID ARG               00117400
                  AIF   (T'&MF EQ 'O').ZG58D    OMITTED                 00117500
&ZASYSLNDX        SETA  0                                               00117600
.ZG58A            ANOP  ,           POSITIONAL MACRO KEY                00117700
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00117800
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG58C                00117900
&ZTLC             SETC 'MF'                                             00118000
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG58A       00118100
.ZG58B            ANOP  ,                                               00118200
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00118300
&ZMS              SETC  'THE "MF" KEY'                                  00118400
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00118500
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00118600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00118700
                  AGO   .ZG58E                                          00118800
.ZG58C            ANOP  ,                                               00118900
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00119000
&ZMS              SETC  '"MF='                                          00119100
&ZMS              SETC  '&ZMS.&MF"'                                     00119200
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00119300
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00119400
&ZMS              SETC  '&ZMS "S",'                                     00119500
&ZMS              SETC  '&ZMS "L",'                                     00119600
&ZMS              SETC  '&ZMS OR "E".'                                  00119700
                  MNOTE 8,' &ZMS '                                      00119800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00119900
                  AGO   .ZG58E                                          00120000
.ZG58D            ANOP  ,                                               00120100
&XMF              SETC  'S'         SET DEFAULT KEYWORD                 00120200
&XMFSCK           SETC  'COMPLETE'  COMPLETE CHECKING                   00120300
.ZG58E            ANOP  ,                                               00120400
.********************************************************************   00120500
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00120600
.********************************************************************   00120700
                  ACTR  10000                                           00120800
.*-------------------------------------------------------------------   00120900
.***AG.MF03 MF=(SLE)                                                    00121000
                  AIF   ('&XMF' EQ 'L').ZGMFX                           00121100
.*------------------------------------------------------------------    00121200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121300
&XTRAXFRPT        SETC  ''          INITIALIZE XVARIABLE                00121400
.*-------------------------------------------------------------------   00121500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121600
.ZG3              ANOP  ,                                               00121700
                  AIF   (K'&TRAXFRPT(1) LE 0).ZG3A                      00121800
&ZTLC             SETC 'NO'                                             00121900
                  AIF   ('&TRAXFRPT(1)' NE '&ZTLC').ZG4                 00122000
&XTRAXFRPT        SETC  'NO'        SET KEYWORD                         00122100
                  AIF   (N'&TRAXFRPT LE 1).ZG3A  CK NUM                 00122200
&ZMS              SETC  '"TRAXFRPT='                                    00122300
&ZMS              SETC  '&ZMS.&TRAXFRPT"'                               00122400
&ZMS              SETC  '&ZMS "TRAXFRPT"'                               00122500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00122600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00122700
.ZG3A             ANOP  ,                                               00122800
.*------------------------------------------------------------------    00122900
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00123000
&ZCVAL            SETC ''           CLEAR ERROR KEY ACCUMULATOR         00123100
.ZG3A0            AIF   (K'&SYSEVPL LE 0).ZG3A1  OK                     00123200
&ZCVAL            SETC '&ZCVAL SYSEVPL'         INCORRECT KEY USED      00123300
.ZG3A1            AIF   (K'&ZCVAL LE 0).ZG3A2   OK                      00123400
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00123500
&ZMS              SETC  '"TRAXFRPT'                                     00123600
&ZMS              SETC  '&ZMS.=&TRAXFRPT"'                              00123700
&ZMS              SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'            00123800
                  MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'            00123900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00124000
.ZG3A2            ANOP  ,                                               00124100
.*-------------------------------------------------------------------   00124200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00124300
.ZG4              ANOP  ,                                               00124400
&ZTLC             SETC 'YES'                                            00124500
                  AIF   ('&TRAXFRPT(1)' NE '&ZTLC').ZG8                 00124600
&XTRAXFRPT        SETC  'YES'       SET KEYWORD                         00124700
                  AIF   (N'&TRAXFRPT LE 1).ZG4A  CK NUM                 00124800
&ZMS              SETC  '"TRAXFRPT='                                    00124900
&ZMS              SETC  '&ZMS.&TRAXFRPT"'                               00125000
&ZMS              SETC  '&ZMS "TRAXFRPT"'                               00125100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00125200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00125300
.ZG4A             ANOP  ,                                               00125400
.*----------------------------------------------------------------***   00125500
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00125600
                  AIF   (N'&SYSEVPL LE 1).ZG6A  CK NUM                  00125700
&ZMS              SETC  '"SYSEVPL='                                     00125800
&ZMS              SETC  '&ZMS.&SYSEVPL"'                                00125900
&ZMS              SETC  '&ZMS "SYSEVPL"'                                00126000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00126100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00126200
.ZG6A             ANOP  ,                                               00126300
.*-------------------------------------------------------------------   00126400
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00126500
&ZXSYSEVPL        SETC  'INPUT'     SET IN/OUTPUT                       00126600
&XSYSEVPL         SETC  '&SYSEVPL(1)'           SET XVARIABLE           00126700
                  AIF   (N'&SYSEVPL GT 1).ZG6B  MULTI PARMS             00126800
&XSYSEVPL         SETC  '&SYSEVPL'  SET XVARIABLE                       00126900
.ZG6B             AIF   (K'&SYSEVPL(1) GT 0).ZG6C                       00127000
&ZXSYSEVPL        SETC  ''          RESET IN/OUTPUT                     00127100
&ZMS              SETC  'WHEN "YES" IS SPECIFIED'                       00127200
&ZMS              SETC  '&ZMS , "SYSEVPL" KEY AND ITS'                  00127300
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00127400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00127500
.ZG6C             ANOP  ,                                               00127600
.*-------------------------------------------------------------------   00127700
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00127800
                  AIF   (K'&ZXSYSEVPL LE 0).ZG6R  NOT I/O               00127900
                  AIF   ('&XSYSEVPL'(1,1) NE '(').ZG6R                  00128000
&ZCGPR            SETC  '&XSYSEVPL'(2,K'&XSYSEVPL-2)                    00128100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                     00128200
                  AIF   (K'&ZCGPR GT 2).ZG6Q                            00128300
                  AIF   ('&ZCGPR' EQ '0').ZG6Q                          00128400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00128500
                  AIF   (T'&ZCGPR NE 'N').ZG6Q  INVALID REG NAME        00128600
.ZG6P             ANOP  ,                                               00128700
                  AIF   (T'&ZCGPR NE 'N').ZG6R  NON NUMERIC             00128800
                  AIF   ('&ZCGPR' LT '2').ZG6Q                          00128900
                  AIF   ('&ZCGPR' LE '12').ZG6R                         00129000
.ZG6Q             ANOP  ,                                               00129100
&ZMS              SETC  '"SYSEVPL='                                     00129200
&ZMS              SETC  '&ZMS.&SYSEVPL"'                                00129300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00129400
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00129500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00129600
.ZG6R             ANOP  ,                                               00129700
.*------------------------------------------------------------------    00129800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00129900
.ZG8              ANOP  ,                                               00130000
&ZXTRAXFRPT       SETC  'INPUT'     SET IN/OUTPUT                       00130100
                  AIF   (K'&XTRAXFRPT GT 0).ZG8E  VALID ARG             00130200
                  AIF   (T'&TRAXFRPT EQ 'O').ZG8D  OMITTED              00130300
&ZASYSLNDX        SETA  0                                               00130400
.ZG8A             ANOP  ,           POSITIONAL MACRO KEY                00130500
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00130600
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG8C                 00130700
&ZTLC             SETC 'TRAXFRPT'                                       00130800
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG8A        00130900
.ZG8B             ANOP  ,                                               00131000
&ZXTRAXFRPT       SETC  ''          RESET IN/OUTPUT                     00131100
&ZMS              SETC  'THE "TRAXFRPT" KEY'                            00131200
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00131300
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00131400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00131500
                  AGO   .ZG8E                                           00131600
.ZG8C             ANOP  ,                                               00131700
&ZXTRAXFRPT       SETC  ''          RESET IN/OUTPUT                     00131800
&ZMS              SETC  '"TRAXFRPT='                                    00131900
&ZMS              SETC  '&ZMS.&TRAXFRPT"'                               00132000
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00132100
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00132200
&ZMS              SETC  '&ZMS "NO"'                                     00132300
&ZMS              SETC  '&ZMS OR "YES".'                                00132400
                  MNOTE 8,' &ZMS '                                      00132500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00132600
                  AGO   .ZG8E                                           00132700
.ZG8D             ANOP  ,                                               00132800
&XTRAXFRPT        SETC  'NO'        SET DEFAULT KEYWORD                 00132900
.ZG8E             ANOP  ,                                               00133000
.*----------------------------------------------------------------***   00133100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00133200
                  AIF   (N'&MONTKN LE 1).ZG10A  CK NUM                  00133300
&ZMS              SETC  '"MONTKN='                                      00133400
&ZMS              SETC  '&ZMS.&MONTKN"'                                 00133500
&ZMS              SETC  '&ZMS "MONTKN"'                                 00133600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00133700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00133800
.ZG10A            ANOP  ,                                               00133900
.*-------------------------------------------------------------------   00134000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00134100
&ZXMONTKN         SETC  'INPUT'     SET IN/OUTPUT                       00134200
&XMONTKN          SETC  '&MONTKN(1)'            SET XVARIABLE           00134300
                  AIF   (N'&MONTKN GT 1).ZG10B  MULTI PARMS             00134400
&XMONTKN          SETC  '&MONTKN'   SET XVARIABLE                       00134500
.ZG10B            AIF   (K'&MONTKN(1) GT 0).ZG10C                       00134600
&ZXMONTKN         SETC  ''          RESET IN/OUTPUT                     00134700
&ZMS              SETC  ' '                                             00134800
&ZMS              SETC  '&ZMS "MONTKN" KEY AND ITS'                     00134900
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00135000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00135100
.ZG10C            ANOP  ,                                               00135200
.*-------------------------------------------------------------------   00135300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00135400
                  AIF   (K'&ZXMONTKN LE 0).ZG10R  NOT I/O               00135500
                  AIF   ('&XMONTKN'(1,1) NE '(').ZG10R                  00135600
&ZCGPR            SETC  '&XMONTKN'(2,K'&XMONTKN-2)                      00135700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                    00135800
                  AIF   (K'&ZCGPR GT 2).ZG10Q                           00135900
                  AIF   ('&ZCGPR' EQ '0').ZG10Q                         00136000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00136100
                  AIF   (T'&ZCGPR NE 'N').ZG10Q  INVALID REG NAME       00136200
.ZG10P            ANOP  ,                                               00136300
                  AIF   (T'&ZCGPR NE 'N').ZG10R  NON NUMERIC            00136400
                  AIF   ('&ZCGPR' LT '2').ZG10Q                         00136500
                  AIF   ('&ZCGPR' LE '12').ZG10R                        00136600
.ZG10Q            ANOP  ,                                               00136700
&ZMS              SETC  '"MONTKN='                                      00136800
&ZMS              SETC  '&ZMS.&MONTKN"'                                 00136900
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00137000
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00137100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00137200
.ZG10R            ANOP  ,                                               00137300
.*------------------------------------------------------------------    00137400
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00137500
&XCOMPLETION      SETC  ''          INITIALIZE XVARIABLE                00137600
.*-------------------------------------------------------------------   00137700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00137800
.ZG14             ANOP  ,                                               00137900
                  AIF   (K'&COMPLETION(1) LE 0).ZG14A                   00138000
&ZTLC             SETC 'YES'                                            00138100
                  AIF   ('&COMPLETION(1)' NE '&ZTLC').ZG15              00138200
&XCOMPLETION      SETC  'YES'       SET KEYWORD                         00138300
                  AIF   (N'&COMPLETION LE 1).ZG14A  CK NUM              00138400
&ZMS              SETC  '"COMPLETION='                                  00138500
&ZMS              SETC  '&ZMS.&COMPLETION"'                             00138600
&ZMS              SETC  '&ZMS "COMPLETION"'                             00138700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00138800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00138900
.ZG14A            ANOP  ,                                               00139000
.*-------------------------------------------------------------------   00139100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00139200
.ZG15             ANOP  ,                                               00139300
&ZTLC             SETC 'NO'                                             00139400
                  AIF   ('&COMPLETION(1)' NE '&ZTLC').ZG16              00139500
&XCOMPLETION      SETC  'NO'        SET KEYWORD                         00139600
                  AIF   (N'&COMPLETION LE 1).ZG15A  CK NUM              00139700
&ZMS              SETC  '"COMPLETION='                                  00139800
&ZMS              SETC  '&ZMS.&COMPLETION"'                             00139900
&ZMS              SETC  '&ZMS "COMPLETION"'                             00140000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00140100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00140200
.ZG15A            ANOP  ,                                               00140300
.*------------------------------------------------------------------    00140400
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00140500
.ZG16             ANOP  ,                                               00140600
&ZXCOMPLETION     SETC  'INPUT'     SET IN/OUTPUT                       00140700
                  AIF   (K'&XCOMPLETION GT 0).ZG16E  VALID ARG          00140800
                  AIF   (T'&COMPLETION EQ 'O').ZG16D  OMITTED           00140900
&ZASYSLNDX        SETA  0                                               00141000
.ZG16A            ANOP  ,           POSITIONAL MACRO KEY                00141100
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00141200
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG16C                00141300
&ZTLC             SETC 'COMPLETION'                                     00141400
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG16A       00141500
.ZG16B            ANOP  ,                                               00141600
&ZXCOMPLETION     SETC  ''          RESET IN/OUTPUT                     00141700
&ZMS              SETC  'THE "COMPLETION" KEY'                          00141800
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00141900
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00142000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00142100
                  AGO   .ZG16E                                          00142200
.ZG16C            ANOP  ,                                               00142300
&ZXCOMPLETION     SETC  ''          RESET IN/OUTPUT                     00142400
&ZMS              SETC  '"COMPLETION='                                  00142500
&ZMS              SETC  '&ZMS.&COMPLETION"'                             00142600
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00142700
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00142800
&ZMS              SETC  '&ZMS "YES"'                                    00142900
&ZMS              SETC  '&ZMS OR "NO".'                                 00143000
                  MNOTE 8,' &ZMS '                                      00143100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00143200
                  AGO   .ZG16E                                          00143300
.ZG16D            ANOP  ,                                               00143400
&XCOMPLETION      SETC  'YES'       SET DEFAULT KEYWORD                 00143500
.ZG16E            ANOP  ,                                               00143600
.*------------------------------------------------------------------    00143700
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00143800
                  AIF   (K'&COMPLETION(1) GT 0).ZG16F  PARM             00143900
&XCOMPLETION      SETC  ''          ENSURE NULL KEYWORD                 00144000
&ZXCOMPLETION     SETC  ''          RESET IN/OUTPUT                     00144100
&ZMS              SETC  'THE'                                           00144200
&ZMS              SETC  '&ZMS "COMPLETION" KEY AND ITS'                 00144300
&ZMS              SETC  '&ZMS ARGUMENT ARE REQUIRED.'                   00144400
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00144500
&ZMS              SETC  '&ZMS "YES"'                                    00144600
&ZMS              SETC  '&ZMS OR "NO".'                                 00144700
                  MNOTE 8,' &ZMS '                                      00144800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00144900
.ZG16F            ANOP  ,                                               00145000
.*------------------------------------------------------------------    00145100
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00145200
&XDISASSOCIATE    SETC  ''          INITIALIZE XVARIABLE                00145300
.*-------------------------------------------------------------------   00145400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00145500
.ZG19             ANOP  ,                                               00145600
                  AIF   (K'&DISASSOCIATE(1) LE 0).ZG19A                 00145700
&ZTLC             SETC 'YES'                                            00145800
                  AIF   ('&DISASSOCIATE(1)' NE '&ZTLC').ZG23            00145900
&XDISASSOCIATE    SETC  'YES'       SET KEYWORD                         00146000
                  AIF   (N'&DISASSOCIATE LE 1).ZG19A  CK NUM            00146100
&ZMS              SETC  '"DISASSOCIATE='                                00146200
&ZMS              SETC  '&ZMS.&DISASSOCIATE"'                           00146300
&ZMS              SETC  '&ZMS "DISASSOCIATE"'                           00146400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00146500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00146600
.ZG19A            ANOP  ,                                               00146700
.*----------------------------------------------------------------***   00146800
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00146900
                  AIF   (N'&WORKREQ_STA LE 1).ZG21A  CK NUM             00147000
&ZMS              SETC  '"WORKREQ_STA='                                 00147100
&ZMS              SETC  '&ZMS.&WORKREQ_STA"'                            00147200
&ZMS              SETC  '&ZMS "WORKREQ_STA"'                            00147300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00147400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00147500
.ZG21A            ANOP  ,                                               00147600
.*-------------------------------------------------------------------   00147700
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00147800
&ZXWORKREQ_STA    SETC  'INPUT'     SET IN/OUTPUT                       00147900
&XWORKREQ_STA     SETC  'IWMEWLMARMSTATUSNONE'                          00148000
                  AIF   (K'&WORKREQ_STA(1) LE 0).ZG21B  PARM            00148100
&XWORKREQ_STA     SETC  '&WORKREQ_STA(1)'       SET XVARIABLE           00148200
                  AIF   (N'&WORKREQ_STA GT 1).ZG21B  MULTI              00148300
&XWORKREQ_STA     SETC  '&WORKREQ_STA'          SET XVARIABLE           00148400
.ZG21B            ANOP  ,                                               00148500
.*-------------------------------------------------------------------   00148600
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00148700
                  AIF   (K'&ZXWORKREQ_STA LE 0).ZG21R  NOT I/O          00148800
         AIF   ('&XWORKREQ_STA' EQ 'IWMEWLMARMSTATUSNONE').ZG21R        00148900
                  AIF   ('&XWORKREQ_STA'(1,1) NE '(').ZG21R             00149000
&ZCGPR            SETC  '&XWORKREQ_STA'(2,K'&XWORKREQ_STA-2)            00149100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG21P                    00149200
                  AIF   (K'&ZCGPR GT 2).ZG21Q                           00149300
                  AIF   ('&ZCGPR' EQ '0').ZG21Q                         00149400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00149500
                  AIF   (T'&ZCGPR NE 'N').ZG21Q  INVALID REG NAME       00149600
.ZG21P            ANOP  ,                                               00149700
                  AIF   (T'&ZCGPR NE 'N').ZG21R  NON NUMERIC            00149800
                  AIF   ('&ZCGPR' LT '2').ZG21Q                         00149900
                  AIF   ('&ZCGPR' LE '12').ZG21R                        00150000
.ZG21Q            ANOP  ,                                               00150100
&ZMS              SETC  '"WORKREQ_STA='                                 00150200
&ZMS              SETC  '&ZMS.&WORKREQ_STA"'                            00150300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00150400
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00150500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00150600
.ZG21R            ANOP  ,                                               00150700
.*-------------------------------------------------------------------   00150800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00150900
.ZG23             ANOP  ,                                               00151000
&ZTLC             SETC 'NO'                                             00151100
                  AIF   ('&DISASSOCIATE(1)' NE '&ZTLC').ZG24            00151200
&XDISASSOCIATE    SETC  'NO'        SET KEYWORD                         00151300
                  AIF   (N'&DISASSOCIATE LE 1).ZG23A  CK NUM            00151400
&ZMS              SETC  '"DISASSOCIATE='                                00151500
&ZMS              SETC  '&ZMS.&DISASSOCIATE"'                           00151600
&ZMS              SETC  '&ZMS "DISASSOCIATE"'                           00151700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00151800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00151900
.ZG23A            ANOP  ,                                               00152000
.*------------------------------------------------------------------    00152100
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00152200
&ZCVAL            SETC ''           CLEAR ERROR KEY ACCUMULATOR         00152300
.ZG23A0           AIF   (K'&WORKREQ_STA LE 0).ZG23A1  OK                00152400
&ZCVAL            SETC '&ZCVAL WORKREQ_STA'     INCORRECT KEY USED      00152500
.ZG23A1           AIF   (K'&ZCVAL LE 0).ZG23A2  OK                      00152600
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00152700
&ZMS              SETC  '"DISASSOCIATE'                                 00152800
&ZMS              SETC  '&ZMS.=&DISASSOCIATE"'                          00152900
&ZMS              SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'            00153000
                  MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'            00153100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00153200
.ZG23A2           ANOP  ,                                               00153300
.*------------------------------------------------------------------    00153400
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00153500
.ZG24             ANOP  ,                                               00153600
&ZXDISASSOCIATE   SETC  'INPUT'     SET IN/OUTPUT                       00153700
                  AIF   (K'&XDISASSOCIATE GT 0).ZG24E  VALID ARG        00153800
                  AIF   (T'&DISASSOCIATE EQ 'O').ZG24D  OMITTED         00153900
&ZASYSLNDX        SETA  0                                               00154000
.ZG24A            ANOP  ,           POSITIONAL MACRO KEY                00154100
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00154200
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG24C                00154300
&ZTLC             SETC 'DISASSOCIATE'                                   00154400
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG24A       00154500
.ZG24B            ANOP  ,                                               00154600
&ZXDISASSOCIATE   SETC  ''          RESET IN/OUTPUT                     00154700
&ZMS              SETC  'THE "DISASSOCIATE" KEY'                        00154800
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00154900
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00155000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00155100
                  AGO   .ZG24E                                          00155200
.ZG24C            ANOP  ,                                               00155300
&ZXDISASSOCIATE   SETC  ''          RESET IN/OUTPUT                     00155400
&ZMS              SETC  '"DISASSOCIATE='                                00155500
&ZMS              SETC  '&ZMS.&DISASSOCIATE"'                           00155600
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00155700
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00155800
&ZMS              SETC  '&ZMS "YES"'                                    00155900
&ZMS              SETC  '&ZMS OR "NO".'                                 00156000
                  MNOTE 8,' &ZMS '                                      00156100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00156200
                  AGO   .ZG24E                                          00156300
.ZG24D            ANOP  ,                                               00156400
&XDISASSOCIATE    SETC  'YES'       SET DEFAULT KEYWORD                 00156500
.ZG24E            ANOP  ,                                               00156600
.*------------------------------------------------------------------    00156700
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00156800
                  AIF   (K'&DISASSOCIATE(1) GT 0).ZG24F  PARM           00156900
&XDISASSOCIATE    SETC  ''          ENSURE NULL KEYWORD                 00157000
&ZXDISASSOCIATE   SETC  ''          RESET IN/OUTPUT                     00157100
&ZMS              SETC  'THE'                                           00157200
&ZMS              SETC  '&ZMS "DISASSOCIATE" KEY AND ITS'               00157300
&ZMS              SETC  '&ZMS ARGUMENT ARE REQUIRED.'                   00157400
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00157500
&ZMS              SETC  '&ZMS "YES"'                                    00157600
&ZMS              SETC  '&ZMS OR "NO".'                                 00157700
                  MNOTE 8,' &ZMS '                                      00157800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00157900
.ZG24F            ANOP  ,                                               00158000
.*----------------------------------------------------------------***   00158100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00158200
                  AIF   (N'&CONNTKN LE 1).ZG26A  CK NUM                 00158300
&ZMS              SETC  '"CONNTKN='                                     00158400
&ZMS              SETC  '&ZMS.&CONNTKN"'                                00158500
&ZMS              SETC  '&ZMS "CONNTKN"'                                00158600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00158700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00158800
.ZG26A            ANOP  ,                                               00158900
.*-------------------------------------------------------------------   00159000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00159100
&ZXCONNTKN        SETC  'INPUT'     SET IN/OUTPUT                       00159200
&XCONNTKN         SETC  'NO_CONNTKN'                                    00159300
                  AIF   (K'&CONNTKN(1) LE 0).ZG26B  PARM                00159400
&XCONNTKN         SETC  '&CONNTKN(1)'           SET XVARIABLE           00159500
                  AIF   (N'&CONNTKN GT 1).ZG26B  MULTI                  00159600
&XCONNTKN         SETC  '&CONNTKN'  SET XVARIABLE                       00159700
.ZG26B            ANOP  ,                                               00159800
.*-------------------------------------------------------------------   00159900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00160000
                  AIF   (K'&ZXCONNTKN LE 0).ZG26R  NOT I/O              00160100
         AIF   ('&XCONNTKN' EQ 'NO_CONNTKN').ZG26R                      00160200
                  AIF   ('&XCONNTKN'(1,1) NE '(').ZG26R                 00160300
&ZCGPR            SETC  '&XCONNTKN'(2,K'&XCONNTKN-2)                    00160400
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                    00160500
                  AIF   (K'&ZCGPR GT 2).ZG26Q                           00160600
                  AIF   ('&ZCGPR' EQ '0').ZG26Q                         00160700
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00160800
                  AIF   (T'&ZCGPR NE 'N').ZG26Q  INVALID REG NAME       00160900
.ZG26P            ANOP  ,                                               00161000
                  AIF   (T'&ZCGPR NE 'N').ZG26R  NON NUMERIC            00161100
                  AIF   ('&ZCGPR' LT '2').ZG26Q                         00161200
                  AIF   ('&ZCGPR' LE '12').ZG26R                        00161300
.ZG26Q            ANOP  ,                                               00161400
&ZMS              SETC  '"CONNTKN='                                     00161500
&ZMS              SETC  '&ZMS.&CONNTKN"'                                00161600
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00161700
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00161800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00161900
.ZG26R            ANOP  ,                                               00162000
.*----------------------------------------------------------------***   00162100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00162200
                  AIF   (N'&ENDTIME LE 1).ZG29A  CK NUM                 00162300
&ZMS              SETC  '"ENDTIME='                                     00162400
&ZMS              SETC  '&ZMS.&ENDTIME"'                                00162500
&ZMS              SETC  '&ZMS "ENDTIME"'                                00162600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00162700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00162800
.ZG29A            ANOP  ,                                               00162900
.*-------------------------------------------------------------------   00163000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00163100
&ZXENDTIME        SETC  'INPUT'     SET IN/OUTPUT                       00163200
&XENDTIME         SETC  'CURRENT'                                       00163300
                  AIF   (K'&ENDTIME(1) LE 0).ZG29B  PARM                00163400
&XENDTIME         SETC  '&ENDTIME(1)'           SET XVARIABLE           00163500
                  AIF   (N'&ENDTIME GT 1).ZG29B  MULTI                  00163600
&XENDTIME         SETC  '&ENDTIME'  SET XVARIABLE                       00163700
.ZG29B            ANOP  ,                                               00163800
.*-------------------------------------------------------------------   00163900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00164000
                  AIF   (K'&ZXENDTIME LE 0).ZG29R  NOT I/O              00164100
         AIF   ('&XENDTIME' EQ 'CURRENT').ZG29R                         00164200
                  AIF   ('&XENDTIME'(1,1) NE '(').ZG29R                 00164300
&ZCGPR            SETC  '&XENDTIME'(2,K'&XENDTIME-2)                    00164400
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                    00164500
                  AIF   (K'&ZCGPR GT 2).ZG29Q                           00164600
                  AIF   ('&ZCGPR' EQ '0').ZG29Q                         00164700
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00164800
                  AIF   (T'&ZCGPR NE 'N').ZG29Q  INVALID REG NAME       00164900
.ZG29P            ANOP  ,                                               00165000
                  AIF   (T'&ZCGPR NE 'N').ZG29R  NON NUMERIC            00165100
                  AIF   ('&ZCGPR' LT '2').ZG29Q                         00165200
                  AIF   ('&ZCGPR' LE '12').ZG29R                        00165300
.ZG29Q            ANOP  ,                                               00165400
&ZMS              SETC  '"ENDTIME='                                     00165500
&ZMS              SETC  '&ZMS.&ENDTIME"'                                00165600
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00165700
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00165800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00165900
.ZG29R            ANOP  ,                                               00166000
.*----------------------------------------------------------------***   00166100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00166200
                  AIF   (N'&RETCODE LE 1).ZG32A  CK NUM                 00166300
&ZMS              SETC  '"RETCODE='                                     00166400
&ZMS              SETC  '&ZMS.&RETCODE"'                                00166500
&ZMS              SETC  '&ZMS "RETCODE"'                                00166600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00166700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00166800
.ZG32A            ANOP  ,                                               00166900
.*-------------------------------------------------------------------   00167000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00167100
                  AIF   (K'&RETCODE(1) LE 0).ZG32C  NO PARM             00167200
&ZXRETCODE        SETC  'OUTPUT'    SET OUTPUT                          00167300
&XRETCODE         SETC  '&RETCODE(1)'           SET XVARIABLE           00167400
                  AIF   (N'&RETCODE GT 1).ZG32C                         00167500
&XRETCODE         SETC  '&RETCODE'  SET XVARIABLE                       00167600
.ZG32C            ANOP  ,                                               00167700
.*-------------------------------------------------------------------   00167800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00167900
                  AIF   (K'&ZXRETCODE LE 0).ZG32R  NOT I/O              00168000
                  AIF   ('&XRETCODE'(1,1) NE '(').ZG32R                 00168100
&ZCGPR            SETC  '&XRETCODE'(2,K'&XRETCODE-2)                    00168200
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                    00168300
                  AIF   (K'&ZCGPR GT 2).ZG32Q                           00168400
                  AIF   ('&ZCGPR' EQ '0').ZG32Q                         00168500
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00168600
                  AIF   (T'&ZCGPR NE 'N').ZG32Q  INVALID REG NAME       00168700
.ZG32P            ANOP  ,                                               00168800
                  AIF   (T'&ZCGPR NE 'N').ZG32R  NON NUMERIC            00168900
                  AIF   ('&ZCGPR' EQ '15').ZG32R                        00169000
                  AIF   ('&ZCGPR' LT '2').ZG32Q                         00169100
                  AIF   ('&ZCGPR' LE '12').ZG32R                        00169200
.ZG32Q            ANOP  ,                                               00169300
&ZMS              SETC  '"RETCODE='                                     00169400
&ZMS              SETC  '&ZMS.&RETCODE"'                                00169500
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00169600
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'        00169700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00169800
.ZG32R            ANOP  ,                                               00169900
.*----------------------------------------------------------------***   00170000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00170100
                  AIF   (N'&RSNCODE LE 1).ZG35A  CK NUM                 00170200
&ZMS              SETC  '"RSNCODE='                                     00170300
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00170400
&ZMS              SETC  '&ZMS "RSNCODE"'                                00170500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00170600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00170700
.ZG35A            ANOP  ,                                               00170800
.*-------------------------------------------------------------------   00170900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00171000
                  AIF   (K'&RSNCODE(1) LE 0).ZG35C  NO PARM             00171100
&ZXRSNCODE        SETC  'OUTPUT'    SET OUTPUT                          00171200
&XRSNCODE         SETC  '&RSNCODE(1)'           SET XVARIABLE           00171300
                  AIF   (N'&RSNCODE GT 1).ZG35C                         00171400
&XRSNCODE         SETC  '&RSNCODE'  SET XVARIABLE                       00171500
.ZG35C            ANOP  ,                                               00171600
.*-------------------------------------------------------------------   00171700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00171800
                  AIF   (K'&ZXRSNCODE LE 0).ZG35R  NOT I/O              00171900
                  AIF   ('&XRSNCODE'(1,1) NE '(').ZG35R                 00172000
&ZCGPR            SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                    00172100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                    00172200
                  AIF   (K'&ZCGPR GT 2).ZG35Q                           00172300
                  AIF   ('&ZCGPR' EQ '0').ZG35R                         00172400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00172500
                  AIF   (T'&ZCGPR NE 'N').ZG35Q  INVALID REG NAME       00172600
.ZG35P            ANOP  ,                                               00172700
                  AIF   (T'&ZCGPR NE 'N').ZG35R  NON NUMERIC            00172800
                  AIF   ('&ZCGPR' EQ '0').ZG35R                         00172900
                  AIF   ('&ZCGPR' LT '2').ZG35Q                         00173000
                  AIF   ('&ZCGPR' LE '12').ZG35R                        00173100
.ZG35Q            ANOP  ,                                               00173200
&ZMS              SETC  '"RSNCODE='                                     00173300
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00173400
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00173500
                  MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'         00173600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00173700
.ZG35R            ANOP  ,                                               00173800
.******************************************************************     00173900
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00174000
.******************************************************************     00174100
                  ACTR  10000                                           00174200
.*----------------------------------------------------------------***   00174300
.***AH.P02 EXTRA POSITIONALS                                            00174400
                  AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS            00174500
                  AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL            00174600
                  AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL        00174700
                  AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL         00174800
.ZGLISTX1         ANOP  ,                                               00174900
&ZCVAL            SETC  ''          ERROR FIELD                         00175000
&ZAWRK            SETA  0           POSITIONAL NUMBER                   00175100
.ZGLIST2          ANOP  ,                                               00175200
&ZAWRK            SETA  &ZAWRK+1    NEXT POSITIONAL                     00175300
                  AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE            00175400
&ZCVAL            SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                 00175500
                  AGO   .ZGLIST2                                        00175600
.*                                                                      00175700
.ZGLIST3          ANOP  ,                                               00175800
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)   STRIP COMMA             00175900
&ZMS              SETC  'POSITIONAL ARGUMENT(S),'                       00176000
&ZMS              SETC  '&ZMS "&ZCVAL"'                                 00176100
&ZMS              SETC  '&ZMS CANNOT BE USED.'                          00176200
&ZMS              SETC  '&ZMS NO POSITIONAL ARGUMENTS'                  00176300
                  MNOTE 8,' &ZMS ARE ALLOWED.'                          00176400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00176500
.ZGLISTX          ANOP  ,                                               00176600
&ZASYSLNDX        SETA  0                                               00176700
.*-------------------------------------------------------------------   00176800
.***AG.MF04 MF=(SLE)                                                    00176900
.ZGMFX            ANOP  ,           END OF FULL SYNTAX CHECK            00177000
.*******************************************************************    00177100
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00177200
.*******************************************************************    00177300
                  AIF   (&ZMACRET NE 0).ZLX2    ERROR DETECTED          00177400
.*******************************************************************    00177500
.***AE.01  START OF IWMMNTFY MACRO CODE                                 00177600
.*******************************************************************    00177700
                  LCLC  &M0M0001                 NAME                   00177800
&M0M0001          SETC  '&XLABEL'                SET NAME               00177900
                  AIF   (K'&XLABEL NE 0).XLAB2                          00178000
&M0M0001          SETC  'M00M&SYSNDX'            DEFAULT NAME           00178100
.*                                                                      00178200
.XLAB2            ANOP  ,                                               00178300
                  AIF   ('&XMF' EQ 'L').XLAB3                           00178400
&M0M0001 DS    0H                             IWMMNTFY-1                00178500
.XLAB3            ANOP  ,                                               00178600
.*******************************************************************    00178700
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00178800
.*******************************************************************    00178900
              PUSH  PRINT                                               00179000
                  AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON      00179100
                  PRINT OFF         ++ PR01                             00179200
                  AGO   .ZPRNTXX                                        00179300
.ZPRINTX          PRINT ON                                              00179400
.ZPRNTXX          ANOP  ,                                               00179500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00179600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00179700
.********************************************************************   00179800
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00179900
.********************************************************************   00180000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00180100
                      LCLA  &ZOPN1         INVOCATION INDEX             00180200
                      LCLC  &ZOPL(4095)    LABEL                        00180300
                      LCLC  &ZOPO(4095)    OPERATION                    00180400
                      LCLC  &ZOPV(4095)    VALUE                        00180500
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00180600
.*                                                                      00180700
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00180800
.******************************************************************     00180900
.***AL.L10 IWMMNTFY FMT=LIST MF=S!L PARAMETERS                          00181000
.******************************************************************     00181100
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00181200
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00181300
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00181400
&XMFATTR              SETC  '0D'                                        00181500
.*                                                                      00181600
&ZOPN                 SETA  &ZOPN+1                                     00181700
&ZOPL(&ZOPN)          SETC  ' '                                         00181800
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00181900
&ZOPO(&ZOPN)          SETC  'B'                                         00182000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00182100
                      AGO   .ZALVL6B                                    00182200
.ZALVL6A              ANOP                                              00182300
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00182400
&ZOPV(&ZOPN)          SETC  '4,8'                                       00182500
&ZOPN                 SETA  &ZOPN+1                                     00182600
&ZOPL(&ZOPN)          SETC  ' '                                         00182700
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00182800
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00182900
.ZALVL6B              ANOP                                              00183000
&ZOPD(&ZOPN)          SETC  '++ IWMMNTFY ARG PARMS'                     00183100
.*                                                                      00183200
&ZOPN                 SETA  &ZOPN+1                                     00183300
&ZOPL(&ZOPN)          SETC  ' '                                         00183400
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00183500
&ZOPV(&ZOPN)          SETC  '1'                                         00183600
&ZOPD(&ZOPN)          SETC  ' '                                         00183700
.*                                                                      00183800
.ZLMFSL2              ANOP  ,                                           00183900
.*-------------------------------------------------------------------   00184000
.***AM.L00  IWMMNTFY FMT=LIST name                                      00184100
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00184200
&ZOPN                 SETA &ZOPN+1                                      00184300
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00184400
&ZOPO(&ZOPN)          SETC 'EQU'                                        00184500
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00184600
&ZOPD(&ZOPN)          SETC '++ IWMMNTFY NAME'                           00184700
.ZLMFSL2M             ANOP  ,                                           00184800
.*-------------------------------------------------------------------   00184900
.***AM.L01  IWMMNTFY FMT=LIST PARAMETERS                                00185000
&ZOPN                 SETA &ZOPN+1                                      00185100
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00185200
&ZOPO(&ZOPN)          SETC 'DS'                                         00185300
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00185400
&ZOPD(&ZOPN)          SETC '++ IWMMNTFY PARM LIST'                      00185500
.*-------------------------------------------------------------------   00185600
.***AM.L02 XVERSION XL1                                                 00185700
&ZOPN                 SETA &ZOPN+1                                      00185800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00185900
&ZOPO(&ZOPN)          SETC 'DS'                                         00186000
&ZOPV(&ZOPN)          SETC 'XL1'                                        00186100
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00186200
.*-------------------------------------------------------------------   00186300
.***AM.L03 XNOTIFY_OPTIONS BL.16                                        00186400
&ZOPN                 SETA &ZOPN+1                                      00186500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNOTIFY_OPTIONS'                  00186600
&ZOPO(&ZOPN)          SETC 'DS'                                         00186700
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00186800
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00186900
.*                                                                      00187000
&ZOPN                 SETA  &ZOPN+1                                     00187100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTRAXFRPT_YES'                   00187200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00187300
&ZOPV(&ZOPN)          SETC  'B''1000000000000000'''                     00187400
&ZOPD(&ZOPN)          SETC  '++ XTRAXFRPT.'                             00187500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00187600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00187700
.*                                                                      00187800
&ZOPN                 SETA  &ZOPN+1                                     00187900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCOMPLETION_YES'                 00188000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00188100
&ZOPV(&ZOPN)          SETC  'B''0100000000000000'''                     00188200
&ZOPD(&ZOPN)          SETC  '++ XCOMPLETION.'                           00188300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00188400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00188500
.*                                                                      00188600
&ZOPN                 SETA  &ZOPN+1                                     00188700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDISASSOCIATE_YES'               00188800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00188900
&ZOPV(&ZOPN)          SETC  'B''0010000000000000'''                     00189000
&ZOPD(&ZOPN)          SETC  '++ XDISASSOCIATE.'                         00189100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00189200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00189300
.*-------------------------------------------------------------------   00189400
.***AM.L09  XRSV0003 CL1                                                00189500
&ZOPN                 SETA &ZOPN+1                                      00189600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         00189700
&ZOPO(&ZOPN)          SETC 'DS'                                         00189800
&ZOPV(&ZOPN)          SETC 'CL1'                                        00189900
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00190000
.*-------------------------------------------------------------------   00190100
.***AM.L09 ADDR XSYSEVPL A                                              00190200
&ZOPN                 SETA &ZOPN+1                                      00190300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSYSEVPL_ADDR'                    00190400
&ZOPO(&ZOPN)          SETC 'DS'                                         00190500
&ZOPV(&ZOPN)          SETC 'A'                                          00190600
&ZOPD(&ZOPN)          SETC '++ &ZXSYSEVPL ADDR'                         00190700
.*-------------------------------------------------------------------   00190800
.***AM.L09  XCONNTKN BL.32                                              00190900
&ZOPN                 SETA &ZOPN+1                                      00191000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONNTKN'                         00191100
&ZOPO(&ZOPN)          SETC 'DS'                                         00191200
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00191300
&ZOPD(&ZOPN)          SETC '++ &ZXCONNTKN '                             00191400
.*-------------------------------------------------------------------   00191500
.***AM.L09  XMONTKN BL.32                                               00191600
&ZOPN                 SETA &ZOPN+1                                      00191700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN'                          00191800
&ZOPO(&ZOPN)          SETC 'DS'                                         00191900
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00192000
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN '                              00192100
.*-------------------------------------------------------------------   00192200
.***AM.L09  XENDTIME BL.64                                              00192300
&ZOPN                 SETA &ZOPN+1                                      00192400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XENDTIME'                         00192500
&ZOPO(&ZOPN)          SETC 'DS'                                         00192600
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00192700
&ZOPD(&ZOPN)          SETC '++ &ZXENDTIME '                             00192800
.*-------------------------------------------------------------------   00192900
.***AM.L09  XRSVD0024 CL4                                               00193000
&ZOPN                 SETA &ZOPN+1                                      00193100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVD0024'                        00193200
&ZOPO(&ZOPN)          SETC 'DS'                                         00193300
&ZOPV(&ZOPN)          SETC 'CL4'                                        00193400
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00193500
.*-------------------------------------------------------------------   00193600
.***AM.L09  XRSVD0028 CL4                                               00193700
&ZOPN                 SETA &ZOPN+1                                      00193800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVD0028'                        00193900
&ZOPO(&ZOPN)          SETC 'DS'                                         00194000
&ZOPV(&ZOPN)          SETC 'CL4'                                        00194100
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00194200
.*-------------------------------------------------------------------   00194300
.***AM.L09  XRSVD002C CL4                                               00194400
&ZOPN                 SETA &ZOPN+1                                      00194500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVD002C'                        00194600
&ZOPO(&ZOPN)          SETC 'DS'                                         00194700
&ZOPV(&ZOPN)          SETC 'CL4'                                        00194800
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00194900
.*-------------------------------------------------------------------   00195000
.***AM.L09 ADDR XWORKREQ_STA A                                          00195100
&ZOPN                 SETA &ZOPN+1                                      00195200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XWORKREQ_STA_ADDR'                00195300
&ZOPO(&ZOPN)          SETC 'DS'                                         00195400
&ZOPV(&ZOPN)          SETC 'A'                                          00195500
&ZOPD(&ZOPN)          SETC '++ &ZXWORKREQ_STA ADDR'                     00195600
.*-------------------------------------------------------------------   00195700
.***AM.L10 END OF IWMMNTFY LIST PARAMETERS                              00195800
&ZOPN                 SETA &ZOPN+1                                      00195900
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00196000
&ZOPO(&ZOPN)          SETC 'EQU'                                        00196100
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00196200
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00196300
.*                                                                      00196400
&ZOPN                 SETA &ZOPN+1                                      00196500
&ZOPL(&ZOPN)          SETC ' '                                          00196600
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00196700
&ZOPV(&ZOPN)          SETC '1'                                          00196800
&ZOPD(&ZOPN)          SETC ' '                                          00196900
.*-------------------------------------------------------------------   00197000
.***AL.L12 IWMMNTFY FMT=LIST MF=S!L PARAMETERS                          00197100
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00197200
.*                                                                      00197300
&ZOPN                 SETA  &ZOPN+1                                     00197400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00197500
&ZOPO(&ZOPN)          SETC  'DC'                                        00197600
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00197700
&ZOPD(&ZOPN)          SETC  '++ IWMMNTFY ARG PARMS'                     00197800
.*                                                                      00197900
.ZLMFSLX              ANOP  ,                                           00198000
.*-------------------------------------------------------------------   00198100
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00198200
&ZPLLEN               SETA 40                                           00198300
.*                                                                      00198400
.******************************************************************     00198500
.***AI.L01 IWMMNTFY FMT=LIST FILL IN PARAMETER AREA                     00198600
.******************************************************************     00198700
                      ACTR  10000                                       00198800
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00198900
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00199000
&ZCVAL                SETC  'LAE'          XAX MODE                     00199100
.ZIMFXA               ANOP ,                                            00199200
.*                                                                      00199300
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00199400
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00199500
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00199600
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00199700
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00199800
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00199900
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00200000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00200100
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00200200
&ZOPN                 SETA  &ZOPN+1                                     00200300
&ZOPL(&ZOPN)          SETC  ' '                                         00200400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00200500
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00200600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00200700
                      AGO   .ZIMFNX                                     00200800
.*                                                                      00200900
.ZIMFN2               ANOP ,                                            00201000
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00201100
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00201200
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00201300
&ZOPN                 SETA  &ZOPN+1                                     00201400
&ZOPL(&ZOPN)          SETC  ' '                                         00201500
&ZOPO(&ZOPN)          SETC  'LAE'                                       00201600
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00201700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00201800
                      AGO   .ZIMFNX                                     00201900
.ZIMFNX1              ANOP ,                                            00202000
&ZOPN                 SETA  &ZOPN+1                                     00202100
&ZOPL(&ZOPN)          SETC  ' '                                         00202200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00202300
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00202400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00202500
.ZIMFNX               ANOP ,                                            00202600
.********************************************************************   00202700
.***AI.L02 IWMMNTFY FMT=LIST INITIALIZE PARAMETER AREA                  00202800
.********************************************************************   00202900
.***AI.L03 MF=(SLE)                                                     00203000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00203100
.*                                                                      00203200
&ZOPN                 SETA  &ZOPN+1                                     00203300
&ZOPL(&ZOPN)          SETC  ' '                                         00203400
&ZOPO(&ZOPN)          SETC  'XC'                                        00203500
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00203600
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00203700
.ZIMFLX               ANOP  ,                                           00203800
.*-------------------------------------------------------------------   00203900
.***AI.L04A XVERSION XL1                                                00204000
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00204100
&ZOPN                 SETA  &ZOPN+1                                     00204200
&ZOPL(&ZOPN)          SETC  ' '                                         00204300
&ZOPO(&ZOPN)          SETC  'MVI'                                       00204400
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00204500
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00204600
.ZIMFVW               ANOP  ,                                           00204700
.*-------------------------------------------------------------------   00204800
.***AI.L05 XNOTIFY_OPTIONS BL2                                          00204900
&ZW                   SETC  ''                                          00205000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00205100
.*-------------------------------------------------------------------   00205200
.***AI.L08 XNOTIFY_OPTIONS "YES"                                        00205300
.***      BL2'1XXXXXXXXXXXXXXX'                                         00205400
         AIF   ('&XTRAXFRPT' NE 'YES').ZI3A                             00205500
&ZW                   SETC  '&ZW.1'                                     00205600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00205700
                      AGO   .ZI3C                                       00205800
.*                                                                      00205900
.ZI3A                 ANOP  ,                                           00206000
&ZW                   SETC  '&ZW.0'                                     00206100
.ZI3C                 ANOP  ,                                           00206200
.*-------------------------------------------------------------------   00206300
.***AI.L08 XNOTIFY_OPTIONS "YES"                                        00206400
.***      BL2'X1XXXXXXXXXXXXXX'                                         00206500
         AIF   ('&XCOMPLETION' NE 'YES').ZI4A                           00206600
&ZW                   SETC  '&ZW.1'                                     00206700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00206800
                      AGO   .ZI4C                                       00206900
.*                                                                      00207000
.ZI4A                 ANOP  ,                                           00207100
&ZW                   SETC  '&ZW.0'                                     00207200
.ZI4C                 ANOP  ,                                           00207300
.*-------------------------------------------------------------------   00207400
.***AI.L08 XNOTIFY_OPTIONS "YES"                                        00207500
.***      BL2'XX1XXXXXXXXXXXXX'                                         00207600
         AIF   ('&XDISASSOCIATE' NE 'YES').ZI5A                         00207700
&ZW                   SETC  '&ZW.10000000000000'                        00207800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00207900
                      AGO   .ZI5C                                       00208000
.*                                                                      00208100
.ZI5A                 ANOP  ,                                           00208200
&ZW                   SETC  '&ZW.00000000000000'                        00208300
.ZI5C                 ANOP  ,                                           00208400
.*-------------------------------------------------------------------   00208500
.***AI.L10 XNOTIFY_OPTIONS BL2                                          00208600
                      AIF   ('&ZCLNG' NE 'YES').ZI5E  ALL ZERO BITS     00208700
&ZOPN                 SETA  &ZOPN+1                                     00208800
&ZOPL(&ZOPN)          SETC  ' '                                         00208900
&ZOPO(&ZOPN)          SETC  'OC'                                        00209000
&ZOPV(&ZOPN)          SETC  '1(2,1),=BL2''&ZW'''                        00209100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL2'                              00209200
.ZI5E                 ANOP  ,                                           00209300
.*-------------------------------------------------------------------   00209400
.***AI.L19 ADDR XSYSEVPL A                                              00209500
                      AIF   ('&ZXSYSEVPL' EQ '').ZI7H                   00209600
&ZCLNG                SETC  '&XSYSEVPL'                                 00209700
&ZCGPR                SETC  '14'                                        00209800
         AIF   ('&XSYSEVPL'(1,1) EQ '(').ZI7F  IN GPR                   00209900
.*                                                                      00210000
&ZOPN                 SETA  &ZOPN+1                                     00210100
&ZOPL(&ZOPN)          SETC  ' '                                         00210200
&ZOPO(&ZOPN)          SETC  'LA'                                        00210300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00210400
&ZOPD(&ZOPN)          SETC  '++ &ZXSYSEVPL XSYSEVPL'                    00210500
.*                                                                      00210600
                      AGO   .ZI7G                                       00210700
.*                                                                      00210800
.ZI7F                 ANOP  ,                                           00210900
&ZCGPR   SETC  '&XSYSEVPL'(2,K'&XSYSEVPL-2)                             00211000
.*                                                                      00211100
.ZI7G                 ANOP  ,                                           00211200
.*                                                                      00211300
&ZOPN                 SETA  &ZOPN+1                                     00211400
&ZOPL(&ZOPN)          SETC  ' '                                         00211500
&ZOPO(&ZOPN)          SETC  'ST'                                        00211600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4(,1)'                              00211700
&ZOPD(&ZOPN)          SETC  '++ &ZXSYSEVPL XSYSEVPL'                    00211800
.*                                                                      00211900
.ZI7H                 ANOP  ,                                           00212000
.*-------------------------------------------------------------------   00212100
.***AI.L18  XCONNTKN XL4                                                00212200
         AIF   ('&XCONNTKN' NE 'NO_CONNTKN').ZI8                        00212300
&ZXCONNTKN            SETC  ''             RESET INPUT/OUTPUT           00212400
.ZI8                  ANOP  ,                                           00212500
.*-------------------------------------------------------------------   00212600
.***AI.L25  XCONNTKN XL4                                                00212700
                      AIF   ('&ZXCONNTKN' EQ '').ZI8E                   00212800
                      AIF   ('&ZXCONNTKN' EQ 'OUTPUT').ZI8E             00212900
&ZCGPR                SETC  '&XCONNTKN'                                 00213000
.*                                                                      00213100
                      AIF   ('&XCONNTKN'(1,1) NE '(').ZI8B              00213200
&ZCGPR   SETC  '0('.'&XCONNTKN'(2,K'&XCONNTKN-2).')'                    00213300
                      AGO   .ZI8D                                       00213400
.ZI8B                 ANOP  ,                                           00213500
.*                                                                      00213600
&ZC                   SETC  '&XCONNTKN'(1,1)                            00213700
                      AIF   (T'&ZC NE 'N').ZI8D                         00213800
&ZC                   SETC  '&XCONNTKN'                                 00213900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI8D                00214000
&ZCGPR                SETC  '=BL4''&XCONNTKN'''                         00214100
.*                                                                      00214200
.ZI8D                 ANOP  ,                                           00214300
.*                                                                      00214400
&ZOPN                 SETA  &ZOPN+1                                     00214500
&ZOPL(&ZOPN)          SETC  ' '                                         00214600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00214700
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             00214800
&ZOPD(&ZOPN)          SETC  '++ &ZXCONNTKN XCONNTKN'                    00214900
.*                                                                      00215000
.ZI8E                 ANOP  ,                                           00215100
.*-------------------------------------------------------------------   00215200
.***AI.L25  XMONTKN XL4                                                 00215300
                      AIF   ('&ZXMONTKN' EQ '').ZI9E                    00215400
                      AIF   ('&ZXMONTKN' EQ 'OUTPUT').ZI9E              00215500
&ZCGPR                SETC  '&XMONTKN'                                  00215600
.*                                                                      00215700
                      AIF   ('&XMONTKN'(1,1) NE '(').ZI9B               00215800
&ZCGPR   SETC  '0('.'&XMONTKN'(2,K'&XMONTKN-2).')'                      00215900
                      AGO   .ZI9D                                       00216000
.ZI9B                 ANOP  ,                                           00216100
.*                                                                      00216200
&ZC                   SETC  '&XMONTKN'(1,1)                             00216300
                      AIF   (T'&ZC NE 'N').ZI9D                         00216400
&ZC                   SETC  '&XMONTKN'                                  00216500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI9D                00216600
&ZCGPR                SETC  '=BL4''&XMONTKN'''                          00216700
.*                                                                      00216800
.ZI9D                 ANOP  ,                                           00216900
.*                                                                      00217000
&ZOPN                 SETA  &ZOPN+1                                     00217100
&ZOPL(&ZOPN)          SETC  ' '                                         00217200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00217300
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00217400
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN XMONTKN'                      00217500
.*                                                                      00217600
.ZI9E                 ANOP  ,                                           00217700
.*-------------------------------------------------------------------   00217800
.***AI.L18  XENDTIME XL8                                                00217900
         AIF   ('&XENDTIME' NE 'CURRENT').ZI10                          00218000
&ZXENDTIME            SETC  ''             RESET INPUT/OUTPUT           00218100
.ZI10                 ANOP  ,                                           00218200
.*-------------------------------------------------------------------   00218300
.***AI.L25  XENDTIME XL8                                                00218400
                      AIF   ('&ZXENDTIME' EQ '').ZI10E                  00218500
                      AIF   ('&ZXENDTIME' EQ 'OUTPUT').ZI10E            00218600
&ZCGPR                SETC  '&XENDTIME'                                 00218700
.*                                                                      00218800
                      AIF   ('&XENDTIME'(1,1) NE '(').ZI10B             00218900
&ZCGPR   SETC  '0('.'&XENDTIME'(2,K'&XENDTIME-2).')'                    00219000
                      AGO   .ZI10D                                      00219100
.ZI10B                ANOP  ,                                           00219200
.*                                                                      00219300
&ZC                   SETC  '&XENDTIME'(1,1)                            00219400
                      AIF   (T'&ZC NE 'N').ZI10D                        00219500
&ZC                   SETC  '&XENDTIME'                                 00219600
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               00219700
&ZCGPR                SETC  '=BL8''&XENDTIME'''                         00219800
.*                                                                      00219900
.ZI10D                ANOP  ,                                           00220000
.*                                                                      00220100
&ZOPN                 SETA  &ZOPN+1                                     00220200
&ZOPL(&ZOPN)          SETC  ' '                                         00220300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00220400
&ZOPV(&ZOPN)          SETC  '16(8,1),&ZCGPR'                            00220500
&ZOPD(&ZOPN)          SETC  '++ &ZXENDTIME XENDTIME'                    00220600
.*                                                                      00220700
.ZI10E                ANOP  ,                                           00220800
.*-------------------------------------------------------------------   00220900
.***AI.L18 ADDR XWORKREQ_STA A                                          00221000
         AIF   ('&XWORKREQ_STA' NE 'IWMEWLMARMSTATUSNONE').ZI14         00221100
&ZXWORKREQ_STA        SETC  ''             RESET INPUT/OUTPUT           00221200
.ZI14                 ANOP  ,                                           00221300
.*-------------------------------------------------------------------   00221400
.***AI.L19 ADDR XWORKREQ_STA A                                          00221500
                      AIF   ('&ZXWORKREQ_STA' EQ '').ZI14H              00221600
&ZCLNG                SETC  '&XWORKREQ_STA'                             00221700
&ZCGPR                SETC  '14'                                        00221800
         AIF   ('&XWORKREQ_STA'(1,1) EQ '(').ZI14F  IN GPR              00221900
.*                                                                      00222000
&ZOPN                 SETA  &ZOPN+1                                     00222100
&ZOPL(&ZOPN)          SETC  ' '                                         00222200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00222300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00222400
&ZOPD(&ZOPN)          SETC  '++ &ZXWORKREQ_STA XWORKREQ_STA'            00222500
.*                                                                      00222600
                      AGO   .ZI14G                                      00222700
.*                                                                      00222800
.ZI14F                ANOP  ,                                           00222900
&ZCGPR   SETC  '&XWORKREQ_STA'(2,K'&XWORKREQ_STA-2)                     00223000
.*                                                                      00223100
.ZI14G                ANOP  ,                                           00223200
.*                                                                      00223300
&ZOPN                 SETA  &ZOPN+1                                     00223400
&ZOPL(&ZOPN)          SETC  ' '                                         00223500
&ZOPO(&ZOPN)          SETC  'ST'                                        00223600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,36(,1)'                             00223700
&ZOPD(&ZOPN)          SETC  '++ &ZXWORKREQ_STA XWORKREQ_STA'            00223800
.*                                                                      00223900
.ZI14H                ANOP  ,                                           00224000
.*-------------------------------------------------------------------   00224100
&ZOPN1                SETA &ZOPN                                        00224200
.*******************************************************************    00224300
.***  PROCESS IWMMNTFY OUTPUT PARAMETERS                                00224400
.*******************************************************************    00224500
                      ACTR  10000                                       00224600
.*******************************************************************    00224700
.***AO.X02  RETURN CODE PROCESSING                                      00224800
.*******************************************************************    00224900
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00225000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00225100
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00225200
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00225300
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00225400
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00225500
&ZOPN                 SETA  &ZOPN+1                                     00225600
&ZOPL(&ZOPN)          SETC  ' '                                         00225700
&ZOPO(&ZOPN)          SETC  'ST'                                        00225800
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00225900
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00226000
                      AGO   .ZMRETX                                     00226100
.*                                                                      00226200
.ZMRET2               ANOP  ,                                           00226300
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00226400
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00226500
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00226600
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00226700
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00226800
&ZOPN                 SETA  &ZOPN+1                                     00226900
&ZOPL(&ZOPN)          SETC  ' '                                         00227000
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00227100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00227200
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00227300
.ZMRETX               ANOP  ,                                           00227400
.*******************************************************************    00227500
.***AO.X03  REASON CODE PROCESSING                                      00227600
.*******************************************************************    00227700
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00227800
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00227900
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00228000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00228100
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00228200
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00228300
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00228400
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00228500
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00228600
&ZOPN                 SETA  &ZOPN+1                                     00228700
&ZOPL(&ZOPN)          SETC  ' '                                         00228800
&ZOPO(&ZOPN)          SETC  'ST'                                        00228900
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00229000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00229100
                      AGO   .ZMRSNX                                     00229200
.*                                                                      00229300
.ZMRSN2               ANOP  ,                                           00229400
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00229500
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00229600
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00229700
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00229800
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00229900
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00230000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00230100
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00230200
&ZOPN                 SETA  &ZOPN+1                                     00230300
&ZOPL(&ZOPN)          SETC  ' '                                         00230400
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00230500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00230600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00230700
.ZMRSNX               ANOP  ,                                           00230800
.*******************************************************************    00230900
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00231000
.*******************************************************************    00231100
.ZMFLX                ANOP  ,              MF=L PROCESSING              00231200
.*******************************************************************    00231300
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00231400
.*******************************************************************    00231500
                      ACTR  10000                                       00231600
.*                                                                      00231700
                      LCLA  &ZLC           COLUMN POSITION              00231800
                      LCLA  &ZOPX          LIST TABLE INDEX             00231900
                      LCLC  &ZLL           LABEL                        00232000
                      LCLC  &ZLOP          OPERATION                    00232100
                      LCLC  &ZLV           VALUE                        00232200
                      LCLC  &ZLD           DESCRIPTION                  00232300
.*                                                                      00232400
&ZOPX                 SETA  1                                           00232500
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00232600
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00232700
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00232800
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00232900
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00233000
                      AIF   (K'&ZLD LE 0).ZL5                           00233100
&ZLC                  SETA  35             COMMENT COLUMN               00233200
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00233300
&ZLC                  SETA  33             COMMMENT COLUMN              00233400
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00233500
&ZLV                  SETC  '&ZLV'.' '                                  00233600
                      AGO   .ZL3                                        00233700
.*                                                                      00233800
.ZL4                  ANOP  ,                                           00233900
&ZLV                  SETC  '&ZLV'.' '                                  00234000
.ZL5                  ANOP  ,                                           00234100
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00234200
.*                                                                      00234300
&ZLL     &ZLOP &ZLV                                                     00234400
.*                                                                      00234500
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00234600
                      AGO   .ZL2           CONTINUE LOOPING             00234700
.*                                                                      00234800
.ZLX                  ANOP  ,                                           00234900
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00235000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00235100
         L     14,16(0,0)              GET CVT ADDRESS                  00235200
         TM    CVTOSLV1-CVT(14),X'40'      TEST FOR WLM PRESENCE        00235300
         BO    WLM&SYSNDX              BRANCH WHEN WLM IS PRESENT       00235400
        AIF   ('&XTRAXFRPT' EQ 'YES').NTFYSYS BRANCH IF SYSEVENT NEEDED 00235500
         LA    0,IwmRsnCodeCompatNoSyseventRqd SET REASON CODE = NO WLM 00235600
         LA    15,IWMRETCODEWARNING    SET WARNING RETURN CODE          00235700
         B     END&SYSNDX              BRANCH TO END LABEL              00235800
         AGO    .NTFYWLM                                                00235900
.NTFYSYS ANOP                                                           00236000
         L     1,4(1,0)                ESTABLISH THE SYSEVENT PL ADDR   00236100
         SYSEVENT TRAXFRPT,ENTRY=BRANCH                                 00236200
         LTR   15,15                                                    00236300
         BZ    END&SYSNDX              BRANCH TO END WHEN SUCCESSFUL    00236400
         LA    0,IWMRETCODEENVERROR                                     00236500
         CR    15,0                                                     00236600
         BE    R12&SYSNDX              BRANCH WHEN SYSEVENT RC=12       00236700
         DS    0H                      SYSEVENT RC = 8 (NO WORK ELT)    00236800
         LR    15,0                    SET RC = IWMRETCODEENVERROR      00236900
         LA    0,IWMRSNCODESYSEVENTNOWORKELT  SET REASONCODE            00237000
         B     END&SYSNDX              BRANCH TO END LABEL              00237100
R12&SYSNDX DS    0H                    SYEVENT RC=12 (REPORTING SUSP)   00237200
         LA    0,IWMRSNCODEREPORTINGSUSP      SET REASONCODE            00237300
         B     END&SYSNDX              BRANCH TO END LABEL              00237400
.NTFYWLM   ANOP                        CODE GENERATION FOR WLM PRESENT  00237500
*                                                                       00237600
WLM&SYSNDX DS    0H                    BRANCH LABEL FOR WLM PRESENT     00237700
         AIF   ('&XENDTIME' NE 'CURRENT').NTFYENDTIME                   00237800
         STCK  16(1)                   SAVE TOD IN P.L.                 00237900
         BC    8,IWMMNTFY_TIMEOK&SYSNDX BRANCH WHEN STCK CC=0           00238000
         LA    0,IWMRSNCODENOENDTIME   SET REASONCODE                   00238100
         LA    15,IWMRETCODEENVERROR   SET RC = IWMRETCODEENVERROR      00238200
         B     IWMMNTFY_FINIS&SYSNDX   BRANCH TO THE END                00238300
IWMMNTFY_TIMEOK&SYSNDX DS 0H           BRANCH LABEL FOR STCK CC=0       00238400
.NTFYENDTIME ANOP                      BRANCH LABEL WHEN ENDTIME GIVEN  00238500
         L     14,X'8C'(14,0)          GET ECVT ADDRESS                 00238600
         L     14,X'C4'(14,0)          GET WMVT ADDRESS                 00238700
         L     15,X'108'(14,0)         GET NOTIFY RTN ENTRY POINT ADDR  00238800
         BASR  14,15                   CALL NOTIFY ROUTINE              00238900
         AIF   ('&XENDTIME' NE 'CURRENT').NTFYEND                       00239000
IWMMNTFY_FINIS&SYSNDX DS 0H            BRANCH LABEL FOR STCK NON-0 CC   00239100
.NTFYEND     ANOP                                                       00239200
END&SYSNDX DS    0H                    END LABEL                        00239300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00239400
.ZLINKX               ANOP  ,                                           00239500
.*******************************************************************    00239600
.***AP.X01  FORMAT GENERATED CODE                                       00239700
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00239800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00239900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00240000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00240100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00240200
                      AIF   (K'&ZLD LE 0).ZL51                          00240300
&ZLC                  SETA  35             COMMENT COLUMN               00240400
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00240500
&ZLC                  SETA  33             COMMENT COLUMN               00240600
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00240700
&ZLV                  SETC  '&ZLV'.' '                                  00240800
                      AGO   .ZL31                                       00240900
.*                                                                      00241000
.ZL41                 ANOP  ,                                           00241100
&ZLV                  SETC  '&ZLV'.' '                                  00241200
.ZL51                 ANOP  ,                                           00241300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00241400
.*                                                                      00241500
&ZLL     &ZLOP &ZLV                                                     00241600
.*                                                                      00241700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00241800
                      AGO   .ZL21          CONTINUE LOOPING             00241900
.*                                                                      00242000
.ZLX1                 ANOP  ,                                           00242100
.*******************************************************************    00242200
.***AP.X02  END OF IWMMNTFY MACRO                                       00242300
&ZIWMMNTFY            SETC  'YES'          SET IWMMNTFY USED            00242400
         POP   PRINT                                                    00242500
*                                            IWMMNTFY-1                 00242600
         SPACE 1                                                        00242700
.ZLX2                 ANOP  ,                                           00242800
         MEND                                                           00242900
**********************************************************************/ 00243000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00243100
*%IWMMNTFY: MACRO KEYS(TRAXFRPT,SYSEVPL,MONTKN,COMPLETION,              00243200
*                 DISASSOCIATE,WORKREQ_STA,CONNTKN,ENDTIME,RETCODE,     00243300
*                 RSNCODE,PLISTVER,MF);                                 00243400
*  ANS('?'!!MACLABEL!!' '!!'IWMMNTFP '!!MACLIST!!                       00243500
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00243600
*%END IWMMNTFY;                                                         00243700

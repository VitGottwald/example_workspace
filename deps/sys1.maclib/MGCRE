*/*                                                                     00010000
         MACRO                                                          00020000
&NAME    MGCRE &MF=^,&TEXT=^,&CMDFLAG=^,&CONSID=^,&CONSNAME=^,         X00030000
               &TOKEN=^,&CART=^,&UTOKEN=^,&ENVRIN=^,&PLISTVER=^,       X00040001
               &AUTHCMDX=^                                         @05C 00050001
.*********************************************************************  00060000
.*                                                                   *  00070000
.*01* MACRO NAME = MGCRE                                             *  00080000
.*                                                                   *  00090000
.*01* DESCRIPTIVE NAME = MGCRE MACRO                                 *  00100000
.*                                                                   *  00110000
.*01* EXTERNAL CLASSIFICATION: PI                                    *  00120000
.*    END OF EXTERNAL CLASSIFICATION                                 *  00130000
.*                                                                   *  00140000
.**01* PROPRIETARY STATEMENT=                                        *  00150001
.* **PROPRIETARY_STATEMENT********************************************  00160001
.*                                                                   *  00170000
.*                LICENSED MATERIALS - PROPERTY OF IBM               *  00180000
.*                5694-A01  COPYRIGHT IBM CORP. 1990, 2003           *  00190000
.*                                                                   *  00200000
.*01* STATUS    = HBB7707                                            *  00210000
.*                                                                   *  00220000
.* **END_OF_PROPRIETARY_STATEMENT*************************************  00230001
.*                                                                   *  00240000
.*01* FUNCTION  =                                                    *  00250000
.*                                                                   *  00260000
.*       THE MGCRE MACRO IS USED TO BUILD A PARAMETER LIST           *  00270000
.*       FOR SVC 34 COMMAND PROCESSING.                              *  00280000
.*                                                                   *  00290000
.*                                                                   *  00300000
.*02* OPERATION =                                                    *  00310000
.*                                                                   *  00320000
.*       MGCRE AS AN INTERFACE FOR SVC 34 COMMANDS WILL:             *  00330000
.*         - BUILD THE MGCRE PARAMETER LIST WITH THE PARAMETERS      *  00340000
.*           SUPPLIED BY THE ISSUER                                  *  00350000
.*         - PLACE THE ADDRESS OF THE PARAMETER LIST INTO REGISTER 1 *  00360000
.*         - ISSUE SVC 34                                            *  00370000
.*                                                                   *  00380000
.*01* USAGE     =                                                    *  00390000
.*                                                                   *  00400000
.*       THIS MACRO MAY BE USED BY AUTHORIZED USERS TO BUILD THE     *  00410000
.*       MGCRE PARAMETER LIST AND ISSUE SVC 34.                      *  00420000
.*                                                                   *  00430000
.*01* INVOCATION =                                                   *  00440000
.*                                                                   *  00450000
.*     SPECIFY:     MGCRE  TEXT=,CMDFLAG=,CONSID=,CONSNAME=,         *  00460000
.*                         TOKEN=,MF=,CART=,UTOKEN=,ENVRIN=,      @04C  00470001
.*                         PLISTVER=,AUTHCMDX=                    @05C  00480001
.*                                                                   *  00490000
.*                                                                   *  00500000
.*     WHERE:       TEXT     = POINTER TO A DATA AREA CONTAINING     *  00510000
.*                             THE 2-BYTE COMMAND TEXT LENGTH        *  00520000
.*                             IMMEDIATELY FOLLOWED BY THE COMMAND   *  00530000
.*                             TEXT.  IF A REGISTER IS USED, IT      *  00540000
.*                             CONTAINS THE ADDRESS OF A DATA        *  00550000
.*                             AREA CONTAINING THE COMMAND TEXT      *  00560000
.*                             LENGTH FOLLOWED BY THE COMMAND TEXT.  *  00570000
.*                             THE MAXIMUM LENGTH OF THE TEXT IS     *  00580000
.*                             126 CHARACTERS.                       *  00590000
.*                                                                   *  00600000
.*                  CMDFLAG  = THIS FIELD IS OPTIONAL. VALID         *  00610000
.*                             VALUES ARE:                           *  00620000
.*                             COMMTASK - COMMAND WAS RE-ISSUED      *  00630000
.*                                        INTERNALLY BY IEAVC700     *  00640000
.*                                        (COMM TASK COMMAND QUEUER).*  00650000
.*                                        THIS OPERAND IS MUTUALLY   *  00660000
.*                                        EXCLUSIVE WITH SUBSYS      *  00670000
.*                                        AND TSO.                @L3C  00680000
.*                                                                   *  00690000
.*                             SUBSYS   - COMMAND WAS ISSUED BY A    *  00700000
.*                                        SUBSYSTEM OUT OF THE SSI.  *  00710000
.*                                        THIS OPERAND IS MUTUALLY   *  00720000
.*                                        EXCLUSIVE WITH COMMTASK    *  00730000
.*                                        AND TSO.                @L3C  00740000
.*                                                                   *  00750000
.*                             NOHCPY   - COMMAND IS NOT TO BE       *  00760000
.*                                        HARDCOPIED.                *  00770000
.*                                                                   *  00780000
.*                             TSO      - COMMAND WAS ISSUED BY A    *  00790000
.*                                        TSO OPERATOR, CONSID WILL  *  00800000
.*                                        CONTAIN THE TJID.  THIS    *  00810000
.*                                        OPERAND IS MUTUALLY        *  00820000
.*                                        EXCLUSIVE WITH COMMTASK    *  00830000
.*                                        AND SUBSYS.             @L3A  00840000
.*                                                                   *  00850000
.*                  CONSID   = CONTAINS 4-BYTE CONSOLE ID OF THE     *  00860000
.*                             CONSOLE ISSUING THE COMMAND. IF A     *  00870000
.*                             REGISTER IS USED, IT CONTAINS A       *  00880000
.*                             4-BYTE CONSOLE ID. THIS KEYWORD IS    *  00890000
.*                             MUTUALLY EXCLUSIVE WITH CONSNAME.     *  00900000
.*                             CONSID WILL CONTAIN THE TJID IF       *  00910000
.*                             CMDFLAG=TSO.                       @L3C  00920000
.*                                                                   *  00930000
.*                  CONSNAME = CONTAINS A 2-8 CHARACTER CONSOLE      *  00940000
.*                             NAME, LEFT JUSTIFIED AND PADDED       *  00950000
.*                             WITH BLANKS. IF A REGISTER IS USED,   *  00960000
.*                             IT CONTAINS THE ADDRESS OF AN         *  00970000
.*                             8-BYTE FIELD CONTAINING THE 2-8       *  00980000
.*                             CHARACTER CONSOLE NAME.  THIS KEYWORD *  00990000
.*                             IS MUTUALLY EXCLUSIVE WITH CONSID.    *  01000000
.*                                                                   *  01010000
.*                  TOKEN      CONTAINS A 31-BIT RIGHT            @01C  01020000
.*                             JUSTIFIED TOKEN THAT IS            @01C  01030000
.*                             ASSOCIATED WITH THIS COMMAND. IF   @01C  01040000
.*                             A REGISTER IS USED, THE REGISTER   @01C  01050000
.*                             WILL CONTAIN A 31-BIT RIGHT        @01A  01060000
.*                             JUSTIFIED TOKEN.  THIS FIELD IS    @01A  01070000
.*                             OPTIONAL.                          @01A  01080000
.*                                                                *     01090000
.*                  CART     = CONTAINS THE                       @03C  01100000
.*                             8-BYTE COMMAND AND RESPONSE TOKEN  @L1A  01110000
.*                             (CART).  IF A REGISTER IS USED, IT @L1A  01120000
.*                             SPECIFIES A 31-BIT ADDRESS         @L1A  01130000
.*                             POINTER TO THE CART.  THIS FIELD   @L1A  01140000
.*                             IS OPTIONAL.                       @L1A  01150000
.*                                                                   *  01160000
.*                  UTOKEN   = POINTER TO A DATA AREA CONTAINING  @D1A  01170000
.*                             A SECURITY TOKEN (UTOKEN).         @D1A  01180000
.*                             IT IS USED IN SVC 34 PROCESSING    @D1A  01190000
.*                             TO CHECK THE ISSUER'S AUTHORITY.   @D1A  01200000
.*                             IF A REGISTER IS USED, IT          @D1A  01210000
.*                             CONTAINS THE ADDRESS OF A DATA     @D1A  01220000
.*                             AREA CONTAINING THE UTOKEN.        @D1A  01230000
.*                             THIS FIELD IS OPTIONAL.            @D1A  01240000
.*                                                                @D1A  01250000
.*                  ENVRIN   = POINTER TO THE ENVR SECURITY       @04A  01260000
.*                             STRUCTURE.  THIS FIELD IS          @04A  01270000
.*                             OPTIONAL.  IF SPECIFIED THEN       @04A  01280000
.*                             UTOKEN MUST ALSO BE SPECIFIED.     @04A  01290000
.*                                                                @04A  01300000
.*                  AUTHCMDX = POINTER TO DATA STRUCTURE          @05A  01310001
.*                             DEPICTING THE ISSUER'S AUTHORITY   @05A  01320001
.*                             STRUCTURED LIKE CMDXAUTH.          @05A  01330001
.*                               16 BIT STRUCTURE                 @05A  01340001
.*                             1000000000000000 - MASTER AUTH     @05A  01350001
.*                             0100000000000000 - SYS AUTHORITY   @05A  01360001
.*                             0010000000000000 - IO AUTHORITY    @05A  01370001
.*                             0001000000000000 - CONS AUTHORITY  @05A  01380001
.*                             0000000000000000 - INFO AUTHORITY  @05A  01390001
.*                                                                @05A  01400001
.*                  PLISTVER = IS AN OPTIONAL BYTE INPUT DECIMAL  @04A  01410000
.*                             VALUE IN THE "1-3" RANGE THAT      @04A  01420000
.*                             SPECIFIES THE MACRO VERSION.       @04A  01430000
.*                             PLISTVER IS THE ONLY KEY ALLOWED   @04A  01440000
.*                             ON THE LIST FORM OF MF AND         @04A  01450000
.*                             DETERMINES WHICH PARAMETER LIST    @04A  01460000
.*                             IS GENERATED.  THE MACRO KEYS      @04A  01470000
.*                             ASSOCIATED WITH EACH SUPPORTED     @04A  01480000
.*                             VERSION OF THE MACRO ARE LISTED    @04A  01490000
.*                             IN MACRO USAGE NOTE 1.  NOTE THAT  @04A  01500000
.*                             MAX MAY BE SPECIFIED INSTEAD OF A  @04A  01510000
.*                             NUMBER, AND THE PARAMETER LIST WILL@04A  01520000
.*                             BE OF THE LARGEST SIZE CURRENTLY   @04A  01530000
.*                             SUPPORTED.  THIS SIZE MAY GROW     @04A  01540000
.*                             FROM RELEASE TO RELEASE (THUS      @04A  01550000
.*                             POSSIBLY AFFECTING THE AMOUNT OF   @04A  01560000
.*                             STORAGE NEEDED BY YOUR PROGRAM).   @04A  01570000
.*                             IF YOUR PROGRAM CAN TOLERATE THIS, @04A  01580000
.*                             IBM RECOMMENDS THAT YOU ALWAYS     @04A  01590000
.*                             SPECIFY MAX WHEN CREATING THE LIST @04A  01600000
.*                             FORM PARAMETER LIST AS THAT WILL   @04A  01610000
.*                             ENSURE THAT THE LIST FORM PARAMETER@04A  01620000
.*                             LIST IS ALWAYS LONG ENOUGH TO HOLD @04A  01630000
.*                             WHATEVER PARAMETERS MIGHT BE       @04A  01640000
.*                             SPECIFIED ON THE EXECUTE FORM      @04A  01650000
.*                             DEFAULT: 1                         @04A  01660000
.*                                                                @04A  01670000
.*                  MF       = SPECIFIES THE TYPE OF EXPANSION       *  01680000
.*                             THAT IS REQUIRED.  VALID VALUES       *  01690000
.*                             ARE: E OR L.                          *  01700000
.*                                                                   *  01710000
.*01* DEPENDENCIES    = NONE                                         *  01720000
.*                                                                   *  01730000
.*01* CHANGE ACTIVITY =                                              *  01740000
.*      $L0 = CNMGEMG, HBB4410, 870424, PDU9: CONSOLE MERGE STAGE II *  01750000
.*      $L1 = TSOOP,   HBB4410, 870831, PDDI: TSO OPERATOR           *  01760000
.*      $L2 = TSOOP7CW HBB4410, 880420, PDCW: TSO OPERATOR           *  01770000
.*      $D1 = DCR238,  HBB4410, 890814, PDEF: SP410 BARLOW SUPPORT   *  01780000
.*      $01 = OY38182, HBB4410, 910110, PDHE: DEFINE TOKEN AS 31-BIT *  01790000
.*                                            TO MATCH MGCR          *  01800000
.*      $02 = OY60067, HBB4410, 930107, PDCM: UTOKEN REGISTER VALUE  *  01810000
.*      $03 = OW13765, HBB5510, 950731, PDHL: FIX COMMENTS           *  01820000
.*      $L3 = CSTAR,   JBB7727, 030215, PDKP: MGCRE FROM TSO         *  01830000
.*      $04 = OA35671, HBB7760, 110911, PDED: ENVRIN                 *  01840000
.*      $05 = OA39026, HBB7770, 120313, PDED: AUTHCMDX               *  01850000
.*                                                                   *  01860000
.*01* MACROS          = THE PARAMETER LIST GENERATED BY THIS MACRO   *  01870000
.*                      IS MAPPED BY IEZMGCRE.  HOWEVER, IEZMGCRE    *  01880000
.*                      NOT REQUIRED TO USE THIS MACRO.              *  01890000
.*                                                                   *  01900000
.*01* MESSAGES =  THE MGCRE MACRO WILL ISSUE THE FOLLOWING           *  01910000
.*                MNOTES UPON THE DETECTION OF SYNTAX ERRORS:        *  01920000
.*                                                                   *  01930000
.*                                                                   *  01940000
.*02*  WARNING = (SEVERITY 4)                                        *  01950000
.*                                                                   *  01960000
.*         CMDFLAG KEYWORD IGNORED.  'FFFFFFFF' VALUE IS NOT         *  01970000
.*          VALID.                                                   *  01980000
.*                                                                   *  01990000
.*         'KKKKKKKK' KEYWORD IGNORED.  NO DATA SPECIFIED.           *  02000000
.*                                                                   *  02010000
.*         'KKKKKKKK' DATA IGNORED.  NO KEYWORDS PERMITTED ON THE    *  02020000
.*           LIST FORM OF MGCRE.                                     *  02030000
.*                                                                   *  02040000
.*          KKKKKKKK(X,Y) HAS TOO MANY ARGUMENTS. ARGUMENTS          *  02050000
.*           IGNORED AFTER X.                                        *  02060000
.*                                                                   *  02070000
.*          KKKKKKKK(X,Y,Z) HAS TOO MANY ARGUMENTS. ARGUMENTS        *  02080000
.*           IGNORED AFTER Z.                                        *  02090000
.*                                                                   *  02100000
.*                                                                   *  02110000
.*                                                                   *  02120000
.*     WHERE:  'FFFFFFFF' IS NOT COMMTASK, SUBSYS, NOHCPY OR TSO  @L3C  02130000
.*             'KKKKKKKK' MAY BE CONSID, CONSNAME, TOKEN, TEXT,      *  02140000
.*             CMDFLAG, UTOKEN, ENVRIN, OR AUTHCMDX               @05C  02150001
.*             X, Y, AND Z ARE ARBITRARY ARGUMENTS                   *  02160000
.*                                                                   *  02170000
.*02*  ERROR = (SEVERITY 12)                                         *  02180000
.*                                                                   *  02190000
.*         NO TEXT GENERATED. 'MF' VALUE IS NOT VALID.               *  02200000
.*                                                                   *  02210000
.*         NO TEXT GENERATED. 'MF' VALUE IS NOT SPECIFIED.           *  02220000
.*                                                                   *  02230000
.*         NO TEXT GENERATED. 'TEXT' VALUE IS REQUIRED BUT NOT       *  02240000
.*          SUPPLIED.                                                *  02250000
.*                                                                   *  02260000
.*         NO TEXT GENERATED.  'CMDFLAG=SUBSYS' IS MUTUALLY          *  02270000
.*          EXCLUSIVE WITH 'CMDFLAG=COMMTASK'.                       *  02280000
.*                                                                   *  02290000
.*         NO TEXT GENERATED.  'CMDFLAG=TSO' IS MUTUALLY             *  02300000
.*          EXCLUSIVE WITH 'CMDFLAG=COMMTASK'.                    @L3A  02310000
.*                                                                   *  02320000
.*         NO TEXT GENERATED.  'CMDFLAG=TSO' IS MUTUALLY             *  02330000
.*          EXCLUSIVE WITH 'CMDFLAG=SUBSYS'.                      @L3A  02340000
.*                                                                   *  02350000
.*         NO TEXT GENERATED.  'CONSNAME' IS MUTUALLY EXCLUSIVE      *  02360000
.*          WITH 'CONSID'.                                           *  02370000
.*                                                                   *  02380000
.*         NO TEXT GENERATED.  CONSID OR CONSNAME IS REQUIRED        *  02390000
.*          BUT NOT SUPPLIED.                                        *  02400000
.*                                                                   *  02410000
.*         NO TEXT GENERATED.  CONSID IS REQUIRED IF 'CMDFLAG=TSO'   *  02420000
.*          IS SPECIFIED.                                         @L3A  02430000
.*                                                                   *  02440000
.*         NO TEXT GENERATED.  UTOKEN IS REQUIRED IF ENVRIN IS       *  02450000
.*          SPECIFIED.                                            @04A  02460000
.*                                                                   *  02470000
.*                                                                   *  02480000
.*01* ABEND CODES    = NONE                                          *  02490000
.*                                                                   *  02500000
.*01* MACRO USAGE NOTES:                                             *  02510000
.*    1.THE  MGCRE  MACRO  SUPPORTS MULTIPLE VERSIONS. THE MACRO KEY *  02520000
.*      LIST  BELOW  CONTAINS THE VERSION LEVEL IN WHICH THE KEY WAS *  02530000
.*      FIRST  INTRODUCED.  THE LOWEST VALUE  REPRESENTS THE ORIGNAL *  02540000
.*      VERSION  AND THE  HIGHEST VALUE  REPRESENTS THE  MOST RECENT *  02550000
.*      VERSION OF THE  MGCRE MACRO.  WHEN  SPECIFYING  PLISTVER, BE *  02560000
.*      SURE THAT  IT IS  AT LEAST  AS HIGH  AS THE  HIGHEST VERSION *  02570000
.*      NUMBER OF ALL THE KEYS BEING USED.                           *  02580000
.*                                                                   *  02590000
.*      VERSION   KEY                                                *  02600000
.*                                                                   *  02610000
.*            1      AUTHCMDX                                    @05A*  02620001
.*                   CART                                            *  02630001
.*                   CMDFLAG                                         *  02640000
.*                   CONSID                                          *  02650000
.*                   CONSNAME                                        *  02660000
.*                   PLISTVER                                        *  02670000
.*                   TEXT                                            *  02680000
.*                   TOKEN                                           *  02690000
.*                   UTOKEN                                          *  02700000
.*            3      ENVRIN                                          *  02710000
.*                                                                   *  02720000
.*********************************************************************  02730000
.*                                                                   *  02740000
.*********************************************************************  02750000
.*       L O C A L  D E C L A R A T I O N S                          *  02760000
.*********************************************************************  02770000
         LCLA  &CNT                     COUNTER FOR COMMAND FLAGS       02780000
         LCLA  &I                       COUNTER FOR GENERATING PARMLIST 02790000
         LCLA  &INDX                    COUNTER FOR CLEARING FLAG  @L1A 02800000
         LCLA  &FLG2VAL                 ACCUMULATOR VALUE          @L1A 02810000
         LCLA  &XPLISTVER               PLISTVER VALUE             @04A 02820000
         LCLA  &ZN                      NUMERIC WORK VARIABLE      @04A 02830000
         LCLB  &IDSPEC                  CONSOLE ID SPECIFIED            02840000
         LCLB  &NMSPEC                  CONSOLE NAME SPECIFIED          02850000
         LCLB  &FLG(8)                  COMMAND FLAGS                   02860000
         LCLB  &FLG2(8)                 COMMAND FLAG - BYTE 2           02870000
         LCLB  &TEXTOK                  TEXT VALUE SPECIFIED CORRECTLY  02880000
         LCLB  &CIDOK                   CONSID VALUE SPECIFIED         X02890000
                                        CORRECTLY                       02900000
         LCLB  &CNMEOK                  CONSNAME VALUE SPECIFIED       X02910000
                                        CORRECTLY                       02920000
         LCLB  &FLGSOK                  CMDFLAG VALUES SPECIFIED       X02930000
                                        CORRECTLY                       02940000
         LCLB  &TKNOK                   TOKEN VALUE SPECIFIED CORRECTLY 02950000
         LCLB  &CARTOK                  CART VALUE SPECIFIED       @L1AX02960000
                                        CORRECTLY                  @L1A 02970000
         LCLB  &UTKNOK                  UTOKEN VALUE SPECIFIED     @D1AX02980000
                                        CORRECTLY                  @D1A 02990000
         LCLB  &ENVROK                  ENVRIN VALUE SPECIFIED         X03000000
                                        CORRECTLY                  @04A 03010000
         LCLB  &FLGS2OK                 CMDFLAG VALUES SPECIFIED       X03020000
                                        CORRECTLY                  @D1A 03030000
         LCLC  &GNAME                   LOCAL NAME USED FOR BRANCHS     03040000
         LCLB  &FLGS3OK                 CMDFLAG VALUES SPECIFIED       X03050000
                                        CORRECTLY                  @L3A 03060000
         LCLB  &AUTHCXOK                AUTHCMDX SPECIFIED CORRECTLY   X03070000
                                                                   @05A 03080000
.*********************************************************************  03090000
         ACTR  30000                                                    03100000
&GNAME   SETC  'IHB'.'&SYSNDX'                                          03110000
.*********************************************************************  03120000
.*       I N I T I A L I Z E  V A R I A B L E S                      *  03130000
.*********************************************************************  03140000
&CNT     SETA  0                        INITIALIZE COUNTER TO ZERO      03150000
&FLG2VAL SETA  0                        INITIALIZE FLAGS VALUE TO ZERO  03160000
&IDSPEC  SETB  0                        INDICATE CONSID NOT SPECIFIED   03170000
&NMSPEC  SETB  0                        INDICATE CONSNAME NOT SPECIFIED 03180000
&TEXTOK  SETB  0                        USED TO VERIFY THAT TEXT VALUE X03190000
                                        WAS SPECIFIED CORRECTLY         03200000
&CIDOK   SETB  0                        USED TO VERIFY THAT CONSID     X03210000
                                        VALUE WAS SPECIFIED CORRECTLY   03220000
&CNMEOK  SETB  0                        USED TO VERIFY THAT CONSNAME   X03230000
                                        VALUE WAS SPECIFIED CORRECTLY   03240000
&FLGSOK  SETB  0                        USED TO VERIFY THAT CMDFLAG    X03250000
                                        VALUE WAS SPECIFIED CORRECTLY   03260000
&TKNOK   SETB  0                        USED TO VERIFY THAT TOKEN      X03270000
                                        VALUE WAS SPECIFIED CORRECTLY   03280000
&CARTOK  SETB  0                        USED TO VERIFY THAT CART   @L1AX03290000
                                        VALUE WAS SPEC'ED CORRECTLY@L1A 03300000
&UTKNOK  SETB  0                        USED TO VERIFY THAT UTOKEN     X03310000
                                        VALUE WAS SPEC'D CORRECTLY @D1A 03320000
&ENVROK  SETB  0                        USED TO VERIFY THAT ENVRIN     X03330000
                                        VALUE WAS SPEC'D CORRECTLY @04A 03340000
&FLGS2OK SETB  0                        USED TO VERIFY THAT CMDFLAG    X03350000
                                        VALUE WAS SPEC'D CORRECTLY @D1A 03360000
&FLGS3OK SETB  0                        USED TO VERIFY THAT CMDFLAG    X03370000
                                        VALUE WAS SPEC'D CORRECTLY @L3A 03380000
&AUTHCXOK SETB  0                       USED TO VERIFY THAT AUTHCMDX   X03390001
                                        VALUE WAS SPEC'D CORRECTLY @05A 03400001
.*-------------------------------------------------------*.        @04A 03410001
.*       PROCESS PLISTVER                                *.        @04A 03420001
.*-------------------------------------------------------*.        @04A 03430001
&XPLISTVER      SETA  1                                                 03440001
                AIF   ('&PLISTVER' NE '^').ZPL1                         03450001
                AIF   ('&ENVRIN' EQ '^').ZPVCKE                         03460001
&XPLISTVER      SETA  3                                                 03470001
                AGO   .ZPVCKE                                           03480001
.ZPL1           ANOP  ,                                                 03490001
                AIF   (N'&PLISTVER LE 1).EPLISTVER  TOO MANY ARGUMENTS X03500001
                                           ON PLISTVER KEYWORD     @04A 03510001
                MNOTE 4,' ''PLISTVER=&PLISTVER'' HAS TOO MANY ARGUMENTSX03520001
                      .  ARGUMENTS IGNORED AFTER &PLISTVER(1,1) .' @04A 03530001
.EPLISTVER      ANOP  ,                                                 03540001
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPL2                    03550001
&XPLISTVER      SETA  3                                                 03560001
                AGO   .ZPVCKE                                           03570001
.ZPL2           ANOP  ,                                                 03580001
&ZN             SETA  &PLISTVER(1)     CONVERT TO ARITHMETIC            03590001
                AIF   (&ZN LT 1).ZPL3                                   03600001
                AIF   (&ZN LE 3).ZPL4                                   03610001
.ZPL3           ANOP  ,                                                 03620001
                MNOTE 8,'PLISTVER='&PLISTVER' IS OUT OF THE VALID RANGEX03630001
                OF (1-3).'                                              03640001
                AGO   .ZPVCKE                                           03650001
.ZPL4           ANOP  ,                                                 03660001
&XPLISTVER      SETA  &ZN                                               03670001
.ZPVCKE         ANOP  ,                                                 03680001
.*-------------------------------------------------------------------   03690001
.*-------------------------------------------------------*.        @L1A 03700000
.*       INITIALIZE FLAGS FOR FLAG BYTE 2 TO ZERO        *.        @L1A 03710000
.*-------------------------------------------------------*.        @L1A 03720000
&INDX    SETA  1                                         *.        @L1A 03730000
.CLRFLGS ANOP                                            *.        @L1A 03740000
&FLG(&INDX) SETB  0                                      *.        @L1A 03750000
&FLG2(&INDX) SETB  0                                     *.        @D1A 03760000
&FLG3(&INDX) SETB  0                                     *.        @L3A 03770000
&INDX    SETA  &INDX+1                                   *.        @L1A 03780000
         AIF   (&INDX LT 9).CLRFLGS                      *.        @L1A 03790000
.*-------------------------------------------------------*.        @L1A 03800000
.START   ANOP                                                           03810000
         AIF   ('&MF' NE '^').MFSPEC      MF KEYWORD SPECIFIED ?        03820000
         MNOTE 12,' NO TEXT GENERATED. ''MF'' VALUE IS NOT SPECIFIED.'  03830000
         AGO   .EXIT                                                    03840000
.MFSPEC  ANOP                                                           03850000
         AIF   ('&MF' NE '').MFLORE       MF KEYWORD IS LIST OR EXEC    03860000
         MNOTE 12,' NO TEXT GENERATED. ''MF'' VALUE IS NOT SPECIFIED.'  03870000
         AGO   .EXIT                                                    03880000
.MFLORE  ANOP                                                           03890000
         AIF   ('&MF(1)' EQ 'L').MFLIST   LIST FORM SPECIFIED ?         03900000
         AIF   ('&MF(1)' EQ 'E').MFEXEC   EXEC FORM SPECIFIED ?         03910000
         MNOTE 12,' NO TEXT GENERATED. ''MF'' VALUE IS NOT VALID.'      03920000
         AGO   .EXIT                                                    03930000
.*********************************************************************  03940000
.*       L I S T  F O R M                                            *  03950000
.*********************************************************************  03960000
.MFLIST  ANOP                         LIST FORM WAS SPECIFIED           03970000
&NAME    DS    0H                      MGCRE PARAMTER LIST              03980000
         AIF   (N'&MF LE 2).LTVALID   VERIFY NO PARAMETERS ON LIST FORM 03990001
         MNOTE 4,' ''MF=&MF'' HAS TOO MANY ARGUMENTS..'                 04000001
.*********************************************************************  04010000
.*       ONLY PLISTVER IS ALLOWED ON THE LIST FORM OF MGCRE.  IF     *  04020001
.*       ANY OTHER KEYWORDS ARE SPECIFIED THEY WILL BE IGNORED.      *  04030001
.*********************************************************************  04040000
.LTVALID ANOP                             LIST FORM SPECIFIED CORRECTLY 04050000
         AIF   ('&TEXT' EQ '^').LFLAG     TEXT VALUE SPECIFIED ?        04060000
         MNOTE 4,' ''TEXT'' DATA IGNORED.  NO KEYWORDS PERMITTED ON THEX04070000
                LIST FORM OF MGCRE.'                                    04080000
.LFLAG   ANOP                                                           04090000
         AIF   ('&CMDFLAG' EQ '^').LCID     CMDFLAG VALUE SPECIFIED ?   04100000
         MNOTE 4,' ''CMDFLAG'' DATA IGNORED.  NO KEYWORDS PERMITTED ON X04110000
               THE LIST FORM OF MGCRE.'                                 04120000
.LCID    ANOP                                                           04130000
         AIF   ('&CONSID' EQ '^').LCNAME    CONSID VALUE SPECIFIED ?    04140000
         MNOTE 4,' ''CONSID'' DATA IGNORED.  NO KEYWORDS PERMITTED ON TX04150000
               HE LIST FORM OF MGCRE.'                                  04160000
.LCNAME  ANOP                                                           04170000
         AIF   ('&CONSNAME' EQ '^').LTOKEN  CONSNAME VALUE SPECIFIED ?  04180000
         MNOTE 4,' ''CONSNAME'' DATA IGNORED. NO KEYWORDS PERMITTED ON X04190000
               THE LIST FORM OF MGCRE.'                                 04200000
.LTOKEN  ANOP                                                           04210000
         AIF   ('&TOKEN' EQ '^').LCART     TOKEN VALUE SPECIFIED ? @L1C 04220000
         MNOTE 4,' ''TOKEN'' DATA IGNORED. NO KEYWORDS PERMITTED ON THEX04230000
                LIST FORM OF MGCRE.'                                    04240000
.LCART   ANOP                                                      @L1A 04250000
         AIF   ('&CART' EQ '^').LUTOKEN     CART VALUE SPECIFIED ? @D1C 04260000
         MNOTE 4,' ''CART'' DATA IGNORED. NO KEYWORDS PERMITTED ON THE X04270000
               LIST FORM OF MGCRE.'                                @L1A 04280000
.LUTOKEN ANOP                                                      @D1A 04290000
         AIF   ('&UTOKEN' EQ '^').LENVRIN  UTOKEN VALUE SPECIFIED? @D1A 04300001
         MNOTE 4,' ''UTOKEN'' DATA IGNORED. NO KEYWORDS PERMITTED ON THX04310000
               E LIST FORM OF MGCRE.'                              @D1A 04320000
.LENVRIN ANOP                                                      @04A 04330000
         AIF   ('&ENVRIN' EQ '^').LAUTHCX  ENVRIN VALUE SPECIFIED? @05C 04340001
         MNOTE 4,' ''ENVRIN'' DATA IGNORED. NO KEYWORDS PERMITTED ON THX04350000
               E LIST FORM OF MGCRE.'                              @04A 04360000
.LAUTHCX ANOP                                                      @05A 04370001
         AIF   ('&AUTHCMDX' EQ '^').LISTOK AUTHCMDX VALUE SPECIFIED    X04380001
                                                                   @05A 04390001
         MNOTE 4,' ''AUTHCMDX'' DATA IGNORED. NO KEYWORDS PERMITTED ON X04400001
               THE LIST FORM OF MGCRE.'                            @05A 04410000
.LISTOK  ANOP                                                           04420000
.*********************************************************************  04430000
.*       G E N E R A T E  P A R A M E T E R  L I S T                 *  04440000
.*********************************************************************  04450000
         DC    AL1(0)                  FLAG FIELD '00'                  04460000
         DC    AL1(0)                  RESERVED                         04470000
&I       SETA  1                                                        04480000
.CLRFLG  ANOP                                                           04490000
&FLG(&I) SETB  0                                                        04500000
&I       SETA  &I+1                                                     04510000
         AIF   (&I LT 9).CLRFLG                                         04520000
         DC    B'&FLG(1)&FLG(2)&FLG(3)&FLG(4)&FLG(5)&FLG(6)&FLG(7)&FLG(X04530000
               8)'                     FLAG FIELD                       04540000
         DC    B'&FLG2(1)&FLG2(2)&FLG2(3)&FLG2(4)&FLG2(5)&FLG2(6)&FLG2(X04550000
               7)&FLG2(8)'             FLAG FIELD 2                @L1A 04560000
         DC    CL5'MGCRE'              CONTROL BLOCK ACRONYM 'MGCRE'    04570000
         DC    AL1(1)                  VERSION LEVEL                    04580000
         DC    B'&FLG3(1)&FLG3(2)&FLG3(3)&FLG3(4)&FLG3(5)&FLG3(6)&FLG3(X04590000
               7)&FLG3(8)'             FLAG FIELD 3                @L3A 04600000
         DC    AL1(0)                  RESERVED                    @L3C 04610000
         DC    AL4(0)                  ADDRESS OF THE COMMAND TEXT      04620000
         DC    AL4(0)                  TOKEN                            04630000
         DC    CL8'        '           CONSOLE NAME                     04640000
         DC    AL4(0)                  CONSOLE ID                       04650000
         DC    XL1'0'                  COMMAND DISPOSITION         @L1A 04660000
         DC    XL2'0'                  COMMAND AUTHORITY LEVEL     @L1A 04670000
         DC    XL1'0'                  RESERVED                    @L1A 04680000
         DC    XL8'00'                 COMMAND AND RESPOSE TOKEN   @L1A 04690000
         DC    XL8'00'                 SYSTEM NAME                 @L1C 04700000
         DC    AL4(0)                  UTOKEN ADDRESS              @D1A 04710000
         DC    XL4'00'                 RESERVED                    @D1C 04720000
         AIF   (&XPLISTVER LT 3).EXIT                                   04730000
         DC    AL4(0)                  ENVRIN ADDRESS              @04A 04740000
         DC    XL32'00'                RESERVED                    @04A 04750000
         AGO   .EXIT                                                    04760000
.*********************************************************************  04770000
.*       E X E C  F O R M                                            *  04780000
.*********************************************************************  04790000
.MFEXEC  ANOP                         PROCESS MF LISTNAME               04800000
&FLG(1)  SETB  1                      INDICATE MGCRE WAS SPECIFIED      04810000
&FLGSOK  SETB  1                      CMDFLAG VALUE SPECIFIED          X04820000
                                             CORRECTLY                  04830000
         AIF   (N'&MF LE 2).ENAME     TOO MANY ARGUEMENTS ON MF KEYWORD 04840000
         MNOTE 4,' ''MF=&MF'' HAS TOO MANY ARGUMENTS. ARGUMENTS IGNOREDX04850000
                AFTER &MF(2) .'                                         04860000
         AGO   .EXVALID                                                 04870000
.ENAME   ANOP                         LIST NAME FOR EXEC FORM SPECIFIED 04880000
         AIF   (N'&MF EQ 2).EXVALID                                     04890000
         MNOTE 12,' NO TEXT GENERATED. MF LIST NAME IS REQUIRED BUT NOTX04900000
                SUPPLIED.'                                              04910000
         AGO   .EXIT                                                    04920000
.EXVALID ANOP                         EXEC FORM SPECIFIED CORRECTLY     04930000
&FLG(1)  SETB  1                      INDICATE THAT MGCRE WAS SPECIFIED 04940000
.*********************************************************************  04950000
.*       T E X T                                                     *  04960000
.*********************************************************************  04970000
         AIF   (N'&TEXT LE 1).ETEXT  TOO MANY ARGUMENTS ON TEXT KEYWORD 04980000
         MNOTE 4,' ''TEXT=&TEXT'' HAS TOO MANY ARGUMENTS. ARGUMENTS IGNX04990000
               ORED AFTER &TEXT(1,1) .'                                 05000000
.ETEXT   ANOP                                                           05010000
         AIF   ('&TEXT' NE '^').VFYTEXT                                 05020000
         MNOTE 12,' NO TEXT GENERATED. ''TEXT'' VALUE IS REQUIRED BUT NX05030000
               OT SUPPLIED.'                                            05040000
         AGO   .EXIT                                                    05050000
.VFYTEXT ANOP                                                           05060000
         AIF   ('&TEXT' EQ '').NOTEXT    TEXT VALUE SPECIFIED ?         05070000
         AGO   .CONT1                                                   05080000
.NOTEXT  ANOP                                                           05090000
         MNOTE 12,' NO TEXT GENERATED. ''TEXT'' VALUE IS REQUIRED BUT NX05100000
               OT SUPPLIED.'                                            05110000
         AGO   .EXIT                                                    05120000
.CONT1   ANOP                                                           05130000
&TEXTOK  SETB  1                             TEXT VALUE SPECIFIED      X05140000
                                             CORRECTLY                  05150000
.*********************************************************************  05160000
.*       C O N S O L E  I D                                          *  05170000
.*********************************************************************  05180000
.CHKCID  ANOP                      TOO MANY ARGUMENTS ON CONSID KEYWORD 05190000
         AIF   (N'&CONSID LE 1).ECONSID                                 05200000
         MNOTE 4,' ''CONSID=&CONSID'' HAS TOO MANY ARGUMENTS. ARGUMENTSX05210000
                IGNORED AFTER &CONSID(1,1) .'                           05220000
.ECONSID ANOP                                                           05230000
         AIF   ('&CONSID' EQ '^').CHKNAME  CONSID KEYWORD NOT SPECIFIED 05240000
         AIF   ('&CONSID' NE '').VFYCID    NO DATA SPECIFIED ON CONSID  05250000
         MNOTE 4,' ''CONSID'' KEYWORD IGNORED. NO DATA SPECIFIED.'      05260000
         AGO   .CHKNAME                                                 05270000
.VFYCID  ANOP                                VERIFY CONSOLE ID          05280000
&IDSPEC  SETB  1                             INDICATE CONSID SPECIFIEC  05290000
&FLG(6)  SETB  1                             INDICATE CONSID SPECIFIED X05300000
                                             CORRECTLY                  05310000
&CIDOK   SETB  1                             CONSID VALUE SPECIFIED    X05320000
                                             CORRECTLY                  05330000
&FLGSOK  SETB  1                             CMDFLAG VALUE SPECIFIED   X05340000
                                             CORRECTLY                  05350000
.*********************************************************************  05360000
.*       C O N S O L E  N A M E                                      *  05370000
.*********************************************************************  05380000
.CHKNAME ANOP                                                           05390000
         AIF   (N'&CONSNAME LE 1).ECNAME     TOO MANY ARGUMENTS ON CONSX05400000
                                             NAME KEYWORD               05410000
         MNOTE 4,' ''CONSNAME=&CONSNAME'' HAS TOO MANY ARGUMENTS. ARGUMX05420000
               ENTS IGNORED AFTER &CONSNAME(1,1) .'                     05430000
.ECNAME  ANOP                                                           05440000
         AIF   ('&CONSNAME' EQ '^').CIDSPEC CONSNAME NOT SPECIFIED      05450000
         AIF   ('&CONSNAME' NE '').CNMSPEC  CONSNAME SPECIFIED ?        05460000
         MNOTE 4,' ''CONSNAME'' KEYWORD IGNORED. NO DATA SPECIFIED.'    05470000
         AGO   .CIDSPEC            CONSID SPECIFIED ?                   05480000
.CNMSPEC ANOP                      CONSNAME WAS SPECIFIED               05490000
&NMSPEC  SETB  1                   INDICATE THAT CONSNAME WAS SPECIFIED 05500000
&FLG(7)  SETB  1                   INDICATE CONSNAME WAS SPECIFIED IN  X05510000
                                   THE COMMAND FLAGS                    05520000
&FLGSOK  SETB  1                   CMDFLAG VALUE SPECIFIED             X05530000
                                             CORRECTLY                  05540000
         AGO   .BTHSPEC            BOTH CONSID AND CONSNAME SPECIFIED ? 05550000
.CIDSPEC ANOP                      CONSID SPECIFIED ?                   05560000
         AIF   ('&IDSPEC' NE '0').BTHSPEC   BOTH SPECIFIED ?            05570000
         MNOTE 12,' NO TEXT GENERATED. CONSID OR CONSNAME IS REQUIRED BX05580000
               UT NOT SUPPLIED.'                                        05590000
         AGO   .EXIT                                                    05600000
.BTHSPEC ANOP                      BOTH CONSID AND CONSNAME SPECIFIED ? 05610000
         AIF   ('&IDSPEC' EQ '1' AND '&NMSPEC' EQ '1').MNOTE1           05620000
         AIF   ('&CONSNAME' EQ '' OR '&CONSNAME' EQ '^').CHKFLAG        05630000
&CNMEOK  SETB  1                             CONSNAME VALUE SPECIFIED  X05640000
                                             CORRECTLY                  05650000
         AGO   .CHKFLAG                                                 05660000
.MNOTE1  ANOP                                                           05670000
         MNOTE 12,' NO TEXT GENERATED. ''CONSNAME'' IS MUTUALLY EXCLUSIX05680000
               VE WITH ''CONSID''.'                                     05690000
         AGO   .EXIT                                                    05700000
.*********************************************************************  05710000
.*       C O M M A N D  F L A G S                                    *  05720000
.*********************************************************************  05730000
.CHKFLAG ANOP                                                           05740000
         AIF   ('&CMDFLAG' EQ '^').CHKTKN        CMDFLAG SPECIFIED ?    05750000
         AIF   ('&CMDFLAG' NE '').FLGSPEC        CMDFLAG DATA SPEC ?    05760000
         MNOTE 4,' ''CMDFLAG'' KEYWORD IGNORED. NO DATA SPECIFIED.'     05770000
.FLGSPEC ANOP                                                           05780000
         AIF   (N'&CMDFLAG LE 3).CNTFLAG         TOO MANY ARGUMENTS ON X05790000
                                                 CMDFLAG KEYWORD        05800000
         MNOTE 4,' ''CMDFLAG=&CMDFLAG'' HAS TOO MANY ARGUMENTS. ARGUMENX05810000
               TS IGNORED AFTER &CMDFLAG(3,1) .'                        05820000
.CNTFLAG ANOP                                                           05830000
&CNT     SETA  &CNT+1                                                   05840000
         AIF   (&CNT GT N'&CMDFLAG).CONT2                               05850000
         AIF   ('&CMDFLAG(&CNT)' EQ 'SUBSYS').SETFLG2                   05860000
         AGO   .CHKFLG3                                                 05870000
.SETFLG2 ANOP                                                           05880000
&FLG(2)  SETB  1                                                        05890000
.CHKFLG3 ANOP                                                           05900000
         AIF   ('&CMDFLAG(&CNT)' EQ 'COMMTASK').SETFLG3                 05910000
         AGO   .CHKFLG4                                                 05920000
.SETFLG3 ANOP                                                           05930000
&FLG(3)  SETB  1                                                        05940000
.CHKFLG4 ANOP                                                           05950000
         AIF   ('&CMDFLAG(&CNT)' EQ 'NOHCPY').SETFLG4                   05960000
         AGO   .CHKFLG5                                            @L3C 05970000
.SETFLG4 ANOP                                                           05980000
&FLG(4)  SETB  1                                                        05990000
.CHKFLG5 ANOP                                                      @L3A 06000000
         AIF   ('&CMDFLAG(&CNT)' EQ 'TSO').SETFLG5                 @L3A 06010000
         AGO   .OTHERS                                             @L3A 06020000
.SETFLG5 ANOP                                                      @L3A 06030000
&FLG3(3)  SETB  1                                                  @L3A 06040000
.OTHERS  ANOP                                                           06050000
         AIF   ('&CMDFLAG(&CNT)' EQ '^').CONT2                          06060000
         AIF   ('&CMDFLAG(&CNT)' EQ '').FNODAT                          06070000
         AIF   ('&CMDFLAG(&CNT)' EQ 'SUBSYS'   OR                      X06080000
                '&CMDFLAG(&CNT)' EQ 'COMMTASK' OR                      X06090000
                '&CMDFLAG(&CNT)' EQ 'TSO' OR                           X06100000
                '&CMDFLAG(&CNT)' EQ 'NOHCPY').FVALID               @L3C 06110000
         AGO   .FNTVAL                                                  06120000
.FVALID  ANOP                      CMDFLAG VALUE SPECIFIED IS VALID     06130000
         AIF   ('&FLG(2)' EQ '1' AND '&FLG(3)' EQ '1').FLGEXC COMMTASK X06140000
                                              AND SUBSYS SPECIFIED ?    06150000
         AIF   ('&FLG(3)' EQ '1' AND '&FLG3(3)' EQ '1').FLGEX2 COMMTASKX06160000
                                              AND TSO SPECIFIED ?  @L3A 06170000
         AIF   ('&FLG(2)' EQ '1' AND '&FLG3(3)' EQ '1').FLGEX3 SUBSYS  X06180000
                                              AND TSO SPECIFIED ?  @L3A 06190000
         AGO   .CNTFLAG                                                 06200000
.FNTVAL  ANOP                      CMDFLAG VALUE SPECIFIED IS NOT VALID 06210000
         MNOTE 4,' CMDFLAG VALUE IGNORED. ''CMDFLAG=&CMDFLAG(&CNT)'' ISX06220000
                NOT VALID.'                                             06230000
         AGO   .CNTFLAG                                                 06240000
.FNODAT  ANOP                                                           06250000
         MNOTE 4,' ''CMDFLAG'' KEYWORD IGNORED. NO DATA SPECIFIED.'     06260000
         AGO   .CNTFLAG                                                 06270000
.FLGEXC  ANOP                                                           06280000
         MNOTE 12,' NO TEXT GENERATED. ''CMDFLAG=SUBSYS'' IS MUTUALLY EX06290000
               XCLUSIVE WITH ''CMDFLAG=COMMTASK''.'                     06300000
         AGO   .EXIT                                                    06310000
.FLGEX2  ANOP                                                           06320000
         MNOTE 12,' NO TEXT GENERATED. ''CMDFLAG=TSO'' IS MUTUALLY EXCLX06330000
               USIVE WITH ''CMDFLAG=COMMTASK''.'                   @L3A 06340000
         AGO   .EXIT                                                    06350000
.FLGEX3  ANOP                                                           06360000
         MNOTE 12,' NO TEXT GENERATED. ''CMDFLAG=TSO'' IS MUTUALLY EXCLX06370000
               USIVE WITH ''CMDFLAG=SUBSYS''.'                     @L3A 06380000
         AGO   .EXIT                                                    06390000
.CONT2   ANOP                                                           06400000
&FLGSOK  SETB  1                             CMDFLAG VALUE SPECIFIED   X06410000
                                             CORRECTLY                  06420000
&FLGS3OK SETB  1                             CMDFLAG VALUE SPECIFIED   X06430000
                                             CORRECTLY             @L3A 06440000
         AIF   ('&FLG3(3)' EQ '1' AND '&CONSID' EQ '^').ERRTSO         X06450000
                                             CMDFLAG=TSO SPECIFIED AND X06460000
                                             CONSID KEYWORD NOT        X06470000
                                             SPECIFIED             @L3A 06480000
         AIF   ('&FLG3(3)' EQ '1' AND '&CONSID' NE '').CHKTKN          X06490000
                                             CMDFLAG=TSO SPECIFIED AND X06500000
                                             NO DATA SPECIFIED ON      X06510000
                                             CONSID                @L3A 06520000
         AIF   ('&FLG3(3)' NE '1').CHKTKN    CONTINUE IF CMDFLAG=TSO   X06530000
                                             WAS NOT SPECIFIED     @L3A 06540000
.ERRTSO  ANOP                                                           06550000
         MNOTE 12,' NO TEXT GENERATED. ''CONSID'' KEYWORD IS REQUIRED IX06560000
               F ''CMDFLAG=TSO'' IS SPECIFIED.'                    @L3A 06570000
         AGO   .EXIT                                               @L3A 06580000
.*********************************************************************  06590000
.*       T O K E N                                                   *  06600000
.*********************************************************************  06610000
.CHKTKN  ANOP                                                           06620000
         AIF   (N'&TOKEN LE 1).ETOKEN      TOO MANY ARGUMENTS ON TOKEN X06630000
                                           KEYWORD                      06640000
         MNOTE 4,' ''TOKEN=&TOKEN'' HAS TOO MANY ARGUMENTS. ARGUMENTS IX06650000
               GNORED AFTER &TOKEN(1,1) .'                              06660000
.ETOKEN  ANOP                                                           06670000
         AIF   ('&TOKEN' EQ '^').CHKCART   TOKEN VALUE SPECIFIED ? @L1C 06680000
         AIF   ('&TOKEN' NE '').CONT3       NO DATA SPECIFIED           06690000
         MNOTE 4,' ''TOKEN'' KEYWORD IGNORED. NO DATA SPECIFIED.'       06700000
         AGO   .CHKCART                   BYPASS TOKEN PROCESSING  @D1A 06710000
.CONT3   ANOP                                                           06720000
&TKNOK   SETB  1                             TOKEN VALUE SPECIFIED     X06730000
                                             CORRECTLY                  06740000
&FLGSOK  SETB  1                             CMDFLAG VALUE SPECIFIED   X06750000
                                             CORRECTLY                  06760000
&FLG(5)  SETB  1                             INDICATE TOKEN  SPECIFIED X06770000
                                             CORRECTLY                  06780000
.***************************************************************** @L1A 06790000
.*       C A R T                                                 * @L1A 06800000
.***************************************************************** @L1A 06810000
.CHKCART ANOP                                                      @L1A 06820000
         AIF   (N'&CART LE 1).ECART        TOO MANY ARGUMENTS ON   @L1AX06830000
                                           CART KEYWORD            @L1A 06840000
         MNOTE 4,' ''CART=&CART'' HAS TOO MANY ARGUMENTS.  ARGUMENTS IGX06850000
               NORED AFTER &CART(1,1) .'                           @L1A 06860000
.ECART   ANOP                                                           06870000
         AIF   ('&CART' EQ '^').CHKUTKN    CART VALUE SPECIFIED ?  @D1C 06880000
         AIF   ('&CART' NE '').CONT4        NO DATA SPECIFIED      @L1A 06890000
         MNOTE 4,' ''CART'' KEYWORD IGNORED. NO DATA SPECIFIED.'   @L1A 06900000
         AGO   .CHKUTKN                    BYPASS CART PROCESSING  @D1A 06910000
.CONT4   ANOP                                                           06920000
&CARTOK  SETB  1                           CART SPECIFIED CORRECLY @L1A 06930000
&FLG2(3) SETB  1                           INDICATE CART SPECIFIED @D1A 06940000
&FLGS2OK SETB  1                           INDICATE A FLAG WAS SET @D1A 06950000
.***************************************************************** @D1A 06960000
.*       U T O K E N                                             * @D1A 06970000
.***************************************************************** @D1A 06980000
.CHKUTKN ANOP                                                      @D1A 06990000
         AIF   (N'&UTOKEN LE 1).EUTKN      TOO MANY ARGUMENTS ON   @D1AX07000000
                                           UTOKEN KEYWORD          @D1A 07010000
         MNOTE 4,' ''UTOKEN=&UTOKEN'' HAS TOO MANY ARGUMENTS.  ARGUMENTX07020000
               S IGNORED AFTER &UTOKEN(1,1) .'                     @D1A 07030000
.EUTKN   ANOP                                                           07040000
         AIF   ('&UTOKEN' EQ '^').CHKENVR  UTOKEN VALUE SPECIFIED? @D1A 07050001
         AIF   ('&UTOKEN' NE '').CONT5      NO DATA SPECIFIED      @D1A 07060000
         MNOTE 4,' ''UTOKEN'' KEYWORD IGNORED. NO DATA SPECIFIED.' @D1A 07070000
         AGO   .INSERT                   BYPASS UTOKEN PROCESSING  @D1A 07080000
.CONT5   ANOP                                                           07090000
&UTKNOK  SETB  1                         UTOKEN SPECIFIED CORRECLY @D1A 07100000
&FLG2(5) SETB  1                         INDICATE UTOKEN SPECIFIED @D1A 07110000
&FLGS2OK SETB  1                           INDICATE A FLAG WAS SET @D1A 07120000
.***************************************************************** @04A 07130001
.*       E N V R I N                                             * @04A 07140000
.***************************************************************** @04A 07150001
.CHKENVR ANOP                                                      @04A 07160000
         AIF   (N'&ENVRIN LE 1).EENVR      TOO MANY ARGUMENTS ON   @04AX07170001
                                           ENVRIN KEYWORD          @04A 07180000
         MNOTE 4,' ''ENVRIN=&ENVRIN'' HAS TOO MANY ARGUMENTS.  ARGUMENTX07190001
               S IGNORED AFTER &ENVRIN(1,1) .'                     @04A 07200000
.EENVR   ANOP                                                           07210001
         AIF   ('&ENVRIN' EQ '^').CHKAUCX  ENVRIN VALUE SPECIFIED? @04A 07220001
         AIF   ('&ENVRIN' NE '').CONT6      NO DATA SPECIFIED      @04A 07230001
         MNOTE 4,' ''ENVRIN'' KEYWORD IGNORED. NO DATA SPECIFIED.' @04A 07240000
         AGO   .CHKAUCX                  BYPASS ENVRIN PROCESSING  @05C 07250001
.CONT6   ANOP                                                           07260000
&ENVROK  SETB  1                         ENVRIN SPECIFIED CORRECLY @04A 07270001
&FLG3(4) SETB  1                         INDICATE ENVRIN SPECIFIED @04A 07280000
         AIF   ('&ENVRIN' NE '' AND '&UTOKEN' EQ '^').ERRENVR          X07290001
                                         ENVRIN SPECIFIED AND UTOKEN   X07300000
                                         WASN'T SPECIFIED          @04A 07310001
         AGO   .CONT7                                                   07320000
.ERRENVR ANOP                                                           07330001
         MNOTE 12,' NO TEXT GENERATED.  ''UTOKEN'' KEYWORD IS REQUIRED X07340000
               IF ''ENVRIN'' IS SPECIFIED.'                        @04A 07350001
         AGO   .EXIT                                                    07360000
.CONT7   ANOP                                                           07370001
         AIF   ('&ENVRIN' NE '' AND ('&PLISTVER(1)' EQ '^'             X07380000
                                OR '&PLISTVER(1)' EQ '1'               X07390001
                                OR '&PLISTVER(1)' EQ '2')).ERRVSNE @04A 07400000
         AGO   .CONT8                                                   07410001
.ERRVSNE ANOP                                                           07420000
         MNOTE 12,' NO TEXT GENERATED.  ''ENVRIN'' KEYWORD REQUIRES A VX07430001
               ERSION OF 3 OR HIGHER.'                             @04A 07440000
         AGO   .EXIT                                                    07450001
.CONT8   ANOP                                                           07460000
&FLGS3OK SETB  1                           INDICATE A FLAG WAS SET @04A 07470001
.***************************************************************** @05A 07480001
.*       A U T H C M D X                                         * @05A 07490001
.***************************************************************** @05A 07500001
.CHKAUCX ANOP                                                      @05A 07510001
         AIF   (N'&AUTHCMDX LE 1).EAUTHCX  TOO MANY ARGUMENTS ON   @05AX07520001
                                           AUTHCMDX KEYWORD        @05A 07530001
         MNOTE 4,' ''AUTHCMDX=&AUTHCMDX'' HAS TOO MANY ARGUMENTS.  ARGUX07540001
               MENTS IGNORED AFTER &AUTHCMDX(1,1) .'               @05A 07550001
.EAUTHCX ANOP                                                           07560001
         AIF   ('&AUTHCMDX' EQ '^').INSERT  AUTHCMDX VALUE SPECIFIED?  X07570001
                                                                   @05A 07580001
         AIF   ('&AUTHCMDX' NE '').CONT9    NO AUTHCMDX SPECIFIED  @05A 07590001
         MNOTE 4,' ''AUTHCMDX'' KEYWORD IGNORED. NO DATA SPECIFIED.'   X07600001
                                                                   @05A 07610001
         AGO   .INSERT                 BYPASS AUTHCMDX PROCESSING  @05A 07620001
.CONT9   ANOP                                                           07630001
&AUTHCXOK SETB 1                     AUTHCMDX SPECIFIED            @05A 07640001
&FLG(8)  SETB 1                      INDICATE AUTH VALUE SPECIFIED @05A 07650001
&FLGSOK  SETB 1                      FLAG VALUE SPECIFIED          @05A 07660001
.*********************************************************************  07670000
.*       INSERT ALL VALUES SPECIFIED INTO THE PARAMTER LIST          *  07680000
.*********************************************************************  07690000
.INSERT  ANOP                                                           07700000
&NAME    IHBINNRA &MF(2)             SET UP PARAMETER LIST ADDRESS      07710000
         XC    0(4,1),0(1)                 CLEAR LIST UPTO ACRONYM @L2C 07720000
         XC    10(50,1),10(1)              CLEAR LIST PAST VERSION @L2A 07730000
         MVI   9(1),&XPLISTVER           INSERT VERSION INTO PLIST @04A 07740000
.*********************************************************************  07750000
.*       INSERT TEXT VALUE IF IT WAS SPECIFIED                       *  07760000
.*********************************************************************  07770000
.INSRTTX ANOP                                                           07780000
         AIF   ('&TEXTOK' NE '1').INSRTID                               07790000
         AIF   ('&TEXT'(1,1) EQ '(').ETEXTRG   TEXT VALUE IS IN A REG   07800000
         MVC   12(4,1),&TEXT(1,1)           INSERT TEXT ADDRESS INTO   X07810000
                                            PARMLIST               @03C 07820000
         AGO   .INSRTID                                                 07830000
.ETEXTRG ANOP                                                           07840000
         ST    &TEXT(1,1),12(,1)            INSERT TEXT ADDRESS INTO   X07850000
                                            PARMLIST               @03C 07860000
         AGO   .INSRTID                                                 07870000
.*********************************************************************  07880000
.*       INSERT CONSID VALUE IF IT WAS SPECIFIED                     *  07890000
.*********************************************************************  07900000
.INSRTID ANOP                                                           07910000
         AIF   ('&CIDOK' NE '1').INSRTNM                                07920000
         AIF   ('&CONSID'(1,1) EQ '(').ECIDRG CONSID VALUE IS IN A REG  07930000
         MVC   28(4,1),&CONSID(1,1)          INSERT CONSID INTO PLIST   07940000
         AGO   .INSRTNM                                                 07950000
.ECIDRG  ANOP                                                           07960000
         ST    &CONSID(1,1),28(,1)          INSERT CONSID INTO PLIST    07970000
.*********************************************************************  07980000
.*       INSERT CONSNAME VALUE IF IT WAS SPECIFIED                   *  07990000
.*********************************************************************  08000000
.INSRTNM ANOP                                                           08010000
         AIF   ('&CNMEOK' NE '1').SETFLGS                               08020000
         AIF   ('&CONSNAME'(1,1) EQ '(').ENAMERG                        08030000
         MVC   20(8,1),&CONSNAME(1,1)      INSERT CONSNAME INTO PLIST   08040000
         AGO   .SETFLGS                                                 08050000
.ENAMERG ANOP                               CONSNAME VALUE IS IN A REG  08060000
         MVC   20(8,1),0(&CONSNAME(1,1))    INSERT CONSNAME INTO PLIST  08070000
         AGO   .SETFLGS                                                 08080000
.*********************************************************************  08090000
.*       INSERT CMDFLAG VALUES IF IT WAS SPECIFIED                   *  08100000
.*********************************************************************  08110000
.SETFLGS ANOP                      SET THE COMMAND FLAGS                08120000
         AIF   ('&FLGSOK' NE '1').INSRTTK                               08130000
         AIF   (NOT &FLG(1) AND                                        X08140000
                NOT &FLG(2) AND                                        X08150000
                NOT &FLG(3) AND                                        X08160000
                NOT &FLG(4) AND                                        X08170000
                NOT &FLG(5) AND                                        X08180000
                NOT &FLG(6) AND                                        X08190000
                NOT &FLG(7) AND                                        X08200000
                NOT &FLG(8)).CHKTKN                                     08210000
.*       SLR   1,1                          CLEAR REGISTER ONE          08220000
         OI    2(1),B'&FLG(1)&FLG(2)&FLG(3)&FLG(4)&FLG(5)&FLG(6)&FLG(7)X08230000
               &FLG(8)'                     SET COMMAND FLAGS           08240000
.*********************************************************************  08250000
.*       INSERT TOKEN VALUES IF IT WAS SPECIFIED                     *  08260000
.*********************************************************************  08270000
.INSRTTK ANOP                                                           08280000
         AIF   ('&TKNOK' NE '1').NSRTCRT                           @D1C 08290000
         AIF   ('&TOKEN'(1,1) EQ '(').ETKNRG   TOKEN VALUE IS IN A REG  08300000
         MVC   16(4,1),&TOKEN(1,1)          INSERT TOKEN INTO PARMLIST  08310000
         AGO   .NSRTCRT                     CHECK NEXT KEYWORD     @D1C 08320000
.ETKNRG  ANOP                                                           08330000
         ST    &TOKEN(1,1),16(,1)           INSERT TOKEN INTO PARMLIST  08340000
         AGO   .NSRTCRT                     CHECK NEXT KEYWORD     @D1C 08350000
.******************************************************************@L1A 08360000
.*       INSERT CART VALUE IF IT WAS SPECIFIED                    *@L1A 08370000
.******************************************************************@L1A 08380000
.NSRTCRT ANOP                                                      @L1A 08390000
         AIF   ('&CARTOK' NE '1').INSRTAX    CART SPECIFIED?       @05C 08400001
         AIF   ('&CART'(1,1) EQ '(').ETCART  CART VALUE IS IN A REG@L1A 08410000
         MVC   36(8,1),&CART              MOVE CART INTO PARMLIST  @L1A 08420000
         AGO   .INSRTAX                  CHECK NEXT KEYWORD        @05C 08430001
.ETCART  ANOP                                                           08440000
         MVC   36(8,1),0(&CART(1,1))     INSERT CART INTO PARMLIST @L1A 08450000
         AGO   .INSRTAX                  CHECK NEXT KEYWORD        @05C 08460001
.******************************************************************@05A 08470001
.*       INSERT AUTHCMDX VALUES IF SPECIFIED                      *@05A 08480001
.******************************************************************@05A 08490001
.INSRTAX ANOP                                                      @05A 08500001
         AIF   ('&AUTHCXOK' NE '1').INSRTUT  AUTHCMDX SPECIFIED?   @05A 08510001
         AIF   ('&AUTHCMDX'(1,1) EQ '(').ETAUTCX  AUTHCMDX VALUE       X08520001
                                         SPECIFIED A REGISTER      @05A 08530001
         L     15,&AUTHCMDX                                             08540001
         AGO   .COPYAUTH                                                08550001
.ETAUTCX ANOP                                                           08560001
         LR    15,&AUTHCMDX(1,1)                                        08570001
.COPYAUTH ANOP                                                          08580001
         TM    0(15),X'80'               Is the MASTER bit ON      @05A 08590001
         JNO   MGCRECHECKSYS&SYSNDX      No, skip to SYS bit       @05A 08600001
         OI    32(1),X'40'               Set Master bit            @05A 08610001
MGCRECHECKSYS&SYSNDX EQU   *             Check the SYS bit         @05A 08620001
         TM    0(15),X'40'               Is the SYS bit ON         @05A 08630001
         JNO   MGCRECHECKIO&SYSNDX       No, skip to IO bit        @05A 08640001
         OI    33(1),X'80'               Set SYS bit               @05A 08650001
MGCRECHECKIO&SYSNDX  EQU   *             Check the IO bit          @05A 08660001
         TM    0(15),X'20'               Is the IO bit ON          @05A 08670001
         JNO   MGCRECHECKCON&SYSNDX      No, skip to CONS bit      @05A 08680001
         OI    33(1),X'40'               Set IO bit                @05A 08690001
MGCRECHECKCON&SYSNDX EQU   *             Check the CONS bit        @05A 08700001
         TM    0(15),X'10'               Is the CONS bit ON        @05A 08710001
         JNO   MGCRECHECKDONE&SYSNDX     No, continue filling data @05A 08720001
         OI    33(1),X'20'               Set CONS bit              @05A 08730001
MGCRECHECKDONE&SYSNDX EQU   *            AUTHCMDX complete         @05A 08740001
         AGO   .INSRTUT                  continue                  @05A 08750001
.******************************************************************@D1A 08760000
.*       INSERT UTOKEN VALUE IF IT WAS SPECIFIED                  *@D1A 08770000
.******************************************************************@D1A 08780000
.INSRTUT ANOP                                                      @D1A 08790000
         AIF   ('&UTKNOK' NE '1').V3KEYS   UTOKEN SPECIFIED?       @04C 08800001
         AIF   ('&UTOKEN'(1,1) EQ '(').ETUTKN UTOKEN IS IN A REG   @D1A 08810000
         MVC   52(4,1),&UTOKEN           MOVE UTOKEN ADDRESS INTO      X08820000
                                         PARMLIST                  @03C 08830000
         AGO   .V3KEYS                   GO SET VERSION 3 KEYWORDS @04C 08840001
.ETUTKN  ANOP                                                           08850000
         ST    &UTOKEN(1,1),52(,1)       INSERT UTOKEN ADDRESS INTO    X08860000
                                         PARMLIST                  @03C 08870000
         AGO   .V3KEYS                   CHECK NEXT KEYWORD        @04C 08880001
.******************************************************************@04A 08890001
.*       CLEAR STORAGE FOR V3 KEYWORDS                            *@04A 08900001
.******************************************************************@04A 08910001
.V3KEYS  ANOP                                                           08920001
         AIF   ('&ENVROK' NE '1').FLG2STF  CHECK ALL V3 KEYWORDS   @04A 08930001
         XC    60(36,1),60(1)              CLEAR V3 KEYS STORAGE   @04A 08940001
.******************************************************************@04A 08950001
.*       INSERT ENVRIN VALUE IF IT WAS SPECIFIED                  *@04A 08960001
.******************************************************************@04A 08970000
.INSRENV ANOP                                                      @04A 08980001
         AIF   ('&ENVROK' NE '1').FLG2STF  ENVRIN SPECIFIED?       @04A 08990001
         AIF   ('&ENVRIN'(1,1) EQ '(').ETENVR ENVRIN IS IN A REG   @04A 09000001
         MVC   60(4,1),&ENVRIN           MOVE ENVRIN ADDRESS INTO      X09010001
                                         PARMLIST                  @04A 09020001
         AGO   .FLG2STF                  GO SET FLAG 2 BITS        @04A 09030001
.ETENVR  ANOP                                                           09040001
         ST    &ENVRIN(1,1),60(,1)       INSERT ENVRIN ADDRESS INTO    X09050001
                                         PARMLIST                  @04A 09060001
         AGO   .FLG2STF                  GO SET FLAG 2 BITS        @04A 09070000
.******************************************************************@D1M 09080000
.*       STORE FLAG BYTE 2 INFORMATION                             @D1M 09090000
.******************************************************************@D1M 09100000
.FLG2STF ANOP                                                      @D1M 09110000
         AIF   ('&FLGS2OK' NE '1').FLG3STF                         @D1A 09120000
         OI    3(1),B'&FLG2(1)&FLG2(2)&FLG2(3)&FLG2(4)&FLG2(5)&FLG2(6)&X09130000
               FLG2(7)&FLG2(8)'          SET FLAG BYTE 2           @D1M 09140000
.******************************************************************@L3A 09150000
.*       STORE FLAG BYTE 3 INFORMATION                             @L3A 09160000
.******************************************************************@L3A 09170000
.FLG3STF ANOP                                                      @L3A 09180000
         AIF   ('&FLGS3OK' NE '1').EXECSVC                         @L3A 09190000
         OI    10(1),B'&FLG3(1)&FLG3(2)&FLG3(3)&FLG3(4)&FLG3(5)&FLG3(6)X09200000
               &FLG3(7)&FLG3(8)'         SET FLAG BYTE 3           @L3A 09210000
.*********************************************************************  09220000
.*       I S S U E  S V C  3 4                                       *  09230000
.*********************************************************************  09240000
.EXECSVC ANOP                                                           09250000
         SVC 34                             ISSUE SVC 34           @L1C 09260000
.EXIT    MEND                                                           09270000
**/                                                                     09280000
* %MGCRE: MACRO KEYS(                                                   09290000
*                    MF,       /* LIST FORMAT                      */   09300000
*                    TEXT,     /* COMMAND TEXT AREA ADDRESS    @03C*/   09310000
*                    CMDFLAG,  /* SOURCE OF COMMAND                */   09320000
*                    CONSID,   /* 4-BYTE CONSOLE ID                */   09330000
*                    CONSNAME, /* CONSOLE NAME                     */   09340000
*                    CART,     /* COMMAND AND RESPONSE TOKEN   @L1A*/   09350000
*                    TOKEN,    /* TOKEN ASSOCIATED WITH COMMAND@D1C*/   09360000
*                    UTOKEN,   /* SECURITY TOKEN ADDRESS       @03C*/   09370001
*                    ENVRIN,   /* ENVRIN STRUCTURE ADDRESS     @04A*/   09380001
*                    AUTHCMDX, /* AUTH VALUES                  @04A*/   09390001
*                    PLISTVER  /* PLISTVER VALUE               @04A*/   09400001
*                          );                                           09410000
*            ANS('?'!!MACLABEL!!'MGCREP '!!MACLIST!!MACKEYS!!';');      09420000
*%END MGCRE;                                                            09430000

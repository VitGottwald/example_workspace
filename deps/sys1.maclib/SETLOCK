*/***PROPRIETARY_STATEMENT********************************************/ 00001000
*/*                                                                  */ 00002000
*/*                                                                  */ 00003000
*/* LICENSED MATERIALS - PROPERTY OF IBM                             */ 00004000
*/* 5650-ZOS COPYRIGHT IBM CORP. 1980, 2021                          */ 00005000
*/*                                                                  */ 00006000
*/* STATUS= HBB77D0                                                  */ 00007000
*/*                                                                  */ 00008000
*/***END_OF_PROPRIETARY_STATEMENT*************************************/ 00009000
*%/*                                                                    00010000
         MACRO                                                          00020000
&NAME    SETLOCK &REQUEST,&TYPE=,&ADDR=,&MODE=,&DISABLE,&RELATED=,     X00030000
               &REGS=,&BRANCH=,&ASCB=,&LOCKHLD=,&SCOPE=,&LOCK=,        X00040000
               &WORKREG=,&INSTDATA=                                @LIC 00050000
.**************************************************************         00060000
.*01*  MACRO NAME = SETLOCK                                             00070000
.*                                                                      00080000
.*01*  External Classification:                                         00090000
.*02*  NONE: BASE                                                       00100000
.*02*  GUPI: For OBTAIN and RELEASE, TYPE=CPU,                          00110000
.*                                   TYPE=CMS,                          00120000
.*                                   TYPE=LOCAL,                        00130000
.*                                   TYPE=CML,ASCB                      00140000
.*                                      MODE                            00150000
.*                                      REGS                            00160000
.*                                      RELATED                         00170000
.*           For TEST, TYPE=CPU,                                        00180000
.*                     TYPE=CMS,                                        00190000
.*                     TYPE=LOCAL,                                      00200000
.*                     TYPE=ALOCAL                                      00210000
.*                     TYPE=CML,ASCB                                    00220000
.*                        LOCKHLD                                       00230000
.*                        BRANCH                                        00240000
.*                        RELATED                                       00250000
.*01*  End of External Classification:                                  00260000
.*                                                                      00270000
.*01*  FUNCTION = GENERATE THE LINKAGE TO SPIN AND SUSPEND              00280000
.*                LOCK MANAGER                                          00290000
.*                                                                      00300000
.*01*  COMPONENT = SC1C5 (SUPERVISOR CONTROL)                           00310000
.*                                                                      00320000
.*01*  MACLIB = AMACLIB                                                 00330000
.*                                                                      00340000
.*02*   NOTES =                                                         00350000
.*        AR-MODE INVOKERS:                                        @L3A 00360000
.*          SYSSTATE IS USED TO TEST FOR AN AR-MODE INVOKER.            00370000
.*          FOR INSTRUCTIONS SUCH AS LM WITH NO INDEX REGISTER, THE     00380000
.*            AR OF THE BASE REGISTER IS SET BEFOREHAND.                00390000
.*          PRIMARY MODE IS ENTERED BEFORE THE CALL, AND AR-MODE        00400000
.*            IS REENTERED AFTER THE CALL.                              00410000
.*          R14 HOLDS THE PSALITA RATHER THAN R13 TO CONFORM TO THE     00420000
.*            PL/AS SUPPORT.                                            00430000
.*          FOR REGS=SAVE, THE STM IS DONE OFF R13 SINCE AR13 MUST HAVE 00440000
.*            BEEN ESTABLISHED BY AN AR-MODE INVOKER.                   00450000
.*          FOR REGS=SAVE, UPON RETURN, SINCE AR13 IS NEEDED TO DO THE  00460000
.*            LM, BUT THE ADDRESS IS IN R15 WITH THE RETURN CODE IN     00470000
.*            R13, THE TWO REGS ARE SWAPPED BEFORE DOING THE LM.        00480000
.*            THIS SAVES A STORAGE REFERENCE.                           00490000
.*          FOR LM OF ONLY 2 REGS, RATHER THAN SETTING THE AR, 2 LOADS  00500000
.*            ARE DONE SPECIFYING INDEX RATHER THAN BASE REG.           00510000
.*        WHEN REGS=STDSAVE IS SPECIFIED, ONLY GENERAL REGISTERS 2-12   00520000
.*          ARE PRESERVED.  GENERAL REGISTERS 14,15,0, AND 1 ARE NOT    00530000
.*          RESTORED BECAUSE ACCESS REGISTERS 14,15,0, AND 1 MAY NOT    00540000
.*          BE COUNTED ON ACROSS THE MACRO CALL.                        00550000
.*                                                                      00560000
.*01*  DEPENDENCIES =                                                   00570000
.*        Modules using SETLOCK must include the IHAPSA mapping         00580000
.*        prior to invocation.                                          00590000
.*                                                                      00600000
.*01*  SYNTAX  =                                                        00610000
.*                                                                      00620000
.* LABEL: SETLOCK                                                       00630000
.*                                                                      00640000
.*        OBTAIN                                                        00650000
.*                                                                      00660000
.*          ,TYPE=ASM        ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    00670000
.*                                 (11)                        (10)     00680000
.*                                                                      00690000
.*                ASMGL      ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    00700000
.*                                 (11)                        (10)     00710000
.*                                                                      00720000
.*                BMFLSD     ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    00730000
.*                                 (11)                        (10)     00740000
.*                                                                      00750000
.*                CML        ,ASCB=ASCB ADDRESS                         00760000
.*                                 (11)                   {2}           00770000
.*                                                                      00780000
.*                CMS                                     {2}           00790000
.*                                                                      00800000
.*                CMSALL                                  {2,4}         00810000
.*                                                                      00820000
.*                CMSEQDQ                                 {2}           00830000
.*                                                                      00840000
.*                CMSLATCH                                {2}           00850000
.*                                                                      00860000
.*                CMSSMF                                  {2}           00870000
.*                                                                      00880000
.*                CPU                                     {1}           00890000
.*                                                                      00900000
.*                DISP                                                  00910000
.*                                                                      00920000
.*                ETRSET                                                00930000
.*                                                                      00940000
.*                IOS        ,SCOPE=SHR                                 00950000
.*                                  EXCL                                00960000
.*                                                                      00970000
.*           ***  IOSCAT        NO LONGER SUPPORTED                     00980000
.*                                                                      00990000
.*           ***  IOSLCH        NO LONGER SUPPORTED                     01000000
.*                                                                      01010000
.*                IOSUCB     ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01020000
.*                                 (11)                        (10)     01030000
.*                                                                      01040000
.*                IOSULUT    ,SCOPE=SHR                                 01050000
.*                                  EXCL                                01060000
.*                                                                      01070000
.*                IOSYNCH    ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01080000
.*                                 (11)                        (10)     01090000
.*                                                                      01100000
.*                IXLDS      ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01110000
.*                                 (11)                        (10)     01120000
.*                                                                      01130000
.*                IXLREQST   ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01140000
.*                                 (11)                        (10)     01150000
.*                                                                      01151000
.*                IXLSCH     ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01152000
.*                                 (11)                        (10)     01153000
.*                                                                      01154000
.*                IXLSHELL   ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01155000
.*                                 (11)                        (10)     01156000
.*                                                                      01157000
.*                IXLSHR     ,SCOPE=SHR                                 01157100
.*                                  EXCL                                01157200
.*                                                                      01157300
.*                LOCAL                                   {2}           01157400
.*                                                                      01157500
.*                RSM        ,SCOPE=SHR                                 01157600
.*                                  EXCL                                01157700
.*                                                                      01157800
.*                RSMAD      ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01157900
.*                                 (11)                        (10)     01158000
.*                           *Not Supported*                            01158100
.*                                                                      01158200
.*                RSMCM      ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01158300
.*                                 (11)                        (10)     01158400
.*                           *Not Supported*                            01158500
.*                                                                      01158600
.*                RSMDS      ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01158700
.*                                 (11)                        (10)     01158800
.*                                                                      01158900
.*                RSMGL      ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01159000
.*                                 (11)                        (10)     01159100
.*                                                                      01159200
.*                RSMQ     ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨ @LKA 01159300
.*                                 (11)                        (10)     01159400
.*                                                                      01159500
.*                RSMST      ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01159600
.*                                 (11)                        (10)     01159700
.*                           *Not Supported*                            01159800
.*                                                                      01159900
.*                RSMXM      ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01160000
.*                                 (11)                        (10)     01160100
.*                           *Not Supported*                            01160200
.*                                                                      01160300
.*                SALLOC                                                01160400
.*                                                                      01160500
.*                SRM                                     {4}           01160600
.*                                                                      01160700
.*                TPACBDEB   ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01160800
.*                                 (11)                        (10)     01160900
.*                                                                      01161000
.*           ***  TPDNCB        NO LONGER SUPPORTED                     01161100
.*                                                                      01161200
.*           ***  TPNCB         NO LONGER SUPPORTED                     01161300
.*                                                                      01161400
.*                TRACE      ,SCOPE=SHR                                 01161500
.*                                  EXCL                                01161600
.*                                                                      01161700
.*                VSMFIX                                                01161800
.*                                                                      01161900
.*                VSMPAG                                                01162000
.*                                                                      01162100
.*                XCFDS      ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01162200
.*                                 (11)                        (10)     01162300
.*                                                                      01162400
.*                XCFQ       ,SCOPE=SHR                                 01162500
.*                                  EXCL                                01162600
.*                                                                      01162700
.*                XCFRES     ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01162800
.*                                 (11)                        (10)     01162900
.*                                                                      01163000
.*                WLMRES     ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01163100
.*                                 (11)                        (10)     01163200
.*                                                                      01163300
.*                WLMQ       ,SCOPE=SHR                                 01163400
.*                                  EXCL                                01163500
.*                                                                      01163600
.*                CONTEXT    ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01163700
.*                                 (11)                        (10)     01163800
.*                                                                      01163900
.*                REGSRV     ,SCOPE=SHR                                 01164000
.*                                  EXCL                                01164100
.*                                                                      01164200
.*                SSD        ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01164300
.*                                 (11)                        (10)     01164400
.*                                                                      01164500
.*                GRSINT     ,SCOPE=SHR                                 01164600
.*                                  EXCL                                01164700
.*                                                                      01164800
.*                MISC       ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01164900
.*                                 (11)                        (10)     01165000
.*                                                                      01165100
.*                DONOTUS2   ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01165200
.*                                 (11)                        (10)     01165300
.*                           *Not Supported*                            01165400
.*                                                                      01165500
.*                DONOTUS3   ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01165600
.*                                 (11)                        (10)     01165700
.*                                                                      01165800
.*                DONOTUS4   ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01165900
.*                                 (11)                        (10)     01166000
.*                                                                      01166100
.*                DONOTUS5   ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01166200
.*                                 (11)                        (10)     01166300
.*                                                                      01166400
.*                HCWDRLK2   ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01166500
.*                                 (11)                        (10)     01166600
.*                                                                      01166700
.*                HCWDRLK1   ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01166800
.*                                 (11)                        (10)     01166900
.*                                                                      01167000
.*                SRMENQ     ,SCOPE=SHR                                 01167100
.*                                  EXCL                                01167200
.*                                                                      01167300
.*                SSDGROUP   ,ADDR=LOCKWORD ADDRESS Ý,INSTDATA=data¨    01167400
.*                                 (11)                        (10)     01167500
.*                                                                      01167600
.*                                                                      01167700
.*                                                                      01167800
.*                                                                      01167900
.*          ,MODE=COND                                    {4,6}         01168000
.*                (COND,IN)                               {3,6}         01168100
.*                UNCOND   < ,DISABLED >                  {1,2}         01168200
.*                                                                      01168300
.*        < ,REGS=SAVE                                                  01168400
.*                USE                                     {5}           01168500
.*                STDSAVE  >                                            01168600
.*                                                                      01168700
.*        < ,RELATED=VALUE  >                                           01168800
.*                                                                      01168900
.*   NOTES: SETLOCK OBTAIN ONLY                                         01169000
.*                                                                      01169100
.*     {1}  THE MODE PARAMETER IS IGNORED IF TYPE=CPU IS                01169200
.*          SPECIFIED.                                                  01169300
.*                                                                      01169400
.*     {2}  THE DISABLED PARAMETER MAY NOT BE SPECIFIED WITH            01169500
.*          TYPE=CMS, TYPE=CMSEQDQ, TYPE=CMSSMF, TYPE=CMSLATCH          01169600
.*          TYPE=CMSALL, TYPE=LOCAL, TYPE=CML OR                        01169700
.*          MODE=COND.                                                  01169800
.*                                                                      01169900
.*     {3}  THE MODE=(COND,IN) PARAMETER IS ONLY VALID WITH             01170000
.*          TYPE=CML.                                                   01170100
.*                                                                      01170200
.*     {4}  MODE=COND MAY NOT BE SPECIFIED WITH TYPE=CMSALL             01170301
.*                                                                      01170500
.*     {5}  REGS=USE MAY NOT BE SPECIFIED WITH INSTDATA=.               01170600
.*                                                                      01170800
.*     {6}  INSTDATA= REQUIRES MODE=UNCOND. IT HAS THE SAME             01170900
.*          ADDRESSABILITY REQUIREMENTS AS LOCKWORD.                    01171000
.*                                                                      01171100
.*--------------------------------------------------------------------- 01171200
.*                                                                      01171300
.*        RELEASE                                                       01171400
.*                                                                      01171500
.*          ,TYPE=ALL                                                   01171600
.*                                                                      01171700
.*                ASM        ,ADDR=LOCKWORD ADDRESS                     01171800
.*                                 (11)                                 01171900
.*                                                                      01172000
.*                ASMGL      ,ADDR=LOCKWORD ADDRESS                     01172100
.*                                 (11)                                 01172200
.*                                                                      01172300
.*                BMFLSD     ,ADDR=LOCKWORD ADDRESS                     01172400
.*                                 (11)                                 01172500
.*                                                                      01172600
.*                CML        ,ASCB=ASCB ADDRESS                         01172700
.*                                 (11)                                 01172800
.*                                                                      01172900
.*                CMS                                                   01173000
.*                                                                      01173100
.*                CMSALL                                                01173200
.*                                                                      01173300
.*                CMSEQDQ                                               01173400
.*                                                                      01173500
.*                CMSLATCH                                              01173600
.*                                                                      01173700
.*                CMSSMF                                                01173800
.*                                                                      01173900
.*                CPU                                                   01174000
.*                                                                      01174100
.*                DISP                                                  01174200
.*                                                                      01174300
.*                ETRSET                                                01174400
.*                                                                      01174500
.*                IOS        ,SCOPE=SHR                                 01174600
.*                                  EXCL                                01174700
.*                                                                      01174800
.*           ***  IOSCAT        NO LONGER SUPPORTED                     01174900
.*                                                                      01175000
.*           ***  IOSLCH        NO LONGER SUPPORTED                     01175100
.*                                                                      01175200
.*                IOSUCB     ,ADDR=LOCKWORD ADDRESS                     01175300
.*                                 (11)                                 01175400
.*                                                                      01175500
.*                IOSULUT    ,SCOPE=SHR                                 01175600
.*                                  EXCL                                01175700
.*                                                                      01175800
.*                IOSYNCH    ,ADDR=LOCKWORD ADDRESS                     01175900
.*                                 (11)                                 01176000
.*                                                                      01176100
.*                IXLDS      ,ADDR=LOCKWORD ADDRESS                     01176200
.*                                 (11)                                 01176300
.*                                                                      01176400
.*                IXLREQST   ,ADDR=LOCKWORD ADDRESS                     01176500
.*                                 (11)                                 01176600
.*                                                                      01176700
.*                IXLSCH     ,ADDR=LOCKWORD ADDRESS                     01176800
.*                                 (11)                                 01176900
.*                                                                      01177000
.*                IXLSHELL   ,ADDR=LOCKWORD ADDRESS                     01177100
.*                                 (11)                                 01177200
.*                                                                      01177300
.*                IXLSHR     ,SCOPE=SHR                                 01177400
.*                                  EXCL                                01177500
.*                                                                      01177600
.*                LOCAL                                                 01177700
.*                                                                      01177800
.*                (REG)                                                 01177900
.*                                                                      01178000
.*                RSM        ,SCOPE=SHR                                 01178100
.*                                  EXCL                                01178200
.*                                                                      01178300
.*                RSMAD      ,ADDR=LOCKWORD ADDRESS                     01178400
.*                                 (11)                                 01178500
.*                           *Not Supported*                            01178600
.*                                                                      01178700
.*                RSMCM      ,ADDR=LOCKWORD ADDRESS                     01178800
.*                                 (11)                                 01178900
.*                           *Not Supported*                            01179000
.*                                                                      01179100
.*                RSMDS      ,ADDR=LOCKWORD ADDRESS                     01179200
.*                                 (11)                                 01179300
.*                                                                      01179400
.*                RSMGL      ,ADDR=LOCKWORD ADDRESS                     01179500
.*                                 (11)                                 01179600
.*                                                                      01179700
.*                RSMQ       ,ADDR=LOCKWORD ADDRESS                @LKA 01179800
.*                                 (11)                                 01179900
.*                                                                      01180000
.*                RSMST      ,ADDR=LOCKWORD ADDRESS                     01180100
.*                                 (11)                                 01180200
.*                           *Not Supported*                            01180300
.*                                                                      01180400
.*                RSMXM      ,ADDR=LOCKWORD ADDRESS                     01180500
.*                                 (11)                                 01180600
.*                           *Not Supported*                            01180700
.*                                                                      01180800
.*                SALLOC                                                01180900
.*                                                                      01181000
.*                SPIN                                                  01181100
.*                                                                      01181200
.*                SRM                                                   01181300
.*                                                                      01181400
.*                TPACBDEB   ,ADDR=LOCKWORD ADDRESS                     01181500
.*                                 (11)                                 01181600
.*                                                                      01181700
.*           ***  TPDNCB        NO LONGER SUPPORTED                     01181800
.*                                                                      01181900
.*           ***  TPNCB         NO LONGER SUPPORTED                     01182000
.*                                                                      01182100
.*                TRACE      ,SCOPE=SHR                                 01182200
.*                                  EXCL                                01182300
.*                                                                      01182400
.*                VSMFIX                                                01182500
.*                                                                      01182600
.*                VSMPAG                                                01182700
.*                                                                      01182800
.*                XCFDS      ,ADDR=LOCKWORD ADDRESS                     01182900
.*                                 (11)                                 01183000
.*                                                                      01183100
.*                XCFQ       ,SCOPE=SHR                                 01183200
.*                                  EXCL                                01183300
.*                                                                      01183400
.*                XCFRES     ,ADDR=LOCKWORD ADDRESS                     01183500
.*                                 (11)                                 01183600
.*                                                                      01183700
.*                WLMRES     ,ADDR=LOCKWORD ADDRESS                     01183800
.*                                 (11)                                 01183900
.*                                                                      01184000
.*                WLMQ       ,SCOPE=SHR                                 01184100
.*                                  EXCL                                01184200
.*                                                                      01184300
.*                CONTEXT    ,ADDR=LOCKWORD ADDRESS                     01184400
.*                                 (11)                                 01184500
.*                                                                      01184600
.*                REGSRV     ,SCOPE=SHR                                 01184700
.*                                  EXCL                                01184800
.*                                                                      01184900
.*                SSD        ,ADDR=LOCKWORD ADDRESS                     01185000
.*                                 (11)                                 01185100
.*                                                                      01185200
.*                GRSINT     ,SCOPE=SHR                                 01185300
.*                                  EXCL                                01185400
.*                                                                      01185500
.*                MISC       ,ADDR=LOCKWORD ADDRESS                     01185600
.*                                 (11)                                 01185700
.*                                                                      01185800
.*                DONOTUS2   ,ADDR=LOCKWORD ADDRESS                     01185900
.*                                 (11)                                 01186000
.*                           *Not Supported*                            01186100
.*                                                                      01186200
.*                DONOTUS3   ,ADDR=LOCKWORD ADDRESS                     01186300
.*                                 (11)                                 01186400
.*                                                                      01186500
.*                DONOTUS4   ,ADDR=LOCKWORD ADDRESS                     01186600
.*                                 (11)                                 01186700
.*                                                                      01186800
.*                DONOTUS5   ,ADDR=LOCKWORD ADDRESS                     01186900
.*                                 (11)                                 01187000
.*                                                                      01187100
.*                HCWDRLK2   ,ADDR=LOCKWORD ADDRESS                     01187200
.*                                 (11)                                 01187300
.*                                                                      01187400
.*                HCWDRLK1   ,ADDR=LOCKWORD ADDRESS                     01187500
.*                                 (11)                                 01187600
.*                                                                      01187700
.*                SRMENQ     ,SCOPE=SHR                                 01187800
.*                                  EXCL                                01187900
.*                                                                      01188000
.*                SSDGROUP   ,ADDR=LOCKWORD ADDRESS                     01188100
.*                                 (11)                                 01188200
.*                                                                      01188300
.*                                                                      01188400
.*        < ,DISABLED >                                                 01188500
.*                                                                      01188600
.*        < ,REGS=SAVE                                                  01188700
.*                USE                                                   01188800
.*                STDSAVE  >                                            01188900
.*                                                                      01189000
.*        < ,RELATED=VALUE  >                                           01189100
.*                                                                      01189200
.*--------------------------------------------------------------------- 01189300
.*                                                                      01189400
.*        TEST                                                          01189500
.*                                                                      01189600
.*          ,TYPE=ALL                                                   01189700
.*                                                                      01189800
.*                ALOCAL   < ,LOCKHLD=(SYMBOLIC REG) >                  01189900
.*                                                                      01190000
.*                ASM      < ,ADDR=(SYMBOLIC REG) >                     01190100
.*                                                                      01190200
.*                ASMGL    < ,ADDR=(SYMBOLIC REG) >                     01190300
.*                                                                      01190400
.*                BMFLSD   < ,ADDR=(SYMBOLIC REG) >      {3}            01190500
.*                                                                      01190600
.*                CML        ,ASCB=(SYMBOLIC REG)                       01190700
.*                           ,LOCKHLD=(SYMBOLIC REG)     {4}            01190800
.*                                                                      01190900
.*                CMS                                                   01191000
.*                                                                      01191100
.*                CPU      < ,LOCKHLD=(SYMBOLIC REG) >                  01191200
.*                                                                      01191300
.*                DISP                                                  01191400
.*                                                                      01191500
.*                ETRSET                                 {3}            01191600
.*                                                                      01191700
.*                HIER       ,LOCK=ASM                   {3}            01191800
.*                                 ASMGL                 {3}            01191900
.*                                 BMFLSD                {3}            01192000
.*                                 DISP                  {3}            01192100
.*                                 ETRSET                {3}            01192200
.*                                 IOS                   {3}            01192300
.*                                 IOSUCB                {3}            01192400
.*                                 IOSULUT               {3}            01192500
.*                                 IOSYNCH               {3}            01192600
.*                                 IXLDS                 {3}            01192700
.*                                 IXLSCH                {3}            01192800
.*                                 IXLREQST              {3}            01192900
.*                                 IXLSHELL              {3}            01193000
.*                                 IXLSHR                {3}            01193100
.*                                 RSM                   {3}            01193200
.* *Not Supported*                 RSMAD                 {3}            01193300
.* *Not Supported*                 RSMCM                 {3}            01193400
.*                                 RSMDS                 {3}            01193500
.*                                 RSMGL                 {3}            01193600
.*                                 RSMQ                  {3}       @LKA 01193700
.* *Not Supported*                 RSMST                 {3}            01193800
.* *Not Supported*                 RSMXM                 {3}            01193900
.*                                 SALLOC                {3}            01194000
.*                                 SRM                   {3}            01194100
.*                                 TPACBDEB              {3}            01194200
.*                                 TPDNCB                {3}            01194300
.*                                 TPNCB                 {3}            01194400
.*                                 TRACE                 {3}            01194500
.*                                 VSMFIX                {3}            01194600
.*                                 VSMPAG                {3}            01194700
.*                                 XCFDS                 {3}            01194800
.*                                 XCFQ                  {3}            01194900
.*                                 XCFRES                {3}            01195000
.*                                 WLMRES                {3}            01195100
.*                                 WLMQ                  {3}            01195200
.*                                 CONTEXT               {3}            01195300
.*                                 REGSRV                {3}            01195400
.*                                 SSD                   {3}            01195500
.*                                 GRSINT                {3}            01195600
.*                                 MISC                  {3}            01195700
.*                                 DONOTUS2              {3}            01195800
.*                                 DONOTUS3              {3}            01195900
.*                                 DONOTUS4              {3}            01196000
.*                                 DONOTUS5              {3}            01196100
.*                                 HCWDRLK2              {3}            01196200
.*                                 HCWDRLK1              {3}            01196300
.*                                 SRMENQ                {3}            01196400
.*                                 SSDGROUP              {3}            01196500
.*                                                                      01196600
.*                IOS      < ,SCOPE=SHR                                 01196700
.*                                  EXCL >                              01196800
.*                                                                      01196900
.*           ***  IOSCAT        NO LONGER SUPPORTED                     01197000
.*                                                                      01197100
.*           ***  IOSLCH        NO LONGER SUPPORTED                     01197200
.*                                                                      01197300
.*                IOSUCB   < ,ADDR=(SYMBOLIC REG) >                     01197400
.*                                                                      01197500
.*                IOSULUT  < ,SCOPE=SHR                                 01197600
.*                                  EXCL >               {3}            01197700
.*                                                                      01197800
.*                IOSYNCH  < ,ADDR=(SYMBOLIC REG) >                     01197900
.*                                                                      01198000
.*                IXLDS    < ,ADDR=(SYMBOLIC REG) >      {3}            01198100
.*                                                                      01198200
.*                IXLREQST < ,ADDR=(SYMBOLIC REG) >      {3}            01198300
.*                                                                      01198400
.*                IXLSCH   < ,ADDR=(SYMBOLIC REG) >      {3}            01198500
.*                                                                      01198600
.*                IXLSHELL < ,ADDR=(SYMBOLIC REG) >      {3}            01198700
.*                                                                      01198800
.*                IXLSHR   < ,SCOPE=SHR                                 01198900
.*                                  EXCL >                              01199000
.*                                                                      01199100
.*                LOCAL                                                 01199200
.*                                                                      01199300
.*                (REG)    < ,REGS=(SYMBOLIC REG) >      {1,5}          01199400
.*                                                                      01199500
.*                RSM      < ,SCOPE=SHR                                 01199600
.*                                  EXCL >                              01199700
.*                                                                      01199800
.*                RSMAD    < ,ADDR=(SYMBOLIC REG) >                     01199900
.*                           *Not Supported*                            01200000
.*                                                                      01200100
.*                RSMCM    < ,ADDR=(SYMBOLIC REG) >                     01200200
.*                           *Not Supported*                            01200300
.*                                                                      01200400
.*                RSMDS    < ,ADDR=(SYMBOLIC REG) >                     01200500
.*                                                                      01200600
.*                RSMGL    < ,ADDR=(SYMBOLIC REG) >                     01200700
.*                                                                      01200800
.*                RSMQ     < ,ADDR=(SYMBOLIC REG) >                @LKA 01200900
.*                                                                      01201000
.*                RSMST    < ,ADDR=(SYMBOLIC REG) >                     01201100
.*                           *Not Supported*                            01201200
.*                                                                      01201300
.*                RSMXM    < ,ADDR=(SYMBOLIC REG) >                     01201400
.*                           *Not Supported*                            01201500
.*                                                                      01201600
.*                SALLOC                                                01201700
.*                                                                      01201800
.*                SPIN                                   {3}            01201900
.*                                                                      01202000
.*                SRM                                                   01202100
.*                                                                      01202200
.*                TPACBDEB < ,ADDR=(SYMBOLIC REG) >                     01202300
.*                                                                      01202400
.*           ***  TPDNCB        NO LONGER SUPPORTED                     01202500
.*                                                                      01202600
.*           ***  TPNCB         NO LONGER SUPPORTED                     01202700
.*                                                                      01202800
.*                TRACE    < ,SCOPE=SHR                                 01202900
.*                                  EXCL >                              01203000
.*                                                                      01203100
.*                VSMFIX                                                01203200
.*                                                                      01203300
.*                VSMPAG                                                01203400
.*                                                                      01203500
.*                XCFDS    < ,ADDR=(SYMBOLIC REG) >      {3}            01203600
.*                                                                      01203700
.*                XCFQ     < ,SCOPE=SHR                  {3}            01203800
.*                                  EXCL >                              01203900
.*                                                                      01204000
.*                XCFRES   < ,ADDR=(SYMBOLIC REG) >      {3}            01204100
.*                                                                      01204200
.*                WLMRES   < ,ADDR=(SYMBOLIC REG) >      {3}            01204300
.*                                                                      01204400
.*                WLMQ     < ,SCOPE=SHR                  {3}            01204500
.*                                  EXCL >                              01204600
.*                                                                      01204700
.*                CONTEXT  < ,ADDR=(SYMBOLIC REG) >      {3}            01204800
.*                                                                      01204900
.*                REGSRV   < ,SCOPE=SHR                  {3}            01205000
.*                                  EXCL >                              01205100
.*                                                                      01205200
.*                SSD      < ,ADDR=(SYMBOLIC REG) >      {3}            01205300
.*                                                                      01205400
.*                GRSINT   < ,SCOPE=SHR                  {3}            01205500
.*                                  EXCL >                              01205600
.*                                                                      01205700
.*                MISC < ,ADDR=(SYMBOLIC REG) >          {3}            01205800
.*                                                                      01205900
.*                DONOTUS2 < ,ADDR=(SYMBOLIC REG) >      {3}            01206000
.*                           *Not Supported*                            01206100
.*                                                                      01206200
.*                DONOTUS3 < ,ADDR=(SYMBOLIC REG) >      {3}            01206300
.*                                                                      01206400
.*                DONOTUS4 < ,ADDR=(SYMBOLIC REG) >      {3}            01206500
.*                                                                      01206600
.*                DONOTUS5 < ,ADDR=(SYMBOLIC REG) >      {3}            01206700
.*                                                                      01206800
.*                HCWDRLK2 < ,ADDR=(SYMBOLIC REG) >      {3}            01206900
.*                                                                      01207000
.*                HCWDRLK1 < ,ADDR=(SYMBOLIC REG) >      {3}            01207100
.*                                                                      01207200
.*                SRMENQ   < ,SCOPE=SHR                  {3}            01207300
.*                                  EXCL >                              01207400
.*                                                                      01207500
.*                SSDGROUP < ,ADDR=(SYMBOLIC REG) >      {3}            01207600
.*                                                                      01207700
.*                                                                      01207800
.*                                                                      01207900
.*       < ,BRANCH=(HELD,LABEL)                                         01208000
.*                 (NOTHELD,LABEL) >                     {2,3,5}        01208100
.*                                                                      01208200
.*       < ,WORKREG=(SYMBOLIC REG) >                     {1,2}          01208300
.*                                                                      01208400
.*       < ,RELATED=VALUE >                                             01208500
.*                                                                      01208600
.*   NOTES: SETLOCK TEST ONLY                                           01208700
.*                                                                      01208800
.*     {1}  THE WORKREG PARAMETER CANNOT BE SPECIFIED WITH              01208900
.*          TYPE=(REG).                                                 01209000
.*                                                                      01209100
.*     {2}  THE WORKREG PARAMETER WILL BE IGNORED IF THE                01209200
.*          BRANCH PARAMETER IS NOT SPECIFIED.                          01209300
.*                                                                      01209400
.*     {3}  IF THE WORKREG PARAMETER IS SPECIFIED WITH                  01209500
.*          TYPE=SPIN, TYPE=HIER, TYPE=BMFLSD, TYPE=ETRSET,             01209600
.*          TYPE=XCFDS, TYPE=XCFRES, TYPE=XCFQ,                         01209700
.*          TYPE=WLMRES, TYPE=WLMQ, TYPE=CONTEXT, TYPE=REGSRV,          01209800
.*          TYPE=IOSULUT, TYPE=IXLDS, TYPE=IXLREQST, TYPE=IXLSCH,       01209900
.*          TYPE=IXLSHELL, TYPE=IXLSHR, TYPE=GRSINT, TYPE=SRMENQ,       01210000
.*          TYPE=SSDGROUP, or TYPE=SSD, then the branch                 01210100
.*          parameter is requred.                                       01210200
.*                                                                      01210300
.*     {4}  IF THE TYPE=CML PARAMETER IS SPECIFIED, THEN                01210400
.*          THE LOCKHLD AND/OR ASCB PARAMETERS MUST BE                  01210500
.*          SPECIFIED.                                                  01210600
.*                                                                      01210700
.*     {5}  The REGS parameter, if specified, is only valid with        01210800
.*          TYPE=(REG).  REGS is REQUIRED if BOTH TYPE=(REG)            01210900
.*          and the BRANCH keywords are specified.                      01211000
.*                                                                      01211100
.*--------------------------------------------------------------------- 01211200
.*                                                                      01211300
.*01*   CHANGE ACTIVITY =                                               01211400
.*    OZ35343 - CHANGE REFERENCES TO PSA LOCATIONS TO USE EXPLICIT      01211500
.*              ADDRESSABILITY SO THAT A USING PSA,0 IS NOT NEEDED TO   01211600
.*              INVOKE THE MACRO                                        01211700
.*                                                                      01211800
.*  $L1=AR       HBB3310  850801  PD16H4:  ACCESS REGISTER SUPPORT      01211900
.*  $L2=DATASPAC HBB3310  860220  PD22XB:  AR-MODE INVOKER SUPPORT      01212000
.*  $L3=DATASPAC HBB3310  860903  PD16Q4:  RSMDS LOCK                   01212100
.*  $D1=DCR0031  HBB3310  860903  PD16Q4:  IOS LOCK                     01212200
.*  $P1=PC40381  HBB3310  861101  PD16H4:  LOAD PARMS BEFORE PSALITA    01212300
.*  $P2=PC40337  HBB3310  861229  PD16Q4:  TEST FOR LOCK PARM WHEN      01212400
.*                                         TYPE=HIER IS NOT SPECIFIED   01212500
.*                                         ON TEST OPTION               01212600
.*  $L4=LOCKR    HBB4410  880715  PD16BN:  ADD STDSAVE OPTION FOR       01212700
.*                                         REGS KEYWORD                 01212800
.*  $L5=COUPL    HBB4410  880715  PD16BN:  XCFDS,XCFRES,XCFQ LOCKS      01212900
.*  $L6=CLOCK    HBB4410  870831  PD16BN:  ETRSET LOCK                  01213000
.*  $L7=JUP03    HBB4410  880715  PD16BN:  BMFLSD LOCK                  01213100
.*  $L8=LOCKR    HBB4410  870831  PD16BN:  LOCK RESTRUCTURE             01213200
.*  $P3=PEO0033  HBB4410  871026  PD16BN:  ADD SPACE AFTER COMMA ON     01213300
.*                                         SETLOCK8 INVOCATION          01213400
.*  $P4=PHB1079  HBB4410  890313  PD16BN:  PUT OUT CORRECT MNOTE FOR    01213500
.*                                         OBTAIN,TYPE=ALL              01213600
.*  $L9=USERV    FBB4418  890626  PD16EJ:  UCB SERVICES SUPPORT         01213700
.*                                         IOSULUT SPIN LOCK ADDED      01213800
.*  $LA=SYSLK    HBB5510  890821  PD16EJ:  SYSTEM LOCK MANAGER SUPPORT. 01213900
.*  $LB=SYSLK    HBB5510  900904  PD16EI:  SYSTEM LOCK MANAGER LOCK     01214000
.*                                         CHANGES                      01214100
.*  $P5=PIG0101  HBB5510  920812  PD16IG:  Changed error messages for   01214200
.*                                         SETLOCK TEST w/ REGS         01215000
.*  $01=OW02794  HBB5510  931207  PD162M:  IXLREQST spin lock added     01216000
.*  $LC=WLMPASM  HBB6603  951212  PD16FB:  WLM, CONTEXT services Locks  01217000
.*  $LD=PRSER    HBB7706  001015  B7HGH5:  SSD Lock                     01218000
.*  $LE=CMSLATC  HBB7706  010307  B7VBGD:  CMS Latching lock            01219000
.*  $P6=PJK1357  HBB7709  031226  PD00XB:  Relative branch              01220000
.*  $LF=GRSLOCK  HBB7740  060502  U2IAXZ:  GRSINT lock                  01230000
.*     =ME08509  HBB7740  061115  PD00KD:  License update               01240000
.*  $LG=DDMINF   HBB7760  080324  U2IAXZ:  DDM locks                    01241000
.*  $LH=SRMLOCK  HBB7780  091231  PD00KP:  SRMENQ lock                  01242000
.*  $LI=SPNINST  HBB7780  100226  PD00BS:  Spin Lock Instrumentation    01243000
.*  $LJ=DYNEXITS HBB77A0  130430  PD00XB:  MISC lock                    01244000
.*  $LK=RSMQ     HBB77A0  130901  PD00XB:  RSMQ                         01244100
.*  $LL=IEASEM   HBB77A0  130901  PD00XB:  IEASEM                       01244200
.*  $LM=MLTPAUSE HBB77A0  131003  PD00KD:  SSDGROUP lock                01244300
.*  $LN=HDEXT    HBB77B0  170630  PD00NJ:  restrict SRM lock to UNCOND  01244400
.*  $LO=W226335  HBB77C0  180105  PD00XB:  Support Flag(Page0)          01244500
.*  $LP=W377825  HBB77D0  200601  PD00XB:  Allow SRM COND               01244604
.*                                                                      01244700
.**************************************************************@G50EPXS 01244800
.*                                                                      01244900
.*   CMSSMF LOCK SUPPORT                                       @G741PXT 01245000
.*   CML LOCK SUPPORT                                          @G387PXR 01245100
.*   DELETE IOSCAT,IOSLCH LOCKS                                @G860PXB 01245200
.*   CHANGES FOR SALLOC LOCK BREAKUP                           @G860PXA 01245300
.*   ADD CPU LOCK                                              @G860PXA 01246000
.*   CML TEST SUPPORT                                          @G382PXR 01247000
.*   ADD TEST SUPPORT FOR THE SALLOC LOCK BREAKUP              @G860PXA 01248000
.*   SUPPORT NEW INTERFACE FOR RELEASE ALL AND RELEASE REG     @G860PXA 01249000
.*   CPU TEST SUPPORT                                          @G860PXK 01250000
.*   ADD RSMCM LOCK                                            @G860PXJ 01260000
.*   ADD TEST SUPPORT FOR TYPE=HIER                            @G860PXA 01270000
.*   ADD "MODE=(COND,IN)" SUPPORT FOR CML LOCK OBTAIN              @L1A 01280000
.*   ADD RSMDS LOCK                                                @L3A 01290000
.*   ADD IOS LOCK                                                  @D1A 01300000
.*   ADD STDSAVE                                                   @L4A 01310000
.*   ADD XCFDS, XCFRES, AND XCFQ LOCKS                             @L5A 01320000
.*   ADD ETRSET LOCK                                               @L6A 01330000
.*   ADD BMFLSD LOCK                                               @L7A 01340000
.*   ADD LOCK RESTRUCTURE SUPPORT                                  @L8A 01350000
.*   ADD IOSULUT LOCK SUPPORT                                      @L9A 01360000
.*   ADD IXLSCH, IXLSHR, IXLDS, AND IXLSHELL LOCKS                 @LBA 01370000
.*   ADD IXLREQST LOCK                                             @01A 01380000
.*   ADD WLMRES, WLMQ LOCKS, CONTEXT LOCKS, REGSRV LOCKS           @LCA 01390000
.*   ADD SSD LOCK                                                  @LDA 01400000
.*   ADD CMSLATCH LOCK                                             @LEA 01410000
.*   ADD GRSINT LOCK                                               @LFA 01420000
.*   ADD MISC, DONOTUS2, DONOTUS3, DONOTUS4, DONUTUS5,                  01430000
.*       HCWDRLK2, and HCWDRLK1 locks.                             @LGA 01440000
.*   ADD SRMENQ LOCK                                               @LHA 01441000
.*   ADD INSTDATA parameter for spin lock instrumentation          @LIA 01442000
.*   ADD RSMQ lock                                                 @LKA 01443000
.*   ADD SSDGROUP lock                                             @LMA 01443100
.*                                                                      01443200
.**************************************************************@G860PXK 01443300
.*                                                                      01443400
         GBLC  &SYSASCE             GLOBAL FOR SYSSTATE MACRO      @L2A 01443500
         GBLA  &SYSALVL             GLOBAL FOR SYSSTATE MACRO      @P6A 01443600
         SYSSTATE TEST              OBTAIN DEFAULT SYSASCE         @L2A 01443700
         GBLC  &SYSSPLV             GLOBAL FOR SPLEVEL MACRO   @G860PXD 01443800
         SPLEVEL TEST               OBTAIN DEFAULT SYSSPLV     @G860PXD 01443900
         AIF   ('&SYSSPLV' LT '4').LEVEL1   GO GEN DOWNWARD        @L8C 01444000
.*                                  COMPATIBLE MACRO                    01444100
         GBLC  &MESSAGE                                                 01444200
         LCLA  &INDEX                                              @L8C 01444300
         LCLA  &OFSET,&MASK,&BYTE                                       01444400
         LCLA  &X,&FCN,&PSAPTR                                     @L8A 01444500
         LCLC  &B,&LA                                              @LJC 01444600
         LCLA  &COBT(80),&UOBT(80),&REL(80),&RELD(80)              @LFC 01444700
         LCLC  &MESSAG2,&REG1                                      @L8C 01444800
         LCLC  &LABEL                                              @L8C 01444900
         LCLC  &LKNAMES(80)                                        @LFC 01445000
         LCLC  &GNAME1,&GNAME3                                     @LJC 01446000
         GBLC  &SYSAM64                                            @LEA 01447000
         SYSSTATE TEST                                             @LEA 01448000
         AIF   ('&SYSAM64' NE 'YES').AM641                         @LEA 01449000
         MNOTE 8,'SETLOCK ---> MUST NOT BE INVOKED IN AMODE 64'    @LEA 01450000
.AM641   ANOP                                                      @LEA 01451000
&B       SETC  'B'                                                 @P6A 01452000
&LA      SETC  'LA'                                                     01453000
         AIF   (&SYSALVL LT 1).NOTALVL1                            @P6A 01454000
&B       SETC  'J'                                                 @P6A 01455000
.NOTALVL1 ANOP                                                     @P6A 01456000
         AIF   (&SYSALVL LT 2).NOTALVL2                            @LJA 01457000
&LA      SETC  'LARL'                                                   01458000
.NOTALVL2 ANOP                                                     @LJA 01459000
         AIF   ('&TYPE' EQ 'RSMAD').Not_Supported                  @LLA 01460000
         AIF   ('&TYPE' EQ 'RSMXM').Not_Supported                  @LLA 01461000
         AIF   ('&TYPE' EQ 'RSMST').Not_Supported                  @LLA 01461100
         AIF   ('&TYPE' NE 'RSMCM').OK_Continue                    @LLA 01461200
.Not_Supported ANOP                                                @LLA 01461300
         MNOTE 12,'&TYPE LOCK is not supported'                    @LLA 01461400
         MEXIT                                                     @LLA 01461500
.OK_Continue ANOP                                                  @LLA 01461600
.*                                                                      01461700
.*******************************************************************    01461800
.*                                                                 *    01461900
.*       LOCK NAMES                                                *    01462000
.*                                                                 *    01463000
.*******************************************************************    01463100
.*                                                                      01463200
&LKNAMES(1)  SETC 'DISP'                                           @L8A 01463300
&LKNAMES(2)  SETC 'RSMDS'                                          @L8A 01463400
&LKNAMES(3)  SETC 'IOSUCB'                                         @L8A 01463500
&LKNAMES(4)  SETC 'IOSLCH'                                         @L8A 01463600
&LKNAMES(5)  SETC 'IOSYNCH'                                        @L8A 01463700
&LKNAMES(6)  SETC 'TPNCB'                                          @L8A 01463800
&LKNAMES(7)  SETC 'TPDNCB'                                         @L8A 01463900
&LKNAMES(8)  SETC 'TPACBDEB'                                       @L8A 01464000
&LKNAMES(9)  SETC 'ASM'                                            @L8A 01465000
&LKNAMES(10) SETC 'SALLOC'                                         @L8A 01466000
&LKNAMES(11) SETC 'SRM'                                            @L8A 01467000
&LKNAMES(12) SETC 'CMS'                                            @L8A 01468000
&LKNAMES(13) SETC 'LOCAL'                                          @L8A 01469000
&LKNAMES(14) SETC 'SPIN'                                           @L8A 01470000
&LKNAMES(15) SETC 'CMSEQDQ'                                        @L8A 01471000
&LKNAMES(16) SETC 'CMSALL'                                         @L8A 01472000
&LKNAMES(17) SETC 'ALLCMSHELD'                                     @L8A 01473000
&LKNAMES(18) SETC 'CMSSMF'                                         @L8A 01474000
&LKNAMES(19) SETC 'CML'                                            @L8A 01475000
&LKNAMES(20) SETC 'TRACE_S'                                        @L8A 01476000
&LKNAMES(21) SETC 'TRACE_E'                                        @L8A 01477000
&LKNAMES(22) SETC 'VSMPAG'                                         @L8A 01478000
&LKNAMES(23) SETC 'RSM_S'                                          @L8A 01479000
&LKNAMES(24) SETC 'RSM_E'                                          @L8A 01480000
&LKNAMES(25) SETC 'RSMAD'                                          @L8A 01490000
&LKNAMES(26) SETC 'RSMXM'                                          @L8A 01491000
&LKNAMES(27) SETC 'RSMST'                                          @L8A 01492000
&LKNAMES(28) SETC 'ASMGL'                                          @L8A 01493000
&LKNAMES(29) SETC 'VSMFIX'                                         @L8A 01494000
&LKNAMES(30) SETC 'RSMGL'                                          @L8A 01495000
&LKNAMES(31) SETC 'CPU'                                            @L8A 01496000
&LKNAMES(32) SETC 'ALL'                                            @L8A 01497000
&LKNAMES(33) SETC '(REG)'                                          @L8A 01498000
&LKNAMES(34) SETC 'RSMCM'                                          @L8A 01499000
&LKNAMES(35) SETC 'IOS_S'                                          @L8A 01500000
&LKNAMES(36) SETC 'IOS_E'                                          @L8A 01501000
&LKNAMES(37) SETC 'BMFLSD'                                         @L7A 01502000
&LKNAMES(38) SETC 'ETRSET'                                         @L6A 01503000
&LKNAMES(39) SETC 'XCFDS'                                          @L5A 01504000
&LKNAMES(40) SETC 'XCFRES'                                         @L5A 01505000
&LKNAMES(41) SETC 'XCFQ_S'                                         @L5A 01506000
&LKNAMES(42) SETC 'XCFQ_E'                                         @L5A 01507000
&LKNAMES(43) SETC 'IOSULUT_S'                                      @L9A 01508000
&LKNAMES(44) SETC 'IOSULUT_E'                                      @L9A 01509000
&LKNAMES(45) SETC 'IXLSCH'                                         @LBC 01510000
&LKNAMES(46) SETC 'IXLSHR_S'                                       @LBC 01511000
&LKNAMES(47) SETC 'IXLSHR_E'                                       @LBC 01512000
&LKNAMES(48) SETC 'IXLDS'                                          @LBC 01513000
&LKNAMES(49) SETC 'IXLSHELL'                                       @LBA 01514000
&LKNAMES(50) SETC 'IXLREQST'                                       @01A 01515000
&LKNAMES(51) SETC 'WLMQ_S'                                         @LCA 01516000
&LKNAMES(52) SETC 'WLMQ_E'                                         @LCA 01517000
&LKNAMES(53) SETC 'WLMRES'                                         @LCA 01518000
&LKNAMES(54) SETC 'REGSRV_S'                                       @LCA 01519000
&LKNAMES(55) SETC 'REGSRV_E'                                       @LCA 01520000
&LKNAMES(56) SETC 'CONTEXT'                                        @LCA 01521000
&LKNAMES(57) SETC 'SSD'                                            @LDA 01522000
&LKNAMES(58) SETC 'CMSLATCH'                                       @LEA 01523000
&LKNAMES(59) SETC 'GRSINT_S'                                       @LFA 01524000
&LKNAMES(60) SETC 'GRSINT_E'                                       @LFA 01525000
&LKNAMES(61) SETC 'MISC'                                           @LJC 01526000
&LKNAMES(62) SETC 'DONOTUS2'                                       @LJC 01527000
&LKNAMES(63) SETC 'DONOTUS3'                                       @LJC 01528000
&LKNAMES(64) SETC 'DONOTUS4'                                       @LJC 01528100
&LKNAMES(65) SETC 'DONOTUS5'                                       @LJC 01528200
&LKNAMES(66) SETC 'HCWDRLK2'                                       @LGA 01528300
&LKNAMES(67) SETC 'HCWDRLK1'                                       @LGA 01528400
&LKNAMES(68) SETC 'SRMENQ_S'                                       @LHA 01528500
&LKNAMES(69) SETC 'SRMENQ_E'                                       @LHA 01528600
.* Entries 70-74 are SETLOCKP only                                      01528700
&LKNAMES(75) SETC 'RSMQ'                                           @LKA 01528800
&LKNAMES(76) SETC 'SSDGROUP'                                       @LMA 01528900
.*                                                                      01529000
.*******************************************************************    01530000
.*                                                                 *    01530100
.*       CONDITIONAL OBTAIN LIT OFFSETS (DECIMAL)                  *    01530200
.*                                                                 *    01530300
.*******************************************************************    01530400
.*                                                                      01530500
&COBT(1)     SETA 0           DISPATCHER LOCK                      @L8A 01530600
&COBT(2)     SETA 48          RSMDS LOCK                           @L8A 01530700
&COBT(3)     SETA 96          IOSUCB LOCK                          @L8A 01530800
&COBT(4)     SETA 144         IOSLCH LOCK - NO LONGER SUPPORTED    @L8A 01530900
&COBT(5)     SETA 192         IOSYNCH LOCK                         @L8A 01531000
&COBT(6)     SETA 240         TPNCB LOCK - NO LONGER SUPPORTED     @L8A 01532000
&COBT(7)     SETA 288         TPDNCB LOCK - NO LONGER SUPPORTED    @L8A 01533000
&COBT(8)     SETA 336         TPACBDEB LOCK                        @L8A 01534000
&COBT(9)     SETA 384         ASM LOCK                             @L8A 01535000
&COBT(10)    SETA 432         SALLOC LOCK                          @L8A 01536000
&COBT(11)    SETA 480         SRM lock                             @LPC 01537104
&COBT(12)    SETA 528         CMS LOCK                             @L8A 01538000
&COBT(13)    SETA 564         LOCAL LOCK                           @L8A 01539000
&COBT(14)    SETA -1          SPIN - USED FOR RELEASE ONLY         @L8A 01540000
&COBT(15)    SETA 612         CMSEQDQ LOCK                         @L8A 01550000
&COBT(16)    SETA -1          CMSALL - COND OBTAIN NOT SUPPORTED   @L8A 01551000
&COBT(17)    SETA -1          ALL CMS LOCKS HELD- FOR RELEASE ONLY @L8A 01552000
&COBT(18)    SETA 684         CMSSMF LOCK                          @L8A 01553000
&COBT(19)    SETA 720         CML LOCK                             @L8A 01554000
&COBT(20)    SETA 756         TRACE LOCK - SHARED ENTRY            @L8A 01555000
&COBT(21)    SETA 804         TRACE LOCK - EXCLUSIVE ENTRY         @L8A 01556000
&COBT(22)    SETA 852         VSMPAG LOCK                          @L8A 01557000
&COBT(23)    SETA 900         RSM LOCK - SHARED ENTRY              @L8A 01558000
&COBT(24)    SETA 948         RSM LOCK - EXCLUSIVE ENTRY           @L8A 01559000
&COBT(25)    SETA 996         RSMAD LOCK                           @L8A 01560000
&COBT(26)    SETA 1044        RSMXM LOCK                           @L8A 01561000
&COBT(27)    SETA 1092        RSMST LOCK                           @L8A 01562000
&COBT(28)    SETA 1140        ASMGL LOCK                           @L8A 01563000
&COBT(29)    SETA 1188        VSMFIX LOCK                          @L8A 01564000
&COBT(30)    SETA 1236        RSMGL LOCK                           @L8A 01565000
&COBT(31)    SETA 1284        CPU LOCK                             @L8A 01566000
&COBT(32)    SETA -1          ALL - USED FOR RELEASE ONLY          @L8A 01567000
&COBT(33)    SETA -1          (REG) - USED FOR RELEASE ONLY        @L8A 01568000
&COBT(34)    SETA 1356        RSMCM LOCK                           @L8A 01569000
&COBT(35)    SETA 1420        IOS LOCK - SHARED ENTRY              @L8A 01570000
&COBT(36)    SETA 1468        IOS LOCK - EXCLUSIVE ENTRY           @L8A 01571000
&COBT(37)    SETA 0           BMFLSD LOCK                          @L7A 01572000
&COBT(38)    SETA 48          ETRSET LOCK                          @L6A 01573000
&COBT(39)    SETA 96          XCFDS LOCK                           @L5A 01574000
&COBT(40)    SETA 144         XCFRES LOCK                          @L5A 01575000
&COBT(41)    SETA 192         XCFQ LOCK - SHARED ENTRY             @L5A 01576000
&COBT(42)    SETA 240         XCFQ LOCK - EXCLUSIVE ENTRY          @L5A 01577000
&COBT(43)    SETA 292         IOSULUT LOCK - SHARED ENTRY          @L9A 01578000
&COBT(44)    SETA 340         IOSULUT LOCK - EXCLUSIVE ENTRY       @L9A 01579000
&COBT(45)    SETA 388         IXLSCH LOCK                          @LBC 01580000
&COBT(46)    SETA 436         IXLSHR LOCK - SHARED ENTRY           @LBC 01590000
&COBT(47)    SETA 484         IXLSHR LOCK - EXCLUSIVE ENTRY        @LBA 01591000
&COBT(48)    SETA 532         IXLDS LOCK                           @LBC 01592000
&COBT(49)    SETA 580         IXLSHELL LOCK                        @LBC 01593000
&COBT(50)    SETA 628         IXLREQST LOCK                        @01A 01593100
&COBT(51)    SETA 676         WLMQ LOCK - SHARED ENTRY             @LCA 01593200
&COBT(52)    SETA 724         WLMQ LOCK - EXCLUSIVE ENTRY          @LCA 01593300
&COBT(53)    SETA 772         WLMRES LOCK                          @LCA 01593400
&COBT(54)    SETA 820         REGSRV LOCK - SHARED ENTRY           @LCA 01593500
&COBT(55)    SETA 868         REGSRV LOCK - EXCLUSIVE ENTRY        @LCA 01593600
&COBT(56)    SETA 916         CONTEXT LOCK                         @LCA 01593700
&COBT(57)    SETA 964         SSD LOCK                             @LDA 01593800
&COBT(58)    SETA 1012        CMSLATCH LOCK                        @LEA 01593900
.* Note, there are only 3 CMSLATCH lock LIT entries, instead of 4.      01594000
&COBT(59)    SETA 1048        GRSINT LOCK - SHARED ENTRY           @LFA 01595000
&COBT(60)    SETA 1096        GRSINT LOCK - EXCLUSIVE ENTRY        @LFA 01595100
&COBT(61)    SETA 1144        MISC lock                            @LJC 01595200
&COBT(62)    SETA 1192        DONOTUS2 lock                        @LJC 01595300
&COBT(63)    SETA 1240        DONOTUS3 lock                        @LJC 01595400
&COBT(64)    SETA 1288        DONOTUS4 lock                        @LJC 01595500
&COBT(65)    SETA 1336        DONOTUS5 lock                        @LJC 01595600
&COBT(66)    SETA 1384        HCWDRLK2 lock                        @LGA 01595700
&COBT(67)    SETA 1432        HCWDRLK1 lock                        @LGA 01595800
&COBT(68)    SETA 1480        SRMENQ LOCK - SHARED ENTRY           @LHA 01595900
&COBT(69)    SETA 1528        SRMENQ LOCK - EXCLUSIVE ENTRY        @LHA 01596000
.* Entries 70-74 are SETLOCKP only                                      01596100
&COBT(75)    SETA 1528+6*48   RSMQ LOCK                            @LKA 01596200
&COBT(76)    SETA 1528+7*48   SSDGROUP lock                        @LMA 01596300
.*                                                                      01596500
.*******************************************************************    01596600
.*                                                                 *    01596700
.*       UNCONDITIONAL OBTAIN LIT OFFSETS (DECIMAL)                *    01596800
.*                                                                 *    01596900
.*******************************************************************    01597000
.*                                                                      01597100
&UOBT(1)     SETA 12          DISPATCHER LOCK                      @L8A 01597200
&UOBT(2)     SETA 60          RSMDS LOCK                           @L8A 01597300
&UOBT(3)     SETA 108         IOSUCB LOCK                          @L8A 01597400
&UOBT(4)     SETA 156         IOSLCH LOCK - NO LONGER SUPPORTED    @L8A 01597500
&UOBT(5)     SETA 204         IOSYNCH LOCK                         @L8A 01597600
&UOBT(6)     SETA 252         TPNCB LOCK - NO LONGER SUPPORTED     @L8A 01597700
&UOBT(7)     SETA 300         TPDNCB LOCK - NO LONGER SUPPORTED    @L8A 01597800
&UOBT(8)     SETA 348         TPACBDEB LOCK                        @L8A 01597900
&UOBT(9)     SETA 396         ASM LOCK                             @L8A 01598000
&UOBT(10)    SETA 444         SALLOC LOCK                          @L8A 01598100
&UOBT(11)    SETA 492         SRM LOCK                             @L8A 01599000
&UOBT(12)    SETA 540         CMS LOCK                             @L8A 01600000
&UOBT(13)    SETA 576         LOCAL LOCK                           @L8A 01601000
&UOBT(14)    SETA -1          SPIN - USED FOR RELEASE ONLY         @L8A 01602000
&UOBT(15)    SETA 624         CMSEQDQ LOCK                         @L8A 01603000
&UOBT(16)    SETA 648         CMSALL                               @L8A 01604000
&UOBT(17)    SETA -1          ALL CMS LOCKS HELD- FOR RELEASE ONLY @L8A 01605000
&UOBT(18)    SETA 696         CMSSMF LOCK                          @L8A 01606000
&UOBT(19)    SETA 732         CML LOCK                             @L8A 01607000
&UOBT(20)    SETA 768         TRACE LOCK - SHARED ENTRY            @L8A 01608000
&UOBT(21)    SETA 816         TRACE LOCK - EXCLUSIVE ENTRY         @L8A 01609000
&UOBT(22)    SETA 864         VSMPAG LOCK                          @L8A 01610000
&UOBT(23)    SETA 912         RSM LOCK - SHARED ENTRY              @L8A 01620000
&UOBT(24)    SETA 960         RSM LOCK - EXCLUSIVE ENTRY           @L8A 01621000
&UOBT(25)    SETA 1008        RSMAD LOCK                           @L8A 01622000
&UOBT(26)    SETA 1056        RSMXM LOCK                           @L8A 01623000
&UOBT(27)    SETA 1104        RSMST LOCK                           @L8A 01624000
&UOBT(28)    SETA 1152        ASMGL LOCK                           @L8A 01625000
&UOBT(29)    SETA 1200        VSMFIX LOCK                          @L8A 01626000
&UOBT(30)    SETA 1248        RSMGL LOCK                           @L8A 01627000
&UOBT(31)    SETA 1284        CPU LOCK                             @L8A 01628000
&UOBT(32)    SETA -1          ALL - USED FOR RELEASE ONLY          @L8A 01629000
&UOBT(33)    SETA -1          (REG) - USED FOR RELEASE ONLY        @L8A 01630000
&UOBT(34)    SETA 1368        RSMCM LOCK                           @L8A 01631000
&UOBT(35)    SETA 1432        IOS LOCK - SHARED ENTRY              @L8A 01632000
&UOBT(36)    SETA 1480        IOS LOCK - EXCLUSIVE ENTRY           @L8A 01633000
&UOBT(37)    SETA 12          BMFLSD LOCK                          @L7A 01634000
&UOBT(38)    SETA 60          ETRSET LOCK                          @L6A 01635000
&UOBT(39)    SETA 108         XCFDS LOCK                           @L5A 01636000
&UOBT(40)    SETA 156         XCFRES LOCK                          @L5A 01637000
&UOBT(41)    SETA 204         XCFQ LOCK - SHARED ENTRY             @L5A 01638000
&UOBT(42)    SETA 252         XCFQ LOCK - EXCLUSIVE ENTRY          @L5A 01639000
&UOBT(43)    SETA 304         IOSULUT LOCK - SHARED ENTRY          @L9A 01640000
&UOBT(44)    SETA 352         IOSULUT LOCK - EXCLUSIVE ENTRY       @L9A 01641000
&UOBT(45)    SETA 400         IXLSCH LOCK                          @LBC 01642000
&UOBT(46)    SETA 448         IXLSHR LOCK - SHARED ENTRY           @LBC 01643000
&UOBT(47)    SETA 496         IXLSHR LOCK - EXCLUSIVE ENTRY        @LBC 01644000
&UOBT(48)    SETA 544         IXLDS LOCK                           @LBC 01645000
&UOBT(49)    SETA 592         IXLSHELL LOCK                        @LBA 01646000
&UOBT(50)    SETA 640         IXLREQST LOCK                        @01A 01647000
&UOBT(51)    SETA 688         WLMQ LOCK - SHARED ENTRY             @LCA 01648000
&UOBT(52)    SETA 736         WLMQ LOCK - EXCLUSIVE ENTRY          @LCA 01649000
&UOBT(53)    SETA 784         WLMRES LOCK                          @LCA 01650000
&UOBT(54)    SETA 832         REGSRV LOCK - SHARED ENTRY           @LCA 01651000
&UOBT(55)    SETA 880         REGSRV LOCK - EXCLUSIVE ENTRY        @LCA 01652000
&UOBT(56)    SETA 928         CONTEXT LOCK                         @LCA 01653000
&UOBT(57)    SETA 976         SSD LOCK                             @LDA 01654000
&UOBT(58)    SETA 1024        CMSLATCH LOCK                        @LEA 01655000
&UOBT(59)    SETA 1060        GRSINT LOCK - SHARED ENTRY           @LFA 01656000
&UOBT(60)    SETA 1108        GRSINT LOCK - EXCLUSIVE ENTRY        @LFA 01657000
&UOBT(61)    SETA 1156        MISC lock                            @LJC 01658000
&UOBT(62)    SETA 1204        DONOTUS2 lock                        @LJC 01659000
&UOBT(63)    SETA 1252        DONOTUS3 lock                        @LJC 01660000
&UOBT(64)    SETA 1300        DONOTUS4 lock                        @LJC 01661000
&UOBT(65)    SETA 1348        DONOTUS5 lock                        @LJC 01661100
&UOBT(66)    SETA 1396        HCWDRLK2 lock                        @LGA 01661200
&UOBT(67)    SETA 1444        HCWDRLK1 lock                        @LGA 01661300
&UOBT(68)    SETA 1492        SRMENQ LOCK - SHARED ENTRY           @LHA 01661400
&UOBT(69)    SETA 1540        SRMENQ LOCK - EXCLUSIVE ENTRY        @LHA 01661500
.* Entries 70-74 are SETLOCKP only                                      01661600
&UOBT(75)    SETA 1540+6*48   RSMQ LOCK                            @LKA 01661700
&UOBT(76)    SETA 1540+7*48   SSDGROUP lock                        @LMA 01661800
.*                                                                      01661900
.*******************************************************************    01662000
.*                                                                 *    01662100
.*       RELEASE LIT OFFSETS (DECIMAL)                             *    01662200
.*                                                                 *    01662300
.*******************************************************************    01662400
.*                                                                      01662500
&REL(1)      SETA 24          DISPATCHER LOCK                      @L8A 01662600
&REL(2)      SETA 72          RSMDS LOCK                           @L8A 01662700
&REL(3)      SETA 120         IOSUCB LOCK                          @L8A 01662800
&REL(4)      SETA 168         IOSLCH LOCK - NO LONGER SUPPORTED    @L8A 01662900
&REL(5)      SETA 216         IOSYNCH LOCK                         @L8A 01663000
&REL(6)      SETA 264         TPNCB LOCK - NO LONGER SUPPORTED     @L8A 01664000
&REL(7)      SETA 312         TPDNCB LOCK - NO LONGER SUPPORTED    @L8A 01665000
&REL(8)      SETA 360         TPACBDEB LOCK                        @L8A 01666000
&REL(9)      SETA 408         ASM LOCK                             @L8A 01667000
&REL(10)     SETA 456         SALLOC LOCK                          @L8A 01668000
&REL(11)     SETA 504         SRM LOCK                             @L8A 01669000
&REL(12)     SETA 552         CMS LOCK                             @L8A 01670000
&REL(13)     SETA 588         LOCAL LOCK                           @L8A 01680000
&REL(14)     SETA 600         SPIN - RELEASE ALL SPIN LOCKS HELD   @L8A 01681000
&REL(15)     SETA 636         CMSEQDQ LOCK                         @L8A 01682000
&REL(16)     SETA 660         CMSALL                               @L8A 01683000
&REL(17)     SETA 672         ALL CMS LOCKS HELD                   @L8A 01684000
&REL(18)     SETA 708         CMSSMF LOCK                          @L8A 01685000
&REL(19)     SETA 744         CML LOCK                             @L8A 01686000
&REL(20)     SETA 780         TRACE LOCK - SHARED ENTRY            @L8A 01687000
&REL(21)     SETA 828         TRACE LOCK - EXCLUSIVE ENTRY         @L8A 01688000
&REL(22)     SETA 876         VSMPAG LOCK                          @L8A 01689000
&REL(23)     SETA 924         RSM LOCK - SHARED ENTRY              @L8A 01690000
&REL(24)     SETA 972         RSM LOCK - EXCLUSIVE ENTRY           @L8A 01691000
&REL(25)     SETA 1020        RSMAD LOCK                           @L8A 01692000
&REL(26)     SETA 1068        RSMXM LOCK                           @L8A 01693000
&REL(27)     SETA 1116        RSMST LOCK                           @L8A 01694000
&REL(28)     SETA 1164        ASMGL LOCK                           @L8A 01695000
&REL(29)     SETA 1212        VSMFIX LOCK                          @L8A 01696000
&REL(30)     SETA 1260        RSMGL LOCK                           @L8A 01697000
&REL(31)     SETA 1296        CPU LOCK                             @L8A 01698000
&REL(32)     SETA 1308        ALL - RELEASE ALL LOCKS HELD         @L8A 01699000
&REL(33)     SETA 1332        (REG) - RELEASE LOCKS SPECIFIED      @L8A 01700000
&REL(34)     SETA 1380        RSMCM LOCK                           @L8A 01701000
&REL(35)     SETA 1444        IOS LOCK - SHARED ENTRY              @L8A 01702000
&REL(36)     SETA 1492        IOS LOCK - EXCLUSIVE ENTRY           @L8A 01703000
&REL(37)     SETA 24          BMFLSD LOCK                          @L7A 01704000
&REL(38)     SETA 72          ETRSET LOCK                          @L6A 01705000
&REL(39)     SETA 120         XCFDS LOCK                           @L5A 01706000
&REL(40)     SETA 168         XCFRES LOCK                          @L5A 01707000
&REL(41)     SETA 216         XCFQ LOCK - SHARED ENTRY             @L5A 01708000
&REL(42)     SETA 264         XCFQ LOCK - EXCLUSIVE ENTRY          @L5A 01709000
&REL(43)     SETA 316         IOSULUT LOCK - SHARED ENTRY          @L9A 01710000
&REL(44)     SETA 364         IOSULUT LOCK - EXCLUSIVE ENTRY       @L9A 01720000
&REL(45)     SETA 412         IXLSCH LOCK                          @LBC 01721000
&REL(46)     SETA 460         IXLSHR LOCK - SHARED ENTRY           @LBC 01722000
&REL(47)     SETA 508         IXLSHR LOCK - EXCLUSIVE ENTRY        @LBC 01723000
&REL(48)     SETA 556         IXLDS LOCK                           @LBC 01724000
&REL(49)     SETA 604         IXLSHELL LOCK                        @LBA 01725000
&REL(50)     SETA 652         IXLREQST LOCK                        @01A 01726000
&REL(51)     SETA 700         WLMQ LOCK - SHARED ENTRY             @LCA 01726100
&REL(52)     SETA 748         WLMQ LOCK - EXCLUSIVE ENTRY          @LCA 01726200
&REL(53)     SETA 796         WLMRES LOCK                          @LCA 01726300
&REL(54)     SETA 844         REGSRV LOCK - SHARED ENTRY           @LCA 01726400
&REL(55)     SETA 892         REGSRV LOCK - EXCLUSIVE ENTRY        @LCA 01726500
&REL(56)     SETA 940         CONTEXT LOCK                         @LCA 01726600
&REL(57)     SETA 988         SSD LOCK                             @LDA 01726700
&REL(58)     SETA 1036        CMSLATCH LOCK                        @LEA 01726800
&REL(59)     SETA 1072        GRSINT LOCK - SHARED ENTRY           @LFA 01726900
&REL(60)     SETA 1120        GRSINT LOCK - EXCLUSIVE ENTRY        @LFA 01727000
&REL(61)     SETA 1168        MISC lock                            @LJC 01728000
&REL(62)     SETA 1216        DONOTUS2 lock                        @LJC 01728100
&REL(63)     SETA 1264        DONOTUS3 lock                        @LJC 01728200
&REL(64)     SETA 1312        DONOTUS4 lock                        @LJC 01728300
&REL(65)     SETA 1360        DONOTUS5 lock                        @LJC 01728400
&REL(66)     SETA 1408        HCWDRLK2 lock                        @LGA 01728500
&REL(67)     SETA 1456        HCWDRLK1 lock                        @LGA 01728600
&REL(68)     SETA 1504        SRMENQ LOCK - SHARED ENTRY           @LHA 01728700
&REL(69)     SETA 1552        SRMENQ LOCK - EXCLUSIVE ENTRY        @LHA 01728800
.* Entries 70-74 are SETLOCKP only                                      01728900
&REL(75)     SETA 1552+6*48   RSMQ LOCK                            @LKA 01729000
&REL(76)     SETA 1552+7*48   SSDGROUP lock                        @LMA 01729100
.*                                                                      01729200
.*******************************************************************    01729300
.*                                                                 *    01729400
.*       RELEASE DISABLED LIT OFFSETS (DECIMAL)                    *    01729500
.*                                                                 *    01729600
.*******************************************************************    01729700
.*                                                                      01729800
&RELD(1)     SETA 36          DISPATCHER LOCK                      @L8A 01729900
&RELD(2)     SETA 84          RSMDS LOCK                           @L8A 01730000
&RELD(3)     SETA 132         IOSUCB LOCK                          @L8A 01730100
&RELD(4)     SETA 180         IOSLCH LOCK - NO LONGER SUPPORTED    @L8A 01730200
&RELD(5)     SETA 228         IOSYNCH LOCK                         @L8A 01730300
&RELD(6)     SETA 276         TPNCB LOCK - NO LONGER SUPPORTED     @L8A 01730400
&RELD(7)     SETA 324         TPDNCB LOCK - NO LONGER SUPPORTED    @L8A 01730500
&RELD(8)     SETA 372         TPACBDEB LOCK                        @L8A 01730600
&RELD(9)     SETA 420         ASM LOCK                             @L8A 01730700
&RELD(10)    SETA 468         SALLOC LOCK                          @L8A 01730800
&RELD(11)    SETA 516         SRM LOCK                             @L8A 01730900
&RELD(12)    SETA -1          CMS LOCK - DISABLED NOT SUPPORTED    @L8A 01731000
&RELD(13)    SETA -1          LOCAL LOCK - DISABLED NOT SUPPORTED  @L8A 01732000
&RELD(14)    SETA 600         SPIN - RELEASE ALL SPIN LOCKS HELD   @L8A 01733000
&RELD(15)    SETA -1          CMSEQDQ LOCK - DISABLED NOT SUPPORTED@L8A 01734000
&RELD(16)    SETA -1          CMSALL - DISABLED NOT SUPPORTED      @L8A 01735000
&RELD(17)    SETA -1          ALL CMS LOCKS HELD- DISABLED NOT     @L8A 01736000
.*                            SUPPORTED                                 01737000
&RELD(18)    SETA -1          CMSSMF LOCK - DISABLED NOT SUPPORTED @L8A 01738000
&RELD(19)    SETA -1          CML LOCK - DISABLED NOT SUPPORTED    @L8A 01739000
&RELD(20)    SETA 792         TRACE LOCK - SHARED ENTRY            @L8A 01740000
&RELD(21)    SETA 840         TRACE LOCK - EXCLUSIVE ENTRY         @L8A 01750000
&RELD(22)    SETA 888         VSMPAG LOCK                          @L8A 01751000
&RELD(23)    SETA 936         RSM LOCK - SHARED ENTRY              @L8A 01752000
&RELD(24)    SETA 984         RSM LOCK - EXCLUSIVE ENTRY           @L8A 01753000
&RELD(25)    SETA 1032        RSMAD LOCK                           @L8A 01754000
&RELD(26)    SETA 1080        RSMXM LOCK                           @L8A 01755000
&RELD(27)    SETA 1128        RSMST LOCK                           @L8A 01756000
&RELD(28)    SETA 1176        ASMGL LOCK                           @L8A 01757000
&RELD(29)    SETA 1224        VSMFIX LOCK                          @L8A 01758000
&RELD(30)    SETA 1272        RSMGL LOCK                           @L8A 01759000
&RELD(31)    SETA 1296        CPU LOCK                             @L8A 01760000
&RELD(32)    SETA 1320        ALL - RELEASE ALL LOCKS HELD         @L8A 01761000
&RELD(33)    SETA 1344        (REG) - RELEASE LOCKS SPECIFIED      @L8A 01762000
&RELD(34)    SETA 1392        RSMCM LOCK                           @L8A 01763000
&RELD(35)    SETA 1456        IOS LOCK - SHARED ENTRY              @L8A 01764000
&RELD(36)    SETA 1504        IOS LOCK - EXCLUSIVE ENTRY           @L8A 01765000
&RELD(37)    SETA 36          BMFLSD LOCK                          @L7A 01766000
&RELD(38)    SETA 84          ETRSET LOCK                          @L6A 01767000
&RELD(39)    SETA 132         XCFDS LOCK                           @L5A 01768000
&RELD(40)    SETA 180         XCFRES LOCK                          @L5A 01769000
&RELD(41)    SETA 228         XCFQ LOCK - SHARED ENTRY             @L5A 01770000
&RELD(42)    SETA 276         XCFQ LOCK - EXCLUSIVE ENTRY          @L5A 01780000
&RELD(43)    SETA 328         IOSULUT LOCK - SHARED ENTRY          @L9A 01781000
&RELD(44)    SETA 376         IOSULUT LOCK - EXCLUSIVE ENTRY       @L9A 01782000
&RELD(45)    SETA 424         IXLSCH LOCK                          @LBC 01783000
&RELD(46)    SETA 472         IXLSHR LOCK - SHARED ENTRY           @LBC 01784000
&RELD(47)    SETA 520         IXLSHR LOCK - EXCLUSIVE ENTRY        @LBC 01785000
&RELD(48)    SETA 568         IXLDS LOCK                           @LBC 01786000
&RELD(49)    SETA 616         IXLSHELL LOCK                        @LBA 01787000
&RELD(50)    SETA 664         IXLREQST LOCK                        @01A 01788000
&RELD(51)    SETA 712         WLMQ LOCK - SHARED ENTRY             @LCA 01789000
&RELD(52)    SETA 760         WLMQ LOCK - EXCLUSIVE ENTRY          @LCA 01790000
&RELD(53)    SETA 808         WLMRES LOCK                          @LCA 01791000
&RELD(54)    SETA 856         REGSRV LOCK - SHARED ENTRY           @LCA 01792000
&RELD(55)    SETA 904         REGSRV LOCK - EXCLUSIVE ENTRY        @LCA 01793000
&RELD(56)    SETA 952         CONTEXT LOCKS                        @LCA 01794000
&RELD(57)    SETA 1000        SSD LOCKS                            @LDA 01794100
&RELD(58)    SETA -1          CMSLATCH LOCK - DISABLED NOT SUPPORTED   -01794200
                                                                   @LEA 01794300
&RELD(59)    SETA 1084        GRSINT LOCK - SHARED ENTRY           @LFA 01794400
&RELD(60)    SETA 1132        GRSINT LOCK - EXCLUSIVE ENTRY        @LFA 01794500
&RELD(61)    SETA 1180        MISC lock                            @LJC 01794600
&RELD(62)    SETA 1228        DONOTUS2 lock                        @LJC 01794700
&RELD(63)    SETA 1276        DONOTUS3 lock                        @LJC 01794800
&RELD(64)    SETA 1324        DONOTUS4 lock                        @LJC 01794900
&RELD(65)    SETA 1372        DONOTUS5 lock                        @LJC 01795000
&RELD(66)    SETA 1420        HCWDRLK2 lock                        @LGA 01796000
&RELD(67)    SETA 1468        HCWDRLK1 lock                        @LGA 01796100
&RELD(68)    SETA 1516        SRMENQ LOCK - SHARED ENTRY           @LHA 01796200
&RELD(69)    SETA 1564        SRMENQ LOCK - EXCLUSIVE ENTRY        @LHA 01796300
.* Entries 70-74 are SETLOCKP only                                      01796400
&RELD(75)    SETA 1564+6*48   RSMQ LOCK                            @LKA 01796500
&RELD(76)    SETA 1564+7*48   SSDGROUP lock                        @LMA 01796600
.*                                                                      01796700
.*******************************************************************    01796800
.*                                                                      01796900
&LABEL   SETC  'IHA&SYSNDX'                                    @G860PXA 01797000
&GNAME1  SETC  'IHB'.'&SYSNDX'.'K'                                 @L8A 01798000
*                                                                 1@LJD 01799000
&GNAME3  SETC  'IHB'.'&SYSNDX'.'T'                                 @L8A 01800000
*                                                                 1@LJD 01810000
*        MACDATE = 12/31/2009                                      @LHC 01820000
&INDEX   SETA  0                                                        01830000
         AIF   ('&REQUEST' EQ 'TEST').TEST                              01840000
.*                                                                      01850000
&FCN     SETA  0                                                   @L8A 01860000
.*                                                                      01870000
         AIF   ('&REQUEST' EQ 'OBTAIN').OBTAIN                          01880000
         AIF   ('&REQUEST' NE 'RELEASE').ERRREQ                    @L8C 01890000
.*                                                                      01900000
.*******************************************************************    01910000
.*                                                                 *    01920000
.*       RELEASE PROCESSING                                        *    01930000
.*                                                                 *    01940000
.*******************************************************************    01950000
.*                                                                      01960000
         AIF   (T'&BRANCH NE 'O').ERRBR                            @L8C 01970000
         AIF   (T'&WORKREG NE 'O').ERRWK                           @L8A 01980000
         AIF   (T'&LOCK NE 'O').NOLOCK                             @L8A 01990000
         AIF   (T'&LOCKHLD NE 'O').ERRLHLD                         @L8C 02000000
         AIF   (T'&TYPE EQ 'O').ERRTYPE                        @G387PXR 02010000
         AIF   (T'&MODE NE 'O').ERRMODE                        @G387PXR 02020000
         AIF   (T'&INSTDATA NE 'O').ERRINSTDATA1                   @LIA 02030000
         AIF   ('&TYPE' EQ 'ALOCAL').ERRALOC                   @G387PXR 02040000
         AIF   ('&DISABLE' EQ 'DISABLED').TESTSUP  TEST FOR SUSPEND REQ 02050000
         AIF   ('&DISABLE' NE '').ERRDIS1                          @L8C 02060000
.*                                                                      02070000
.*       RELEASE WITHOUT DISABLE                                   @L8A 02080000
.*                                                                      02090000
&FCN     SETA  3                                                   @L8A 02100000
         AGO   .REGS                                               @L8A 02110000
.*                                                                      02120000
.TESTSUP ANOP                      CHECK DISABLE INVALID CASES @G860PXA 02130000
         AIF   ('&TYPE'(1,3) EQ 'CMS').ERRDIS2                 @G741PXT 02140000
         AIF   ('&TYPE' EQ 'LOCAL').ERRDIS2                             02150000
         AIF   ('&TYPE' EQ 'CML').ERRDIS2                      @G387PXR 02160000
         AIF   ('&TYPE' EQ 'CPU').ERRDIS2                      @G860PXA 02170000
.*                                                                      02180000
.*       RELEASE DISABLED                                          @L8A 02190000
.*                                                                      02200000
&FCN     SETA  4                                                   @L8A 02210000
         AGO   .REGS                                               @L8A 02220000
.*                                                                      02230000
.*******************************************************************    02240000
.*                                                                 *    02250000
.*       OBTAIN PROCESSING                                         *    02260000
.*                                                                 *    02270000
.*******************************************************************    02280000
.*                                                                      02290000
.OBTAIN  ANOP                                                           02300000
         AIF   (T'&BRANCH NE 'O').ERRBR                                 02310000
         AIF   (T'&WORKREG NE 'O').ERRWK                           @L8A 02320000
         AIF   (T'&LOCK NE 'O').NOLOCK                             @L8A 02330000
         AIF   (T'&LOCKHLD NE 'O').ERRLHLD                         @L8C 02340000
         AIF   (T'&TYPE EQ 'O').ERRTYPE                        @G837PXR 02350000
         AIF   ('&TYPE' EQ 'ALOCAL').EROALOC                   @G837PXR 02360000
         AIF   (T'&ADDR NE 'O').CHECKDISABLE                       @LIA 02370000
         AIF   (T'&INSTDATA NE 'O').ERRINSTDATA2                   @LIA 02380000
.CHECKDISABLE ANOP                                                 @LIA 02381000
         AIF   ('&DISABLE' EQ '').OBTAIN2                               02382000
         AIF   ('&DISABLE' NE 'DISABLED').ERRDIS1                       02383000
.*                                                                      02384000
.* NOTE THAT ON AN OBTAIN, TYPE=CPU, DISABLED IS NOT SUPPORTED @G860PXA 02385000
.*                                                                      02386000
         AIF   ('&TYPE' EQ 'CPU').INVDIS                           @L8C 02387000
         AGO   .MODECK                                             @L8A 02388000
.*                                                                      02389000
.OBTAIN2 ANOP                                                           02390000
         AIF   ('&TYPE' NE 'CPU').MODECK                       @G860PXA 02400000
         AIF   (T'&MODE EQ 'O').COND                           @G860PXA 02410000
         MNOTE 0,'*** MODE IGNORED WITH TYPE=CPU'              @G860PXA 02420000
         AGO   .COND                                           @G860PXA 02430000
.*                                                                      02440000
.MODECK  ANOP                                                           02450000
         AIF   ('&MODE' EQ 'COND').COND                                 02460000
         AIF   ('&MODE' EQ 'UNCOND').UNCOND                             02470000
         AIF   ('&MODE' EQ '(COND,IN)').CONDIN                     @L1A 02480000
         AIF   ('&MODE' EQ '').NOMODE                              @L8C 02490000
         AGO   .MODERR                                             @L8C 02500000
.*                                                                      02510000
.*       UNCONDITIONAL OBTAIN                                      @L8A 02520000
.*                                                                      02530000
.UNCOND  ANOP                                                      @L8A 02540000
&FCN     SETA  2                                                   @L8A 02550000
         AGO   .REGS                                               @L8A 02560000
.*                                                                      02570000
.*       CONDITIONAL OBTAIN                                        @L8A 02580000
.*                                                                      02590000
.COND    ANOP                                                           02600000
         AIF   (T'&INSTDATA NE 'O').ERRINSTDATA3                   @LIA 02610000
         AIF   ('&DISABLE' EQ 'DISABLED').ERRDIS3                  @L8C 02620000
&FCN     SETA  1                                                   @L8A 02630000
.*                                                                      02640000
.REGS    ANOP                                                           02650000
         AIF   ('&REGS' EQ 'SAVE').TYPE SAVE IS VALID PARAMETER         02660000
         AIF   ('&REGS' EQ 'STDSAVE').TYPE STDSAVE IS VALID        @L4A 02670000
.*                                         PARAMETER                    02680000
         AIF   ('&REGS' EQ 'USE').REGUSE USE IS VALID PARAMETER    @LIA 02690000
         AIF   ('&REGS' NE '').BADREGS  INDICATE REGS IS INVALID   @L8C 02700000
.*                                                                      02710000
.REGUSE  ANOP                                                           02720000
         AIF   (T'&INSTDATA NE 'O').ERRINSTDATA4                   @LIA 02730000
.TYPE    ANOP                                                           02740000
.*********************************************************************  02750000
.*                                                                   *  02760000
.*    &X REFERS TO THE INDEX WITHIN THE 4 OFFSET ARRAYS, COBT,       *  02770000
.*    UOBT, REL, AND RELD.                                           *  02780000
.*                                                                   *  02790000
.*    NOTE:  &X SHOULD BE INCREMENTED BY 2 INSTEAD OF 1 AFTER        *  02800000
.*    SHR/EXCL LOCKS.                                                *  02810000
.*                                                                   *  02820000
.*********************************************************************  02830000
&PSAPTR  SETA  0                                                   @L8A 02840000
&X       SETA  1              UPDATE INDEX TO DISP ENTRY           @L8C 02850000
         AIF   ('&TYPE' EQ 'DISP').CODE1                       @G387PXR 02860000
&X       SETA  2              UPDATE INDEX TO RSMDS ENTRY          @L8C 02870000
         AIF   ('&TYPE' EQ 'IOSCAT').INVTYP  NOT SUPPORTED     @G860PXB 02880000
         AIF   ('&TYPE' EQ 'RSMDS').CODEA                          @L3A 02890000
&X       SETA  3              UPDATE INDEX TO IOSUCB ENTRY         @L8C 02900000
         AIF   ('&TYPE' EQ 'IOSUCB').CODEA                              02910000
&X       SETA  4              UPDATE INDEX TO IOSLCH ENTRY         @L8C 02920000
         AIF   ('&TYPE' EQ 'IOSLCH').INVTYP  NOT SUPPORTED     @G860PXB 02930000
&X       SETA  5              UPDATE INDEX TO IOSYNCH ENTRY        @L8C 02940000
         AIF   ('&TYPE' EQ 'IOSYNCH').CODEA                             02950000
&X       SETA  6              UPDATE INDEX TO TPNCB ENTRY          @L8C 02960000
         AIF   ('&TYPE' EQ 'TPNCB').INVTYP   NOT SUPPORTED         @L8C 02970000
&X       SETA  7              UPDATE INDEX TO TPDNCB ENTRY         @L8C 02980000
         AIF   ('&TYPE' EQ 'TPDNCB').INVTYP  NOT SUPPORTED         @L8C 02990000
&X       SETA  8              UPDATE INDEX TO TPACBDEB ENTRY       @L8C 03000000
         AIF   ('&TYPE' EQ 'TPACBDEB').CODEA                            03010000
&X       SETA  9              UPDATE INDEX TO ASM ENTRY            @L8C 03020000
         AIF   ('&TYPE' EQ 'ASM').CODEA                                 03030000
&X       SETA  10             UPDATE INDEX TO SALLOC ENTRY         @L8C 03040000
         AIF   ('&TYPE' EQ 'SALLOC').CODE1                     @G387PXR 03050000
&X       SETA  11             UPDATE INDEX TO SRM ENTRY            @L8C 03060000
         AIF   ('&TYPE' EQ 'SRM').CODE1                            @LPA 03061004
&X       SETA  12             UPDATE INDEX TO CMS ENTRY            @L8C 03080000
         AIF   ('&TYPE' EQ 'CMS').CODE1                        @G387PXR 03090000
&X       SETA  13             UPDATE INDEX TO LOCAL ENTRY          @L8C 03100000
         AIF   ('&TYPE' EQ 'LOCAL').CODE1                      @G387PXR 03110000
&X       SETA  14             UPDATE INDEX TO SPIN ENTRY           @L8C 03120000
         AIF   ('&TYPE' EQ 'SPIN').CKSPNAL                     @G860PXA 03130000
&X       SETA  15             UPDATE INDEX TO CMSEQDQ ENTRY        @L8C 03140000
         AIF   ('&TYPE' EQ 'CMSEQDQ').CODE1                    @G387PXR 03150000
&X       SETA  16             UPDATE INDEX TO CMSALL ENTRY         @L8C 03160000
         AIF   ('&TYPE' EQ 'CMSALL').CKCOND                    @G741PXT 03161000
&X       SETA  18             UPDATE INDEX TO CMSSMF ENTRY         @L8C 03180000
         AIF   ('&TYPE' EQ 'CMSSMF').CODE1                     @G387PXR 03190000
&X       SETA  19             UPDATE INDEX TO CML ENTRY            @L8C 03200000
         AIF   ('&TYPE' EQ 'CML').CODE                         @G387PXR 03210000
&X       SETA  20             UPDATE INDEX TO TRACE ENTRY          @L8C 03220000
         AIF   ('&TYPE' EQ 'TRACE').SCOPE                      @G860PXA 03230000
&X       SETA  22             UPDATE INDEX TO VSMPAG ENTRY         @L8C 03240000
         AIF   ('&TYPE' EQ 'VSMPAG').CODE1                     @G860PXA 03250000
&X       SETA  23             UPDATE INDEX TO RSM ENTRY            @L8C 03260000
         AIF   ('&TYPE' EQ 'RSM').SCOPE                        @G860PXA 03270000
&X       SETA  25             UPDATE INDEX TO RSMAD ENTRY          @L8C 03280000
         AIF   ('&TYPE' EQ 'RSMAD').CODEA                      @G860PXA 03290000
&X       SETA  26             UPDATE INDEX TO RSMXM ENTRY          @L8C 03300000
         AIF   ('&TYPE' EQ 'RSMXM').CODEA                      @G860PXA 03310000
&X       SETA  27             UPDATE INDEX TO RSMST ENTRY          @L8C 03320000
         AIF   ('&TYPE' EQ 'RSMST').CODEA                      @G860PXA 03330000
&X       SETA  28             UPDATE INDEX TO ASMGL ENTRY          @L8C 03340000
         AIF   ('&TYPE' EQ 'ASMGL').CODEA                      @G860PXA 03350000
&X       SETA  29             UPDATE INDEX TO VSMFIX ENTRY         @L8C 03360000
         AIF   ('&TYPE' EQ 'VSMFIX').CODE1                     @G860PXA 03370000
&X       SETA  30             UPDATE INDEX TO RSMGL ENTRY          @L8C 03380000
         AIF   ('&TYPE' EQ 'RSMGL').CODEA                      @G860PXA 03390000
&X       SETA  31             UPDATE INDEX TO CPU ENTRY            @L8C 03400000
         AIF   ('&TYPE' EQ 'CPU').CODE1                        @G860PXA 03410000
&X       SETA  32             UPDATE INDEX TO ALL ENTRY            @L8C 03420000
         AIF   ('&TYPE' EQ 'ALL').CKSPNAL                      @G860PXA 03430000
&X       SETA  33             UPDATE INDEX TO (REG) ENTRY          @L8C 03440000
         AIF   ('&TYPE'(1,1) EQ '(').CKSPNAL                       @L8C 03450000
&X       SETA  34             UPDATE INDEX TO RSMCM ENTRY          @L8C 03460000
         AIF   ('&TYPE' EQ 'RSMCM').CODEA                      @G860PXJ 03470000
&X       SETA  35             UPDATE INDEX TO IOS ENTRY            @L8C 03480000
         AIF   ('&TYPE' EQ 'IOS').SCOPE                            @D1A 03490000
&PSAPTR  SETA  1                                                   @L8A 03500000
&X       SETA  37             UPDATE INDEX TO BMFLSD ENTRY         @L7A 03510000
         AIF   ('&TYPE' EQ 'BMFLSD').CODEA                         @L7A 03520000
&X       SETA  38             UPDATE INDEX TO ETRSET ENTRY         @L6A 03530000
         AIF   ('&TYPE' EQ 'ETRSET').CODE1                         @L6A 03540000
&X       SETA  39             UPDATE INDEX TO XCFDS ENTRY          @L5A 03550000
         AIF   ('&TYPE' EQ 'XCFDS').CODEA                          @L5A 03560000
&X       SETA  40             UPDATE INDEX TO XCFRES ENTRY         @L5A 03570000
         AIF   ('&TYPE' EQ 'XCFRES').CODEA                         @L5A 03580000
&X       SETA  41             UPDATE INDEX TO XCFQ ENTRY           @L5A 03590000
         AIF   ('&TYPE' EQ 'XCFQ').SCOPE                           @L5A 03600000
&X       SETA  43             UPDATE INDEX TO IOSULUT ENTRY        @L9A 03610000
         AIF   ('&TYPE' EQ 'IOSULUT').SCOPE                        @L9A 03620000
&X       SETA  45             UPDATE INDEX TO IXLSCH ENTRY         @LBC 03630000
         AIF   ('&TYPE' EQ 'IXLSCH').CODEA                         @LBC 03640000
&X       SETA  46             UPDATE INDEX TO IXLSHR ENTRY         @LBC 03650000
         AIF   ('&TYPE' EQ 'IXLSHR').SCOPE                         @LBC 03660000
&X       SETA  48             UPDATE INDEX TO IXLDS ENTRY          @LBC 03670000
         AIF   ('&TYPE' EQ 'IXLDS').CODEA                          @LAA 03680000
&X       SETA  49             UPDATE INDEX TO IXLSHELL ENTRY       @LBC 03690000
         AIF   ('&TYPE' EQ 'IXLSHELL').CODEA                       @LBC 03700000
&X       SETA  50             UPDATE INDEX TO IXLREQST ENTRY       @01A 03710000
         AIF   ('&TYPE' EQ 'IXLREQST').CODEA                       @01A 03720000
&X       SETA  51             UPDATE INDEX TO WLMQ ENTRY           @LCA 03730000
         AIF   ('&TYPE' EQ 'WLMQ').SCOPE                           @LCA 03740000
&X       SETA  53             UPDATE INDEX TO WLMRES ENTRY         @LCA 03750000
         AIF   ('&TYPE' EQ 'WLMRES').CODEA                         @LCA 03760000
&X       SETA  54             UPDATE INDEX TO REGSRV ENTRY         @LCA 03770000
         AIF   ('&TYPE' EQ 'REGSRV').SCOPE                         @LCA 03780000
&X       SETA  56             UPDATE INDEX TO CONTEXT ENTRY        @LCA 03790000
         AIF   ('&TYPE' EQ 'CONTEXT').CODEA                        @LCA 03800000
&X       SETA  57             UPDATE INDEX TO SSD ENTRY            @LDA 03810000
         AIF   ('&TYPE' EQ 'SSD').CODEA                            @LDA 03820000
&X       SETA  58             UPDATE INDEX TO CMSLATCH ENTRY       @LEA 03830000
         AIF   ('&TYPE' EQ 'CMSLATCH').CODE1                       @LEA 03840000
&X       SETA  59             UPDATE INDEX TO GRSINT ENTRY         @LFA 03850000
         AIF   ('&TYPE' EQ 'GRSINT').SCOPE                         @LFA 03860000
.*                            Add 2 after SHR/EXCL lock.                03870000
&X       SETA  61             UPDATE INDEX TO MISC ENTRY           @LJC 03880000
         AIF   ('&TYPE' EQ 'MISC').CODEA                           @LJC 03890000
&X       SETA  62             UPDATE INDEX TO DONOTUS2 ENTRY       @LJC 03900000
         AIF   ('&TYPE' EQ 'DONOTUS2').CODEA                       @LJC 03910000
&X       SETA  63             UPDATE INDEX TO DONOTUS3 ENTRY       @LJC 03920000
         AIF   ('&TYPE' EQ 'DONOTUS3').CODEA                       @LJC 03930000
&X       SETA  64             UPDATE INDEX TO DONOTUS4 ENTRY       @LJC 03940000
         AIF   ('&TYPE' EQ 'DONOTUS4').CODEA                       @LJC 03950000
&X       SETA  65             UPDATE INDEX TO DONOTUS5 ENTRY       @LJC 03960000
         AIF   ('&TYPE' EQ 'DONOTUS5').CODEA                       @LJC 03970000
&X       SETA  66             UPDATE INDEX TO HCWDRLK2 ENTRY       @LGA 03980000
         AIF   ('&TYPE' EQ 'HCWDRLK2').CODEA                       @LGA 03990000
&X       SETA  67             UPDATE INDEX TO HCWDRLK1 ENTRY       @LGA 04000000
         AIF   ('&TYPE' EQ 'HCWDRLK1').CODEA                       @LGA 04010000
&X       SETA  68             UPDATE INDEX TO SRMENQ ENTRY         @LHA 04020000
         AIF   ('&TYPE' EQ 'SRMENQ').SCOPE                         @LHA 04030000
.*                            Add 2 after SHR/EXCL lock.                04040000
.* 70-74 are defined only in SETLOCKP                              @LKA 04050000
&X       SETA  75             UPDATE INDEX TO RSMQ ENTRY           @LKA 04060000
         AIF   ('&TYPE' EQ 'RSMQ').CODEA                           @LKA 04061000
&X       SETA  76             UPDATE INDEX TO SSDGROUP ENTRY       @LMA 04062000
         AIF   ('&TYPE' EQ 'SSDGROUP').CODEA                       @LMA 04062100
         AIF   ('&TYPE' NE '').INVTYP  INDICATE TYPE IS INVALID         04062200
         AGO   .NOTYP                  INDICATE TYPE NOT SPECIFIED @L8A 04062300
.*                                                                      04062400
.CKSPNAL ANOP                                                  @G860PXA 04062500
         AIF   ('&REQUEST' NE 'RELEASE').INVTYP  TYPE SPIN!ALL!    @P4C 04062600
.*                                               (REG) ONLY VALID FOR   04062700
.*                                               RELEASE                04062800
         AIF   (T'&ADDR NE 'O').ERRAD                                   04062900
         AIF   ('&TYPE' EQ 'SPIN').RSPIN                                04063000
         AIF   ('&TYPE' EQ 'ALL').RALL                                  04064000
         AIF   ('&TYPE'(K'&TYPE,1) EQ ')').RREG                         04065000
         AGO   .INVTYP                 INDICATE TYPE IS INVALID    @L8A 04066000
.*                                                                      04067000
.CKCOND  ANOP                                                  @G741PXT 04067100
         AIF   ('&MODE' EQ 'COND').CNOTSUP  COND IS NOT SUPPORTED  @L8C 04069000
.*                                          FOR CMSALL or SRM REQUEST   04070000
         AGO   .CODE1                                              @L8A 04080000
.*                                                                      04090000
.SCOPE   ANOP         CHECK LOCKS THAT REQUIRE SCOPE KEYWORD   @G860PXA 04100000
         AIF   (T'&SCOPE EQ 'O').SCOPREQ                       @G860PXA 04110000
         AIF   ('&SCOPE' EQ 'SHR').CODE1A                      @G860PXA 04120000
&X       SETA  (&X+1)       UPDATE TO EXCLUSIVE ENTRY              @L8C 04130000
         AIF   ('&SCOPE' NE 'EXCL').INVSCOP                        @L8C 04140000
         AGO   .CODE1A                                             @L8A 04150000
.*                                                                      04160000
.CODE1   ANOP         CHECK CASES WHERE SCOPE IS NOT ALLOWED   @G860PXA 04170000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 04180000
.CODE1A  ANOP                                                  @G860PXA 04190000
         AIF   (T'&ASCB NE 'O').ERRASCB  ASCB VALID FOR CML    @G860PXA 04200000
.*                                       ONLY                           04210000
.CODE    ANOP                                                      @L8A 04220000
.*                                                                      04230000
.*       CHECK THE REQUEST                                              04240000
.*                                                                      04250000
         AIF   (&FCN GT 1).ISIT2                                   @L8A 04260000
&INDEX   SETA  &COBT(&X)       CONDITIONAL OBTAIN REQUEST          @L8A 04270000
         AGO   .CONTINU                                            @L8A 04280000
.ISIT2   ANOP                                                      @L8A 04290000
         AIF   (&FCN GT 2).ISIT3                                   @L8A 04300000
&INDEX   SETA  &UOBT(&X)       UNCONDITIONAL OBTAIN REQUEST        @L8A 04310000
         AGO   .CONTINU                                            @L8A 04320000
.ISIT3   ANOP                                                      @L8A 04330000
         AIF   (&FCN GT 3).ISIT4                                   @L8A 04340000
&INDEX   SETA  &REL(&X)        RELEASE WITHOUT DISABLE REQUEST     @L8A 04350000
         AGO   .CONTINU                                            @L8A 04360000
.ISIT4   ANOP                                                      @L8A 04370000
&INDEX   SETA  &RELD(&X)       RELEASE DISABLED REQUEST            @L8A 04380000
.*                                                                      04390000
.CONTINU ANOP                                                      @L8A 04400000
         AIF   ('&ADDR' NE '').ERRAD                                    04410000
         AIF   ('&REGS' EQ 'SAVE').SAVE1                                04420000
         AIF   ('&REGS' EQ 'STDSAVE').STD1                         @L4A 04430000
         AIF   ('&REGS' EQ 'USE').USE1                                  04440000
&NAME    DS    0H                                                  @P1A 04450000
         AIF   ('&TYPE' EQ 'LOCAL').LOAD                                04460000
         AIF   ('&TYPE' EQ 'CML').LOAD                         @G387PXR 04470000
         AIF   (&PSAPTR EQ 0).OLDLIT1                              @L8A 04480000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 04490000
         AGO   .ARCHK1              GO CHECK FOR AR-MODE           @L8A 04500000
.OLDLIT1 ANOP                                                      @L8A 04510000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 04520000
.ARCHK1  ANOP                                                      @L8A 04530000
         AIF   ('&SYSASCE' EQ 'P').NOAR1                           @L2A 04540000
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 04550000
.NOAR1   ANOP                                                           04560000
         LM    11,13,&INDEX.(14)    LOAD ADDRESS OF THE LOCKWORD,  @L2C 04570000
*                                   PARM LIST POINTER, AND LOCK RTN     04580000
*                                   ENTRY POINT.                        04590000
         AGO   .MNLCODE                                                 04600000
.*                                                                      04610000
.SAVE1   ANOP                                                           04620000
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS              04630000
         STM   11,14,0(13)          SAVE REGISTERS                 @L2C 04640000
         AIF   ('&TYPE' EQ 'LOCAL').LOAD                                04650000
         AIF   ('&TYPE' EQ 'CML').LOAD                         @G387PXR 04660000
         AIF   (&PSAPTR EQ 0).OLDLIT2                              @L8A 04670000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 04680000
         AGO   .ARCHK2                                             @L8A 04690000
.OLDLIT2 ANOP                                                      @L8A 04700000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 04710000
.ARCHK2  ANOP                                                      @L8A 04720000
         AIF   ('&SYSASCE' EQ 'P').NOAR3                           @L2A 04730000
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 04740000
.NOAR3   ANOP                                                           04750000
         LM    11,13,&INDEX.(14)    LOAD ADDRESS OF THE LOCKWORD,  @L2C 04760000
*                                   PARM LIST POINTER, AND LOCK RTN     04770000
*                                   ENTRY POINT.                        04780000
         AGO   .MNLCODE                                                 04790000
.*                                                                      04800000
.STD1    ANOP                                                      @L4A 04810000
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS         @L4A 04820000
         STM   14,12,12(13)         SAVE REGISTERS                 @L4A 04830000
         AIF   ('&TYPE' EQ 'LOCAL').LOAD                           @L4A 04840000
         AIF   ('&TYPE' EQ 'CML').LOAD                             @L4A 04850000
         AIF   (&PSAPTR EQ 0).OLDLIT3                              @L8A 04860000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 04870000
         AGO   .ARCHK3                                             @L8A 04880000
.OLDLIT3 ANOP                                                      @L8A 04890000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L4A 04900000
.ARCHK3  ANOP                                                      @L8A 04910000
         AIF   ('&SYSASCE' EQ 'P').NOAR4                           @L4A 04920000
         LAE   14,0(14,0)           GET ALET OF 0                  @L4A 04930000
.NOAR4   ANOP                                                      @L4A 04940000
         LM    11,13,&INDEX.(14)    LOAD ADDRESS OF THE LOCKWORD,  @L4A 04950000
*                                   PARM LIST POINTER, AND LOCK RTN     04960000
*                                   ENTRY POINT.                        04970000
         AGO   .MNLCODE                                                 04980000
.*                                                                      04990000
.USE1    ANOP                                                           05000000
&NAME    LR    15,11                SAVE REGISTER 11                    05010000
         LR    0,12                 SAVE REGISTER 12                    05020000
         LR    1,13                 SAVE REGISTER 13                    05030000
         AIF   ('&TYPE' EQ 'LOCAL').LOAD                                05040000
         AIF   ('&TYPE' EQ 'CML').LOAD                         @G387PXR 05050000
         AIF   (&PSAPTR EQ 0).OLDLIT4                              @L8A 05060000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 05070000
         AGO   .ARCHK4                                             @L8A 05080000
.OLDLIT4 ANOP                                                      @L8A 05090000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 05100000
.ARCHK4  ANOP                                                      @L8A 05110000
         AIF   ('&SYSASCE' EQ 'P').NOAR5                           @L2A 05120000
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 05130000
.NOAR5   ANOP                                                           05140000
         LM    11,13,&INDEX.(14)    LOAD ADDRESS OF THE LOCKWORD,  @L2C 05150000
*                                   PARM LIST POINTER, AND LOCK RTN     05160000
*                                   ENTRY POINT.                        05170000
         AGO   .MNLCODE                                                 05180000
.LOAD    ANOP                                                           05190000
         AIF   ('&TYPE' EQ 'CML').CODEB                                 05200000
.*                                                                      05210000
.*       TYPE IS LOCAL                                         @G387PXR 05220000
.*                                                                      05230000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 05240000
         L     13,&INDEX.+8(14,0)   LOAD ADDRESS OF LOCK RTN       @L8C 05250000
         AGO   .MNLCODE                                                 05260000
.*                                                                      05270000
.CODEB   ANOP                                                  @G387PXR 05280000
.*                                                                      05290000
.*       TYPE IS CML                                                    05300000
.*                                                                      05310000
         AIF   (T'&ASCB EQ 'O').ASCBREQ                        @G387PXR 05320000
         AIF   ('&ASCB' EQ '(11)').CMLR11                      @G387PXR 05330000
         AIF   ('&ASCB'(1,1) EQ '(').ERREG2                    @G387PXR 05340000
         L     11,&ASCB                                            @L8C 05350000
.CMLR11  ANOP                                                  @G387PXR 05360000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 05370000
         L     13,&INDEX.+8(14,0)   LOAD ADDRESS OF LOCK RTN       @L8C 05380000
         AGO   .MNLCODE                                        @G387PXR 05390000
.*                                                                      05400000
.CODEA   ANOP                                                           05410000
.*                                                                      05420000
.*  SCOPE KEYWORD IS NOT ALLOWED FOR LOCKS IN THIS PATH       @G860PXA  05430000
.*                                                                      05440000
.*       CHECK THE REQUEST                                              05450000
.*                                                                      05460000
         AIF   (&FCN GT 1).CHECK2                                  @L8A 05470000
&INDEX   SETA  &COBT(&X)       CONDITIONAL OBTAIN REQUEST          @L8A 05480000
         AGO   .DOMORE                                             @L8A 05490000
.CHECK2  ANOP                                                      @L8A 05500000
         AIF   (&FCN GT 2).CHECK3                                  @L8A 05510000
&INDEX   SETA  &UOBT(&X)       UNCONDITIONAL OBTAIN REQUEST        @L8A 05520000
         AGO   .DOMORE                                             @L8A 05530000
.CHECK3  ANOP                                                      @L8A 05540000
         AIF   (&FCN GT 3).CHECK4                                  @L8A 05550000
&INDEX   SETA  &REL(&X)        RELEASE WITHOUT DISABLE REQUEST     @L8A 05560000
         AGO   .DOMORE                                             @L8A 05570000
.CHECK4  ANOP                                                      @L8A 05580000
&INDEX   SETA  &RELD(&X)       RELEASE DISABLED REQUEST            @L8A 05590000
.*                                                                      05600000
.DOMORE  ANOP                                                      @L8A 05610000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 05620000
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G387PXR 05630000
.CODEA1  ANOP                      LOCK ADDRESS ALREADY LOADED @G387PXR 05640000
         AIF   ('&ADDR' EQ '(11)').MR11                        @G387PXR 05650000
         AIF   ('&ADDR' EQ '').ADDREQ                              @L8C 05660000
.ADRLA   ANOP                                                           05670000
         AIF   ('&ADDR'(1,1) EQ '(').ERREG1                             05680000
         AIF   ('&REGS' EQ 'SAVE').SAVE2                                05690000
         AIF   ('&REGS' EQ 'STDSAVE').STD2                         @L4A 05700000
         AIF   ('&REGS' EQ 'USE').USE2                                  05710000
&NAME    DS    0H                                                  @LIC 05720000
         AIF   ((T'&INSTDATA EQ 'O') OR ('&INSTDATA' EQ '(10)')).GTLCK  05730000
         AIF   ('&INSTDATA'(1,1) EQ '(').ERREG3                    @LIA 05740000
         LA    10,&INSTDATA         Load instrumentation area      @LIA 05750000
.GTLCK   ANOP                                                      @LIA 05760000
         LA    11,&ADDR             LOCKWORD ADDRESS                    05770000
         AIF   (&PSAPTR EQ 0).OLDLIT5                              @L8A 05780000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 05790000
         AGO   .ARCHK5                                             @L8A 05800000
.OLDLIT5 ANOP                                                      @L8A 05810000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 05820000
.ARCHK5  ANOP                                                      @L8A 05830000
         AIF   ('&SYSASCE' EQ 'P').NOAR6                           @L2A 05840000
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 05850000
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 05860000
         AGO   .MNLCODE                                            @L2A 05870000
.NOAR6   ANOP                                                           05880000
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 05890000
*                                   RTN ENTRY POINT.                    05900000
         AGO   .MNLCODE                                                 05910000
.SAVE2   ANOP                                                           05920000
.*                                                                      05930000
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS              05940000
         AIF   (T'&INSTDATA NE 'O').SAVE2_10                       @LIA 05950000
         STM   11,14,0(13)          SAVE REGISTERS                 @L2A 05960000
         AGO   .SAVE2_COM                                          @LIA 05970000
.SAVE2_10  ANOP                                                    @LIA 05980000
         STM   10,14,0(13)          SAVE REGISTERS                 @LIA 05990000
         AIF   ((T'&INSTDATA EQ 'O') OR ('&INSTDATA' EQ '(10)')).GTLCK2 06000000
         AIF   ('&INSTDATA'(1,1) EQ '(').ERREG3                    @LIA 06010000
         LA    10,&INSTDATA         Load instrumentation area           06020000
.GTLCK2  ANOP                                                      @LIA 06030000
.SAVE2_COM ANOP                                                    @LIA 06040000
         LA    11,&ADDR             LOCKWORD ADDRESS                    06041000
         AIF   (&PSAPTR EQ 0).OLDLIT6                              @L8A 06042000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 06043000
         AGO   .ARCHK6                                             @L8A 06044000
.OLDLIT6 ANOP                                                      @L8A 06045000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 06045100
.ARCHK6  ANOP                                                      @L8A 06045200
         AIF   ('&SYSASCE' EQ 'P').NOAR9                           @L2A 06045300
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 06045400
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 06045500
         AGO   .MNLCODE                                            @L2A 06045600
.NOAR9   ANOP                                                           06045700
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 06045800
*                                   RTN ENTRY POINT.                    06045900
         AGO   .MNLCODE                                                 06046000
.*                                                                      06047000
.STD2    ANOP                                                      @L4A 06048000
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS         @L4A 06049000
         STM   14,12,12(13)         SAVE REGISTERS                 @L4A 06050000
         AIF   ((T'&INSTDATA EQ 'O') OR ('&INSTDATA' EQ '(10)')).GTLCK3 06060000
         AIF   ('&INSTDATA'(1,1) EQ '(').ERREG3                    @LIA 06070000
         LA    10,&INSTDATA         Load instrumentation area      @LIA 06080000
.GTLCK3  ANOP                                                      @LIA 06090000
         LA    11,&ADDR             LOCKWORD ADDRESS               @L4A 06100000
         AIF   (&PSAPTR EQ 0).OLDLIT7                              @L8A 06110000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 06120000
         AGO   .ARCHK7                                             @L8A 06130000
.OLDLIT7 ANOP                                                      @L8A 06140000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L4A 06150000
.ARCHK7  ANOP                                                      @L8A 06160000
         AIF   ('&SYSASCE' EQ 'P').NOAR10                          @L4A 06170000
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 06180000
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 06190000
         AGO   .MNLCODE                                            @L4A 06200000
.NOAR10  ANOP                                                      @L4A 06210000
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 06220000
*                                   RTN ENTRY POINT.                    06230000
         AGO   .MNLCODE                                                 06240000
.*                                                                      06250000
.USE2    ANOP                                                           06260000
&NAME    LR    15,11                SAVE REGISTER 11                    06270000
         LR    0,12                 SAVE REGISTER 12                    06280000
         LR    1,13                 SAVE REGISTER 13                    06290000
         LA    11,&ADDR             LOCKWORD ADDRESS                    06300000
         AIF   (&PSAPTR EQ 0).OLDLIT8                              @L8A 06310000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 06320000
         AGO   .ARCHK8                                             @L8A 06330000
.OLDLIT8 ANOP                                                      @L8A 06340000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 06350000
.ARCHK8  ANOP                                                      @L8A 06360000
         AIF   ('&SYSASCE' EQ 'P').NOAR11                          @L2A 06370000
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 06380000
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 06390000
         AGO   .MNLCODE                                            @L2A 06400000
.NOAR11  ANOP                                                           06410000
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 06420000
*                                   RTN ENTRY POINT.                    06430000
         AGO   .MNLCODE                                                 06440000
.*                                                                      06450000
.MR11    ANOP                                                           06460000
         AIF   ('&REGS' EQ 'SAVE').SAVE3                                06470000
         AIF   ('&REGS' EQ 'STDSAVE').STD3                         @L4A 06480000
         AIF   ('&REGS' EQ 'USE').USE3                                  06490000
         AIF   (&PSAPTR EQ 0).OLDLIT9                              @L8A 06500000
&NAME    DS    0H                                                  @LIC 06510000
         AIF   ((T'&INSTDATA EQ 'O') OR ('&INSTDATA' EQ '(10)')).GTLCK4 06520000
         AIF   ('&INSTDATA'(1,1) EQ '(').ERREG3                    @LIA 06530000
         LA    10,&INSTDATA         Load instrumentation area      @LIA 06540000
.GTLCK4  ANOP                                                      @LIA 06550000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 06560000
         AGO   .ARCHK9                                             @L8A 06570000
.OLDLIT9 ANOP                                                      @L8A 06580000
&NAME    L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 06590000
.ARCHK9  ANOP                                                      @L8A 06600000
         AIF   ('&SYSASCE' EQ 'P').NOAR13                          @L2A 06610000
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 06620000
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 06630000
         AGO   .MNLCODE                                            @L8C 06640000
.NOAR13  ANOP                                                           06650000
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 06660000
*                                   RTN ENTRY POINT.                    06670000
         AGO   .MNLCODE                                                 06680000
.*                                                                      06690000
.SAVE3   ANOP                                                           06700000
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS              06710000
         AIF   (T'&INSTDATA NE 'O').SAVE3_10                       @LIA 06720000
         STM   11,14,0(13)          SAVE REGISTERS                 @L2A 06730000
         AGO   .SAVE3_COM                                          @LIA 06740000
.SAVE3_10  ANOP                                                    @LIA 06750000
         STM   10,14,0(13)          SAVE REGISTERS                 @LIA 06760000
         AIF   ((T'&INSTDATA EQ 'O') OR ('&INSTDATA' EQ '(10)')).GTLCK5 06770000
         AIF   ('&INSTDATA'(1,1) EQ '(').ERREG3                    @LIA 06780000
         LA    10,&INSTDATA         Load instrumentation area           06790000
.GTLCK5  ANOP                                                      @LIA 06800000
.SAVE3_COM ANOP                                                    @LIA 06810000
         AIF   (&PSAPTR EQ 0).OLDLITA                              @L8A 06811000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 06812000
         AGO   .ARCHKA                                             @L8A 06813000
.OLDLITA ANOP                                                      @L8A 06814000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 06814100
.ARCHKA  ANOP                                                      @L8A 06814200
         AIF   ('&SYSASCE' EQ 'P').NOAR15                          @L2A 06814300
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 06814400
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 06814500
         AGO   .MNLCODE                                            @L2A 06814600
.NOAR15  ANOP                                                           06814700
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 06814800
*                                   RTN ENTRY POINT.                    06814900
         AGO   .MNLCODE                                                 06815000
.*                                                                      06816000
.STD3    ANOP                                                      @L4A 06817000
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS         @L4A 06818000
         STM   14,12,12(13)         SAVE REGISTERS                 @L4A 06819000
         AIF   ((T'&INSTDATA EQ 'O') OR ('&INSTDATA' EQ '(10)')).GTLCK6 06820000
         AIF   ('&INSTDATA'(1,1) EQ '(').ERREG3                    @LIA 06830000
         LA    10,&INSTDATA         Load instrumentation area      @LIA 06840000
.GTLCK6  ANOP                                                      @LIA 06850000
         AIF   (&PSAPTR EQ 0).OLDLITB                              @L8A 06860000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 06870000
         AGO   .ARCHKB                                             @L8A 06880000
.OLDLITB ANOP                                                      @L8A 06890000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L4A 06900000
.ARCHKB  ANOP                                                      @L8A 06910000
         AIF   ('&SYSASCE' EQ 'P').NOAR16                          @L4A 06920000
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 06930000
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 06940000
         AGO   .MNLCODE                                            @L4A 06950000
.NOAR16  ANOP                                                      @L4A 06960000
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 06970000
*                                   RTN ENTRY POINT.                    06980000
         AGO   .MNLCODE                                                 06990000
.*                                                                      07000000
.USE3    ANOP                                                           07010000
&NAME    LR    15,11                SAVE REGISTER 11                    07020000
         LR    0,12                 SAVE REGISTER 12                    07030000
         LR    1,13                 SAVE REGISTER 13                    07040000
         AIF   (&PSAPTR EQ 0).OLDLITC                              @L8A 07050000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 07060000
         AGO   .ARCHKC                                             @L8A 07070000
.OLDLITC ANOP                                                      @L8A 07080000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 07090000
.ARCHKC  ANOP                                                      @L8A 07100000
         AIF   ('&SYSASCE' EQ 'P').NOAR17                          @L2A 07110000
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 07120000
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 07130000
         AGO   .MNLCODE                                            @L2A 07140000
.NOAR17  ANOP                                                           07150000
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 07160000
*                                   RTN ENTRY POINT.                    07170000
.*                                                                      07180000
.MNLCODE ANOP                                                           07190000
         AIF   (T'&INSTDATA EQ 'O').CHECKMODE                      @LIA 07200000
         OILH  12,X'8000'           Indicate instrumentation exists     07210000
.CHECKMODE ANOP                                                    @LIA 07220000
         AIF   ('&MODE' EQ 'UNCOND').BALCK                              07230000
.*                                                                      07240000
.MNLCOD2 ANOP                                                           07250000
         AIF   ('&SYSASCE' EQ 'P').NOAR36                          @L2A 07260000
         SAC   0                    PRIMARY MODE                   @L2A 07270000
.NOAR36  ANOP                                                           07280000
         AIF   (&PSAPTR EQ 0).NONOTE1                              @L8A 07290000
*        NOTE: THIS LOCK SUPPORTED IN 31-BIT AMODE ONLY            @L8A 07300000
.NONOTE1 ANOP                                                      @L8A 07310000
         BALR  14,13                BRANCH ENTER LOCK ROUTINE           07320000
         AIF   ('&SYSASCE' EQ 'P').NOAR37                          @L2A 07330000
         SAC   X'200'               AR MODE                        @L2A 07340000
.NOAR37  ANOP                                                           07350000
         AGO   .MNLCOD3                                                 07360000
.*                                                                      07370000
.BALCK   ANOP                                                           07380000
         AIF   ('&DISABLE' EQ '').MNLCOD2                               07390000
         AIF   ('&TYPE' EQ 'LOCAL').ERRDIS3                             07400000
         AIF   ('&TYPE' EQ 'CML').ERRDIS3                      @G387PXR 07410000
         AIF   ('&TYPE'(1,3) EQ 'CMS').ERRDIS3                 @G741PXT 07420000
         AIF   ('&SYSASCE' EQ 'P').NOAR42                          @L2A 07430000
         SAC   0                    PRIMARY MODE                   @L2A 07440000
.NOAR42  ANOP                                                           07450000
         AIF   (&PSAPTR EQ 0).NONOTE2                              @L8A 07460000
*                                                                       07470000
*        NOTE: THIS LOCK SUPPORTED IN 31-BIT AMODE ONLY            @L8A 07480000
.NONOTE2 ANOP                                                      @L8A 07490000
         BAL   14,4(0,13)           BRANCH TO LOCK RTN AT DISABLED      07500000
*                                   ENTRY POINT                         07510000
*        NOTE: YOU HAVE JUST SAID THAT YOU ARE DISABLED                 07520000
         AIF   ('&SYSASCE' EQ 'P').NOAR43                          @L2A 07530000
         SAC   X'200'               AR MODE                        @L2A 07540000
.NOAR43  ANOP                                                           07550000
.*                                                                      07560000
.MNLCOD3 ANOP                                                           07570000
         AIF   ('&REGS' EQ 'SAVE').SAVE4                                07580000
         AIF   ('&REGS' EQ 'STDSAVE').STD4                         @L4A 07590000
         AIF   ('&REGS' NE 'USE').ENDIT                                 07600000
         LR    11,15                RESTORE REGISTER 11                 07610000
         LR    15,13                PUT RETURN CODE IN REGISTER 15      07620000
         LR    12,0                 RESTORE REGISTER 12                 07630000
         LR    13,1                 RESTORE REGISTER 13                 07640000
         MEXIT                                                          07650000
.*                                                                      07660000
.SAVE4   ANOP                                                           07670000
.LMEXIT  LR    12,13                SWAP REGISTERS                 @L4C 07680000
         LR    13,15                               R13 AND         @L4C 07690000
         LR    15,12                                       R15     @L4C 07700000
         AIF   (T'&INSTDATA NE 'O').SAVE4_10                       @LIA 07710000
         LM    11,14,0(13)          RESTORE REGS                   @L2C 07720000
         AGO   .SAVE4_COM                                          @LIA 07730000
.SAVE4_10  ANOP                                                    @LIA 07740000
         LM    10,14,0(13)          RESTORE REGS                   @LIA 07750000
.SAVE4_COM ANOP                                                    @LIA 07760000
         MEXIT                                                          07770000
.*                                                                      07780000
.STD4    ANOP                                                      @L4A 07790000
.LM1EXIT LR    12,13                SWAP REGISTERS                 @L4A 07800000
         LR    13,15                               R13 AND         @L4A 07810000
         LR    15,12                                       R15     @L4A 07820000
         LM    2,12,28(13)          RESTORE REGS PRESERVING        @L4A 07821000
*                                   THE RETURN CODE IN R15              07822000
         MEXIT                                                          07823000
.*                                                                      07824000
.*******************************************************************    07825000
.*       PROCESS "COND,IN" REQUEST FOR CML LOCK ONLY               *    07826000
.*******************************************************************    07827000
.*                                                                      07828000
.CONDIN  ANOP                                                      @L1A 07829000
         AIF   ('&TYPE' NE 'CML').CONDINC  COND,IN REQUEST VALID   @L1A 07830000
.*                                         ONLY FOR CML LOCK OBTAIN     07840000
.*                                                                      07850000
         AIF   (T'&DISABLE NE 'O').ERRDIS3 DISABLED IS NOT VALID   @L1A 07860000
.*                                         FOR CONDITIONAL OBTAIN       07870000
         AIF   (T'&SCOPE NE 'O').NOSCOPE   SCOPE IS INVALID        @L1A 07880000
.*                                                                      07890000
         AIF   (T'&ADDR NE 'O').ERRAD      ADDR IS INVALID         @L1A 07900000
.*                                                                      07910000
         AIF   (T'&ASCB EQ 'O').ASCBREQ    ASCB MUST BE SPECIFIED  @L1A 07920000
.*                                                                      07930000
         AIF   ('&ASCB' EQ '(11)').CONDIN0 ASCB=(11) IS OK         @L1A 07940000
         AIF   ('&ASCB'(1,1) EQ '(').ERREG2  ASCB MUST NOT BE A    @L1A 07950000
.*                                         REGISTER EXCEPT (11)         07960000
.*                                                                      07970000
.CONDIN0 ANOP                                                      @L1A 07980000
         AIF   (T'&NAME EQ 'O').CONDIN1    BRANCH IF LABEL WAS NOT @L1A 07990000
.*                                         SPECIFIED                    08000000
&NAME    DS    0H                                                  @L1A 08010000
.*                                                                      08020000
.CONDIN1 ANOP                                                      @L1A 08030000
         AIF   ('&REGS' EQ 'SAVE').CONDIN2                         @L1A 08040000
         AIF   ('&REGS' EQ 'STDSAVE').CONDIN2A                     @L4A 08050000
         AIF   ('&REGS' EQ 'USE').CONDIN3                          @L1A 08060000
         AIF   (T'&REGS EQ 'O').CONDIN4                            @L1A 08070000
.*                                                                      08080000
         AGO   .BADREGS                    REGS PARAMETER IS BAD   @L1A 08090000
.*                                                                      08100000
.*                                                                      08110000
.CONDIN2 ANOP                                                      @L1A 08120000
         LR    15,13                LOAD SAVE AREA ADDRESS         @L1A 08130000
         STM   11,14,0(13)          SAVE REGISTERS                 @L2C 08140000
         AGO   .CONDIN4                                                 08150000
.*                                                                      08160000
.CONDIN2A ANOP                                                     @L4A 08170000
         LR    15,13                LOAD SAVE AREA ADDRESS         @L4A 08180000
         STM   14,12,12(13)         SAVE REGISTERS                 @L4A 08190000
         AGO   .CONDIN4                                            @L4A 08200000
.*                                                                      08210000
.CONDIN3 ANOP                                                      @L1A 08220000
         LR    15,11                SAVE REGISTER 11               @L1A 08230000
         LR    0,12                 SAVE REGISTER 12               @L1A 08240000
         LR    1,13                 SAVE REGISTER 13               @L1A 08250000
.*                                                                      08260000
.CONDIN4 ANOP                                                      @L1A 08270000
         AIF   ('&ASCB' EQ '(11)').CONDIN4A BRANCH IF ASCB IN R11  @P1A 08280000
.*                                                                      08290000
         L     11,&ASCB             LOAD ASCB ADDRESS              @L1A 08300000
.*                                                                      08310000
.CONDIN4A ANOP                                                     @P1A 08320000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 08330000
         L     13,1416(14,0)        LOCK ROUTINE ENTRY POINT       @L2C 08340000
.*                                                                      08350000
         AGO   .MNLCOD2                                            @L1A 08360000
.*                                                                      08370000
.*                                                                      08380000
.*******************************************************************    08390000
.*       BEGINNING OF RELEASE TYPE=(REG) PROCESSING                *    08400000
.*******************************************************************    08410000
.*                                                                      08420000
.RREG    ANOP                                                           08430000
         AIF   ('&DISABLE' EQ 'DISABLED').STDIS                    @L8C 08440000
&INDEX   SETA  &REL(&X)                    RELEASE LOCKS ENABLED   @L8A 08450000
         AGO   .ASCBS                                                   08460000
.*                                                                      08470000
.STDIS   ANOP                              RELEASE LOCKS DISABLED  @L8A 08480000
&INDEX   SETA  &RELD(&X)                                           @L8A 08490000
.*                                                                      08500000
.ASCBS   ANOP                                                      @L8A 08510000
         AIF   (T'&ASCB NE 'O').RREGASI                            @L8C 08520000
         AIF   (T'&LOCKHLD NE 'O').RREGLKH                         @L8C 08530000
.*                                                                      08540000
         AIF   ('&NAME' EQ '').RREGNN                              @L8C 08550000
&NAME    DC    0H'0'                                           @G860PXA 08560000
.RREGNN  ANOP                                                           08570000
         AIF   (T'&REGS EQ 'O').RREG4                          @G860PXA 08580000
         AIF   ('&REGS' EQ 'SAVE').RREG3                       @G860PXA 08590000
         AIF   ('&REGS' EQ 'STDSAVE').RREG3A                       @L4A 08600000
.*                                                                      08610000
.*  REGS=USE SPECIFIED                                                  08620000
.*                                                                      08630000
         LR    15,11                SAVE REG 11                @G860PXA 08640000
         LR    0,12                 SAVE REG 12                         08650000
         LR    1,13                 SAVE REG 13                         08660000
         AGO   .RREG4                                          @G860PXA 08670000
.*                                                                      08680000
.RREG3   ANOP                                                      @L8A 08690000
         LR    15,13                SAVE AREA ADDRESS          @G860PXA 08700000
         STM   11,14,0(13)          SAVE REGS 11 THRU 14           @L2C 08710000
         AGO   .RREG4                                              @L4A 08720000
.*                                                                      08730000
.RREG3A  ANOP                                                      @L8A 08740000
         LR    15,13                SAVE AREA ADDRESS              @L4A 08750000
         STM   14,12,12(13)         SAVE REGS 14 THRU 12           @L4A 08760000
.*                                                                      08770000
.RREG4   ANOP                                                      @L8A 08780000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 08790000
         AIF   ('&SYSASCE' EQ 'P').NOAR35                          @L2A 08800000
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 08810000
.NOAR35  ANOP                                                      @L8A 08820000
         AIF   ('&TYPE' EQ '(11)').RREG50                      @ZMC0388 08830000
         LR    11,&TYPE(1)          PUT STRING IN PROPER REG   @G860PXA 08840000
.RREG50  ANOP                                                      @L8A 08850000
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM & EP ADDR          @L2C 08860000
         AIF   ('&SYSASCE' EQ 'P').NOAR46                          @L2A 08870000
         SAC   0                    PRIMARY MODE                   @L2A 08880000
.NOAR46  ANOP                                                      @L8A 08890000
         BALR  14,13                LINK TO LOCK RTN           @G387PXR 08900000
         AIF   ('&SYSASCE' EQ 'P').NOAR47                          @L2A 08910000
         SAC   X'200'               AR MODE                        @L2A 08920000
.NOAR47  ANOP                                                      @L8A 08930000
         AIF   (T'&REGS EQ 'O').RREG9                          @G860PXA 08940000
         AIF   ('&REGS' EQ 'SAVE').LMEXIT                          @L2C 08950000
         AIF   ('&REGS' EQ 'STDSAVE').LM1EXIT                      @L4A 08960000
.*                                                                      08970000
.*   REGS=USE SPECIFIED                                                 08980000
.*                                                                      08990000
         LR    11,15                RESTORE REG 11             @G860PXA 09000000
         LR    15,13                PUT RETURN CODE IN REG 15  @ZMC0683 09010000
         LR    12,0                 RESTORE REG 12             @G860PXA 09020000
         LR    13,1                 RESTORE REG 13             @G860PXA 09030000
.*                                                                      09040000
.RREG9   ANOP                                                      @L8A 09050000
         MEXIT                                                 @G860PXA 09060000
.*                                                                      09070000
.*******************************************************************    09080000
.*       BEGINNING OF RELEASE ALL PROCESSING                       *    09090000
.*******************************************************************    09100000
.*                                                                      09110000
.RALL    ANOP                                                           09120000
         AIF   ('&DISABLE' EQ 'DISABLED').SETDIS                   @L8C 09130000
&INDEX   SETA  &REL(&X)                    RELEASE ALL ENABLED     @L8A 09140000
         AGO   .ASCBCK                                             @L8A 09150000
.*                                                                      09160000
.SETDIS  ANOP                              RELEASE ALL DISABLED    @L8A 09170000
&INDEX   SETA  &RELD(&X)                                           @L8A 09180000
.*                                                                      09190000
.ASCBCK  ANOP                                                      @L8A 09200000
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G860PXA 09210000
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                         @L8C 09220000
.*                                                                      09230000
         AIF   ('&NAME' EQ '').RALLNN                          @G860PXA 09240000
&NAME    DC    0H'0'                                                    09250000
.RALLNN  ANOP                                                      @L8A 09260000
         AIF   (T'&REGS EQ 'O').RALL4                          @G860PXA 09270000
         AIF   ('&REGS' EQ 'SAVE').RALL3                       @G860PXA 09280000
         AIF   ('&REGS' EQ 'STDSAVE').RALL3A                       @L4A 09290000
.*                                                                      09300000
.*  REGS=USE SPECIFIED                                                  09310000
.*                                                                      09320000
         LR    15,11                SAVE REG 11                @G860PXA 09330000
         LR    0,12                 SAVE REG 12                         09340000
         LR    1,13                 SAVE REG 13                         09350000
         AGO   .RALL4                                          @G860PXA 09360000
.*                                                                      09370000
.RALL3   ANOP                                                      @L8A 09380000
         LR    15,13                SAVE AREA ADDRESS          @G860PXA 09390000
         STM   11,14,0(13)          SAVE REGS 11 THRU 14           @L2C 09400000
         AGO   .RALL4                                              @L4A 09410000
.*                                                                      09420000
.RALL3A  ANOP                                                      @L8A 09430000
         LR    15,13                SAVE AREA ADDRESS              @L4A 09440000
         STM   14,12,12(13)         SAVE REGS 14 THRU 12           @L4A 09450000
.*                                                                      09460000
.RALL4   ANOP                                                      @L8A 09470000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 09480000
         AIF   ('&SYSASCE' EQ 'P').NOAR33                          @L2A 09490000
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 09500000
.*                                                                      09510000
.NOAR33  ANOP                                                           09520000
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM & EP ADDR          @L2C 09530000
         AIF   ('&SYSASCE' EQ 'P').NOAR38                          @L2A 09540000
         SAC   0                    PRIMARY MODE                   @L2A 09550000
.*                                                                      09560000
.NOAR38  ANOP                                                           09570000
         BALR  14,13                LINK TO LOCK RTN           @G387PXR 09580000
         AIF   ('&SYSASCE' EQ 'P').NOAR39                          @L2A 09590000
         SAC   X'200'               AR MODE                        @L2A 09600000
.*                                                                      09610000
.NOAR39  ANOP                                                           09620000
         AIF   (T'&REGS EQ 'O').RALL9                          @G860PXA 09630000
         AIF   ('&REGS' EQ 'SAVE').LMEXIT                          @L2C 09640000
         AIF   ('&REGS' EQ 'STDSAVE').LM1EXIT                      @L4A 09650000
.*                                                                      09660000
.*  REGS=USE SPECIFIED                                                  09670000
.*                                                                      09680000
         LR    11,15                RESTORE REG 11             @G860PXA 09690000
         LR    15,13                PUT RETURN CODE IN REG 15  @ZMC0683 09700000
         LR    12,0                 RESTORE REG 12             @G860PXA 09710000
         LR    13,1                 RESTORE REG 13             @G860PXA 09720000
.*                                                                      09730000
.RALL9   ANOP                                                  @G860PXA 09740000
         MEXIT                                                          09750000
.*                                                                      09760000
.*******************************************************************    09770000
.*       BEGINNING OF RELEASE TYPE=SPIN PROCESSING                 *    09780000
.*******************************************************************    09790000
.*                                                                      09800000
.RSPIN   ANOP                                                           09810000
         AIF   ('&DISABLE' EQ 'DISABLED').SETDIS2                  @L8C 09820000
&INDEX   SETA  &REL(&X)           RELEASE SPIN LOCKS ENABLED       @L8A 09830000
         AGO   .NAMECK                                             @L8A 09840000
.*                                                                      09850000
.SETDIS2 ANOP                     RELEASE SPIN LOCKS DISABLED      @L8A 09860000
&INDEX   SETA  &RELD(&X)                                           @L8A 09870000
.*                                                                      09880000
.NAMECK  ANOP                                                      @L8A 09890000
         AIF   ('&NAME' EQ '').RSPINNN                                  09900000
&NAME    DC    0H'0'                                                    09910000
.RSPINNN AIF   (T'&REGS EQ 'O').RSPINC                                  09920000
         AIF   ('&REGS' EQ 'SAVE').RSPINS                               09930000
         AIF   ('&REGS' EQ 'STDSAVE').RSPINS1                      @L4A 09940000
         LR    15,11                SAVE REG 11                         09950000
         LR    0,12                 SAVE REG 12                         09960000
         LR    1,13                 SAVE REG 13                         09970000
         AGO   .RSPINC                                                  09980000
.RSPINS  ANOP                                                           09990000
         LR    15,13                SAVE AREA ADDRESS                   10000000
         STM   11,14,0(13)          SAVE REGS 11 THRU 14           @L2C 10010000
         AGO   .RSPINC                                             @L4A 10020000
.RSPINS1 ANOP                                                      @L4A 10030000
         LR    15,13                SAVE AREA ADDRESS              @L4A 10040000
         STM   14,12,12(13)         SAVE REGS 14 THRU 12           @L4A 10050000
.RSPINC  ANOP                                                           10060000
         AIF   (T'&DISABLE EQ 'O').RSPINE                      @ZMC0587 10070000
         MVI   PSAMPSW-PSA(0),X'00' INDICATE RETURN DISABLED   @ZMC0587 10080000
         AGO   .RSPINR                                         @ZMC0587 10090000
.RSPINE  ANOP                                                  @ZMC0587 10100000
         MVI   PSAMPSW-PSA(0),X'03' INDICATE RETURN ENABLED    @ZMC0587 10110000
.RSPINR  ANOP                                                  @ZMC0587 10120000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 10130000
         AIF   ('&SYSASCE' EQ 'P').NOAR34                          @L2A 10140000
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L2A 10150000
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L2A 10160000
         SAC   0                    PRIMARY MODE                   @L2A 10170000
         AGO   .AR34                                               @L2A 10180000
.NOAR34  ANOP                                                           10190000
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM & EP ADDRESS       @L2C 10200000
.AR34    BALR  14,13                LINK TO LOCK MANAGER                10210000
         AIF   ('&SYSASCE' EQ 'P').NOAR41                          @L2A 10220000
         SAC   X'200'               AR MODE                        @L2A 10230000
.NOAR41  ANOP                                                           10240000
         AIF   (T'&REGS EQ 'O').RSPINX                                  10250000
         AIF   ('&REGS' EQ 'USE').RSPINU                                10260000
         AIF   ('&REGS' EQ 'STDSAVE').LM1EXIT  SAVE RETURN CODE,   @L4A 10270000
.*                                  RESTORE REGS 2 THRU 12              10280000
         AGO   .LMEXIT              SAVE RETURN CODE, RESTORE REGS @L4C 10290000
.*                                  11 THRU 14                          10300000
.RSPINX  MEXIT                                                          10310000
.RSPINU  ANOP                                                           10320000
         LR    11,15                RESTORE REG 11                      10330000
         LR    15,13                PUT RETURN CODE IN         @ZMC0683 10340000
*                                   REGISTER 15                @ZMC0683 10350000
         LR    12,0                 RESTORE REG 12                      10360000
         LR    13,1                 RESTORE REG 13                      10370000
         MEXIT                                                          10380000
.*                                                                      10390000
.************************************************************* @G860PXA 10400000
.* BEGINNING OF TEST SUPPORT                                   @G860PXA 10410000
.************************************************************* @G860PXA 10420000
.*                                                                      10430000
.TEST    ANOP                                                           10440000
         AIF   (T'&TYPE EQ 'O').ERRTYPE   TYPE REQUIRED       @G860PXA  10450000
         AIF   (T'&MODE NE 'O').INVMODE   MODE IS NOT VALID             10460000
         AIF   (T'&INSTDATA NE 'O').ERRINSTDATA5                  @LIA  10470000
         AIF   (T'&DISABLE NE 'O').NODIS  DISABLED IS NOT VALID         10480000
         AIF   ('&TYPE' EQ 'HIER').HIER01                         @L8A  10490000
         AIF   ('&TYPE' EQ 'ALL').TALLC                           @L8A  10500000
         AIF   ('&TYPE' EQ 'SPIN').SPIN01                         @L8A  10510000
         AGO   .TSTADR                                            @L8C  10520000
.*                                                                      10530000
.************************************************************* @G860PXA 10540000
.* BEGINNING OF TEST,TYPE=HIER PROCESSING                      @G860PXA 10550000
.************************************************************* @G860PXA 10560000
.*                                                                      10570000
.HIER01  ANOP                                                      @L8A 10580000
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 10590000
         AIF   (T'&ADDR NE 'O').ERRAD                          @G860PXA 10600000
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G860PXA 10610000
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G860PXA 10620000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 10630000
.*                                                                      10640000
         AIF   (T'&LOCK EQ 'O').TERR007                        @G860PXA 10650000
.*********************************************************************  10660000
.*                                                                   *  10670000
.*    &X REFERS TO THE INDEX WITHIN THE 4 OFFSET ARRAYS, COBT,       *  10680000
.*    UOBT, REL, AND RELD.                                           *  10690000
.*                                                                   *  10700000
.*    NOTE:  &X SHOULD BE INCREMENTED BY 2 INSTEAD OF 1 AFTER        *  10710000
.*    SHR/EXCL LOCKS.                                                *  10720000
.*                                                                   *  10730000
.*********************************************************************  10740000
&X       SETA  1              UPDATE INDEX TO DISP ENTRY           @L8C 10750000
         AIF   ('&LOCK' EQ 'DISP').HIER02                      @G860PXA 10760000
&X       SETA  2              UPDATE INDEX TO RSMDS ENTRY          @L8C 10770000
         AIF   ('&LOCK' EQ 'RSMDS').HIER02                         @L3A 10780000
&X       SETA  3              UPDATE INDEX TO IOSUCB ENTRY         @L8C 10790000
         AIF   ('&LOCK' EQ 'IOSUCB').HIER02                    @G860PXA 10800000
&X       SETA  5              UPDATE INDEX TO IOSYNCH ENTRY        @L8C 10810000
         AIF   ('&LOCK' EQ 'IOSYNCH').HIER02                   @G860PXA 10820000
&X       SETA  8              UPDATE INDEX TO TPACBDEB ENTRY       @L8C 10830000
         AIF   ('&LOCK' EQ 'TPACBDEB').HIER02                  @G860PXA 10840000
&X       SETA  9              UPDATE INDEX TO ASM ENTRY            @L8C 10850000
         AIF   ('&LOCK' EQ 'ASM').HIER02                       @G860PXA 10860000
&X       SETA  10             UPDATE INDEX TO SALLOC ENTRY         @L8C 10870000
         AIF   ('&LOCK' EQ 'SALLOC').HIER02                    @G860PXA 10880000
&X       SETA  11             UPDATE INDEX TO SRM ENTRY            @L8C 10890000
         AIF   ('&LOCK' EQ 'SRM').HIER02                       @G860PXA 10900000
&X       SETA  20             UPDATE INDEX TO TRACE ENTRY          @L8C 10910000
         AIF   ('&LOCK' EQ 'TRACE').HIER02                     @G860PXA 10920000
&X       SETA  22             UPDATE INDEX TO VSMPAG ENTRY         @L8C 10930000
         AIF   ('&LOCK' EQ 'VSMPAG').HIER02                    @G860PXA 10940000
&X       SETA  23             UPDATE INDEX TO RSM ENTRY            @L8C 10950000
         AIF   ('&LOCK' EQ 'RSM').HIER02                       @G860PXA 10960000
&X       SETA  25             UPDATE INDEX TO RSMAD ENTRY          @L8C 10970000
         AIF   ('&LOCK' EQ 'RSMAD').HIER02                     @G860PXA 10980000
&X       SETA  26             UPDATE INDEX TO RSMXM ENTRY          @L8C 10990000
         AIF   ('&LOCK' EQ 'RSMXM').HIER02                     @G860PXA 11000000
&X       SETA  27             UPDATE INDEX TO RSMST ENTRY          @L8C 11010000
         AIF   ('&LOCK' EQ 'RSMST').HIER02                     @G860PXA 11020000
&X       SETA  28             UPDATE INDEX TO ASMGL ENTRY          @L8C 11030000
         AIF   ('&LOCK' EQ 'ASMGL').HIER02                     @G860PXA 11040000
&X       SETA  29             UPDATE INDEX TO VSMFIX ENTRY         @L8C 11050000
         AIF   ('&LOCK' EQ 'VSMFIX').HIER02                    @G860PXA 11060000
&X       SETA  30             UPDATE INDEX TO RSMGL ENTRY          @L8C 11070000
         AIF   ('&LOCK' EQ 'RSMGL').HIER02                     @G860PXA 11080000
&X       SETA  34             UPDATE INDEX TO RSMCM ENTRY          @L8C 11090000
         AIF   ('&LOCK' EQ 'RSMCM').HIER02                         @L3C 11100000
&X       SETA  35             UPDATE INDEX TO IOS ENTRY            @L8C 11110000
         AIF   ('&LOCK' EQ 'IOS').HIER02                           @L8C 11120000
&PSAPTR  SETA  1                                                   @L8A 11130000
&X       SETA  37             UPDATE INDEX TO BMFLSD ENTRY         @L7A 11140000
         AIF   ('&LOCK' EQ 'BMFLSD').HIER02                        @L7A 11150000
&X       SETA  38             UPDATE INDEX TO ETRSET ENTRY         @L6A 11160000
         AIF   ('&LOCK' EQ 'ETRSET').HIER02                        @L6A 11170000
&X       SETA  39             UPDATE INDEX TO XCFDS ENTRY          @L5A 11180000
         AIF   ('&LOCK' EQ 'XCFDS').HIER02                         @L5A 11190000
&X       SETA  40             UPDATE INDEX TO XCFRES ENTRY         @L5A 11200000
         AIF   ('&LOCK' EQ 'XCFRES').HIER02                        @L5A 11210000
&X       SETA  41             UPDATE INDEX TO XCFQ ENTRY           @L5A 11220000
         AIF   ('&LOCK' EQ 'XCFQ').HIER02                          @L9C 11230000
&X       SETA  43             UPDATE INDEX TO IOSULUT ENTRY        @L9A 11240000
         AIF   ('&LOCK' EQ 'IOSULUT').HIER02                       @LAC 11250000
&X       SETA  45             UPDATE INDEX TO IXLSCH ENTRY         @LBC 11260000
         AIF   ('&LOCK' EQ 'IXLSCH').HIER02                        @LBC 11270000
&X       SETA  46             UPDATE INDEX TO IXLSHR ENTRY         @LBC 11280000
         AIF   ('&LOCK' EQ 'IXLSHR').HIER02                        @LBC 11290000
&X       SETA  48             UPDATE INDEX TO IXLDS ENTRY          @LBC 11300000
         AIF   ('&LOCK' EQ 'IXLDS').HIER02                         @LAA 11310000
&X       SETA  49             UPDATE INDEX TO IXLSHELL ENTRY       @LBC 11320000
         AIF   ('&LOCK' EQ 'IXLSHELL').HIER02                      @LBC 11330000
&X       SETA  50             UPDATE INDEX TO IXLREQST ENTRY       @01A 11340000
         AIF   ('&LOCK' EQ 'IXLREQST').HIER02                      @01A 11350000
&X       SETA  51             UPDATE INDEX TO WLMQ ENTRY           @LCA 11360000
         AIF   ('&LOCK' EQ 'WLMQ').HIER02                          @LCA 11370000
&X       SETA  53             UPDATE INDEX TO WLMRES ENTRY         @LCA 11380000
         AIF   ('&LOCK' EQ 'WLMRES').HIER02                        @LCA 11390000
&X       SETA  54             UPDATE INDEX TO REGSRV ENTRY         @LCA 11400000
         AIF   ('&LOCK' EQ 'REGSRV').HIER02                        @LCA 11410000
&X       SETA  56             UPDATE INDEX TO CONTEXT ENTRY        @LCA 11420000
         AIF   ('&LOCK' EQ 'CONTEXT').HIER02                       @LCA 11430000
&X       SETA  57             UPDATE INDEX TO SSD ENTRY            @LDA 11440000
         AIF   ('&LOCK' EQ 'SSD').HIER02                           @LDA 11450000
&X       SETA  59             UPDATE INDEX TO GRSINT ENTRY         @LFA 11460000
         AIF   ('&LOCK' EQ 'GRSINT').HIER02                        @LFA 11470000
.*                            Add 2 after SHR/EXCL lock.                11480000
&X       SETA  61             UPDATE INDEX TO MISC ENTRY           @LJC 11490000
         AIF   ('&LOCK' EQ 'MISC').HIER02                          @LJC 11500000
&X       SETA  62             UPDATE INDEX TO DONOTUS2 ENTRY       @LJC 11510000
         AIF   ('&LOCK' EQ 'DONOTUS2').HIER02                      @LJC 11520000
&X       SETA  63             UPDATE INDEX TO DONOTUS3 ENTRY       @LJC 11530000
         AIF   ('&LOCK' EQ 'DONOTUS3').HIER02                      @LJC 11540000
&X       SETA  64             UPDATE INDEX TO DONOTUS4 ENTRY       @LJC 11550000
         AIF   ('&LOCK' EQ 'DONOTUS4').HIER02                      @LJC 11560000
&X       SETA  65             UPDATE INDEX TO DONOTUS5 ENTRY       @LJC 11570000
         AIF   ('&LOCK' EQ 'DONOTUS5').HIER02                      @LJC 11580000
&X       SETA  66             UPDATE INDEX TO HCWDRLK2 ENTRY       @LGA 11590000
         AIF   ('&LOCK' EQ 'HCWDRLK2').HIER02                      @LGA 11600000
&X       SETA  67             UPDATE INDEX TO HCWDRLK1 ENTRY       @LGA 11610000
         AIF   ('&LOCK' EQ 'HCWDRLK1').HIER02                      @LGA 11620000
&X       SETA  68             UPDATE INDEX TO SRMENQ ENTRY         @LHA 11630000
         AIF   ('&LOCK' EQ 'SRMENQ').HIER02                        @LHA 11640000
.*                            Add 2 after SHR/EXCL lock.                11650000
.* 70-74 are defined only in SETLOCKP                              @LKA 11660000
&X       SETA  75             UPDATE INDEX TO RSMQ ENTRY           @LKA 11670000
         AIF   ('&LOCK' EQ 'RSMQ').HIER02                          @LKA 11680000
&X       SETA  76             UPDATE INDEX TO SSDGROUP ENTRY       @LMA 11690000
         AIF   ('&LOCK' EQ 'SSDGROUP').HIER02                      @LMA 11700000
         AGO   .TERR008                                            @LAA 11710000
.HIER02  ANOP                                                           11720000
&INDEX   SETA  &COBT(&X)   GET INDEX INTO LIT, USED TO OBTAIN PARM @L8A 11730000
.*                         LIST ADDRESS FOR SPECIFIED LOCK              11740000
         AIF   (T'&BRANCH EQ 'O').CKWKRG  WORKREG SPECIFIED        @L8A 11750000
.*                                        WITHOUT BRANCH?               11760000
.*  BRANCH WAS SPECIFIED                                                11770000
.*                                                                      11780000
         AIF   (N'&BRANCH NE 2).TINVBR                         @G860PXA 11790000
         AIF   ('&BRANCH(1)' EQ 'HELD').HIER08                 @G860PXA 11800000
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND             @G860PXA 11810000
.*                                                                      11820000
.*  BRANCH OPERAND VALID                                                11830000
.*                                                                      11840000
.HIER08  ANOP                                                           11850000
         AIF   (T'&WORKREG EQ 'O').NOWKREG WORKREG REQUIRED WITH   @L8A 11860000
.*                                         BRANCH                       11870000
.*  WORKREG WAS SPECIFIED                                               11880000
.*                                                                      11890000
         AIF   (N'&WORKREG NE 1).TINVWK                            @L8A 11900000
         AIF   ('&WORKREG'(1,1) NE '(').NOTAREG                    @L8A 11910000
         AIF   ('&NAME' EQ '').NN1                                 @L8A 11920000
&NAME    DC    0H'0'                                               @L8A 11930000
.NN1     ANOP                                                      @L8A 11940000
         AGO   .GENCODE                   GENERATE CODE WITH       @L8A 11950000
.*                                        WORKREG                       11960000
.*  BRANCH WAS NOT SPECIFIED                                            11970000
.*                                                                      11980000
.CKWKRG  ANOP                                                      @L8A 11990000
         AIF   (T'&WORKREG NE 'O').WARNWK WORKREG IGNORED WITHOUT  @L8A 12000000
.*                                        BRANCH                        12010000
.WRNWKR  ANOP                                                      @L8A 12020000
         AIF   ('&NAME' EQ '').NN2                                 @L8A 12030000
&NAME    DC    0H'0'                                               @L8A 12040000
.NN2     ANOP                                                      @L8A 12050000
         AGO   .GENCOD2                   GENERATE CODE WITHOUT    @L8A 12060000
.*                                        WORKREG                       12070000
.GENCODE ANOP                             WORKREG SPECIFIED        @L8A 12080000
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 12090000
.*                                                                      12100000
.GENCOD2 ANOP                       WORKREG NOT SPECIFIED          @L8A 12110000
         IAC   15                   SET CONDITION CODE BASED ON    @L8A 12120000
*                                   ASC MODE TO BE USED BY THE IPM      12130000
*                                   INSTRUCTION WHICH FOLLOWS.          12140000
         SAC   0                    SAC TO PRIMARY FOR BAKR        @L8A 12150000
         &LA   15,&GNAME1           RETURN ADDRESS FOR PR          @LJC 12160000
         BSM   15,0                 SET AMODE BIT FOR RETURN ADDR  @L8A 12170000
         BAKR  15,0                 SAVE STATUS ON THE LINKAGE     @L8A 12180000
*                                   STACK AND SET UP RETURN ADDRESS FOR 12190000
*                                   THE PR                              12200000
         IPM   0                    PUT IAC CC BITS INTO REG 0     @L8A 12210000
         SRL   0,20                 SHIFT IAC CC TO BITS 22-23     @L8A 12220000
         L     15,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 12230000
         AIF   (&PSAPTR EQ 1).NEWLIT                               @L8A 12240000
         L     12,&INDEX.+4(15,0)   PARM LIST ADDRESS FOR          @L8A 12250000
*                                   SPECIFIED LOCK                      12260000
         AGO   .EPA                                                @L8A 12270000
.NEWLIT  ANOP                                                      @L8A 12280000
         L     12,PSALIT2-PSA(0,0)  EXTENDED LOCK INTERFACE TABLE  @L8A 12290000
*                                   ADDRESS                             12300000
         L     12,&INDEX.+4(12,0)   PARM LIST ADDRESS FOR          @L8A 12310000
*                                   SPECIFIED LOCK                      12320000
.EPA     ANOP                                                      @L8A 12330000
         L     15,1524(15,0)        LOCK MANAGER ENTRY POINT       @L8A 12340000
*                                   ADDRESS                             12350000
         BASSM 14,15                BRANCH TO SERVICE RTN.         @L8A 12360000
         EREG  0,1                  RESTORE REGISTERS 0,1          @L8A 12370000
         PR                         RESTORE STATUS                 @L8A 12380000
&GNAME1  EQU   *                                                   @L8A 12390000
*                                                                       12400000
*    THE ASC-MODE OF THE CALLER HAS BEEN RESTORED TO GENERAL REGISTER   12410000
*    15 BY THE SERVICE ROUTINE FOR USE IN THE SAC INSTRUCTION.          12420000
*                                                                       12430000
         SAC   0(15)                RESTORE ORIGINAL ASC-MODE      @L8A 12440000
         ICM   15,B'1110',PSAFZERO-PSA(0) CLEAN RETURN CODE FROM   @L8A 12450000
*                                         LOCK MANAGER                  12460000
*                                                                  @L8A 12470000
         AIF   (T'&BRANCH EQ 'O').DONE                             @L8A 12480000
*                                                                       12490000
*    INSTRUCTIONS THAT CHANGE THE CONDITION CODE MAY NOT BE INSERTED    12500000
*    BETWEEN THE LTR AND THE RESULTING BRANCH WHICH IS GENERATED.       12510000
*                                                                       12520000
         LTR   15,15                                               @L8A 12530000
         LR    15,&WORKREG(1)       RESTORE GPR15                  @L8A 12540000
         AIF   ('&BRANCH(1)' EQ 'HELD').HIER10                     @L8A 12550000
         &B.Z  &BRANCH(2)           BRANCH NO HIGHER LOCKS HELD    @P6C 12560000
*                                   (R.C. IS 0)                         12570000
         MEXIT                                                     @L8A 12580000
.HIER10  ANOP                                                      @L8A 12590000
         &B.NZ &BRANCH(2)           BRANCH HIGHER LOCKS HELD       @P6C 12600000
*                                   (R.C. IS 4)                         12610000
.DONE    ANOP                                                      @L8A 12620000
         MEXIT                                                          12630000
.*                                                                      12640000
.*************************************************************          12650000
.*   BEGINNING OF TEST,TYPE=ALL PROCESSING                   *          12660000
.*************************************************************          12670000
.*                                                                      12680000
.TALLC   ANOP                                                           12690000
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 12700000
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G387PXR 12710000
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G387PXR 12720000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 12730000
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 12740000
         AIF   (T'&LOCK NE 'O').TERR009                            @L8A 12750000
         AIF   ('&BRANCH' EQ '').CKWREG5                           @L8A 12760000
.*                                                                      12770000
.*  BRANCH WAS SPECIFIED                                                12780000
.*                                                                      12790000
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 12800000
         AIF   ('&BRANCH(1)' EQ 'HELD').TALLC2                     @L8A 12810000
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                 @L8A 12820000
.*                                                                      12830000
.*  BRANCH OPERAND VALID                                                12840000
.*                                                                      12850000
.TALLC2  ANOP                                                      @L8A 12860000
         AIF   ('&WORKREG' EQ '').NOWKREG                          @L8A 12870000
.*                                                                      12880000
.*  WORKREG WAS SPECIFIED                                               12890000
.*                                                                      12900000
         AIF   (N'&WORKREG NE 1).TINVWK                            @L8A 12910000
         AIF   ('&WORKREG'(1,1) NE '(').NOTAREG                    @L8A 12920000
         AGO   .NN5                                                @L8A 12930000
.*                                                                      12940000
.*  BRANCH WAS NOT SPECIFIED                                            12950000
.*                                                                      12960000
.CKWREG5 ANOP                                                      @L8A 12970000
         AIF   (T'&WORKREG NE 'O').WARNWK5                         @L8A 12980000
.NN5     ANOP                                                      @L8A 12990000
         AIF   ('&NAME' EQ '').TALLCNA                             @L8A 13000000
&NAME    DC    0H'0'                                               @L8A 13010000
.TALLCNA ANOP                                                      @L8A 13020000
         AIF   (T'&BRANCH EQ 'O').SKPLD6                           @L8A 13030000
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 13040000
.*                                                                      13050000
.SKPLD6  ANOP                                                      @L8A 13060000
         L     15,PSACLHS-PSA(0,0)  LOAD CLHS FOR TESTING          @L8A 13070000
         LTR   15,15                ARE ANY LOCKS HELD?            @L8A 13080000
         AIF   (T'&BRANCH EQ 'O').TALLRC                                13090000
.*                                                                      13100000
         LR    15,&WORKREG(1)       RESTORE GPR15 VALUE            @L8A 13110000
         AIF   ('&BRANCH(1)' EQ 'HELD').TALLBH                          13120000
         &B.Z  &BRANCH(2)           BRANCH ON NOTHELD              @P6C 13130000
         MEXIT                                                          13140000
.*                                                                      13150000
.TALLBH  ANOP                                                           13160000
         &B.NZ &BRANCH(2)           BRANCH ON HELD                 @P6C 13170000
         MEXIT                                                          13180000
.*                                                                      13190000
.TALLRC  ANOP                                                           13200000
         &B.Z  *+12                 BRANCH ON NOTHELD              @P6C 13210000
         LA    15,0(0,0)            SET LOCKS HELD R.C.                 13220000
         &B.   &LABEL.D                                            @P6C 13230000
         LA    15,4(0,0)            SET LOCKS NOT HELD R.C.             13240000
&LABEL.D DC    0H'0'                                                    13250000
         MEXIT                                                          13260000
.*                                                                      13270000
.*************************************************************          13280000
.*   BEGINNING OF TEST,TYPE=SPIN PROCESSING                  *          13290000
.*************************************************************          13300000
.*                                                                      13310000
.SPIN01  ANOP                                                           13320000
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 13330000
         AIF   (T'&ADDR NE 'O').ERRAD                          @G860PXA 13340000
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G860PXA 13350000
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G860PXA 13360000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 13370000
         AIF   (T'&LOCK NE 'O').TERR009                            @L8A 13380000
         AIF   (T'&BRANCH EQ 'O').CKWREG                           @L8A 13390000
.*                                                                      13400000
.*  BRANCH WAS SPECIFIED                                                13410000
.*                                                                      13420000
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 13430000
         AIF   ('&BRANCH(1)' EQ 'HELD').SPIN02                     @L8A 13440000
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                      13450000
.*                                                                      13460000
.*  BRANCH OPERAND VALID                                                13470000
.*                                                                      13480000
.SPIN02  ANOP                                                           13490000
         AIF   ('&WORKREG' EQ '').NOWKREG                          @L8A 13500000
.*                                                                      13510000
.*  WORKREG WAS SPECIFIED                                               13520000
.*                                                                      13530000
         AIF   (N'&WORKREG NE 1).TINVWK                            @L8A 13540000
         AIF   ('&WORKREG'(1,1) NE '(').NOTAREG                    @L8A 13550000
         AIF   ('&NAME' EQ '').NN3                                 @L8A 13560000
&NAME    DC    0H'0'                                               @L8A 13570000
.NN3     ANOP                                                      @L8A 13580000
         AGO   .SPNCODE                    GENERATE CODE WITH      @L8A 13590000
.*                                         WORKREG                      13600000
.*  BRANCH WAS NOT SPECIFIED                                            13610000
.*                                                                      13620000
.CKWREG  ANOP                                                      @L8A 13630000
         AIF   (T'&WORKREG NE 'O').WARNWK2 WORKREG IGNORED WITHOUT @L8A 13640000
.WRNWKR2 ANOP                                                      @L8A 13650000
         AIF   ('&NAME' EQ '').NN4                                 @L8A 13660000
&NAME    DC    0H'0'                                               @L8A 13670000
.NN4     ANOP                                                      @L8A 13680000
         AGO   .SPNCOD2                    GENERATE CODE WITHOUT   @L8A 13690000
.*                                         WORKREG                      13700000
.SPNCODE ANOP                              WORKREG SPECIFIED       @L8A 13710000
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 13720000
.*                                                                      13730000
.SPNCOD2 ANOP                       WORKREG NOT SPECIFIED          @L8A 13740000
         IAC   15                   SET CONDITION CODE BASED ON    @L8A 13750000
*                                   ASC MODE TO BE USED BY THE IPM      13760000
*                                   INSTRUCTION WHICH FOLLOWS.          13770000
         SAC   0                    SAC TO PRIMARY FOR THE BAKR    @L8A 13780000
         &LA   15,&GNAME3           RETURN ADDRESS FOR THE PR      @LJC 13790000
         BSM   15,0                 SET AMODE BIT FOR RETURN ADDR  @L8A 13800000
         BAKR  15,0                 SAVE STATUS ON THE LINKAGE     @L8A 13810000
*                                   STACK AND SET UP RETURN ADDRESS FOR 13820000
*                                   THE PR                              13830000
         IPM   0                    PUT IAC CC BITS INTO REG 0     @L8A 13840000
         SRL   0,20                 SHIFT IAC CC TO BITS 22-23     @L8A 13850000
         L     15,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 13860000
         L     15,1528(15,0)        LOCK MANAGER ENTRY POINT       @L8A 13870000
*                                   ADDRESS                             13880000
         BASSM 14,15                BRANCH TO SERVICE RTN.         @L8A 13890000
         EREG  0,1                  RESTORE REGISTERS 0,1          @L8A 13900000
         PR                         RESTORE STATUS                 @L8A 13910000
&GNAME3  EQU   *                                                   @L8A 13920000
*                                                                       13930000
*    THE ASC-MODE OF THE CALLER HAS BEEN RESTORED TO GENERAL REGISTER   13940000
*    15 BY THE SERVICE ROUTINE FOR USE IN THE SAC INSTRUCTION.          13950000
*                                                                       13960000
         SAC   0(15)                RESTORE ORIGINAL ASC-MODE      @L8A 13970000
         ICM   15,B'1110',PSAFZERO-PSA(0)  CLEAN RETURN CODE FROM  @L8A 13980000
*                                          LOCK MANAGER                 13990000
*                                                                  @L8A 14000000
         AIF   (T'&BRANCH EQ 'O').STOP                             @L8A 14010000
*                                                                       14020000
*    INSTRUCTIONS THAT CHANGE THE CONDITION CODE MAY NOT BE INSERTED    14030000
*    BETWEEN THE LTR AND THE RESULTING BRANCH WHICH IS GENERATED.       14040000
*                                                                       14050000
         LTR   15,15                                               @L8A 14060000
         LR    15,&WORKREG(1)       RESTORE GPR15                  @L8A 14070000
         AIF   ('&BRANCH(1)' EQ 'NOTHELD').SPIN03                  @L8A 14080000
         &B.Z  &BRANCH(2)           BRANCH AT LEAST ONE SPIN LOCK  @P6C 14090000
*                                   WAS HELD   (R.C. IS 0)              14100000
         MEXIT                                                     @L8A 14110000
.SPIN03  ANOP                                                      @L8A 14120000
         &B.NZ &BRANCH(2)           BRANCH NO SPIN LOCKS WERE      @P6C 14130000
*                                   HELD       (R.C. IS 4)              14140000
.STOP    ANOP                                                      @L8A 14150000
         MEXIT                                                          14160000
.*                                                                      14170000
.********************************************************************** 14180000
.* BEGINNING OF TEST,TYPE=USER-SPECIFIED LOCK & TYPE=(REG) PROCESSING * 14190000
.********************************************************************** 14200000
.*                                                                      14210000
.TSTADR  ANOP                                                           14220000
         AIF   (T'&LOCK NE 'O').TERR009                            @P2C 14230000
         AIF   (T'&ADDR EQ 'O').TSTTYPE                            @L8A 14240000
         AIF   ('&ADDR'(1,1) NE '(').TSTBADR                            14250000
         AIF   ('&ADDR'(K'&ADDR,1) NE ')').TSTBADR                 @L8C 14260000
.*                                                                      14270000
.TSTTYPE ANOP                                                  @G860PXA 14280000
&PSAPTR  SETA  0              CLHT SELECTED                        @L8A 14290000
&BYTE    SETA  0              CLHS BYTE 0 SELECTED             @G860PXA 14300000
&OFSET   SETA  96             CLHT ENTRY FOR CPU LOCK          @G860PXA 14310000
&MASK    SETA  128            CLHS POSITION FOR CPU LOCK       @G860PXA 14320000
         AIF   ('&TYPE' EQ 'CPU').TALOC                            @L8C 14330000
.*                                                             @G860PXA 14340000
&OFSET   SETA  80             CLHT ENTRY FOR RSM LOCK          @G860PXA 14350000
&MASK    SETA  8              CLHS POSITION FOR RSM LOCK       @G860PXA 14360000
         AIF   ('&TYPE' EQ 'RSM').TNMSYS1                          @L8C 14370000
.*                                                             @G860PXA 14380000
&OFSET   SETA  84             CLHT ENTRY FOR TRACE LOCK        @G860PXA 14390000
&MASK    SETA  4              CLHS POSITION FOR TRACE LOCK     @G860PXA 14400000
         AIF   ('&TYPE' EQ 'TRACE').TNMSYS1                        @L8C 14410000
.*                                                                 @D1A 14420000
&OFSET   SETA  88             CLHT ENTRY FOR IOS LOCK              @D1A 14430000
&MASK    SETA  2              CLHS POSITION FOR IOS LOCK           @D1A 14440000
         AIF   ('&TYPE' EQ 'IOS').TNMSYS1                          @L8C 14450000
.*                                                             @G860PXA 14460000
&BYTE    SETA  1              CLHS BYTE 1 SELECTED             @G860PXA 14470000
&OFSET   SETA  72             CLHT ENTRY FOR RSMCM LOCK        @G860PXJ 14480000
&MASK    SETA  16             CLHS POSITION FOR RSMCM LOCK     @G860PXJ 14490000
         AIF   ('&TYPE' EQ 'RSMCM').TNAMC1                         @L8C 14500000
.*                                                             @G860PXA 14510000
&OFSET   SETA  44             CLHT ENTRY FOR RSMGL LOCK        @ZMC0568 14520000
&MASK    SETA  8              CLHS POSITION FOR RSMGL LOCK     @G860PXJ 14530000
         AIF   ('&TYPE' EQ 'RSMGL').TNAMC1                         @L8C 14540000
.*                                                             @G860PXA 14550000
&OFSET   SETA  48             CLHT ENTRY FOR VSMFIX LOCK       @G860PXA 14560000
&MASK    SETA  4              CLHS POSITION FOR VSMFIX LOCK    @G860PXA 14570000
         AIF   ('&TYPE' EQ 'VSMFIX').TNMSYS1                       @L8C 14580000
.*                                                             @G860PXA 14590000
&OFSET   SETA  52             CLHT ENTRY FOR ASMGL LOCK        @G860PXA 14600000
&MASK    SETA  2              CLHS POSITION FOR ASMGL LOCK     @G860PXA 14610000
         AIF   ('&TYPE' EQ 'ASMGL').TNAMC1                         @L8C 14620000
.*                                                             @G860PXA 14630000
&OFSET   SETA  56             CLHT ENTRY FOR RSMST LOCK        @G860PXA 14640000
&MASK    SETA  1              CLHS POSITION FOR RSMST LOCK     @G860PXA 14650000
         AIF   ('&TYPE' EQ 'RSMST').TNAMC1                         @L8C 14660000
.*                                                             @G860PXA 14670000
&BYTE    SETA  2              CLHS BYTE 2 SELECTED             @G860PXA 14680000
&OFSET   SETA  60             CLHT ENTRY FOR RSMXM LOCK        @G860PXA 14690000
&MASK    SETA  128            CLHS POSITION FOR RSMXM LOCK     @G860PXA 14700000
         AIF   ('&TYPE' EQ 'RSMXM').TNAMC1                         @L8C 14710000
.*                                                             @G860PXA 14720000
&OFSET   SETA  64             CLHT ENTRY FOR RSMAD LOCK        @G860PXA 14730000
&MASK    SETA  64             CLHS POSITION FOR RSMAD LOCK     @G860PXA 14740000
         AIF   ('&TYPE' EQ 'RSMAD').TNAMC1                         @L8C 14750000
.*                                                             @G860PXA 14760000
&OFSET   SETA  68             CLHT ENTRY FOR VSMPAG LOCK       @G860PXA 14770000
&MASK    SETA  32             CLHS POSITION FOR VSMPAG LOCK    @G860PXA 14780000
         AIF   ('&TYPE' EQ 'VSMPAG').TNMSYS1                       @L8C 14790000
.*                                                             @G860PXA 14800000
&OFSET   SETA  0              CLHT ENTRY FOR DISP LOCK         @G860PXA 14810000
&MASK    SETA  16             CLHS POSITION FOR DISP LOCK      @G860PXA 14820000
         AIF   ('&TYPE' EQ 'DISP').TNMSYS1                         @L8C 14830000
.*                                                                      14840000
&OFSET   SETA  4              CLHT ENTRY FOR ASM LOCK                   14850000
&MASK    SETA  8              CLHS POSITION FOR ASM LOCK                14860000
         AIF   ('&TYPE' EQ 'ASM').TNAMC1                           @L8C 14870000
.*                                                                      14880000
&OFSET   SETA  8              CLHT ENTRY FOR SALLOC LOCK                14890000
&MASK    SETA  4              CLHS POSITION FOR SALLOC LOCK             14900000
         AIF   ('&TYPE' EQ 'SALLOC').TNMSYS1                       @L8C 14910000
.*                                                                      14920000
&OFSET   SETA  12             CLHT ENTRY FOR IOSYNCH LOCK               14930000
&MASK    SETA  2              CLHS POSITION FOR IOSYNCH LOCK            14940000
         AIF   ('&TYPE' EQ 'IOSYNCH').TNAMC1                       @L8C 14950000
.*                                                                      14960000
&OFSET   SETA  16             CLHT ENTRY FOR RSMDS LOCK                 14970000
&MASK    SETA  1              CLHS POSITION FOR RSMDS LOCK              14980000
         AIF   ('&TYPE' EQ 'IOSCAT').INVTYP                    @G860PXB 14990000
         AIF   ('&TYPE' EQ 'RSMDS').TNAMC1                         @L8C 15000000
.*                                                                      15010000
&BYTE    SETA  3              CLHS BYTE 3 SELECTED                      15020000
&OFSET   SETA  20             CLHT ENTRY FOR IOSUCB LOCK                15030000
&MASK    SETA  128            CLHS POSITION FOR IOSUCB LOCK             15040000
         AIF   ('&TYPE' EQ 'IOSUCB').TNAMC1                             15050000
.*                                                                      15060000
&OFSET   SETA  24             CLHT ENTRY FOR RSMQ LOCK             @LKA 15070000
&MASK    SETA  64             CLHS POSITION FOR RSMQ LOCK          @LKA 15080000
         AIF   ('&TYPE' EQ 'RSMQ').TNAMC1                          @LKA 15090000
.*                                                                      15100000
&OFSET   SETA  36             CLHT ENTRY FOR TPACBDEB LOCK              15110000
&MASK    SETA  8              CLHS POSITION FOR TPACBDEB LOCK           15120000
         AIF   ('&TYPE' EQ 'IOSLCH').INVTYP                    @G860PXB 15121000
         AIF   ('&TYPE' EQ 'TPNCB').INVTYP                         @L8C 15122000
         AIF   ('&TYPE' EQ 'TPDNCB').INVTYP                        @L8C 15123000
         AIF   ('&TYPE' EQ 'TPACBDEB').TNAMC1                      @L8C 15124000
.*                                                                      15125000
&OFSET   SETA  40             CLHT ENTRY FOR SRM LOCK                   15126000
&MASK    SETA  4              CLHS POSITION FOR SRM LOCK                15127000
         AIF   ('&TYPE' EQ 'SRM').TNMSYS1                          @L8C 15128000
.*                                                                      15129000
&OFSET   SETA  104            CLHT ENTRY FOR CMS LOCK                   15130000
&MASK    SETA  2              CLHS POSITION FOR CMS LOCK                15140000
         AIF   ('&TYPE' EQ 'CMS').TNMSYS1                          @L8C 15150000
.*                                                                      15160000
&OFSET   SETA  108            CLHT ENTRY FOR LOCAL LOCK                 15170000
&MASK    SETA  1              CLHS POSITION FOR LOCAL LOCK              15180000
         AIF   ('&TYPE' EQ 'LOCAL').TLOCAL                         @L8C 15190000
         AIF   ('&TYPE' EQ 'CML').TCMLCK                           @L8C 15200000
         AIF   ('&TYPE' EQ 'ALOCAL').TALOC                         @L8C 15210000
         AIF   ('&TYPE'(1,1) EQ '(').CKRTP                         @L8C 15220000
         AGO   .NEWLKS        TYPE IS NOT (REG)                    @L8A 15230000
.CKRTP   ANOP                                                      @L8A 15240000
         AIF   ('&TYPE'(K'&TYPE,1) EQ ')').TREGC                   @L8C 15250000
         AGO   .INVTYP                                             @L8A 15260000
.*                                                                      15270000
.NEWLKS  ANOP                                                      @L8A 15280000
&PSAPTR  SETA  1              ECLHT SELECTED                       @L8A 15290000
&BYTE    SETA  0              CLHSE BYTE 0 SELECTED                @L8A 15300000
&OFSET   SETA  0              ECLHT ENTRY FOR BMFLSD LOCK          @L7A 15310000
&MASK    SETA  128            CLHSE POSITION FOR BMFLSD LOCK       @L7A 15320000
         AIF   ('&TYPE' EQ 'BMFLSD').TNAMC2                        @L7A 15330000
.*                                                                 @L7A 15340000
&OFSET   SETA  4              ECLHT ENTRY FOR XCFDS LOCK           @L5A 15350000
&MASK    SETA  64             CLHSE POSITION FOR XCFDS LOCK        @L5A 15360000
         AIF   ('&TYPE' EQ 'XCFDS').TNAMC2                         @L5A 15370000
.*                                                                 @L5A 15380000
&OFSET   SETA  8              ECLHT ENTRY FOR XCFRES LOCK          @L5A 15390000
&MASK    SETA  32             CLHSE POSITION FOR XCFRES LOCK       @L5A 15400000
         AIF   ('&TYPE' EQ 'XCFRES').TNAMC2                        @L5A 15410000
.*                                                                 @L5A 15420000
&OFSET   SETA  12             ECLHT ENTRY FOR XCFQ LOCK            @L5A 15430000
&MASK    SETA  16             CLHSE POSITION FOR XCFQ LOCK         @L5A 15440000
         AIF   ('&TYPE' EQ 'XCFQ').TNMSYS2                         @L5A 15450000
.*                                                                 @L5A 15460000
&OFSET   SETA  16             ECLHT ENTRY FOR ETRSET LOCK          @L6A 15470000
&MASK    SETA  8              CLHSE POSITION FOR ETRSET LOCK       @L6A 15480000
         AIF   ('&TYPE' EQ 'ETRSET').TNMSYS2                       @L6A 15490000
.*                                                                      15500000
&OFSET   SETA  20             ECLHT ENTRY FOR IXLSCH LOCK          @LBC 15510000
&MASK    SETA  4              CLHSE POSITION FOR IXLSCH LOCK       @LBC 15520000
         AIF   ('&TYPE' EQ 'IXLSCH').TNAMC2                        @LBC 15530000
.*                                                                      15540000
&OFSET   SETA  24             ECLHT ENTRY FOR IXLSHR LOCK          @LBC 15550000
&MASK    SETA  2              CLHSE POSITION FOR IXLSHR LOCK       @LBC 15560000
         AIF   ('&TYPE' EQ 'IXLSHR').TNMSYS2                       @LBC 15570000
.*                                                                      15580000
&OFSET   SETA  28             ECLHT ENTRY FOR IXLDS LOCK           @LAA 15590000
&MASK    SETA  1              CLHSE POSITION FOR IXLDS LOCK        @LAA 15600000
         AIF   ('&TYPE' EQ 'IXLDS').TNAMC2                         @LAA 15610000
.*                                                                      15620000
&BYTE    SETA  1              CLHSE BYTE 1 SELECTED                @L9A 15630000
&OFSET   SETA  32             ECLHT ENTRY FOR IXLSHELL LOCK        @LBC 15640000
&MASK    SETA  128            CLHSE POSITION FOR IXLSHELL LOCK     @LBC 15650000
         AIF   ('&TYPE' EQ 'IXLSHELL').TNAMC2                      @LBC 15660000
.*                                                                      15670000
&OFSET   SETA  36             ECLHT ENTRY FOR IOSULUT LOCK         @L9A 15680000
&MASK    SETA  64             CLHSE POSITION FOR IOSULUT LOCK      @L9A 15690000
         AIF   ('&TYPE' EQ 'IOSULUT').TNMSYS2                      @L9A 15700000
.*                                                                      15710000
&OFSET   SETA  40             ECLHT ENTRY FOR IXLREQST LOCK        @01A 15720000
&MASK    SETA  32             CLHSE POSITION FOR IXLREQST LOCK     @01A 15730000
         AIF   ('&TYPE' EQ 'IXLREQST').TNAMC2                      @01A 15740000
.*                                                                      15750000
&OFSET   SETA  44             ECLHT ENTRY FOR WLMRES LOCK          @LCA 15760000
&MASK    SETA  16             CLHSE POSITION FOR WLMRES LOCK       @LCA 15770000
         AIF   ('&TYPE' EQ 'WLMRES').TNAMC2                        @LCA 15780000
.*                                                                      15790000
&OFSET   SETA  48             ECLHT ENTRY FOR WLMQ LOCKS           @LCA 15800000
&MASK    SETA  8              CLHSE POSITION FOR WLMQ LOCKS        @LCA 15810000
         AIF   ('&TYPE' EQ 'WLMQ').TNMSYS2                         @LCA 15820000
.*                                                                      15830000
&OFSET   SETA  52             ECLHT ENTRY FOR CONTEXT LOCKS        @LCA 15840000
&MASK    SETA  4              CLHSE POSITION FOR CONTEXT LOCK      @LCA 15850000
         AIF   ('&TYPE' EQ 'CONTEXT').TNAMC2                       @LCA 15860000
.*                                                                      15870000
&OFSET   SETA  56             ECLHT ENTRY FOR REGSRV LOCKS         @LCA 15880000
&MASK    SETA  2              CLHSE POSITION FOR REGSRV LOCKS      @LCA 15890000
         AIF   ('&TYPE' EQ 'REGSRV').TNMSYS2                       @LCA 15900000
.*                                                                      15910000
&OFSET   SETA  60             ECLHT ENTRY FOR SSD LOCKS            @LDA 15920000
&MASK    SETA  1              CLHSE POSITION FOR SSD LOCK          @LDA 15930000
         AIF   ('&TYPE' EQ 'SSD').TNAMC2                           @LDA 15940000
.*                                                                      15950000
&BYTE    SETA  2              CLHSE BYTE 2 SELECTED                @LFA 15960000
&OFSET   SETA  64             ECLHT ENTRY FOR GRSINT LOCKS         @LFA 15970000
&MASK    SETA  128            CLHSE POSITION FOR GRSINT LOCKS      @LFA 15980000
         AIF   ('&TYPE' EQ 'GRSINT').TNMSYS2                       @LFA 15990000
.*                                                                      16000000
&BYTE    SETA  2              CLHSE byte 2 selected                @LGP 16010000
&OFSET   SETA  68             ECLHT entry for MISC locks           @LJC 16020000
&MASK    SETA  64             CLHSE position for MISC locks        @LJC 16030000
         AIF   ('&TYPE' EQ 'MISC').TNAMC2                          @LJC 16040000
&OFSET   SETA  72             ECLHT entry for DONOTUS2 locks       @LJC 16050000
&MASK    SETA  32             CLHSE position for DONOTUS2 locks    @LJC 16060000
         AIF   ('&TYPE' EQ 'DONOTUS2').TNAMC2                      @LJC 16070000
&OFSET   SETA  76             ECLHT entry for DONOTUS3 locks       @LJC 16080000
&MASK    SETA  16             CLHSE position for DONOTUS3 locks    @LJC 16090000
         AIF   ('&TYPE' EQ 'DONOTUS3').TNAMC2                      @LJC 16100000
&OFSET   SETA  80             ECLHT entry for DONOTUS4 locks       @LJC 16110000
&MASK    SETA  8              CLHSE position for DONOTUS4 locks    @LJC 16120000
         AIF   ('&TYPE' EQ 'DONOTUS4').TNAMC2                      @LJC 16130000
&OFSET   SETA  84             ECLHT entry for DONOTUS5 locks       @LJC 16140000
&MASK    SETA  4              CLHSE position for DONOTUS5 locks    @LJC 16150000
         AIF   ('&TYPE' EQ 'DONOTUS5').TNAMC2                      @LJC 16160000
&OFSET   SETA  88             ECLHT entry for HCWDRLK2 locks       @LGA 16170000
&MASK    SETA  2              CLHSE position for HCWDRLK2 locks    @LGA 16180000
         AIF   ('&TYPE' EQ 'HCWDRLK2').TNAMC2                      @LGA 16190000
&OFSET   SETA  92             ECLHT entry for HCWDRLK1 locks       @LGA 16200000
&MASK    SETA  1              CLHSE position for HCWDRLK1 locks    @LGA 16210000
         AIF   ('&TYPE' EQ 'HCWDRLK1').TNAMC2                      @LGA 16220000
.*                                                                      16230000
&BYTE    SETA  3              CLHSE BYTE 3 SELECTED                @LHA 16240000
&OFSET   SETA  96             ECLHT ENTRY FOR SRMENQ LOCKS         @LHA 16250000
&MASK    SETA  128            CLHSE POSITION FOR SRMENQ LOCKS      @LHA 16260000
         AIF   ('&TYPE' EQ 'SRMENQ').TNMSYS2                       @LHA 16270000
.*                                                                      16280000
&OFSET   SETA  100            ECLHT ENTRY FOR SSDGROUP LOCKS       @LJA 16290000
&MASK    SETA  64             CLHSE POSITION FOR SSDGROUP LOCKS    @LJA 16300000
         AIF   ('&TYPE' EQ 'SSDGROUP').TNAMC2                      @LJA 16310000
.*                                                                      16320000
         AGO   .INVTYP                                                  16330000
.********************************************************************** 16340000
.*                                                                      16350000
.********************************************************************** 16360000
.***********  THIS SECTION IS FOR PRE-4.1.0 LOCK PROCESSING  ********** 16370000
.********************************************************************** 16380000
.*                                                                      16390000
.TNMSYS1 ANOP                                                           16400000
         AIF   (T'&ADDR NE 'O').ERRAD                          @G860PXA 16410000
         AIF   (NOT('&TYPE' EQ 'TRACE' OR '&TYPE' EQ 'RSM' OR '&TYPE'  +16420000
               EQ 'IOS')).TNAMC1                                   @D1C 16430000
.*                                                                      16440000
.*  CHECK PRE-4.1.0 SHR/EXCL LOCKS                                      16450000
.*                                                                      16460000
         AIF   (T'&SCOPE EQ 'O').TNAMC1A                       @G860PXA 16470000
.*                                                                      16480000
.*  SCOPE WAS SPECIFIED                                                 16490000
.*                                                                      16500000
         AIF   ('&SCOPE' NE 'SHR' AND '&SCOPE' NE 'EXCL').INVSCOP       16510000
         AGO   .TNAMC1A                                        @G860PXA 16520000
.*                                                                      16530000
.TNAMC1  ANOP                                                           16540000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 16550000
.TNAMC1A ANOP                                                           16560000
         AIF   (T'&REGS NE 'O').NOREGS                             @L8C 16570000
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G860PXA 16580000
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G860PXA 16590000
         AIF   (T'&BRANCH EQ 'O').TSTW                             @L8A 16600000
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 16610000
         AIF   ('&BRANCH(1)' EQ 'HELD').NAMCK                      @L8A 16620000
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                 @L8A 16630000
         AGO   .NAMCK                                              @L8A 16640000
.TSTW    ANOP                                                      @L8A 16650000
         AIF   (T'&WORKREG NE 'O').WARNWKA                         @L8A 16660000
.NAMCK   ANOP                                                      @L8A 16670000
         AIF   ('&NAME' EQ '').TNAMNN                                   16680000
&NAME    DC    0H'0'                                                    16690000
.TNAMNN  ANOP                                                           16700000
         AIF   (T'&BRANCH NE 'O').TNAMNB                                16710000
         SR    15,15                PRESET LOCK HELD RETURN CODE        16720000
.TNAMNB  ANOP                                                           16730000
         AIF   (T'&ADDR EQ 'O').TSCOPE3                        @G860PXA 16740000
.*                                                                      16750000
.*  MUST BE A CLASS LOCK WITH ADDR KEYWORD SPECIFIED                    16760000
.*                                                                      16770000
         C     &ADDR(1),PSACLHT-PSA+&OFSET.(0,0)  CHECK LKWD ADDR       16780000
*                                                 IN CLHT      @ZA35343 16790000
         AIF   (T'&BRANCH EQ 'O').TNAMARC                               16800000
         AIF   ('&BRANCH(1)' EQ 'HELD').TNAMABH                         16810000
         &B.NE &BRANCH(2)           BRANCH ON NOTHELD              @P6C 16820000
         MEXIT                                                          16830000
.TNAMABH ANOP                                                           16840000
         &B.E  &BRANCH(2)           BRANCH ON HELD                 @P6C 16850000
         MEXIT                                                          16860000
.TNAMARC ANOP                                                           16870000
         &B.E  *+8                                                 @P6C 16880000
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN CODE       16890000
         MEXIT                                                          16900000
.*                                                                      16910000
.TSCOPE3 ANOP                                                           16920000
         AIF   (T'&SCOPE EQ 'O').TNAMTM                        @G860PXA 16930000
         AIF   ('&SCOPE' EQ 'EXCL').TEXCL1                     @G860PXA 16940000
.*                                                                      16950000
.************ PROCESS SCOPE=SHR REQUEST ********************** @G860PXA 16960000
.*                                                                      16970000
         TM    PSACLHT-PSA+&OFSET.(0),X'80' IS LOCK HELD SHR?  @G860PXA 16980000
         AIF   (T'&BRANCH EQ 'O').GOTOG                        @G860PXA 16990000
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOPE5                @G860PXA 17000000
.GOTOG   ANOP                                                  @G860PXA 17010000
         &B.O  &LABEL.G             BRANCH IF NOT HELD WITH        @P6C 17020000
*                                   REQUESTED SCOPE                     17030000
.*****************************************************************      17040000
.*  IF THE HIGH ORDER BIT OF THE LOCKWORD IN THE CLHT IS OFF,    *      17050000
.*  THE LOCK MAY OR MAY NOT BE HELD AS SHARED.  THE CORRECT BIT  *      17060000
.*  IN PSACLHS MUST BE INTERROGATED TO BE SURE.                  *      17070000
.*****************************************************************      17080000
         AGO   .TNAMTM1                                            @L8C 17090000
.TSCOPE5 ANOP                                                  @G860PXA 17100000
         &B.O  &BRANCH(2)           BRANCH ON NOT HELD             @P6C 17110000
.*                                                                      17120000
.TNAMTM1 ANOP                                                           17130000
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  TEST BIT IN        @G860PXA 17140000
*                                           CURRENT LOCK HELD STRING    17141000
         AIF   (T'&BRANCH EQ 'O').TNAMRC1                          @L8C 17142000
         AIF   ('&BRANCH(1)' EQ 'HELD').TNAMBH1                    @L8C 17143000
         &B.Z  &BRANCH(2)           BRANCH ON NOT HELD             @P6C 17144000
         MEXIT                                                     @L8A 17145000
.*                                                                      17146000
.TNAMBH1 ANOP                                                      @L8C 17147000
         &B.O  &BRANCH(2)           BRANCH ON HELD                 @P6C 17148000
&LABEL.G DC    0H'0'                BRANCH LABEL               @G860PXA 17149000
         MEXIT                                                          17150000
.TNAMRC1 ANOP                                                           17151000
         &B.O  *+8                  BRANCH HELD                    @P6C 17152000
&LABEL.G DC    0H'0'                BRANCH LABEL               @G860PXA 17153000
         LA    15,4(0,0)            SET LOCK NOT HELD R.C.     @G860PXA 17154000
         MEXIT                                                          17155000
.*                                                                      17155100
.************ PROCESS SCOPE=EXCL REQUEST *********************          17155200
.*                                                                      17155300
.TEXCL1  ANOP                                                  @G860PXA 17155400
         TM    PSACLHT-PSA+&OFSET.(0),X'80' IS LOCK HELD EXCL? @G860PXA 17155500
         AIF   (T'&BRANCH EQ 'O').TNAMRC2                      @G860PXA 17155600
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOPE6                @G860PXA 17155700
         &B.O  &BRANCH(2)           BRANCH ON HELD                 @P6C 17155800
         MEXIT                                                          17155900
.*                                                                      17156000
.TSCOPE6 ANOP                                                           17157000
         &B.Z  &BRANCH(2)           BRANCH ON NOTHELD              @P6C 17158000
         MEXIT                                                          17159000
.*                                                                      17160000
.TNAMRC2 ANOP                                                           17170000
         &B.O  *+8                  BRANCH ON HELD                 @P6C 17180000
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN   @G860PXA 17190000
*                                   CODE                                17200000
         MEXIT                                                          17210000
.*                                                                      17220000
.*************************************************************          17230000
.*******       PROCESS GARDEN VARIETY LOCK, OR         *******          17240000
.*******       CMS LOCK, OR                            *******          17250000
.*******       CLASS LOCK WITHOUT ADDR KEYWORD, OR     *******          17260000
.*******       SHR/EXCL LOCK WITHOUT SCOPE KEYWORD     *******          17270000
.*******       TEST REQUESTS                           *******          17280000
.*************************************************************          17290000
.*                                                                      17300000
.TNAMTM  ANOP                                                  @G860PXA 17310000
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  IS LOCK HELD?      @G860PXA 17320000
         AIF   (T'&BRANCH EQ 'O').TNAMRC3                      @G860PXA 17330000
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOPE9                @G860PXA 17340000
         &B.O  &BRANCH(2)           BRANCH ON HELD                 @P6C 17350000
         MEXIT                                                          17360000
.*                                                                      17370000
.TSCOPE9 ANOP                                                           17380000
         &B.Z  &BRANCH(2)           BRANCH ON NOTHELD              @P6C 17390000
         MEXIT                                                          17400000
.*                                                                      17410000
.TNAMRC3 ANOP                                                           17420000
         &B.O  *+8                                                 @P6C 17430000
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN   @G860PXA 17440000
*                                   CODE                                17450000
         MEXIT                                                          17460000
.*                                                                      17470000
.******************  END PRE-4.1.0 LOCK PROCESSING  ******************* 17480000
.*                                                                      17490000
.********************************************************************** 17500000
.***   THIS SECTION IS FOR 4.1.0 AND LATER LOCK PROCESSING  *********** 17510000
.********************************************************************** 17520000
.*                                                                      17530000
.* Checks for SHR/EXCL and global (single) locks                        17540000
.*                                                                      17541000
.TNMSYS2 ANOP                                                           17542000
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 17543000
         AIF   (NOT('&TYPE' EQ 'XCFQ' OR                               +17544000
               '&TYPE' EQ 'WLMQ' OR                                    +17545000
               '&TYPE' EQ 'REGSRV' OR                                  +17546000
               '&TYPE' EQ 'GRSINT' OR                                  +17547000
               '&TYPE' EQ 'SRMENQ' OR                                  +17548000
               '&TYPE' EQ 'IOSULUT' OR                                 +17549000
               '&TYPE' EQ 'IXLSHR')).TNAMC2                        @LHC 17550000
.*                                                                      17560000
.*  CHECK SHR/EXCL LOCKS                                           @L8A 17570000
.*                                                                      17580000
         AIF   (T'&SCOPE EQ 'O').TNAMC2B                           @L8A 17590000
.*                                                                      17600000
.*  SCOPE WAS SPECIFIED                                            @L8A 17610000
.*                                                                      17620000
         AIF   ('&SCOPE' NE 'SHR' AND '&SCOPE' NE 'EXCL').INVSCOP  @L8A 17630000
         AGO   .TNAMC2B                                            @L8A 17640000
.*                                                                      17650000
.* Checks for class locks                                               17660000
.*                                                                      17670000
.TNAMC2  ANOP                                                      @L8A 17680000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 17690000
.TNAMC2B ANOP                                                      @L8A 17700000
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 17710000
         AIF   (T'&ASCB NE 'O').ERRASCB                            @L8A 17720000
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                         @L8A 17730000
         AIF   (T'&BRANCH EQ 'O').CKWREG1                          @L8A 17740000
.*                                                                      17750000
.*  BRANCH WAS SPECIFIED                                                17760000
.*                                                                      17770000
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 17780000
         AIF   ('&BRANCH(1)' EQ 'HELD').TNAM02                     @L8A 17790000
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                      17800000
.*                                                                      17810000
.*  BRANCH OPERAND VALID                                                17820000
.*                                                                      17830000
.TNAM02  ANOP                                                           17840000
         AIF   (T'&WORKREG EQ 'O').NOWKREG                         @L8A 17850000
.*                                                                      17860000
.*  WORKREG WAS SPECIFIED                                               17870000
.*                                                                      17880000
         AIF   (N'&WORKREG NE 1).TINVWK                            @L8A 17890000
         AIF   ('&WORKREG'(1,1) NE '(').NOTAREG                    @L8A 17900000
         AGO   .WRNWKRB                                            @L8A 17910000
.CKWREG1 ANOP                                                      @L8A 17920000
         AIF   (T'&WORKREG NE 'O').WARNWKB                         @L8A 17930000
.WRNWKRB ANOP                                                      @L8A 17940000
         AIF   ('&NAME' EQ '').TNAMNN2                             @L8A 17950000
&NAME    DC    0H'0'                                               @L8A 17960000
.TNAMNN2 ANOP                                                      @L8A 17970000
         AIF   (T'&ADDR EQ 'O').TSCOP32                            @L8A 17980000
.*                                                                      17990000
.*  MUST BE A CLASS LOCK WITH ADDR KEYWORD SPECIFIED                    18000000
.*                                                                      18010000
         AIF   (T'&BRANCH EQ 'O').NOLOAD1                          @L8A 18020000
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 18030000
.NOLOAD1 ANOP                                                      @L8A 18040000
         L     15,PSAECLTP-PSA(0,0) ADDRESS OF ECLHT               @LOC 18050000
         C     &ADDR(1),&OFSET.(15,0) CHECK LKWD ADDR IN ECLHT     @L8A 18060000
         AIF   (T'&BRANCH EQ 'O').TNMARC2                          @L8A 18070000
         LR    15,&WORKREG(1)       RESTORE GPR15 VALUE            @L8A 18080000
         AIF   ('&BRANCH(1)' EQ 'HELD').TNMABH2                    @L8A 18090000
         &B.NE &BRANCH(2)           BRANCH ON NOTHELD              @P6C 18100000
         MEXIT                                                     @L8A 18110000
.TNMABH2 ANOP                                                      @L8A 18120000
         &B.E  &BRANCH(2)           BRANCH ON HELD                 @P6C 18130000
         MEXIT                                                     @L8A 18140000
.TNMARC2 ANOP                                                      @L8A 18150000
         &B.E  *+12                                                @P6C 18160000
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN CODE  @L8A 18170000
         &B.   &LABEL.F                                            @P6C 18180000
         LA    15,0(0,0)            SET LOCK HELD RETURN CODE      @L8A 18190000
&LABEL.F DC    0H'0'                BRANCH LABEL                   @L8A 18200000
         MEXIT                                                     @L8A 18210000
.*                                                                      18220000
.TSCOP32 ANOP                                                      @L8A 18230000
         AIF   (T'&SCOPE EQ 'O').TNAMTMA                           @L8A 18240000
         AIF   ('&SCOPE' EQ 'EXCL').TEXCL2                         @L8A 18250000
.*                                                                      18260000
.************ PROCESS SCOPE=SHR REQUEST **********************          18270000
.*                                                                      18280000
         AIF   (T'&BRANCH EQ 'O').SKPLD                            @L8A 18290000
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 18300000
         AIF   ('&SYSASCE' EQ 'P').SKPLD                           @L8A 18310000
         CPYA  &WORKREG(1),15       SAVE AR15 VALUE                @L8A 18320000
.SKPLD   ANOP                                                      @L8A 18330000
         L     15,PSAECLTP-PSA(0,0) ADDRESS OF ECLHT               @LOC 18340000
         AIF   ('&SYSASCE' EQ 'P').NOART1                          @L8A 18350000
         LAE   15,0(15,0)           GET ALET OF 0                  @L8A 18360000
.NOART1  ANOP                                                      @L8A 18370000
         TM    &OFSET.(15),X'80'    IS LOCK HELD SHR?              @L8A 18380000
         AIF   (T'&BRANCH NE 'O').NORC1                            @L8A 18390000
         LA    15,0(0,0)            PRESET SUCCESSFUL RETURN CODE  @L8A 18400000
         AGO   .GOTOG2                                             @L8A 18410000
.NORC1   ANOP                                                      @L8A 18420000
         LR    15,&WORKREG(1)       RESTORE GPR15 VALUE            @L8A 18430000
         AIF   ('&SYSASCE' EQ 'P').NOART2                          @L8A 18440000
         CPYA  15,&WORKREG(1)       RESTORE AR15 VALUE             @L8A 18450000
.NOART2  ANOP                                                      @L8A 18460000
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOP52                    @L8A 18470000
.GOTOG2  ANOP                                                      @L8A 18480000
         &B.O  &LABEL.L             BRANCH IF NOT HELD WITH        @P6C 18490000
*                                   REQUESTED SCOPE                     18500000
.*****************************************************************      18510000
.*  IF THE HIGH ORDER BIT OF THE LOCKWORD IN THE ECLHT IS OFF,   *      18520000
.*  THE LOCK MAY OR MAY NOT BE HELD AS SHARED.  THE CORRECT BIT  *      18530000
.*  IN PSACLHSE MUST BE INTERROGATED TO BE SURE.                 *      18540000
.*****************************************************************      18550000
         AGO   .TNMTM1B                                            @L8A 18560000
.TSCOP52 ANOP                                                      @L8A 18570000
         &B.O  &BRANCH(2)           BRANCH ON NOT HELD             @P6C 18580000
.*                                                                      18590000
.TNMTM1B ANOP                                                      @L8A 18600000
         TM    PSACLHSE-PSA+&BYTE.(0),&MASK IS LOCK REALLY HELD?   @L8A 18610000
         AIF   (T'&BRANCH EQ 'O').TNMRC12                          @L8A 18620000
         AIF   ('&BRANCH(1)' EQ 'HELD').TNMBH12                    @L8A 18630000
         &B.Z  &BRANCH(2)           BRANCH ON NOT HELD             @P6C 18640000
         MEXIT                                                     @L8A 18650000
.*                                                                      18660000
.TNMBH12 ANOP                                                      @L8A 18670000
         &B.O  &BRANCH(2)           BRANCH ON HELD                 @P6C 18680000
&LABEL.L DC    0H'0'                BRANCH LABEL                   @L8A 18690000
         MEXIT                                                     @L8A 18700000
.TNMRC12 ANOP                                                      @L8A 18710000
         &B.O  *+8                  BRANCH HELD                    @P6C 18720000
&LABEL.L DC    0H'0'                BRANCH LABEL                   @L8A 18730000
         LA    15,4(0,0)            SET LOCK NOT HELD R.C.         @L8A 18740000
         MEXIT                                                     @L8A 18750000
.*                                                                      18760000
.************ PROCESS SCOPE=EXCL REQUEST *********************          18770000
.*                                                                      18780000
.TEXCL2  ANOP                                                      @L8A 18790000
         AIF   (T'&BRANCH EQ 'O').SKPLD1                           @L8A 18800000
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 18810000
         AIF   ('&SYSASCE' EQ 'P').SKPLD1                          @L8A 18820000
         CPYA  &WORKREG(1),15       SAVE AR15 VALUE                @L8A 18830000
.SKPLD1  ANOP                                                      @L8A 18840000
         L     15,PSAECLTP-PSA(0,0) ADDRESS OF ECLHT               @LOC 18850000
         AIF   ('&SYSASCE' EQ 'P').NOART3                          @L8A 18860000
         LAE   15,0(15,0)           GET ALET OF 0                  @L8A 18870000
.NOART3  ANOP                                                      @L8A 18880000
         TM    &OFSET.(15),X'80'    IS LOCK HELD EXCL?             @L8A 18890000
         AIF   (T'&BRANCH NE 'O').NORC2                            @L8A 18900000
         LA    15,0(0,0)            PRESET LOCK HELD R.C.          @L8A 18910000
         AGO   .TNMRC22                                            @L8A 18920000
.NORC2   ANOP                                                      @L8A 18930000
         LR    15,&WORKREG(1)       RESTORE GPR15 VALUE            @L8A 18940000
         AIF   ('&SYSASCE' EQ 'P').NOART4                          @L8A 18950000
         CPYA  15,&WORKREG(1)       RESTORE AR15 VALUE             @L8A 18960000
.NOART4  ANOP                                                      @L8A 18970000
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOP62                    @L8A 18980000
         &B.O  &BRANCH(2)           BRANCH ON HELD                 @P6C 18990000
         MEXIT                                                     @L8A 19000000
.*                                                                      19010000
.TSCOP62 ANOP                                                      @L8A 19020000
         &B.Z  &BRANCH(2)           BRANCH ON NOTHELD              @P6C 19030000
         MEXIT                                                     @L8A 19040000
.*                                                                      19050000
.TNMRC22 ANOP                                                      @L8A 19060000
         &B.O  *+8                  BRANCH ON HELD                 @P6C 19070000
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN CODE  @L8A 19080000
         MEXIT                                                     @L8A 19090000
.*                                                                      19100000
.************ PROCESS GARDEN VARIETY TEST REQUEST ************          19110000
.*                                                                      19120000
.TNAMTMA ANOP                                                      @L8A 19130000
         AIF   (T'&BRANCH NE 'O').NORC3                            @L8A 19140000
         SR    15,15                PRESET LOCK HELD R.C.          @L8A 19150000
.NORC3   ANOP                                                      @L8A 19160000
         TM    PSACLHSE-PSA+&BYTE.(0),&MASK IS LOCK HELD?          @L8A 19170000
         AIF   (T'&BRANCH EQ 'O').TNMRC32                          @L8A 19180000
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOP92                    @L8A 19190000
         &B.O  &BRANCH(2)           BRANCH ON HELD                 @P6C 19200000
         MEXIT                                                     @L8A 19210000
.*                                                                      19220000
.TSCOP92 ANOP                                                      @L8A 19230000
         &B.Z  &BRANCH(2)           BRANCH ON NOTHELD              @P6C 19240000
         MEXIT                                                     @L8A 19250000
.*                                                                      19260000
.TNMRC32 ANOP                                                      @L8A 19270000
         &B.O  *+8                                                 @P6C 19280000
         LA    15,4(0,0)            SET LOCK NOT HELD R.C.         @L8A 19290000
         MEXIT                                                     @L8A 19300000
.*                                                                      19310000
.*************************************************************          19320000
.*   BEGINNING OF TEST,TYPE=LOCAL LOCK PROCESSING            *          19330000
.*************************************************************          19340000
.*                                                                      19350000
.TLOCAL  ANOP                                                           19360000
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 19370000
         AIF   (T'&ASCB NE 'O').ERRASCB                            @L8A 19380000
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                         @L8A 19390000
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 19400000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 19410000
         AIF   ('&NAME' EQ '').NN6                                 @L8A 19420000
&NAME    DC    0H'0'                                               @L8A 19430000
.NN6     ANOP                                                      @L8A 19440000
         AIF   (T'&BRANCH NE 'O').CHECKIT                          @L8C 19450000
.*                                                                      19460000
.*  BRANCH WAS NOT SPECIFIED                                            19470000
.*                                                                      19480000
         AIF   (T'&WORKREG NE 'O').WARNWKE                         @L8A 19490000
.WRNWKRE ANOP                                                      @L8A 19500000
         SR    15,15                PRESET LOCK HELD R.C.          @L8A 19510000
.*                                                                      19520000
.CHECKIT ANOP                                                      @L8A 19530000
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  IS LOCAL/CML HELD?     @L8C 19540000
         AIF   (T'&BRANCH EQ 'O').TLOCRC                       @G387PXR 19550000
         AIF   ('&BRANCH(1)' EQ 'HELD').TLOCBH                 @G387PXR 19560000
         &B.Z  &BRANCH(2)           BRANCH ON NOTHELD              @P6C 19570000
         AGO   .TLOCCL                                         @G387PXR 19580000
.*                                                                      19590000
.TLOCRC  ANOP                                                  @G387PXR 19600000
         &B.Z  &LABEL.A             BRANCH ON NOTHELD              @P6C 19610000
         AGO   .TLOCCL                                         @G387PXR 19620000
.*                                                                      19630000
.TLOCBH  ANOP                                                  @G387PXR 19640000
         &B.Z  &LABEL.B             BRANCH ON NOTHELD              @P6C 19650000
.*                                                                      19660000
.TLOCCL  ANOP                                                  @G387PXR 19670000
         CLC   PSALOCAL-PSA(4,0),PSAFZERO-PSA(0) IS LOCAL LOCK @ZMP0008 19680000
*                                                HELD?                  19690000
         AIF   (T'&BRANCH EQ 'O').TLOCRC1                      @G387PXR 19700000
         AIF   ('&BRANCH(1)' EQ 'HELD').TLOCBH1                @G387PXR 19710000
         &B.NE &BRANCH(2)           BRANCH ON NOTHELD              @P6C 19720000
         MEXIT                                                 @G387PXR 19730000
.*                                                                      19740000
.TLOCRC1 ANOP                                                  @G387PXR 19750000
         &B.E  *+8                  BRANCH ON HELD                 @P6C 19760000
&LABEL.A LA    15,4(0,0)            SET LOCK NOT HELD R.C.     @G387PXR 19770000
         MEXIT                                                 @G387PXR 19780000
.TLOCBH1 ANOP                                                  @G387PXR 19790000
         &B.E  &BRANCH(2)           BRANCH ON HELD                 @P6C 19800000
&LABEL.B DC    0H'0'                                           @G387PXR 19810000
         MEXIT                                                 @G387PXR 19820000
.*                                                                      19830000
.*************************************************************          19840000
.*   BEGINNING OF TEST,TYPE=(REG) PROCESSING                 *          19850000
.*************************************************************          19860000
.*                                                                      19870000
.TREGC   ANOP                                                           19880000
         AIF   (T'&WORKREG NE 'O').INVWKRG                         @L8A 19890000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 19900000
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 19910000
         AIF   (T'&ASCB NE 'O').TREGCA                         @G387PXR 19920000
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G387PXR 19930000
         AIF   (T'&REGS EQ 'O').CKB                                @L8A 19940000
         AIF   ('&REGS'(1,1) NE '(').BADREGS                            19950000
         AIF   ('&REGS'(K'&REGS,1) NE ')').BADREGS                      19960000
.CKB     ANOP                                                      @L8A 19970000
         AIF   (T'&BRANCH EQ 'O').TREGCNB                               19980000
         AIF   (T'&REGS EQ 'O').REGREQ                             @L8C 19990000
         AIF   ('&NAME' EQ '').TREGCNN                                  20000000
&NAME    DC    0H'0'                                                    20010000
.TREGCNN LR    &REGS(1),&TYPE(1)    SAVE INPUT STRING                   20020000
         N     &REGS(1),PSACLHS-PSA(0,0) COMPARE TO LOCKS HELD          20030000
*                                       STRING                 @ZA35343 20040000
         CR    &REGS(1),&TYPE(1)    ARE ALL SPECIFIED LOCKS HELD        20050000
         AIF   ('&BRANCH(1)' EQ 'HELD').TREGCBH                         20060000
         &B.NE &BRANCH(2)           BRANCH NOT ALL HELD            @P6C 20070000
         MEXIT                                                          20080000
.TREGCBH &B.E  &BRANCH(2)           BRANCH ALL HELD                @P6C 20090000
         MEXIT                                                          20100000
.TREGCNB ANOP                                                           20110000
         AIF   ('&NAME' EQ '').TREGRNN                                  20120000
&NAME    DC    0H'0'                                                    20130000
.TREGRNN LR    15,&TYPE(1)          SAVE INPUT STRING                   20140000
&REG1    SETC  '&TYPE(1)'                                      @G387PXR 20150000
         AIF   (T'&REGS EQ 'O').TREGCNR                                 20160000
&REG1    SETC  '&REGS(1)'                                      @G387PXR 20170000
         LR    &REG1,&TYPE(1)       MOVE STRING IN WORK REG    @G387PXR 20180000
.TREGCNR N     &REG1,PSACLHS-PSA(0,0)   COMPARE TO LOCKS HELD  @G387PXR 20190000
*                                       STRING                 @ZA35343 20200000
         XR    15,&REG1             SET RC=0 IF ALL HELD       @G387PXR 20210000
         &B.Z  *+8                  EXIT ALL HELD                  @P6C 20220000
         LA    15,4(0,0)            SET RC NOT ALL HELD                 20230000
         MEXIT                                                          20240000
.*                                                                      20250000
.*************************************************************          20260000
.*   BEGINNING OF TEST,TYPE=CML PROCESSING                   *          20270000
.*************************************************************          20280000
.*                                                                      20290000
.TCMLCK  ANOP                                                  @G387PXR 20300000
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 20310000
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 20320000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 20330000
         AIF   (T'&BRANCH EQ 'O').TSTW2                            @L8A 20340000
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 20350000
         AIF   ('&BRANCH(1)' EQ 'HELD').CMLPROC                    @L8A 20360000
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                 @L8A 20370000
         AGO   .CMLPROC                                            @L8A 20380000
.*                                                                      20390000
.TSTW2   ANOP                                                      @L8A 20400000
         AIF   (T'&WORKREG NE 'O').WARNWKC                         @L8A 20410000
.*                                                                      20420000
.CMLPROC ANOP                                                      @L8A 20430000
         AIF   ('&NAME' EQ '').NONAME                              @L8A 20440000
&NAME    DC    0H'0'                                               @L8A 20450000
.NONAME  ANOP                                                      @L8A 20460000
         AIF   (T'&ASCB NE 'O').TCMLAS                         @G387PXR 20470000
         AIF   (T'&LOCKHLD NE 'O').TCMLREG                     @G387PXR 20480000
         AGO   .LKASREQ                                            @L8C 20490000
.*                                                                      20500000
.TCMLAS  ANOP                                                  @G387PXR 20510000
         AIF   (T'&LOCKHLD EQ 'O').TCMLASC                     @G387PXR 20520000
         AGO   .LKHINV                                             @L8C 20530000
.*                                                                      20540000
.TCMLREG ANOP                                                  @G387PXR 20550000
         AIF   ('&LOCKHLD'(1,1) NE '(').BLKHLD                 @G387PXR 20560000
         AIF   ('&LOCKHLD'(K'&LOCKHLD,1) NE ')').BLKHLD        @G387PXR 20570000
         AIF   (T'&BRANCH NE 'O').TCMLR                        @G387PXR 20580000
         SR    15,15                PRESET LOCK HELD R.C.      @G387PXR 20590000
.TCMLR   ANOP                                                           20600000
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  CHECK LOCK HELD    @G387PXR 20610000
         AIF   (T'&BRANCH EQ 'O').TCMLRC                       @G387PXR 20620000
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLBH                 @G387PXR 20630000
         &B.Z  &BRANCH(2)           BRANCH CML NOT HELD            @P6C 20640000
         AGO   .TCMLRCL                                        @G387PXR 20650000
.TCMLRC  &B.Z  &LABEL.A             BRANCH CML NOT HELD            @P6C 20660000
         AGO   .TCMLRCL                                        @G387PXR 20670000
.TCMLBH  &B.Z  &LABEL.X             BRANCH CML NOT HELD            @P6C 20680000
.*                                                                      20690000
.TCMLRCL ANOP                                                  @G387PXR 20700000
         L     &LOCKHLD(1),PSALOCAL-PSA(0,0) LOAD CLHT CML     @G387PXR 20710000
         LTR   &LOCKHLD(1),&LOCKHLD(1)       CML LOCK HELD?    @G387PXR 20720000
         AIF   (T'&BRANCH EQ 'O').TCMLRC1                      @G387PXR 20730000
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLRBH                @G387PXR 20740000
         &B.Z  &BRANCH(2)           BRANCH CML NOT HELD            @P6C 20750000
         MEXIT                                                 @G387PXR 20760000
.TCMLRC1 ANOP                                                  @G387PXR 20770000
         &B.NZ *+8                  BRANCH - CML HELD              @P6C 20780000
&LABEL.A LA    15,4(0,0)            SET R.C.=4 NOT HELD        @G387PXR 20790000
         MEXIT                                                 @G387PXR 20800000
.TCMLRBH &B.NZ &BRANCH(2)           BRANCH - LOCK HELD             @P6C 20810000
&LABEL.X DC    0H'0'                                           @G387PXR 20820000
         MEXIT                                                 @G387PXR 20830000
.*                                                                      20840000
.TCMLASC ANOP                                                  @G387PXR 20850000
         AIF   ('&ASCB'(1,1) NE '(').TCMLANV                   @G387PXR 20860000
         AIF   ('&ASCB'(K'&ASCB,1) NE ')').TCMLANV             @G387PXR 20870000
         AIF   (T'&BRANCH NE 'O').TCMLASA                      @G387PXR 20880000
         SR    15,15                PRESET LOCK HELD R.C.      @G387PXR 20890000
.TCMLASA ANOP                                                  @G387PXR 20900000
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  CHECK LOCK HELD    @G387PXR 20910000
         AIF   (T'&BRANCH EQ 'O').TCMLARC                      @G387PXR 20920000
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLABH                @G387PXR 20930000
         &B.Z  &BRANCH(2)           BRANCH - LOCK NOT HELD         @P6C 20940000
         AGO   .TCMLACL                                        @G387PXR 20950000
.TCMLARC &B.Z  &LABEL.B             BRANCH - LOCK NOT HELD         @P6C 20960000
         AGO   .TCMLACL                                        @G387PXR 20970000
.TCMLABH &B.Z  &LABEL.C             BRANCH - LOCK NOT HELD         @P6C 20980000
.TCMLACL ANOP                                                  @G387PXR 20990000
         CLC   PSAFZERO-PSA(4,0),PSALOCAL-PSA(0)  CML LOCK     @ZMB0398 21000000
*                                                 HELD?        @ZMB0398 21010000
         &B.NE &LABEL.D             YES CONTINUE CHECKS            @P6C 21020000
         CL    &ASCB(1),PSAAOLD-PSA(0,0)  ASCB SPECIFIED=HOME? @G382PXR 21030000
         AIF   (T'&BRANCH EQ 'O').TCMLAR1                      @G387PXR 21040000
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLAH1                @G387PXR 21050000
         &B.NE &BRANCH(2)           BRANCH LOCK NOT HELD           @P6C 21060000
         &B.   &LABEL.C             BRANCH LOCK HELD               @P6C 21070000
         AGO   .TCMLAC1             CONTINUE CHECKS            @G382PXR 21080000
.TCMLAR1 ANOP                                                  @G382PXR 21090000
         &B.E  &LABEL.C             BRANCH LOCK HELD               @P6C 21100000
         &B.   &LABEL.B             BRANCH - SET R.C.              @P6C 21110000
         AGO   .TCMLAC1                                        @G382PXR 21120000
.TCMLAH1 ANOP                                                  @G382PXR 21130000
         &B.E  &BRANCH(2)           BRANCH  LOCK HELD              @P6C 21140000
         &B.   &LABEL.C             BRANCH  LOCK NOT HELD          @P6C 21150000
.TCMLAC1 ANOP                                                  @G382PXR 21160000
&LABEL.D CL    &ASCB(1),PSALOCAL-PSA(0,0)  CML LOCK HELD?      @G382PXR 21170000
         AIF   (T'&BRANCH EQ 'O').TCMLAR2                      @G382PXR 21180000
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLAH2                @G382PXR 21190000
         &B.NE &BRANCH(2)           BRANCH NOT HELD                @P6C 21200000
         AGO   .TCMLEND             END OF CML CHECKS          @G382PXR 21210000
.TCMLAR2 ANOP                                                  @G382PXR 21220000
         &B.E  &LABEL.C             BRANCH LOCK HELD               @P6C 21230000
         AGO   .TCMLAR3                                        @G382PXR 21240000
.TCMLAH2 ANOP                                                  @G382PXR 21250000
         &B.E  &BRANCH(2)           BRANCH LOCK HELD               @P6C 21260000
         AGO   .TCMLEND                                        @G382PXR 21270000
.TCMLAR3 ANOP                                                  @G382PXR 21280000
&LABEL.B LA    15,4(0,0)            LOCK NOT HELD R.C.         @G382PXR 21290000
.TCMLEND ANOP                                                  @G382PXR 21300000
&LABEL.C DC    0H'0'                BRANCH LABEL               @G382PXR 21310000
         MEXIT                                                 @G387PXR 21320000
.*                                                                      21330000
.************************************************************* @G860PXK 21340000
.* BEGINNING OF TEST PROCESSING; TYPE = ALOCAL OR CPU        * @G860PXK 21350000
.************************************************************* @G860PXK 21360000
.*                                                                      21370000
.TALOC   ANOP                                                  @G860PXK 21380000
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 21390000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 21400000
         AIF   (T'&REGS NE 'O').REGINV4                            @L8A 21410000
.REGRET4 ANOP                                                      @L8A 21420000
         AIF   (T'&ASCB NE 'O').ERRASCB                            @L8A 21430000
         AIF   (T'&BRANCH EQ 'O').TSTCAL                           @L8A 21440000
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 21450000
         AIF   ('&BRANCH(1)' EQ 'HELD').TALOCNN                    @L8A 21460000
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                 @L8A 21470000
         AGO   .TALOCNN                                            @L8A 21480000
.*                                                                      21490000
.TSTCAL  ANOP                                                      @L8A 21500000
         AIF   (T'&WORKREG NE 'O').WARNWKD                         @L8A 21510000
.TALOCNN ANOP                                                  @G387PXR 21520000
         AIF   ('&NAME' EQ '').TALCNN2                         @G387PXR 21530000
&NAME    DC    0H'0'                                           @G387PXR 21540000
.TALCNN2 ANOP                                                  @G387PXR 21550000
         AIF   (T'&LOCKHLD EQ 'O').TALOCBR                     @G387PXR 21560000
         AIF   ('&LOCKHLD'(1,1) NE '(').BLKHLD                 @G387PXR 21570000
         AIF   ('&LOCKHLD'(K'&LOCKHLD,1) NE ')').BLKHLD        @G387PXR 21580000
         AIF   (T'&BRANCH NE 'O').TALOC1                       @G387PXR 21590000
         LA    15,4(0,0)            PRESET NOT HELD R.C.       @G387PXR 21600000
.TALOC1  ANOP                                                  @G387PXR 21610000
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  CHECK LOCK HELD    @G387PXR 21620000
         AIF   (T'&BRANCH EQ 'O').TALOCRC                      @G387PXR 21630000
         AIF   ('&BRANCH(1)' EQ 'HELD').TALOCHD                @G387PXR 21640000
         &B.Z  &BRANCH(2)           BRANCH NOT HELD                @P6C 21650000
         AIF   ('&TYPE' EQ 'CPU').TCPU1                        @G860PXK 21660000
         L     &LOCKHLD(1),PSALOCAL-PSA(0,0)  LOAD ASCB ADDR   @ZM50156 21670000
*                                   OF LOCKED ADDR. SPACE      @G387PXR 21680000
         MEXIT                                                 @G387PXR 21690000
.TCPU1   ANOP                                                  @G860PXK 21700000
         L     &LOCKHLD(1),PSACPUL-PSA(0,0)   LOAD CPU LOCKS   @G860PXK 21710000
*                                   HELD CNT                            21720000
         MEXIT                                                 @G860PXK 21730000
.TALOCHD ANOP                                                  @G387PXR 21740000
         &B.Z  &LABEL.A             BRANCH NOT HELD                @P6C 21750000
         AIF   ('&TYPE' EQ 'CPU').TCPU2                        @G860PXK 21760000
         L     &LOCKHLD(1),PSALOCAL-PSA(0,0)  LOAD ASCB ADDR   @ZM50156 21770000
*                                   OF LOCKED ADDR. SPACE      @G387PXR 21780000
         AGO   .TCPU2A                                         @G860PXK 21790000
.TCPU2   ANOP                                                  @G860PXK 21800000
         L     &LOCKHLD(1),PSACPUL-PSA(0,0)   LOAD CPU LOCKS   @G860PXK 21810000
*                                   HELD CNT                            21820000
.TCPU2A  ANOP                                                  @G860PXK 21830000
         &B.   &BRANCH(2)           BRANCH HELD                    @P6C 21840000
&LABEL.A DC    0H'0'                BRANCH LABEL               @G387PXR 21850000
         MEXIT                                                 @G387PXR 21860000
.TALOCRC ANOP                                                  @G387PXR 21870000
         &B.Z  &LABEL.B             BRANCH NOT HELD                @P6C 21880000
         AIF   ('&TYPE' EQ 'CPU').TCPU3                        @G860PXK 21890000
         L     &LOCKHLD(1),PSALOCAL-PSA(0,0)  LOAD ASCB ADDR   @ZM50156 21900000
*                                   OF LOCKED ADDR. SPACE      @G387PXR 21910000
         AGO   .TCPU3A                                         @G860PXK 21920000
.TCPU3   ANOP                                                  @G860PXK 21930000
         L     &LOCKHLD(1),PSACPUL-PSA(0,0)   LOAD CPU LOCKS   @G860PXK 21940000
*                                   HELD CNT                            21950000
.TCPU3A  ANOP                                                  @G860PXK 21960000
         SLR   15,15                SET LOCK HELD R.C.         @G387PXR 21970000
&LABEL.B DC    0H'0'                BRANCH LABEL               @G387PXR 21980000
         MEXIT                                                 @G387PXR 21990000
.TALOCBR ANOP                                                  @G387PXR 22000000
.*                                                                      22010000
.* NOTE - TEST - NO LOCKHLD PARM SPECIFIED                     @G860PXK 22020000
.*                                                                      22030000
         AIF   (T'&BRANCH NE 'O').TALOC2                       @G387PXR 22040000
         SLR   15,15                PRESET LOCK HELD R.C.      @G387PXR 22050000
.TALOC2  ANOP                                                  @G387PXR 22060000
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  CHECK LOCK HELD    @G387PXR 22070000
         AIF   (T'&BRANCH EQ 'O').TALOCR1                      @G387PXR 22080000
         AIF   ('&BRANCH(1)' EQ 'HELD').TALOCH1                @G387PXR 22090000
         &B.Z  &BRANCH(2)           BRANCH NOT HELD                @P6C 22100000
         MEXIT                                                 @G387PXR 22110000
.TALOCH1 ANOP                                                  @G387PXR 22120000
         &B.NZ &BRANCH(2)           BRANCH HELD                    @P6C 22130000
         MEXIT                                                 @G387PXR 22140000
.TALOCR1 ANOP                                                  @G387PXR 22150000
         &B.NZ &LABEL.C             BRANCH HELD                    @P6C 22160000
         LA    15,4(0,0)            SET LOCK NOT HELD R.C.     @G387PXR 22170000
&LABEL.C DC    0H'0'                BRANCH LABEL               @G387PXR 22180000
         MEXIT                                                 @G387PXR 22190000
.ENDIT   ANOP                                                           22200000
         MEXIT                                                 @G860PXD 22210000
.*                                                                      22220000
.*************************************************************          22230000
.*   MESSAGES ISSUED BY SETLOCK PROCESSING                   *          22240000
.*************************************************************          22250000
.*                                                                      22260000
.ADDREQ  ANOP                                                           22270000
.*       IHB001 ADDR OPERAND REQUIRED, NOT SPECIFIED                    22280000
         IHBERMAC 1006,ADDR                                             22290000
         MEXIT                                                          22300000
.ASCBREQ ANOP                                                  @G387PXR 22310000
.*       IHB001 ASCB OPERAND REQUIRED, NOT SPECIFIED           @G387PXR 22320000
         IHBERMAC 1006,ASCB                                    @G387PXR 22330000
         MEXIT                                                 @G387PXR 22340000
.BADREGS ANOP                                                      @L1A 22350000
.*       IHB002 INVALID REGS OPERAND SPECIFIED - XXX                    22360000
         IHBERMAC 1001,REGS,&REGS                                       22370000
         MEXIT                                                          22380000
.CNOTSUP ANOP                                                           22390000
         MNOTE 8,'*** &TYPE CONDITIONAL OBTAIN NOT SUPPORTED'  @G50EPXS 22400000
         MEXIT                                                 @G50EPXS 22410000
.CONDINC ANOP                                                      @L1A 22420000
.*       IHB280 MODE=(COND,IN) INVALID WITH TYPE=&TYPE             @L1A 22430000
&MESSAGE SETC 'MODE=(COND,IN)'                                     @L1A 22440000
&MESSAG2 SETC 'TYPE='.'&TYPE'                                      @L1A 22450000
         IHBERMAC 1020,&MESSAGE,&MESSAG2                           @L1A 22460000
         MEXIT                                                     @L1A 22470000
.EROALOC ANOP                                                  @G387PXR 22480000
.*       IHB280 ALOCAL INVALID WITH OBTAIN                     @G387PXR 22490000
         IHBERMAC 1020,ALOCAL,OBTAIN                           @G387PXR 22500000
         MEXIT                                                 @G387PXR 22510000
.ERRAD   ANOP                                                           22520000
.*       IHB280 ADDR INVALID WITH TYPE=XXX                              22530000
&MESSAGE SETC 'TYPE='.'&TYPE'                                           22540000
         IHBERMAC 1020,ADDR,&MESSAGE                                    22550000
         MEXIT                                                          22560000
.ERRALOC ANOP                                                  @G387PXR 22570000
.*       IHB280 ALOCAL INVALID WITH RELEASE                    @G387PXR 22580000
         IHBERMAC 1020,ALOCAL,RELEASE                          @G387PXR 22590000
         MEXIT                                                 @G387PXR 22600000
.ERRASCB ANOP                                                  @G387PXR 22610000
.*       IHB280 ASCB INVALID WITH TYPE=XXX                     @G387PXR 22620000
&MESSAGE SETC 'TYPE='.'&TYPE'                                  @G387PXR 22630000
         IHBERMAC 1020,ASCB,&MESSAGE                           @G387PXR 22640000
         MEXIT                                                 @G387PXR 22650000
.ERRBR   ANOP                                                           22660000
.*       IHB280 BRANCH INVALID WITH OBTAIN/RELEASE                      22670000
         IHBERMAC 1020,BRANCH,&REQUEST                                  22680000
         MEXIT                                                          22690000
.ERRDIS1 ANOP                                                  @G860PXA 22700000
.*       IHB244 INVALID POSIT-NL XXX OPERAND                            22710000
         IHBERMAC 1008,&DISABLE,1                                       22720000
         MEXIT                                                          22730000
.ERRDIS2 ANOP                                                           22740000
.*       IHB280 DISABLE INVALID WITH CMS/LOCAL/CML/CPU                  22750000
         IHBERMAC 1020,&DISABLE,&TYPE                                   22760000
         MEXIT                                                          22770000
.ERRDIS3 ANOP                                                           22780000
.*       IHB280 DISABLE INVALID WITH COND OR SUSPEND LOCK OBTAIN        22790000
&MESSAGE SETC 'COND OR SUSPEND LOCK OBTAIN'                             22800000
         IHBERMAC 1020,&DISABLE,&MESSAGE                                22810000
         MEXIT                                                          22820000
.ERREG1  ANOP                                                           22830000
.*       IHB280 REGISTER NOTATION INVALID WITH ADDR                     22840000
&MESSAGE SETC 'REGISTER NOTATION'                                       22850000
         IHBERMAC 1020,&MESSAGE,ADDR                                    22860000
         MEXIT                                                          22870000
.ERREG2  ANOP                                                  @G387PXR 22880000
.*       IHB280 REGISTER NOTATION INVALID WITH ASCB            @G387PXR 22890000
&MESSAGE SETC 'REGISTER NOTATION'                              @G387PXR 22900000
         IHBERMAC 1020,&MESSAGE,ASCB                           @G387PXR 22910000
         MEXIT                                                 @G387PXR 22920000
.ERREG3  ANOP                                                  @G387PXR 22930000
.*       IHB280 REGISTER NOTATION INVALID WITH INSTDATA            @LIA 22940000
&MESSAGE SETC 'REGISTER NOTATION'                                  @LIA 22950000
         IHBERMAC 1020,&MESSAGE,INSTDATA                           @LIA 22960000
         MEXIT                                                     @LIA 22970000
.ERRLHLD ANOP                                                      @L8A 22980000
.*       IHB280 LOCKHLD INVALID WITH OBTAIN/RELEASE                @L8A 22981000
         IHBERMAC 1020,LOCKHLD,&REQUEST                            @L8A 22982000
         MEXIT                                                     @L8A 22983000
.ERRLOCK ANOP                                                  @G387PXR 22984000
.*       IHB280 LOCKHLD INVALID WITH TYPE=XXX                  @G387PXR 22985000
&MESSAGE SETC 'TYPE='.'&TYPE'                                  @G387PXR 22986000
         IHBERMAC 1020,LOCKHLD,&MESSAGE                        @G387PXR 22987000
         MEXIT                                                 @G387PXR 22988000
.ERRMODE ANOP                                                           22989000
.*       IHB280 MODE INVALID WITH RELEASE                               22990000
         IHBERMAC 1020,MODE,RELEASE                                     23000000
         MEXIT                                                          23010000
.ERRINSTDATA1 ANOP                                                 @LIA 23020000
.*       IHB280 INSTDATA INVALID WITH RELEASE                      @LIA 23030000
         IHBERMAC 1020,INSTDATA,RELEASE                            @LIA 23040000
         MEXIT                                                     @LIA 23050000
.ERRINSTDATA2 ANOP                                                 @LIA 23060000
.*       IHB246 INSTDATA OPERAND SPECIFIED WITHOUT ADDR OPERAND.   @LIA 23070000
         IHBERMAC 1010,INSTDATA,ADDR                               @LIA 23080000
         MEXIT                                                     @LIA 23090000
.ERRINSTDATA3 ANOP                                                 @LIA 23100000
.*       IHB280 INSTDATA INVALID WITH MODE=COND                    @LIA 23110000
         IHBERMAC 1020,INSTDATA,MODE=COND                          @LIA 23111000
         MEXIT                                                     @LIA 23112000
.ERRINSTDATA4 ANOP                                                 @LIA 23113000
.*       IHB280 INSTDATA INVALID WITH REGS=USE                     @LIA 23114000
         IHBERMAC 1020,INSTDATA,REGS=USE                           @LIA 23114100
         MEXIT                                                     @LIA 23114200
.ERRINSTDATA5 ANOP                                                 @LIA 23114300
.*       IHB280 INSTDATA INVALID WITH TEST                         @LIA 23114400
         IHBERMAC 1020,INSTDATA,TEST                               @LIA 23114500
         MEXIT                                                     @LIA 23114600
.ERRREQ  ANOP                                                           23114700
         IHBERMAC 24                                                    23114800
         MEXIT                                                          23114900
.ERRTYPE ANOP                                                  @G387PXR 23115000
.*       IHB001 TYPE OPERAND REQUIRED, NOT SPECIFIED           @G387PXR 23116000
         IHBERMAC 1006,TYPE                                    @G387PXR 23117000
         MEXIT                                                 @G387PXR 23118000
.ERRWK   ANOP                                                           23119000
         MNOTE 12,'WORKREG KEYWORD IS NOT VALID WITH OBTAIN/RELEASE'    23120000
         MEXIT                                                          23130000
.INVCOND ANOP                                                           23140000
.*       IHB002 INVALID BRANCH OPERAND SPECIFIED - XXX                  23150000
         IHBERMAC 1001,BRANCH,&BRANCH(1)                                23160000
         MEXIT                                                          23170000
.INVDIS  ANOP                                                  @G860PXA 23180000
.*       IHB280 DISABLE INVALID WITH CPU                       @G860PXA 23190000
         IHBERMAC 1020,&DISABLE,&TYPE                          @G860PXA 23200000
         MEXIT                                                 @G860PXA 23210000
.INVMODE ANOP                                                           23220000
.*       IHB280 MODE INVALID WITH TEST                                  23230000
         IHBERMAC 1020,MODE,TEST                                        23240000
         MEXIT                                                          23250000
.INVSCOP ANOP                                                  @G860PXA 23260000
.*       IHB002 INVALID SCOPE OPERAND SPECIFIED - XXX          @G860PXA 23270000
         IHBERMAC 1001,SCOPE,&SCOPE                            @G860PXA 23280000
         MEXIT                                                 @G860PXA 23290000
.INVTYP  ANOP                                                           23300000
.*       IHB002 INVALID TYPE OPERAND SPECIFIED - XXX                    23310000
         IHBERMAC 1001,TYPE,&TYPE                                       23320000
         MEXIT                                                          23330000
.INVWKRG ANOP                                                      @L8A 23340000
.*       IHB280 WORKREG INVALID WITH TYPE=(REG)                    @L8A 23350000
&MESSAGE SETC 'TYPE='.'&TYPE'                                  @G387PXR 23360000
         IHBERMAC 1020,WORKREG,&MESSAGE                        @G387PXR 23370000
         MEXIT                                                 @G387PXR 23380000
.LKASREQ ANOP                                                  @G387PXR 23390000
.*       IHB001 LOCKHLD/ASCB OPERAND REQUIRED NOT SPECIFIED    @G387PXR 23400000
         IHBERMAC 1006,LOCKHLD/ASCB                            @G387PXR 23410000
         MEXIT                                                 @G387PXR 23420000
.LKHINV  ANOP                                                  @G387PXR 23430000
.*       IHB280 LOCKHLD INVALID WITH ASCB                      @G387PXR 23440000
         IHBERMAC 1020,LOCKHLD,ASCB                            @G387PXR 23450000
         MEXIT                                                 @G387PXR 23460000
.MODERR  ANOP                                                           23470000
.*       IHB002 INVALID MODE OPERAND SPECIFIED - XXX                    23480000
         IHBERMAC 1001,MODE,&MODE                                       23490000
         MEXIT                                                          23500000
.NODIS   ANOP                                                           23510000
.*       IHB280 DISABLED INVALID WITH TEST                              23520000
         IHBERMAC 1020,&DISABLE,TEST                                    23530000
         MEXIT                                                          23540000
.NOLOCK  ANOP                                                           23550000
         MNOTE 12,'LOCK KEYWORD IS NOT VALID WITH OBTAIN/RELEASE'       23560000
         MEXIT                                                          23570000
.NOMODE  ANOP                                                           23580000
.*       IHB001 MODE OPERAND REQUIRED, NOT SPECIFIED                    23590000
         IHBERMAC 1006,MODE                                             23600000
         MEXIT                                                          23610000
.NOREGS  ANOP                                                      @L8A 23620000
         MNOTE 12,' ON SETLOCK TEST, REGS IS ONLY VALID WITH TYPE=(REG)*23630000
               . '                                                 @P5C 23640000
         MEXIT                                                     @L8A 23650000
.NOSCOPE ANOP                                                  @G860PXA 23660000
.*       IHB280 SCOPE INVALID WITH TYPE=XXX                    @G860PXA 23670000
&MESSAGE SETC 'TYPE='.'&TYPE'                                  @G860PXA 23680000
         IHBERMAC 1020,SCOPE,&MESSAGE                          @G860PXA 23690000
         MEXIT                                                 @G860PXA 23700000
.NOTAREG ANOP                                                      @L8A 23710000
         MNOTE 12,'WORKREG REQUIRES A REGISTER OPERAND'            @L8A 23720000
         MEXIT                                                     @L8A 23730000
.NOTYP   ANOP                                                           23740000
.*       IHB001 TYPE OPERAND REQUIRED, NOT SPECIFIED                    23750000
         IHBERMAC 1006,TYPE                                             23760000
         MEXIT                                                          23770000
.NOWKREG ANOP                                                      @L8A 23780000
         MNOTE 12,'WORKREG IS REQUIRED WITH BRANCH'                @L8A 23790000
         MEXIT                                                          23800000
.REGINV4 ANOP                                                      @L8A 23810000
         MNOTE 0,'REGS IGNORED WITH SPECIFIED TYPE'                @L8A 23820000
         AGO .REGRET4                                              @L8A 23830000
.REGREQ  ANOP                                                      @L8A 23840000
         MNOTE 12,' REGS IS REQUIRED IF BOTH TYPE=(REG) AND BRANCH ARE *23850000
               SPECIFIED. '                                        @P5C 23860000
         MEXIT                                                          23870000
.RREGASI ANOP                                                      @L8A 23880000
.*       IHB280 ASCB INVALID WITH TYPE=REG                         @L8A 23890000
&MESSAGE SETC 'TYPE='.'&TYPE'                                      @L8A 23900000
         IHBERMAC 1020,ASCB,&MESSAGE                               @L8A 23910000
         MEXIT                                                          23920000
.RREGLKH ANOP                                                      @L8A 23930000
.*       IHB280 LOCKHLD INVALID WITH TYPE=REG                      @L8A 23940000
&MESSAGE SETC 'TYPE='.'&TYPE'                                      @L8A 23950000
         IHBERMAC 1020,LOCKHLD,&MESSAGE                            @L8A 23960000
         MEXIT                                                          23970000
.SCOPREQ ANOP                                                  @G860PXA 23980000
.*       IHB001 SCOPE OPERAND REQUIRED, NOT SPECIFIED          @G860PXA 23990000
         IHBERMAC 1006,SCOPE                                   @G860PXA 24000000
         MEXIT                                                 @G860PXA 24010000
.BLKHLD  ANOP                                                  @G387PXR 24020000
.*       IHB002 INVALID LOCKHLD OPERAND SPECIFIED - XXX        @G387PXR 24030000
         IHBERMAC 1001,LOCKHLD,&LOCKHLD                        @G387PXR 24040000
         MEXIT                                                 @G387PXR 24050000
.TCMLANV ANOP                                                  @G387PXR 24060000
.*       IHB002  INVALID ASCB OPERAND SPECIFIED - XXX          @G387PXR 24070000
         IHBERMAC 1001,ASCB,&ASCB                              @G387PXR 24080000
         MEXIT                                                 @G387PXR 24090000
.TERR007 ANOP                                                  @G860PXA 24100000
.*       IHB001 LOCK OPERAND REQUIRED, NOT SPECIFIED           @G860PXA 24110000
         IHBERMAC 1006,LOCK                                    @G860PXA 24120000
         MEXIT                                                 @G860PXA 24130000
.TERR008 ANOP                                                  @G860PXA 24140000
.*       IHB002 INVALID LOCK OPERAND SPECIFIED                 @G860PXA 24150000
         IHBERMAC 1001,LOCK,&LOCK                              @G860PXA 24160000
         MEXIT                                                 @G860PXA 24170000
.TERR009 ANOP                                                      @L8A 24180000
.*       IHB280 LOCK INVALID WITH TYPE=XXX                         @L8A 24190000
&MESSAGE SETC 'TYPE='.'&TYPE'                                      @L8A 24200000
         IHBERMAC 1020,LOCK,&MESSAGE                               @L8A 24210000
         MEXIT                                                     @L8A 24220000
.TINVBR  ANOP                                                      @L8A 24230000
         MNOTE 12,'TWO BRANCH VALUES ARE REQUIRED'                 @L8A 24240000
         MEXIT                                                          24250000
.TINVWK  ANOP                                                      @L8A 24260000
         MNOTE 12,'ONE WORKREG VALUE IS REQUIRED'                  @L8A 24270000
         MEXIT                                                     @L8A 24280000
.TREGCA  ANOP                                                  @G387PXR 24290000
.*       IHB280 ASCB INVALID WITH TYPE=REG                     @G387PXR 24300000
&MESSAGE SETC   'TYPE='.'&TYPE'                                @G387PXR 24310000
         IHBERMAC 1020,ASCB,&MESSAGE                           @G387PXR 24320000
         MEXIT                                                 @G387PXR 24330000
.TSTBADR ANOP                                                           24340000
.*       IHB002 INVALID ADDR OPERAND SPECIFIED - XXX                    24350000
         IHBERMAC 1001,ADDR,&ADDR                                       24360000
         MEXIT                                                          24370000
.WARNWK  ANOP                                                      @L8A 24380000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 24390000
         AGO   .WRNWKR                                             @L8A 24400000
.WARNWK2 ANOP                                                      @L8A 24410000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 24420000
         AGO   .WRNWKR2                                            @L8A 24430000
.WARNWK5 ANOP                                                      @L8A 24440000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 24450000
         AGO   .NN5                                                @L8A 24460000
.WARNWKA ANOP                                                      @L8A 24470000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 24480000
         AGO   .NAMCK                                              @L8A 24490000
.WARNWKB ANOP                                                      @L8A 24500000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 24510000
         AGO   .WRNWKRB                                            @L8A 24520000
.WARNWKC ANOP                                                      @L8A 24530000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 24540000
         AGO   .CMLPROC                                            @L8A 24550000
.WARNWKD ANOP                                                      @L8A 24560000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 24570000
         AGO   .TALOCNN                                            @L8A 24580000
.WARNWKE ANOP                                                      @L8A 24590000
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 24600000
         AGO   .WRNWKRE                                            @L8A 24610000
.LEVEL1  ANOP                                                  @G860PXD 24620000
&NAME    SETLOCK8 &REQUEST,TYPE=&TYPE,ADDR=&ADDR,MODE=&MODE,   @G860PXD-24630000
               RELATED=&RELATED,REGS=&REGS,BRANCH=&BRANCH,     @G860PXD-24640000
               ASCB=&ASCB,LOCKHLD=&LOCKHLD,&DISABLE,               @P3C-24650000
               LOCK=&LOCK,SCOPE=&SCOPE                             @P3C 24660000
         MEXIT                                                 @G860PXD 24670000
         MEND                                                           24680000
* */                                                                    24690000
*  SETLOCK :                                                            24700000
*  MACRO                                                                24710000
*  KEYS(TYPE,ADDR,MODE,DISABLED,ASCB,SCOPE,REGS,LOCK,      /*@ZMC0463*/ 24720000
*       BRANCH,LOCKHLD,WORKREG,RELATED,INSTDATA,ELSEUSESETLOCK);        24730000
*  ANS('?'!!MACLABEL!!'SETLOCKP '!!MACLIST!!MACKEYS!!';');              24740000
*% END;                                                                 24750000
